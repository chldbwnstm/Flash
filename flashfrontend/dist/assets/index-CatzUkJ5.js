var mk=Object.defineProperty;var pk=(a,e,i)=>e in a?mk(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i;var ss=(a,e,i)=>pk(a,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();var md={exports:{}},kr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function gk(){if(Gg)return kr;Gg=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(s,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:a,type:s,key:u,ref:o!==void 0?o:null,props:l}}return kr.Fragment=e,kr.jsx=i,kr.jsxs=i,kr}var Yg;function vk(){return Yg||(Yg=1,md.exports=gk()),md.exports}var C=vk(),pd={exports:{}},ve={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function yk(){if(Kg)return ve;Kg=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,E={};function _(D,J,fe){this.props=D,this.context=J,this.refs=E,this.updater=fe||k}_.prototype.isReactComponent={},_.prototype.setState=function(D,J){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,J,"setState")},_.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function O(){}O.prototype=_.prototype;function q(D,J,fe){this.props=D,this.context=J,this.refs=E,this.updater=fe||k}var j=q.prototype=new O;j.constructor=q,T(j,_.prototype),j.isPureReactComponent=!0;var M=Array.isArray,x={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function W(D,J,fe,ue,se,Ee){return fe=Ee.ref,{$$typeof:a,type:D,key:J,ref:fe!==void 0?fe:null,props:Ee}}function ae(D,J){return W(D.type,J,void 0,void 0,void 0,D.props)}function X(D){return typeof D=="object"&&D!==null&&D.$$typeof===a}function ee(D){var J={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(fe){return J[fe]})}var le=/\/+/g;function Oe(D,J){return typeof D=="object"&&D!==null&&D.key!=null?ee(""+D.key):J.toString(36)}function dt(){}function xt(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(dt,dt):(D.status="pending",D.then(function(J){D.status==="pending"&&(D.status="fulfilled",D.value=J)},function(J){D.status==="pending"&&(D.status="rejected",D.reason=J)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function Tt(D,J,fe,ue,se){var Ee=typeof D;(Ee==="undefined"||Ee==="boolean")&&(D=null);var ye=!1;if(D===null)ye=!0;else switch(Ee){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(D.$$typeof){case a:case e:ye=!0;break;case g:return ye=D._init,Tt(ye(D._payload),J,fe,ue,se)}}if(ye)return se=se(D),ye=ue===""?"."+Oe(D,0):ue,M(se)?(fe="",ye!=null&&(fe=ye.replace(le,"$&/")+"/"),Tt(se,J,fe,"",function(it){return it})):se!=null&&(X(se)&&(se=ae(se,fe+(se.key==null||D&&D.key===se.key?"":(""+se.key).replace(le,"$&/")+"/")+ye)),J.push(se)),1;ye=0;var _t=ue===""?".":ue+":";if(M(D))for(var Ne=0;Ne<D.length;Ne++)ue=D[Ne],Ee=_t+Oe(ue,Ne),ye+=Tt(ue,J,fe,Ee,se);else if(Ne=b(D),typeof Ne=="function")for(D=Ne.call(D),Ne=0;!(ue=D.next()).done;)ue=ue.value,Ee=_t+Oe(ue,Ne++),ye+=Tt(ue,J,fe,Ee,se);else if(Ee==="object"){if(typeof D.then=="function")return Tt(xt(D),J,fe,ue,se);throw J=String(D),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return ye}function ne(D,J,fe){if(D==null)return D;var ue=[],se=0;return Tt(D,ue,"","",function(Ee){return J.call(fe,Ee,se++)}),ue}function pe(D){if(D._status===-1){var J=D._result;J=J(),J.then(function(fe){(D._status===0||D._status===-1)&&(D._status=1,D._result=fe)},function(fe){(D._status===0||D._status===-1)&&(D._status=2,D._result=fe)}),D._status===-1&&(D._status=0,D._result=J)}if(D._status===1)return D._result.default;throw D._result}var he=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function Be(){}return ve.Children={map:ne,forEach:function(D,J,fe){ne(D,function(){J.apply(this,arguments)},fe)},count:function(D){var J=0;return ne(D,function(){J++}),J},toArray:function(D){return ne(D,function(J){return J})||[]},only:function(D){if(!X(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},ve.Component=_,ve.Fragment=i,ve.Profiler=o,ve.PureComponent=q,ve.StrictMode=s,ve.Suspense=m,ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,ve.act=function(){throw Error("act(...) is not supported in production builds of React.")},ve.cache=function(D){return function(){return D.apply(null,arguments)}},ve.cloneElement=function(D,J,fe){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var ue=T({},D.props),se=D.key,Ee=void 0;if(J!=null)for(ye in J.ref!==void 0&&(Ee=void 0),J.key!==void 0&&(se=""+J.key),J)!F.call(J,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&J.ref===void 0||(ue[ye]=J[ye]);var ye=arguments.length-2;if(ye===1)ue.children=fe;else if(1<ye){for(var _t=Array(ye),Ne=0;Ne<ye;Ne++)_t[Ne]=arguments[Ne+2];ue.children=_t}return W(D.type,se,void 0,void 0,Ee,ue)},ve.createContext=function(D){return D={$$typeof:u,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:l,_context:D},D},ve.createElement=function(D,J,fe){var ue,se={},Ee=null;if(J!=null)for(ue in J.key!==void 0&&(Ee=""+J.key),J)F.call(J,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(se[ue]=J[ue]);var ye=arguments.length-2;if(ye===1)se.children=fe;else if(1<ye){for(var _t=Array(ye),Ne=0;Ne<ye;Ne++)_t[Ne]=arguments[Ne+2];se.children=_t}if(D&&D.defaultProps)for(ue in ye=D.defaultProps,ye)se[ue]===void 0&&(se[ue]=ye[ue]);return W(D,Ee,void 0,void 0,null,se)},ve.createRef=function(){return{current:null}},ve.forwardRef=function(D){return{$$typeof:d,render:D}},ve.isValidElement=X,ve.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:pe}},ve.memo=function(D,J){return{$$typeof:h,type:D,compare:J===void 0?null:J}},ve.startTransition=function(D){var J=x.T,fe={};x.T=fe;try{var ue=D(),se=x.S;se!==null&&se(fe,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(Be,he)}catch(Ee){he(Ee)}finally{x.T=J}},ve.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},ve.use=function(D){return x.H.use(D)},ve.useActionState=function(D,J,fe){return x.H.useActionState(D,J,fe)},ve.useCallback=function(D,J){return x.H.useCallback(D,J)},ve.useContext=function(D){return x.H.useContext(D)},ve.useDebugValue=function(){},ve.useDeferredValue=function(D,J){return x.H.useDeferredValue(D,J)},ve.useEffect=function(D,J){return x.H.useEffect(D,J)},ve.useId=function(){return x.H.useId()},ve.useImperativeHandle=function(D,J,fe){return x.H.useImperativeHandle(D,J,fe)},ve.useInsertionEffect=function(D,J){return x.H.useInsertionEffect(D,J)},ve.useLayoutEffect=function(D,J){return x.H.useLayoutEffect(D,J)},ve.useMemo=function(D,J){return x.H.useMemo(D,J)},ve.useOptimistic=function(D,J){return x.H.useOptimistic(D,J)},ve.useReducer=function(D,J,fe){return x.H.useReducer(D,J,fe)},ve.useRef=function(D){return x.H.useRef(D)},ve.useState=function(D){return x.H.useState(D)},ve.useSyncExternalStore=function(D,J,fe){return x.H.useSyncExternalStore(D,J,fe)},ve.useTransition=function(){return x.H.useTransition()},ve.version="19.0.0",ve}var Qg;function Mf(){return Qg||(Qg=1,pd.exports=yk()),pd.exports}var z=Mf(),gd={exports:{}},Cr={},vd={exports:{}},yd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function bk(){return Xg||(Xg=1,function(a){function e(ne,pe){var he=ne.length;ne.push(pe);e:for(;0<he;){var Be=he-1>>>1,D=ne[Be];if(0<o(D,pe))ne[Be]=pe,ne[he]=D,he=Be;else break e}}function i(ne){return ne.length===0?null:ne[0]}function s(ne){if(ne.length===0)return null;var pe=ne[0],he=ne.pop();if(he!==pe){ne[0]=he;e:for(var Be=0,D=ne.length,J=D>>>1;Be<J;){var fe=2*(Be+1)-1,ue=ne[fe],se=fe+1,Ee=ne[se];if(0>o(ue,he))se<D&&0>o(Ee,ue)?(ne[Be]=Ee,ne[se]=he,Be=se):(ne[Be]=ue,ne[fe]=he,Be=fe);else if(se<D&&0>o(Ee,he))ne[Be]=Ee,ne[se]=he,Be=se;else break e}}return pe}function o(ne,pe){var he=ne.sortIndex-pe.sortIndex;return he!==0?he:ne.id-pe.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;a.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();a.unstable_now=function(){return u.now()-d}}var m=[],h=[],g=1,v=null,b=3,k=!1,T=!1,E=!1,_=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function j(ne){for(var pe=i(h);pe!==null;){if(pe.callback===null)s(h);else if(pe.startTime<=ne)s(h),pe.sortIndex=pe.expirationTime,e(m,pe);else break;pe=i(h)}}function M(ne){if(E=!1,j(ne),!T)if(i(m)!==null)T=!0,xt();else{var pe=i(h);pe!==null&&Tt(M,pe.startTime-ne)}}var x=!1,F=-1,W=5,ae=-1;function X(){return!(a.unstable_now()-ae<W)}function ee(){if(x){var ne=a.unstable_now();ae=ne;var pe=!0;try{e:{T=!1,E&&(E=!1,O(F),F=-1),k=!0;var he=b;try{t:{for(j(ne),v=i(m);v!==null&&!(v.expirationTime>ne&&X());){var Be=v.callback;if(typeof Be=="function"){v.callback=null,b=v.priorityLevel;var D=Be(v.expirationTime<=ne);if(ne=a.unstable_now(),typeof D=="function"){v.callback=D,j(ne),pe=!0;break t}v===i(m)&&s(m),j(ne)}else s(m);v=i(m)}if(v!==null)pe=!0;else{var J=i(h);J!==null&&Tt(M,J.startTime-ne),pe=!1}}break e}finally{v=null,b=he,k=!1}pe=void 0}}finally{pe?le():x=!1}}}var le;if(typeof q=="function")le=function(){q(ee)};else if(typeof MessageChannel<"u"){var Oe=new MessageChannel,dt=Oe.port2;Oe.port1.onmessage=ee,le=function(){dt.postMessage(null)}}else le=function(){_(ee,0)};function xt(){x||(x=!0,le())}function Tt(ne,pe){F=_(function(){ne(a.unstable_now())},pe)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(ne){ne.callback=null},a.unstable_continueExecution=function(){T||k||(T=!0,xt())},a.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ne?Math.floor(1e3/ne):5},a.unstable_getCurrentPriorityLevel=function(){return b},a.unstable_getFirstCallbackNode=function(){return i(m)},a.unstable_next=function(ne){switch(b){case 1:case 2:case 3:var pe=3;break;default:pe=b}var he=b;b=pe;try{return ne()}finally{b=he}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(ne,pe){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var he=b;b=ne;try{return pe()}finally{b=he}},a.unstable_scheduleCallback=function(ne,pe,he){var Be=a.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Be+he:Be):he=Be,ne){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=he+D,ne={id:g++,callback:pe,priorityLevel:ne,startTime:he,expirationTime:D,sortIndex:-1},he>Be?(ne.sortIndex=he,e(h,ne),i(m)===null&&ne===i(h)&&(E?(O(F),F=-1):E=!0,Tt(M,he-Be))):(ne.sortIndex=D,e(m,ne),T||k||(T=!0,xt())),ne},a.unstable_shouldYield=X,a.unstable_wrapCallback=function(ne){var pe=b;return function(){var he=b;b=pe;try{return ne.apply(this,arguments)}finally{b=he}}}}(yd)),yd}var Jg;function Sk(){return Jg||(Jg=1,vd.exports=bk()),vd.exports}var bd={exports:{}},Et={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg;function Tk(){if(Zg)return Et;Zg=1;var a=Mf();function e(m){var h="https://react.dev/errors/"+m;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+m+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(m,h,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:m,containerInfo:h,implementation:g}}var u=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(m,h){if(m==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Et.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Et.createPortal=function(m,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(m,h,null,g)},Et.flushSync=function(m){var h=u.T,g=s.p;try{if(u.T=null,s.p=2,m)return m()}finally{u.T=h,s.p=g,s.d.f()}},Et.preconnect=function(m,h){typeof m=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(m,h))},Et.prefetchDNS=function(m){typeof m=="string"&&s.d.D(m)},Et.preinit=function(m,h){if(typeof m=="string"&&h&&typeof h.as=="string"){var g=h.as,v=d(g,h.crossOrigin),b=typeof h.integrity=="string"?h.integrity:void 0,k=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?s.d.S(m,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:k}):g==="script"&&s.d.X(m,{crossOrigin:v,integrity:b,fetchPriority:k,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Et.preinitModule=function(m,h){if(typeof m=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=d(h.as,h.crossOrigin);s.d.M(m,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(m)},Et.preload=function(m,h){if(typeof m=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,v=d(g,h.crossOrigin);s.d.L(m,g,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Et.preloadModule=function(m,h){if(typeof m=="string")if(h){var g=d(h.as,h.crossOrigin);s.d.m(m,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(m)},Et.requestFormReset=function(m){s.d.r(m)},Et.unstable_batchedUpdates=function(m,h){return m(h)},Et.useFormState=function(m,h,g){return u.H.useFormState(m,h,g)},Et.useFormStatus=function(){return u.H.useHostTransitionStatus()},Et.version="19.0.0",Et}var Wg;function kk(){if(Wg)return bd.exports;Wg=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),bd.exports=Tk(),bd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function Ck(){if($g)return Cr;$g=1;var a=Sk(),e=Mf(),i=kk();function s(t){var n="https://react.dev/errors/"+t;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}var l=Symbol.for("react.element"),u=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),k=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),M=Symbol.for("react.memo_cache_sentinel"),x=Symbol.iterator;function F(t){return t===null||typeof t!="object"?null:(t=x&&t[x]||t["@@iterator"],typeof t=="function"?t:null)}var W=Symbol.for("react.client.reference");function ae(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===W?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case m:return"Fragment";case d:return"Portal";case g:return"Profiler";case h:return"StrictMode";case E:return"Suspense";case _:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case k:return(t.displayName||"Context")+".Provider";case b:return(t._context.displayName||"Context")+".Consumer";case T:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case O:return n=t.displayName||null,n!==null?n:ae(t.type)||"Memo";case q:n=t._payload,t=t._init;try{return ae(t(n))}catch{}}return null}var X=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=Object.assign,le,Oe;function dt(t){if(le===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);le=n&&n[1]||"",Oe=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+le+t+Oe}var xt=!1;function Tt(t,n){if(!t||xt)return"";xt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var K=function(){throw Error()};if(Object.defineProperty(K.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(K,[])}catch(H){var L=H}Reflect.construct(t,[],K)}else{try{K.call()}catch(H){L=H}t.call(K.prototype)}}else{try{throw Error()}catch(H){L=H}(K=t())&&typeof K.catch=="function"&&K.catch(function(){})}}catch(H){if(H&&L&&typeof H.stack=="string")return[H.stack,L.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),y=p[0],S=p[1];if(y&&S){var R=y.split(`
`),N=S.split(`
`);for(f=c=0;c<R.length&&!R[c].includes("DetermineComponentFrameRoot");)c++;for(;f<N.length&&!N[f].includes("DetermineComponentFrameRoot");)f++;if(c===R.length||f===N.length)for(c=R.length-1,f=N.length-1;1<=c&&0<=f&&R[c]!==N[f];)f--;for(;1<=c&&0<=f;c--,f--)if(R[c]!==N[f]){if(c!==1||f!==1)do if(c--,f--,0>f||R[c]!==N[f]){var V=`
`+R[c].replace(" at new "," at ");return t.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",t.displayName)),V}while(1<=c&&0<=f);break}}}finally{xt=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?dt(r):""}function ne(t){switch(t.tag){case 26:case 27:case 5:return dt(t.type);case 16:return dt("Lazy");case 13:return dt("Suspense");case 19:return dt("SuspenseList");case 0:case 15:return t=Tt(t.type,!1),t;case 11:return t=Tt(t.type.render,!1),t;case 1:return t=Tt(t.type,!0),t;default:return""}}function pe(t){try{var n="";do n+=ne(t),t=t.return;while(t);return n}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function he(t){var n=t,r=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(r=n.return),t=n.return;while(t)}return n.tag===3?r:null}function Be(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function D(t){if(he(t)!==t)throw Error(s(188))}function J(t){var n=t.alternate;if(!n){if(n=he(t),n===null)throw Error(s(188));return n!==t?null:t}for(var r=t,c=n;;){var f=r.return;if(f===null)break;var p=f.alternate;if(p===null){if(c=f.return,c!==null){r=c;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===r)return D(f),t;if(p===c)return D(f),n;p=p.sibling}throw Error(s(188))}if(r.return!==c.return)r=f,c=p;else{for(var y=!1,S=f.child;S;){if(S===r){y=!0,r=f,c=p;break}if(S===c){y=!0,c=f,r=p;break}S=S.sibling}if(!y){for(S=p.child;S;){if(S===r){y=!0,r=p,c=f;break}if(S===c){y=!0,c=p,r=f;break}S=S.sibling}if(!y)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?t:n}function fe(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t;for(t=t.child;t!==null;){if(n=fe(t),n!==null)return n;t=t.sibling}return null}var ue=Array.isArray,se=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},ye=[],_t=-1;function Ne(t){return{current:t}}function it(t){0>_t||(t.current=ye[_t],ye[_t]=null,_t--)}function He(t,n){_t++,ye[_t]=t.current,t.current=n}var Tn=Ne(null),Rs=Ne(null),oi=Ne(null),Kr=Ne(null);function Qr(t,n){switch(He(oi,n),He(Rs,t),He(Tn,null),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)&&(n=n.namespaceURI)?Sg(n):0;break;default:if(t=t===8?n.parentNode:n,n=t.tagName,t=t.namespaceURI)t=Sg(t),n=Tg(t,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}it(Tn),He(Tn,n)}function Ca(){it(Tn),it(Rs),it(oi)}function sl(t){t.memoizedState!==null&&He(Kr,t);var n=Tn.current,r=Tg(n,t.type);n!==r&&(He(Rs,t),He(Tn,r))}function Xr(t){Rs.current===t&&(it(Tn),it(Rs)),Kr.current===t&&(it(Kr),vr._currentValue=Ee)}var rl=Object.prototype.hasOwnProperty,ol=a.unstable_scheduleCallback,cl=a.unstable_cancelCallback,Yb=a.unstable_shouldYield,Kb=a.unstable_requestPaint,kn=a.unstable_now,Qb=a.unstable_getCurrentPriorityLevel,lh=a.unstable_ImmediatePriority,uh=a.unstable_UserBlockingPriority,Jr=a.unstable_NormalPriority,Xb=a.unstable_LowPriority,dh=a.unstable_IdlePriority,Jb=a.log,Zb=a.unstable_setDisableYieldValue,_s=null,It=null;function Wb(t){if(It&&typeof It.onCommitFiberRoot=="function")try{It.onCommitFiberRoot(_s,t,void 0,(t.current.flags&128)===128)}catch{}}function ci(t){if(typeof Jb=="function"&&Zb(t),It&&typeof It.setStrictMode=="function")try{It.setStrictMode(_s,t)}catch{}}var Bt=Math.clz32?Math.clz32:tS,$b=Math.log,eS=Math.LN2;function tS(t){return t>>>=0,t===0?32:31-($b(t)/eS|0)|0}var Zr=128,Wr=4194304;function Fi(t){var n=t&42;if(n!==0)return n;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function $r(t,n){var r=t.pendingLanes;if(r===0)return 0;var c=0,f=t.suspendedLanes,p=t.pingedLanes,y=t.warmLanes;t=t.finishedLanes!==0;var S=r&134217727;return S!==0?(r=S&~f,r!==0?c=Fi(r):(p&=S,p!==0?c=Fi(p):t||(y=S&~y,y!==0&&(c=Fi(y))))):(S=r&~f,S!==0?c=Fi(S):p!==0?c=Fi(p):t||(y=r&~y,y!==0&&(c=Fi(y)))),c===0?0:n!==0&&n!==c&&(n&f)===0&&(f=c&-c,y=n&-n,f>=y||f===32&&(y&4194176)!==0)?n:c}function ws(t,n){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&n)===0}function nS(t,n){switch(t){case 1:case 2:case 4:case 8:return n+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fh(){var t=Zr;return Zr<<=1,(Zr&4194176)===0&&(Zr=128),t}function hh(){var t=Wr;return Wr<<=1,(Wr&62914560)===0&&(Wr=4194304),t}function ll(t){for(var n=[],r=0;31>r;r++)n.push(t);return n}function Os(t,n){t.pendingLanes|=n,n!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function iS(t,n,r,c,f,p){var y=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var S=t.entanglements,R=t.expirationTimes,N=t.hiddenUpdates;for(r=y&~r;0<r;){var V=31-Bt(r),K=1<<V;S[V]=0,R[V]=-1;var L=N[V];if(L!==null)for(N[V]=null,V=0;V<L.length;V++){var H=L[V];H!==null&&(H.lane&=-536870913)}r&=~K}c!==0&&mh(t,c,0),p!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=p&~(y&~n))}function mh(t,n,r){t.pendingLanes|=n,t.suspendedLanes&=~n;var c=31-Bt(n);t.entangledLanes|=n,t.entanglements[c]=t.entanglements[c]|1073741824|r&4194218}function ph(t,n){var r=t.entangledLanes|=n;for(t=t.entanglements;r;){var c=31-Bt(r),f=1<<c;f&n|t[c]&n&&(t[c]|=n),r&=~f}}function gh(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function vh(){var t=se.p;return t!==0?t:(t=window.event,t===void 0?32:Bg(t.type))}function aS(t,n){var r=se.p;try{return se.p=t,n()}finally{se.p=r}}var li=Math.random().toString(36).slice(2),kt="__reactFiber$"+li,Dt="__reactProps$"+li,Ea="__reactContainer$"+li,ul="__reactEvents$"+li,sS="__reactListeners$"+li,rS="__reactHandles$"+li,yh="__reactResources$"+li,xs="__reactMarker$"+li;function dl(t){delete t[kt],delete t[Dt],delete t[ul],delete t[sS],delete t[rS]}function Gi(t){var n=t[kt];if(n)return n;for(var r=t.parentNode;r;){if(n=r[Ea]||r[kt]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(t=Eg(t);t!==null;){if(r=t[kt])return r;t=Eg(t)}return n}t=r,r=t.parentNode}return null}function Ra(t){if(t=t[kt]||t[Ea]){var n=t.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return t}return null}function Ds(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t.stateNode;throw Error(s(33))}function _a(t){var n=t[yh];return n||(n=t[yh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ft(t){t[xs]=!0}var bh=new Set,Sh={};function Yi(t,n){wa(t,n),wa(t+"Capture",n)}function wa(t,n){for(Sh[t]=n,t=0;t<n.length;t++)bh.add(n[t])}var jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Th={},kh={};function cS(t){return rl.call(kh,t)?!0:rl.call(Th,t)?!1:oS.test(t)?kh[t]=!0:(Th[t]=!0,!1)}function eo(t,n,r){if(cS(n))if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(n);return}}t.setAttribute(n,""+r)}}function to(t,n,r){if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttribute(n,""+r)}}function In(t,n,r,c){if(c===null)t.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(n,r,""+c)}}function Xt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ch(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function lS(t){var n=Ch(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),c=""+t[n];if(!t.hasOwnProperty(n)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var f=r.get,p=r.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return f.call(this)},set:function(y){c=""+y,p.call(this,y)}}),Object.defineProperty(t,n,{enumerable:r.enumerable}),{getValue:function(){return c},setValue:function(y){c=""+y},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function no(t){t._valueTracker||(t._valueTracker=lS(t))}function Eh(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return t&&(c=Ch(t)?t.checked?"true":"false":t.value),t=c,t!==r?(n.setValue(t),!0):!1}function io(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var uS=/[\n"\\]/g;function Jt(t){return t.replace(uS,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function fl(t,n,r,c,f,p,y,S){t.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?t.type=y:t.removeAttribute("type"),n!=null?y==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+Xt(n)):t.value!==""+Xt(n)&&(t.value=""+Xt(n)):y!=="submit"&&y!=="reset"||t.removeAttribute("value"),n!=null?hl(t,y,Xt(n)):r!=null?hl(t,y,Xt(r)):c!=null&&t.removeAttribute("value"),f==null&&p!=null&&(t.defaultChecked=!!p),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+Xt(S):t.removeAttribute("name")}function Rh(t,n,r,c,f,p,y,S){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),n!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||n!=null))return;r=r!=null?""+Xt(r):"",n=n!=null?""+Xt(n):r,S||n===t.value||(t.value=n),t.defaultValue=n}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=S?t.checked:!!c,t.defaultChecked=!!c,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(t.name=y)}function hl(t,n,r){n==="number"&&io(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function Oa(t,n,r,c){if(t=t.options,n){n={};for(var f=0;f<r.length;f++)n["$"+r[f]]=!0;for(r=0;r<t.length;r++)f=n.hasOwnProperty("$"+t[r].value),t[r].selected!==f&&(t[r].selected=f),f&&c&&(t[r].defaultSelected=!0)}else{for(r=""+Xt(r),n=null,f=0;f<t.length;f++){if(t[f].value===r){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}n!==null||t[f].disabled||(n=t[f])}n!==null&&(n.selected=!0)}}function _h(t,n,r){if(n!=null&&(n=""+Xt(n),n!==t.value&&(t.value=n),r==null)){t.defaultValue!==n&&(t.defaultValue=n);return}t.defaultValue=r!=null?""+Xt(r):""}function wh(t,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(ue(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=Xt(n),t.defaultValue=r,c=t.textContent,c===r&&c!==""&&c!==null&&(t.value=c)}function xa(t,n){if(n){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=n;return}}t.textContent=n}var dS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Oh(t,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="":c?t.setProperty(n,r):typeof r!="number"||r===0||dS.has(n)?n==="float"?t.cssFloat=r:t[n]=(""+r).trim():t[n]=r+"px"}function xh(t,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(t=t.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in n)c=n[f],n.hasOwnProperty(f)&&r[f]!==c&&Oh(t,f,c)}else for(var p in n)n.hasOwnProperty(p)&&Oh(t,p,n[p])}function ml(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ao(t){return hS.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var pl=null;function gl(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Da=null,Aa=null;function Dh(t){var n=Ra(t);if(n&&(t=n.stateNode)){var r=t[Dt]||null;e:switch(t=n.stateNode,n.type){case"input":if(fl(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Jt(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==t&&c.form===t.form){var f=c[Dt]||null;if(!f)throw Error(s(90));fl(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===t.form&&Eh(c)}break e;case"textarea":_h(t,r.value,r.defaultValue);break e;case"select":n=r.value,n!=null&&Oa(t,!!r.multiple,n,!1)}}}var vl=!1;function Ah(t,n,r){if(vl)return t(n,r);vl=!0;try{var c=t(n);return c}finally{if(vl=!1,(Da!==null||Aa!==null)&&(Ho(),Da&&(n=Da,t=Aa,Aa=Da=null,Dh(n),t)))for(n=0;n<t.length;n++)Dh(t[n])}}function As(t,n){var r=t.stateNode;if(r===null)return null;var c=r[Dt]||null;if(c===null)return null;r=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var yl=!1;if(jn)try{var Ns={};Object.defineProperty(Ns,"passive",{get:function(){yl=!0}}),window.addEventListener("test",Ns,Ns),window.removeEventListener("test",Ns,Ns)}catch{yl=!1}var ui=null,bl=null,so=null;function Nh(){if(so)return so;var t,n=bl,r=n.length,c,f="value"in ui?ui.value:ui.textContent,p=f.length;for(t=0;t<r&&n[t]===f[t];t++);var y=r-t;for(c=1;c<=y&&n[r-c]===f[p-c];c++);return so=f.slice(t,1<c?1-c:void 0)}function ro(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function oo(){return!0}function Ph(){return!1}function At(t){function n(r,c,f,p,y){this._reactName=r,this._targetInst=f,this.type=c,this.nativeEvent=p,this.target=y,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(r=t[S],this[S]=r?r(p):p[S]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?oo:Ph,this.isPropagationStopped=Ph,this}return ee(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=oo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=oo)},persist:function(){},isPersistent:oo}),n}var Ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=At(Ki),Ps=ee({},Ki,{view:0,detail:0}),mS=At(Ps),Sl,Tl,Ms,lo=ee({},Ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ms&&(Ms&&t.type==="mousemove"?(Sl=t.screenX-Ms.screenX,Tl=t.screenY-Ms.screenY):Tl=Sl=0,Ms=t),Sl)},movementY:function(t){return"movementY"in t?t.movementY:Tl}}),Mh=At(lo),pS=ee({},lo,{dataTransfer:0}),gS=At(pS),vS=ee({},Ps,{relatedTarget:0}),kl=At(vS),yS=ee({},Ki,{animationName:0,elapsedTime:0,pseudoElement:0}),bS=At(yS),SS=ee({},Ki,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),TS=At(SS),kS=ee({},Ki,{data:0}),Uh=At(kS),CS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ES={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _S(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=RS[t])?!!n[t]:!1}function Cl(){return _S}var wS=ee({},Ps,{key:function(t){if(t.key){var n=CS[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=ro(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ES[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cl,charCode:function(t){return t.type==="keypress"?ro(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ro(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OS=At(wS),xS=ee({},lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lh=At(xS),DS=ee({},Ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cl}),AS=At(DS),NS=ee({},Ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),PS=At(NS),MS=ee({},lo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),US=At(MS),LS=ee({},Ki,{newState:0,oldState:0}),jS=At(LS),IS=[9,13,27,32],El=jn&&"CompositionEvent"in window,Us=null;jn&&"documentMode"in document&&(Us=document.documentMode);var BS=jn&&"TextEvent"in window&&!Us,jh=jn&&(!El||Us&&8<Us&&11>=Us),Ih=" ",Bh=!1;function zh(t,n){switch(t){case"keyup":return IS.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Na=!1;function zS(t,n){switch(t){case"compositionend":return qh(n);case"keypress":return n.which!==32?null:(Bh=!0,Ih);case"textInput":return t=n.data,t===Ih&&Bh?null:t;default:return null}}function qS(t,n){if(Na)return t==="compositionend"||!El&&zh(t,n)?(t=Nh(),so=bl=ui=null,Na=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return jh&&n.locale!=="ko"?null:n.data;default:return null}}var HS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hh(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!HS[t.type]:n==="textarea"}function Vh(t,n,r,c){Da?Aa?Aa.push(c):Aa=[c]:Da=c,n=Ko(n,"onChange"),0<n.length&&(r=new co("onChange","change",null,r,c),t.push({event:r,listeners:n}))}var Ls=null,js=null;function VS(t){pg(t,0)}function uo(t){var n=Ds(t);if(Eh(n))return t}function Fh(t,n){if(t==="change")return n}var Gh=!1;if(jn){var Rl;if(jn){var _l="oninput"in document;if(!_l){var Yh=document.createElement("div");Yh.setAttribute("oninput","return;"),_l=typeof Yh.oninput=="function"}Rl=_l}else Rl=!1;Gh=Rl&&(!document.documentMode||9<document.documentMode)}function Kh(){Ls&&(Ls.detachEvent("onpropertychange",Qh),js=Ls=null)}function Qh(t){if(t.propertyName==="value"&&uo(js)){var n=[];Vh(n,js,t,gl(t)),Ah(VS,n)}}function FS(t,n,r){t==="focusin"?(Kh(),Ls=n,js=r,Ls.attachEvent("onpropertychange",Qh)):t==="focusout"&&Kh()}function GS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uo(js)}function YS(t,n){if(t==="click")return uo(n)}function KS(t,n){if(t==="input"||t==="change")return uo(n)}function QS(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var zt=typeof Object.is=="function"?Object.is:QS;function Is(t,n){if(zt(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var r=Object.keys(t),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var f=r[c];if(!rl.call(n,f)||!zt(t[f],n[f]))return!1}return!0}function Xh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jh(t,n){var r=Xh(t);t=0;for(var c;r;){if(r.nodeType===3){if(c=t+r.textContent.length,t<=n&&c>=n)return{node:r,offset:n-t};t=c}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xh(r)}}function Zh(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?Zh(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function Wh(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var n=io(t.document);n instanceof t.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)t=n.contentWindow;else break;n=io(t.document)}return n}function wl(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function XS(t,n){var r=Wh(n);n=t.focusedElem;var c=t.selectionRange;if(r!==n&&n&&n.ownerDocument&&Zh(n.ownerDocument.documentElement,n)){if(c!==null&&wl(n)){if(t=c.start,r=c.end,r===void 0&&(r=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(r,n.value.length);else if(r=(t=n.ownerDocument||document)&&t.defaultView||window,r.getSelection){r=r.getSelection();var f=n.textContent.length,p=Math.min(c.start,f);c=c.end===void 0?p:Math.min(c.end,f),!r.extend&&p>c&&(f=c,c=p,p=f),f=Jh(n,p);var y=Jh(n,c);f&&y&&(r.rangeCount!==1||r.anchorNode!==f.node||r.anchorOffset!==f.offset||r.focusNode!==y.node||r.focusOffset!==y.offset)&&(t=t.createRange(),t.setStart(f.node,f.offset),r.removeAllRanges(),p>c?(r.addRange(t),r.extend(y.node,y.offset)):(t.setEnd(y.node,y.offset),r.addRange(t)))}}for(t=[],r=n;r=r.parentNode;)r.nodeType===1&&t.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)r=t[n],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var JS=jn&&"documentMode"in document&&11>=document.documentMode,Pa=null,Ol=null,Bs=null,xl=!1;function $h(t,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;xl||Pa==null||Pa!==io(c)||(c=Pa,"selectionStart"in c&&wl(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Bs&&Is(Bs,c)||(Bs=c,c=Ko(Ol,"onSelect"),0<c.length&&(n=new co("onSelect","select",null,n,r),t.push({event:n,listeners:c}),n.target=Pa)))}function Qi(t,n){var r={};return r[t.toLowerCase()]=n.toLowerCase(),r["Webkit"+t]="webkit"+n,r["Moz"+t]="moz"+n,r}var Ma={animationend:Qi("Animation","AnimationEnd"),animationiteration:Qi("Animation","AnimationIteration"),animationstart:Qi("Animation","AnimationStart"),transitionrun:Qi("Transition","TransitionRun"),transitionstart:Qi("Transition","TransitionStart"),transitioncancel:Qi("Transition","TransitionCancel"),transitionend:Qi("Transition","TransitionEnd")},Dl={},em={};jn&&(em=document.createElement("div").style,"AnimationEvent"in window||(delete Ma.animationend.animation,delete Ma.animationiteration.animation,delete Ma.animationstart.animation),"TransitionEvent"in window||delete Ma.transitionend.transition);function Xi(t){if(Dl[t])return Dl[t];if(!Ma[t])return t;var n=Ma[t],r;for(r in n)if(n.hasOwnProperty(r)&&r in em)return Dl[t]=n[r];return t}var tm=Xi("animationend"),nm=Xi("animationiteration"),im=Xi("animationstart"),ZS=Xi("transitionrun"),WS=Xi("transitionstart"),$S=Xi("transitioncancel"),am=Xi("transitionend"),sm=new Map,rm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function ln(t,n){sm.set(t,n),Yi(n,[t])}var Zt=[],Ua=0,Al=0;function fo(){for(var t=Ua,n=Al=Ua=0;n<t;){var r=Zt[n];Zt[n++]=null;var c=Zt[n];Zt[n++]=null;var f=Zt[n];Zt[n++]=null;var p=Zt[n];if(Zt[n++]=null,c!==null&&f!==null){var y=c.pending;y===null?f.next=f:(f.next=y.next,y.next=f),c.pending=f}p!==0&&om(r,f,p)}}function ho(t,n,r,c){Zt[Ua++]=t,Zt[Ua++]=n,Zt[Ua++]=r,Zt[Ua++]=c,Al|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Nl(t,n,r,c){return ho(t,n,r,c),mo(t)}function di(t,n){return ho(t,null,null,n),mo(t)}function om(t,n,r){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r);for(var f=!1,p=t.return;p!==null;)p.childLanes|=r,c=p.alternate,c!==null&&(c.childLanes|=r),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(f=!0)),t=p,p=p.return;f&&n!==null&&t.tag===3&&(p=t.stateNode,f=31-Bt(r),p=p.hiddenUpdates,t=p[f],t===null?p[f]=[n]:t.push(n),n.lane=r|536870912)}function mo(t){if(50<ur)throw ur=0,Iu=null,Error(s(185));for(var n=t.return;n!==null;)t=n,n=t.return;return t.tag===3?t.stateNode:null}var La={},cm=new WeakMap;function Wt(t,n){if(typeof t=="object"&&t!==null){var r=cm.get(t);return r!==void 0?r:(n={value:t,source:n,stack:pe(n)},cm.set(t,n),n)}return{value:t,source:n,stack:pe(n)}}var ja=[],Ia=0,po=null,go=0,$t=[],en=0,Ji=null,Bn=1,zn="";function Zi(t,n){ja[Ia++]=go,ja[Ia++]=po,po=t,go=n}function lm(t,n,r){$t[en++]=Bn,$t[en++]=zn,$t[en++]=Ji,Ji=t;var c=Bn;t=zn;var f=32-Bt(c)-1;c&=~(1<<f),r+=1;var p=32-Bt(n)+f;if(30<p){var y=f-f%5;p=(c&(1<<y)-1).toString(32),c>>=y,f-=y,Bn=1<<32-Bt(n)+f|r<<f|c,zn=p+t}else Bn=1<<p|r<<f|c,zn=t}function Pl(t){t.return!==null&&(Zi(t,1),lm(t,1,0))}function Ml(t){for(;t===po;)po=ja[--Ia],ja[Ia]=null,go=ja[--Ia],ja[Ia]=null;for(;t===Ji;)Ji=$t[--en],$t[en]=null,zn=$t[--en],$t[en]=null,Bn=$t[--en],$t[en]=null}var wt=null,vt=null,xe=!1,un=null,Cn=!1,Ul=Error(s(519));function Wi(t){var n=Error(s(418,""));throw Hs(Wt(n,t)),Ul}function um(t){var n=t.stateNode,r=t.type,c=t.memoizedProps;switch(n[kt]=t,n[Dt]=c,r){case"dialog":ke("cancel",n),ke("close",n);break;case"iframe":case"object":case"embed":ke("load",n);break;case"video":case"audio":for(r=0;r<fr.length;r++)ke(fr[r],n);break;case"source":ke("error",n);break;case"img":case"image":case"link":ke("error",n),ke("load",n);break;case"details":ke("toggle",n);break;case"input":ke("invalid",n),Rh(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),no(n);break;case"select":ke("invalid",n);break;case"textarea":ke("invalid",n),wh(n,c.value,c.defaultValue,c.children),no(n)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||bg(n.textContent,r)?(c.popover!=null&&(ke("beforetoggle",n),ke("toggle",n)),c.onScroll!=null&&ke("scroll",n),c.onScrollEnd!=null&&ke("scrollend",n),c.onClick!=null&&(n.onclick=Qo),n=!0):n=!1,n||Wi(t)}function dm(t){for(wt=t.return;wt;)switch(wt.tag){case 3:case 27:Cn=!0;return;case 5:case 13:Cn=!1;return;default:wt=wt.return}}function zs(t){if(t!==wt)return!1;if(!xe)return dm(t),xe=!0,!1;var n=!1,r;if((r=t.tag!==3&&t.tag!==27)&&((r=t.tag===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||td(t.type,t.memoizedProps)),r=!r),r&&(n=!0),n&&vt&&Wi(t),dm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8)if(r=t.data,r==="/$"){if(n===0){vt=fn(t.nextSibling);break e}n--}else r!=="$"&&r!=="$!"&&r!=="$?"||n++;t=t.nextSibling}vt=null}}else vt=wt?fn(t.stateNode.nextSibling):null;return!0}function qs(){vt=wt=null,xe=!1}function Hs(t){un===null?un=[t]:un.push(t)}var Vs=Error(s(460)),fm=Error(s(474)),Ll={then:function(){}};function hm(t){return t=t.status,t==="fulfilled"||t==="rejected"}function vo(){}function mm(t,n,r){switch(r=t[r],r===void 0?t.push(n):r!==n&&(n.then(vo,vo),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,t===Vs?Error(s(483)):t;default:if(typeof n.status=="string")n.then(vo,vo);else{if(t=ze,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=n,t.status="pending",t.then(function(c){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=c}},function(c){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,t===Vs?Error(s(483)):t}throw Fs=n,Vs}}var Fs=null;function pm(){if(Fs===null)throw Error(s(459));var t=Fs;return Fs=null,t}var Ba=null,Gs=0;function yo(t){var n=Gs;return Gs+=1,Ba===null&&(Ba=[]),mm(Ba,t,n)}function Ys(t,n){n=n.props.ref,t.ref=n!==void 0?n:null}function bo(t,n){throw n.$$typeof===l?Error(s(525)):(t=Object.prototype.toString.call(n),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)))}function gm(t){var n=t._init;return n(t._payload)}function vm(t){function n(P,A){if(t){var U=P.deletions;U===null?(P.deletions=[A],P.flags|=16):U.push(A)}}function r(P,A){if(!t)return null;for(;A!==null;)n(P,A),A=A.sibling;return null}function c(P){for(var A=new Map;P!==null;)P.key!==null?A.set(P.key,P):A.set(P.index,P),P=P.sibling;return A}function f(P,A){return P=Ci(P,A),P.index=0,P.sibling=null,P}function p(P,A,U){return P.index=U,t?(U=P.alternate,U!==null?(U=U.index,U<A?(P.flags|=33554434,A):U):(P.flags|=33554434,A)):(P.flags|=1048576,A)}function y(P){return t&&P.alternate===null&&(P.flags|=33554434),P}function S(P,A,U,G){return A===null||A.tag!==6?(A=Du(U,P.mode,G),A.return=P,A):(A=f(A,U),A.return=P,A)}function R(P,A,U,G){var re=U.type;return re===m?V(P,A,U.props.children,G,U.key):A!==null&&(A.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===q&&gm(re)===A.type)?(A=f(A,U.props),Ys(A,U),A.return=P,A):(A=jo(U.type,U.key,U.props,null,P.mode,G),Ys(A,U),A.return=P,A)}function N(P,A,U,G){return A===null||A.tag!==4||A.stateNode.containerInfo!==U.containerInfo||A.stateNode.implementation!==U.implementation?(A=Au(U,P.mode,G),A.return=P,A):(A=f(A,U.children||[]),A.return=P,A)}function V(P,A,U,G,re){return A===null||A.tag!==7?(A=ca(U,P.mode,G,re),A.return=P,A):(A=f(A,U),A.return=P,A)}function K(P,A,U){if(typeof A=="string"&&A!==""||typeof A=="number"||typeof A=="bigint")return A=Du(""+A,P.mode,U),A.return=P,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case u:return U=jo(A.type,A.key,A.props,null,P.mode,U),Ys(U,A),U.return=P,U;case d:return A=Au(A,P.mode,U),A.return=P,A;case q:var G=A._init;return A=G(A._payload),K(P,A,U)}if(ue(A)||F(A))return A=ca(A,P.mode,U,null),A.return=P,A;if(typeof A.then=="function")return K(P,yo(A),U);if(A.$$typeof===k)return K(P,Mo(P,A),U);bo(P,A)}return null}function L(P,A,U,G){var re=A!==null?A.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return re!==null?null:S(P,A,""+U,G);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case u:return U.key===re?R(P,A,U,G):null;case d:return U.key===re?N(P,A,U,G):null;case q:return re=U._init,U=re(U._payload),L(P,A,U,G)}if(ue(U)||F(U))return re!==null?null:V(P,A,U,G,null);if(typeof U.then=="function")return L(P,A,yo(U),G);if(U.$$typeof===k)return L(P,A,Mo(P,U),G);bo(P,U)}return null}function H(P,A,U,G,re){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return P=P.get(U)||null,S(A,P,""+G,re);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case u:return P=P.get(G.key===null?U:G.key)||null,R(A,P,G,re);case d:return P=P.get(G.key===null?U:G.key)||null,N(A,P,G,re);case q:var Se=G._init;return G=Se(G._payload),H(P,A,U,G,re)}if(ue(G)||F(G))return P=P.get(U)||null,V(A,P,G,re,null);if(typeof G.then=="function")return H(P,A,U,yo(G),re);if(G.$$typeof===k)return H(P,A,U,Mo(A,G),re);bo(A,G)}return null}function oe(P,A,U,G){for(var re=null,Se=null,ce=A,de=A=0,pt=null;ce!==null&&de<U.length;de++){ce.index>de?(pt=ce,ce=null):pt=ce.sibling;var De=L(P,ce,U[de],G);if(De===null){ce===null&&(ce=pt);break}t&&ce&&De.alternate===null&&n(P,ce),A=p(De,A,de),Se===null?re=De:Se.sibling=De,Se=De,ce=pt}if(de===U.length)return r(P,ce),xe&&Zi(P,de),re;if(ce===null){for(;de<U.length;de++)ce=K(P,U[de],G),ce!==null&&(A=p(ce,A,de),Se===null?re=ce:Se.sibling=ce,Se=ce);return xe&&Zi(P,de),re}for(ce=c(ce);de<U.length;de++)pt=H(ce,P,de,U[de],G),pt!==null&&(t&&pt.alternate!==null&&ce.delete(pt.key===null?de:pt.key),A=p(pt,A,de),Se===null?re=pt:Se.sibling=pt,Se=pt);return t&&ce.forEach(function(Di){return n(P,Di)}),xe&&Zi(P,de),re}function me(P,A,U,G){if(U==null)throw Error(s(151));for(var re=null,Se=null,ce=A,de=A=0,pt=null,De=U.next();ce!==null&&!De.done;de++,De=U.next()){ce.index>de?(pt=ce,ce=null):pt=ce.sibling;var Di=L(P,ce,De.value,G);if(Di===null){ce===null&&(ce=pt);break}t&&ce&&Di.alternate===null&&n(P,ce),A=p(Di,A,de),Se===null?re=Di:Se.sibling=Di,Se=Di,ce=pt}if(De.done)return r(P,ce),xe&&Zi(P,de),re;if(ce===null){for(;!De.done;de++,De=U.next())De=K(P,De.value,G),De!==null&&(A=p(De,A,de),Se===null?re=De:Se.sibling=De,Se=De);return xe&&Zi(P,de),re}for(ce=c(ce);!De.done;de++,De=U.next())De=H(ce,P,de,De.value,G),De!==null&&(t&&De.alternate!==null&&ce.delete(De.key===null?de:De.key),A=p(De,A,de),Se===null?re=De:Se.sibling=De,Se=De);return t&&ce.forEach(function(hk){return n(P,hk)}),xe&&Zi(P,de),re}function Je(P,A,U,G){if(typeof U=="object"&&U!==null&&U.type===m&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case u:e:{for(var re=U.key;A!==null;){if(A.key===re){if(re=U.type,re===m){if(A.tag===7){r(P,A.sibling),G=f(A,U.props.children),G.return=P,P=G;break e}}else if(A.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===q&&gm(re)===A.type){r(P,A.sibling),G=f(A,U.props),Ys(G,U),G.return=P,P=G;break e}r(P,A);break}else n(P,A);A=A.sibling}U.type===m?(G=ca(U.props.children,P.mode,G,U.key),G.return=P,P=G):(G=jo(U.type,U.key,U.props,null,P.mode,G),Ys(G,U),G.return=P,P=G)}return y(P);case d:e:{for(re=U.key;A!==null;){if(A.key===re)if(A.tag===4&&A.stateNode.containerInfo===U.containerInfo&&A.stateNode.implementation===U.implementation){r(P,A.sibling),G=f(A,U.children||[]),G.return=P,P=G;break e}else{r(P,A);break}else n(P,A);A=A.sibling}G=Au(U,P.mode,G),G.return=P,P=G}return y(P);case q:return re=U._init,U=re(U._payload),Je(P,A,U,G)}if(ue(U))return oe(P,A,U,G);if(F(U)){if(re=F(U),typeof re!="function")throw Error(s(150));return U=re.call(U),me(P,A,U,G)}if(typeof U.then=="function")return Je(P,A,yo(U),G);if(U.$$typeof===k)return Je(P,A,Mo(P,U),G);bo(P,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,A!==null&&A.tag===6?(r(P,A.sibling),G=f(A,U),G.return=P,P=G):(r(P,A),G=Du(U,P.mode,G),G.return=P,P=G),y(P)):r(P,A)}return function(P,A,U,G){try{Gs=0;var re=Je(P,A,U,G);return Ba=null,re}catch(ce){if(ce===Vs)throw ce;var Se=sn(29,ce,null,P.mode);return Se.lanes=G,Se.return=P,Se}finally{}}}var $i=vm(!0),ym=vm(!1),za=Ne(null),So=Ne(0);function bm(t,n){t=Zn,He(So,t),He(za,n),Zn=t|n.baseLanes}function jl(){He(So,Zn),He(za,za.current)}function Il(){Zn=So.current,it(za),it(So)}var tn=Ne(null),En=null;function fi(t){var n=t.alternate;He(ct,ct.current&1),He(tn,t),En===null&&(n===null||za.current!==null||n.memoizedState!==null)&&(En=t)}function Sm(t){if(t.tag===22){if(He(ct,ct.current),He(tn,t),En===null){var n=t.alternate;n!==null&&n.memoizedState!==null&&(En=t)}}else hi()}function hi(){He(ct,ct.current),He(tn,tn.current)}function qn(t){it(tn),En===t&&(En=null),it(ct)}var ct=Ne(0);function To(t){for(var n=t;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var eT=typeof AbortController<"u"?AbortController:function(){var t=[],n=this.signal={aborted:!1,addEventListener:function(r,c){t.push(c)}};this.abort=function(){n.aborted=!0,t.forEach(function(r){return r()})}},tT=a.unstable_scheduleCallback,nT=a.unstable_NormalPriority,lt={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bl(){return{controller:new eT,data:new Map,refCount:0}}function Ks(t){t.refCount--,t.refCount===0&&tT(nT,function(){t.controller.abort()})}var Qs=null,zl=0,qa=0,Ha=null;function iT(t,n){if(Qs===null){var r=Qs=[];zl=0,qa=Yu(),Ha={status:"pending",value:void 0,then:function(c){r.push(c)}}}return zl++,n.then(Tm,Tm),n}function Tm(){if(--zl===0&&Qs!==null){Ha!==null&&(Ha.status="fulfilled");var t=Qs;Qs=null,qa=0,Ha=null;for(var n=0;n<t.length;n++)(0,t[n])()}}function aT(t,n){var r=[],c={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return t.then(function(){c.status="fulfilled",c.value=n;for(var f=0;f<r.length;f++)(0,r[f])(n)},function(f){for(c.status="rejected",c.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),c}var km=X.S;X.S=function(t,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&iT(t,n),km!==null&&km(t,n)};var ea=Ne(null);function ql(){var t=ea.current;return t!==null?t:ze.pooledCache}function ko(t,n){n===null?He(ea,ea.current):He(ea,n.pool)}function Cm(){var t=ql();return t===null?null:{parent:lt._currentValue,pool:t}}var mi=0,be=null,Me=null,at=null,Co=!1,Va=!1,ta=!1,Eo=0,Xs=0,Fa=null,sT=0;function et(){throw Error(s(321))}function Hl(t,n){if(n===null)return!1;for(var r=0;r<n.length&&r<t.length;r++)if(!zt(t[r],n[r]))return!1;return!0}function Vl(t,n,r,c,f,p){return mi=p,be=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,X.H=t===null||t.memoizedState===null?na:pi,ta=!1,p=r(c,f),ta=!1,Va&&(p=Rm(n,r,c,f)),Em(t),p}function Em(t){X.H=Rn;var n=Me!==null&&Me.next!==null;if(mi=0,at=Me=be=null,Co=!1,Xs=0,Fa=null,n)throw Error(s(300));t===null||ht||(t=t.dependencies,t!==null&&Po(t)&&(ht=!0))}function Rm(t,n,r,c){be=t;var f=0;do{if(Va&&(Fa=null),Xs=0,Va=!1,25<=f)throw Error(s(301));if(f+=1,at=Me=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}X.H=ia,p=n(r,c)}while(Va);return p}function rT(){var t=X.H,n=t.useState()[0];return n=typeof n.then=="function"?Js(n):n,t=t.useState()[0],(Me!==null?Me.memoizedState:null)!==t&&(be.flags|=1024),n}function Fl(){var t=Eo!==0;return Eo=0,t}function Gl(t,n,r){n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~r}function Yl(t){if(Co){for(t=t.memoizedState;t!==null;){var n=t.queue;n!==null&&(n.pending=null),t=t.next}Co=!1}mi=0,at=Me=be=null,Va=!1,Xs=Eo=0,Fa=null}function Nt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?be.memoizedState=at=t:at=at.next=t,at}function st(){if(Me===null){var t=be.alternate;t=t!==null?t.memoizedState:null}else t=Me.next;var n=at===null?be.memoizedState:at.next;if(n!==null)at=n,Me=t;else{if(t===null)throw be.alternate===null?Error(s(467)):Error(s(310));Me=t,t={memoizedState:Me.memoizedState,baseState:Me.baseState,baseQueue:Me.baseQueue,queue:Me.queue,next:null},at===null?be.memoizedState=at=t:at=at.next=t}return at}var Ro;Ro=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Js(t){var n=Xs;return Xs+=1,Fa===null&&(Fa=[]),t=mm(Fa,t,n),n=be,(at===null?n.memoizedState:at.next)===null&&(n=n.alternate,X.H=n===null||n.memoizedState===null?na:pi),t}function _o(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Js(t);if(t.$$typeof===k)return Ct(t)}throw Error(s(438,String(t)))}function Kl(t){var n=null,r=be.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=be.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=Ro(),be.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(t),c=0;c<t;c++)r[c]=M;return n.index++,r}function Hn(t,n){return typeof n=="function"?n(t):n}function wo(t){var n=st();return Ql(n,Me,t)}function Ql(t,n,r){var c=t.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var f=t.baseQueue,p=c.pending;if(p!==null){if(f!==null){var y=f.next;f.next=p.next,p.next=y}n.baseQueue=f=p,c.pending=null}if(p=t.baseState,f===null)t.memoizedState=p;else{n=f.next;var S=y=null,R=null,N=n,V=!1;do{var K=N.lane&-536870913;if(K!==N.lane?(Re&K)===K:(mi&K)===K){var L=N.revertLane;if(L===0)R!==null&&(R=R.next={lane:0,revertLane:0,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null}),K===qa&&(V=!0);else if((mi&L)===L){N=N.next,L===qa&&(V=!0);continue}else K={lane:0,revertLane:N.revertLane,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null},R===null?(S=R=K,y=p):R=R.next=K,be.lanes|=L,Ei|=L;K=N.action,ta&&r(p,K),p=N.hasEagerState?N.eagerState:r(p,K)}else L={lane:K,revertLane:N.revertLane,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null},R===null?(S=R=L,y=p):R=R.next=L,be.lanes|=K,Ei|=K;N=N.next}while(N!==null&&N!==n);if(R===null?y=p:R.next=S,!zt(p,t.memoizedState)&&(ht=!0,V&&(r=Ha,r!==null)))throw r;t.memoizedState=p,t.baseState=y,t.baseQueue=R,c.lastRenderedState=p}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Xl(t){var n=st(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=t;var c=r.dispatch,f=r.pending,p=n.memoizedState;if(f!==null){r.pending=null;var y=f=f.next;do p=t(p,y.action),y=y.next;while(y!==f);zt(p,n.memoizedState)||(ht=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),r.lastRenderedState=p}return[p,c]}function _m(t,n,r){var c=be,f=st(),p=xe;if(p){if(r===void 0)throw Error(s(407));r=r()}else r=n();var y=!zt((Me||f).memoizedState,r);if(y&&(f.memoizedState=r,ht=!0),f=f.queue,Wl(xm.bind(null,c,f,t),[t]),f.getSnapshot!==n||y||at!==null&&at.memoizedState.tag&1){if(c.flags|=2048,Ga(9,Om.bind(null,c,f,r,n),{destroy:void 0},null),ze===null)throw Error(s(349));p||(mi&60)!==0||wm(c,n,r)}return r}function wm(t,n,r){t.flags|=16384,t={getSnapshot:n,value:r},n=be.updateQueue,n===null?(n=Ro(),be.updateQueue=n,n.stores=[t]):(r=n.stores,r===null?n.stores=[t]:r.push(t))}function Om(t,n,r,c){n.value=r,n.getSnapshot=c,Dm(n)&&Am(t)}function xm(t,n,r){return r(function(){Dm(n)&&Am(t)})}function Dm(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!zt(t,r)}catch{return!0}}function Am(t){var n=di(t,2);n!==null&&Ot(n,t,2)}function Jl(t){var n=Nt();if(typeof t=="function"){var r=t;if(t=r(),ta){ci(!0);try{r()}finally{ci(!1)}}}return n.memoizedState=n.baseState=t,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:t},n}function Nm(t,n,r,c){return t.baseState=r,Ql(t,Me,typeof c=="function"?c:Hn)}function oT(t,n,r,c,f){if(Do(t))throw Error(s(485));if(t=n.action,t!==null){var p={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){p.listeners.push(y)}};X.T!==null?r(!0):p.isTransition=!1,c(p),r=n.pending,r===null?(p.next=n.pending=p,Pm(n,p)):(p.next=r.next,n.pending=r.next=p)}}function Pm(t,n){var r=n.action,c=n.payload,f=t.state;if(n.isTransition){var p=X.T,y={};X.T=y;try{var S=r(f,c),R=X.S;R!==null&&R(y,S),Mm(t,n,S)}catch(N){Zl(t,n,N)}finally{X.T=p}}else try{p=r(f,c),Mm(t,n,p)}catch(N){Zl(t,n,N)}}function Mm(t,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){Um(t,n,c)},function(c){return Zl(t,n,c)}):Um(t,n,r)}function Um(t,n,r){n.status="fulfilled",n.value=r,Lm(n),t.state=r,n=t.pending,n!==null&&(r=n.next,r===n?t.pending=null:(r=r.next,n.next=r,Pm(t,r)))}function Zl(t,n,r){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,Lm(n),n=n.next;while(n!==c)}t.action=null}function Lm(t){t=t.listeners;for(var n=0;n<t.length;n++)(0,t[n])()}function jm(t,n){return n}function Im(t,n){if(xe){var r=ze.formState;if(r!==null){e:{var c=be;if(xe){if(vt){t:{for(var f=vt,p=Cn;f.nodeType!==8;){if(!p){f=null;break t}if(f=fn(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){vt=fn(f.nextSibling),c=f.data==="F!";break e}}Wi(c)}c=!1}c&&(n=r[0])}}return r=Nt(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jm,lastRenderedState:n},r.queue=c,r=np.bind(null,be,c),c.dispatch=r,c=Jl(!1),p=iu.bind(null,be,!1,c.queue),c=Nt(),f={state:n,dispatch:null,action:t,pending:null},c.queue=f,r=oT.bind(null,be,f,p,r),f.dispatch=r,c.memoizedState=t,[n,r,!1]}function Bm(t){var n=st();return zm(n,Me,t)}function zm(t,n,r){n=Ql(t,n,jm)[0],t=wo(Hn)[0],n=typeof n=="object"&&n!==null&&typeof n.then=="function"?Js(n):n;var c=st(),f=c.queue,p=f.dispatch;return r!==c.memoizedState&&(be.flags|=2048,Ga(9,cT.bind(null,f,r),{destroy:void 0},null)),[n,p,t]}function cT(t,n){t.action=n}function qm(t){var n=st(),r=Me;if(r!==null)return zm(n,r,t);st(),n=n.memoizedState,r=st();var c=r.queue.dispatch;return r.memoizedState=t,[n,c,!1]}function Ga(t,n,r,c){return t={tag:t,create:n,inst:r,deps:c,next:null},n=be.updateQueue,n===null&&(n=Ro(),be.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=t.next=t:(c=r.next,r.next=t,t.next=c,n.lastEffect=t),t}function Hm(){return st().memoizedState}function Oo(t,n,r,c){var f=Nt();be.flags|=t,f.memoizedState=Ga(1|n,r,{destroy:void 0},c===void 0?null:c)}function xo(t,n,r,c){var f=st();c=c===void 0?null:c;var p=f.memoizedState.inst;Me!==null&&c!==null&&Hl(c,Me.memoizedState.deps)?f.memoizedState=Ga(n,r,p,c):(be.flags|=t,f.memoizedState=Ga(1|n,r,p,c))}function Vm(t,n){Oo(8390656,8,t,n)}function Wl(t,n){xo(2048,8,t,n)}function Fm(t,n){return xo(4,2,t,n)}function Gm(t,n){return xo(4,4,t,n)}function Ym(t,n){if(typeof n=="function"){t=t();var r=n(t);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function Km(t,n,r){r=r!=null?r.concat([t]):null,xo(4,4,Ym.bind(null,n,t),r)}function $l(){}function Qm(t,n){var r=st();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&Hl(n,c[1])?c[0]:(r.memoizedState=[t,n],t)}function Xm(t,n){var r=st();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&Hl(n,c[1]))return c[0];if(c=t(),ta){ci(!0);try{t()}finally{ci(!1)}}return r.memoizedState=[c,n],c}function eu(t,n,r){return r===void 0||(mi&1073741824)!==0?t.memoizedState=n:(t.memoizedState=r,t=Zp(),be.lanes|=t,Ei|=t,r)}function Jm(t,n,r,c){return zt(r,n)?r:za.current!==null?(t=eu(t,r,c),zt(t,n)||(ht=!0),t):(mi&42)===0?(ht=!0,t.memoizedState=r):(t=Zp(),be.lanes|=t,Ei|=t,n)}function Zm(t,n,r,c,f){var p=se.p;se.p=p!==0&&8>p?p:8;var y=X.T,S={};X.T=S,iu(t,!1,n,r);try{var R=f(),N=X.S;if(N!==null&&N(S,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var V=aT(R,c);Zs(t,n,V,Ft(t))}else Zs(t,n,c,Ft(t))}catch(K){Zs(t,n,{then:function(){},status:"rejected",reason:K},Ft())}finally{se.p=p,X.T=y}}function lT(){}function tu(t,n,r,c){if(t.tag!==5)throw Error(s(476));var f=Wm(t).queue;Zm(t,f,n,Ee,r===null?lT:function(){return $m(t),r(c)})}function Wm(t){var n=t.memoizedState;if(n!==null)return n;n={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:Ee},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:r},next:null},t.memoizedState=n,t=t.alternate,t!==null&&(t.memoizedState=n),n}function $m(t){var n=Wm(t).next.queue;Zs(t,n,{},Ft())}function nu(){return Ct(vr)}function ep(){return st().memoizedState}function tp(){return st().memoizedState}function uT(t){for(var n=t.return;n!==null;){switch(n.tag){case 24:case 3:var r=Ft();t=yi(r);var c=bi(n,t,r);c!==null&&(Ot(c,n,r),er(c,n,r)),n={cache:Bl()},t.payload=n;return}n=n.return}}function dT(t,n,r){var c=Ft();r={lane:c,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Do(t)?ip(n,r):(r=Nl(t,n,r,c),r!==null&&(Ot(r,t,c),ap(r,n,c)))}function np(t,n,r){var c=Ft();Zs(t,n,r,c)}function Zs(t,n,r,c){var f={lane:c,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Do(t))ip(n,f);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var y=n.lastRenderedState,S=p(y,r);if(f.hasEagerState=!0,f.eagerState=S,zt(S,y))return ho(t,n,f,0),ze===null&&fo(),!1}catch{}finally{}if(r=Nl(t,n,f,c),r!==null)return Ot(r,t,c),ap(r,n,c),!0}return!1}function iu(t,n,r,c){if(c={lane:2,revertLane:Yu(),action:c,hasEagerState:!1,eagerState:null,next:null},Do(t)){if(n)throw Error(s(479))}else n=Nl(t,r,c,2),n!==null&&Ot(n,t,2)}function Do(t){var n=t.alternate;return t===be||n!==null&&n===be}function ip(t,n){Va=Co=!0;var r=t.pending;r===null?n.next=n:(n.next=r.next,r.next=n),t.pending=n}function ap(t,n,r){if((r&4194176)!==0){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,ph(t,r)}}var Rn={readContext:Ct,use:_o,useCallback:et,useContext:et,useEffect:et,useImperativeHandle:et,useLayoutEffect:et,useInsertionEffect:et,useMemo:et,useReducer:et,useRef:et,useState:et,useDebugValue:et,useDeferredValue:et,useTransition:et,useSyncExternalStore:et,useId:et};Rn.useCacheRefresh=et,Rn.useMemoCache=et,Rn.useHostTransitionStatus=et,Rn.useFormState=et,Rn.useActionState=et,Rn.useOptimistic=et;var na={readContext:Ct,use:_o,useCallback:function(t,n){return Nt().memoizedState=[t,n===void 0?null:n],t},useContext:Ct,useEffect:Vm,useImperativeHandle:function(t,n,r){r=r!=null?r.concat([t]):null,Oo(4194308,4,Ym.bind(null,n,t),r)},useLayoutEffect:function(t,n){return Oo(4194308,4,t,n)},useInsertionEffect:function(t,n){Oo(4,2,t,n)},useMemo:function(t,n){var r=Nt();n=n===void 0?null:n;var c=t();if(ta){ci(!0);try{t()}finally{ci(!1)}}return r.memoizedState=[c,n],c},useReducer:function(t,n,r){var c=Nt();if(r!==void 0){var f=r(n);if(ta){ci(!0);try{r(n)}finally{ci(!1)}}}else f=n;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=dT.bind(null,be,t),[c.memoizedState,t]},useRef:function(t){var n=Nt();return t={current:t},n.memoizedState=t},useState:function(t){t=Jl(t);var n=t.queue,r=np.bind(null,be,n);return n.dispatch=r,[t.memoizedState,r]},useDebugValue:$l,useDeferredValue:function(t,n){var r=Nt();return eu(r,t,n)},useTransition:function(){var t=Jl(!1);return t=Zm.bind(null,be,t.queue,!0,!1),Nt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,n,r){var c=be,f=Nt();if(xe){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),ze===null)throw Error(s(349));(Re&60)!==0||wm(c,n,r)}f.memoizedState=r;var p={value:r,getSnapshot:n};return f.queue=p,Vm(xm.bind(null,c,p,t),[t]),c.flags|=2048,Ga(9,Om.bind(null,c,p,r,n),{destroy:void 0},null),r},useId:function(){var t=Nt(),n=ze.identifierPrefix;if(xe){var r=zn,c=Bn;r=(c&~(1<<32-Bt(c)-1)).toString(32)+r,n=":"+n+"R"+r,r=Eo++,0<r&&(n+="H"+r.toString(32)),n+=":"}else r=sT++,n=":"+n+"r"+r.toString(32)+":";return t.memoizedState=n},useCacheRefresh:function(){return Nt().memoizedState=uT.bind(null,be)}};na.useMemoCache=Kl,na.useHostTransitionStatus=nu,na.useFormState=Im,na.useActionState=Im,na.useOptimistic=function(t){var n=Nt();n.memoizedState=n.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=iu.bind(null,be,!0,r),r.dispatch=n,[t,n]};var pi={readContext:Ct,use:_o,useCallback:Qm,useContext:Ct,useEffect:Wl,useImperativeHandle:Km,useInsertionEffect:Fm,useLayoutEffect:Gm,useMemo:Xm,useReducer:wo,useRef:Hm,useState:function(){return wo(Hn)},useDebugValue:$l,useDeferredValue:function(t,n){var r=st();return Jm(r,Me.memoizedState,t,n)},useTransition:function(){var t=wo(Hn)[0],n=st().memoizedState;return[typeof t=="boolean"?t:Js(t),n]},useSyncExternalStore:_m,useId:ep};pi.useCacheRefresh=tp,pi.useMemoCache=Kl,pi.useHostTransitionStatus=nu,pi.useFormState=Bm,pi.useActionState=Bm,pi.useOptimistic=function(t,n){var r=st();return Nm(r,Me,t,n)};var ia={readContext:Ct,use:_o,useCallback:Qm,useContext:Ct,useEffect:Wl,useImperativeHandle:Km,useInsertionEffect:Fm,useLayoutEffect:Gm,useMemo:Xm,useReducer:Xl,useRef:Hm,useState:function(){return Xl(Hn)},useDebugValue:$l,useDeferredValue:function(t,n){var r=st();return Me===null?eu(r,t,n):Jm(r,Me.memoizedState,t,n)},useTransition:function(){var t=Xl(Hn)[0],n=st().memoizedState;return[typeof t=="boolean"?t:Js(t),n]},useSyncExternalStore:_m,useId:ep};ia.useCacheRefresh=tp,ia.useMemoCache=Kl,ia.useHostTransitionStatus=nu,ia.useFormState=qm,ia.useActionState=qm,ia.useOptimistic=function(t,n){var r=st();return Me!==null?Nm(r,Me,t,n):(r.baseState=t,[t,r.queue.dispatch])};function au(t,n,r,c){n=t.memoizedState,r=r(c,n),r=r==null?n:ee({},n,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var su={isMounted:function(t){return(t=t._reactInternals)?he(t)===t:!1},enqueueSetState:function(t,n,r){t=t._reactInternals;var c=Ft(),f=yi(c);f.payload=n,r!=null&&(f.callback=r),n=bi(t,f,c),n!==null&&(Ot(n,t,c),er(n,t,c))},enqueueReplaceState:function(t,n,r){t=t._reactInternals;var c=Ft(),f=yi(c);f.tag=1,f.payload=n,r!=null&&(f.callback=r),n=bi(t,f,c),n!==null&&(Ot(n,t,c),er(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var r=Ft(),c=yi(r);c.tag=2,n!=null&&(c.callback=n),n=bi(t,c,r),n!==null&&(Ot(n,t,r),er(n,t,r))}};function sp(t,n,r,c,f,p,y){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,p,y):n.prototype&&n.prototype.isPureReactComponent?!Is(r,c)||!Is(f,p):!0}function rp(t,n,r,c){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==t&&su.enqueueReplaceState(n,n.state,null)}function aa(t,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(t=t.defaultProps){r===n&&(r=ee({},r));for(var f in t)r[f]===void 0&&(r[f]=t[f])}return r}var Ao=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function op(t){Ao(t)}function cp(t){console.error(t)}function lp(t){Ao(t)}function No(t,n){try{var r=t.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function up(t,n,r){try{var c=t.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function ru(t,n,r){return r=yi(r),r.tag=3,r.payload={element:null},r.callback=function(){No(t,n)},r}function dp(t){return t=yi(t),t.tag=3,t}function fp(t,n,r,c){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var p=c.value;t.payload=function(){return f(p)},t.callback=function(){up(n,r,c)}}var y=r.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(t.callback=function(){up(n,r,c),typeof f!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function fT(t,n,r,c,f){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&$s(n,r,f,!0),r=tn.current,r!==null){switch(r.tag){case 13:return En===null?qu():r.alternate===null&&Xe===0&&(Xe=3),r.flags&=-257,r.flags|=65536,r.lanes=f,c===Ll?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),Vu(t,c,f)),!1;case 22:return r.flags|=65536,c===Ll?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),Vu(t,c,f)),!1}throw Error(s(435,r.tag))}return Vu(t,c,f),qu(),!1}if(xe)return n=tn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,c!==Ul&&(t=Error(s(422),{cause:c}),Hs(Wt(t,r)))):(c!==Ul&&(n=Error(s(423),{cause:c}),Hs(Wt(n,r))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=Wt(c,r),f=ru(t.stateNode,c,f),Tu(t,f),Xe!==4&&(Xe=2)),!1;var p=Error(s(520),{cause:c});if(p=Wt(p,r),cr===null?cr=[p]:cr.push(p),Xe!==4&&(Xe=2),n===null)return!0;c=Wt(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,t=f&-f,r.lanes|=t,t=ru(r.stateNode,c,t),Tu(r,t),!1;case 1:if(n=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Ri===null||!Ri.has(p))))return r.flags|=65536,f&=-f,r.lanes|=f,f=dp(f),fp(f,t,r,c),Tu(r,f),!1}r=r.return}while(r!==null);return!1}var hp=Error(s(461)),ht=!1;function yt(t,n,r,c){n.child=t===null?ym(n,null,r,c):$i(n,t.child,r,c)}function mp(t,n,r,c,f){r=r.render;var p=n.ref;if("ref"in c){var y={};for(var S in c)S!=="ref"&&(y[S]=c[S])}else y=c;return ra(n),c=Vl(t,n,r,y,p,f),S=Fl(),t!==null&&!ht?(Gl(t,n,f),Vn(t,n,f)):(xe&&S&&Pl(n),n.flags|=1,yt(t,n,c,f),n.child)}function pp(t,n,r,c,f){if(t===null){var p=r.type;return typeof p=="function"&&!xu(p)&&p.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=p,gp(t,n,p,c,f)):(t=jo(r.type,null,c,n,n.mode,f),t.ref=n.ref,t.return=n,n.child=t)}if(p=t.child,!pu(t,f)){var y=p.memoizedProps;if(r=r.compare,r=r!==null?r:Is,r(y,c)&&t.ref===n.ref)return Vn(t,n,f)}return n.flags|=1,t=Ci(p,c),t.ref=n.ref,t.return=n,n.child=t}function gp(t,n,r,c,f){if(t!==null){var p=t.memoizedProps;if(Is(p,c)&&t.ref===n.ref)if(ht=!1,n.pendingProps=c=p,pu(t,f))(t.flags&131072)!==0&&(ht=!0);else return n.lanes=t.lanes,Vn(t,n,f)}return ou(t,n,r,c,f)}function vp(t,n,r){var c=n.pendingProps,f=c.children,p=(n.stateNode._pendingVisibility&2)!==0,y=t!==null?t.memoizedState:null;if(Ws(t,n),c.mode==="hidden"||p){if((n.flags&128)!==0){if(c=y!==null?y.baseLanes|r:r,t!==null){for(f=n.child=t.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;n.childLanes=p&~c}else n.childLanes=0,n.child=null;return yp(t,n,c,r)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},t!==null&&ko(n,y!==null?y.cachePool:null),y!==null?bm(n,y):jl(),Sm(n);else return n.lanes=n.childLanes=536870912,yp(t,n,y!==null?y.baseLanes|r:r,r)}else y!==null?(ko(n,y.cachePool),bm(n,y),hi(),n.memoizedState=null):(t!==null&&ko(n,null),jl(),hi());return yt(t,n,f,r),n.child}function yp(t,n,r,c){var f=ql();return f=f===null?null:{parent:lt._currentValue,pool:f},n.memoizedState={baseLanes:r,cachePool:f},t!==null&&ko(n,null),jl(),Sm(n),t!==null&&$s(t,n,c,!0),null}function Ws(t,n){var r=n.ref;if(r===null)t!==null&&t.ref!==null&&(n.flags|=2097664);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(t===null||t.ref!==r)&&(n.flags|=2097664)}}function ou(t,n,r,c,f){return ra(n),r=Vl(t,n,r,c,void 0,f),c=Fl(),t!==null&&!ht?(Gl(t,n,f),Vn(t,n,f)):(xe&&c&&Pl(n),n.flags|=1,yt(t,n,r,f),n.child)}function bp(t,n,r,c,f,p){return ra(n),n.updateQueue=null,r=Rm(n,c,r,f),Em(t),c=Fl(),t!==null&&!ht?(Gl(t,n,p),Vn(t,n,p)):(xe&&c&&Pl(n),n.flags|=1,yt(t,n,r,p),n.child)}function Sp(t,n,r,c,f){if(ra(n),n.stateNode===null){var p=La,y=r.contextType;typeof y=="object"&&y!==null&&(p=Ct(y)),p=new r(c,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=su,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=c,p.state=n.memoizedState,p.refs={},bu(n),y=r.contextType,p.context=typeof y=="object"&&y!==null?Ct(y):La,p.state=n.memoizedState,y=r.getDerivedStateFromProps,typeof y=="function"&&(au(n,r,y,c),p.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(y=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),y!==p.state&&su.enqueueReplaceState(p,p.state,null),nr(n,c,p,f),tr(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(t===null){p=n.stateNode;var S=n.memoizedProps,R=aa(r,S);p.props=R;var N=p.context,V=r.contextType;y=La,typeof V=="object"&&V!==null&&(y=Ct(V));var K=r.getDerivedStateFromProps;V=typeof K=="function"||typeof p.getSnapshotBeforeUpdate=="function",S=n.pendingProps!==S,V||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S||N!==y)&&rp(n,p,c,y),vi=!1;var L=n.memoizedState;p.state=L,nr(n,c,p,f),tr(),N=n.memoizedState,S||L!==N||vi?(typeof K=="function"&&(au(n,r,K,c),N=n.memoizedState),(R=vi||sp(n,r,R,c,L,N,y))?(V||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=N),p.props=c,p.state=N,p.context=y,c=R):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{p=n.stateNode,Su(t,n),y=n.memoizedProps,V=aa(r,y),p.props=V,K=n.pendingProps,L=p.context,N=r.contextType,R=La,typeof N=="object"&&N!==null&&(R=Ct(N)),S=r.getDerivedStateFromProps,(N=typeof S=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(y!==K||L!==R)&&rp(n,p,c,R),vi=!1,L=n.memoizedState,p.state=L,nr(n,c,p,f),tr();var H=n.memoizedState;y!==K||L!==H||vi||t!==null&&t.dependencies!==null&&Po(t.dependencies)?(typeof S=="function"&&(au(n,r,S,c),H=n.memoizedState),(V=vi||sp(n,r,V,c,L,H,R)||t!==null&&t.dependencies!==null&&Po(t.dependencies))?(N||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,H,R),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,H,R)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&L===t.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&L===t.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=H),p.props=c,p.state=H,p.context=R,c=V):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&L===t.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&L===t.memoizedState||(n.flags|=1024),c=!1)}return p=c,Ws(t,n),c=(n.flags&128)!==0,p||c?(p=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,t!==null&&c?(n.child=$i(n,t.child,null,f),n.child=$i(n,null,r,f)):yt(t,n,r,f),n.memoizedState=p.state,t=n.child):t=Vn(t,n,f),t}function Tp(t,n,r,c){return qs(),n.flags|=256,yt(t,n,r,c),n.child}var cu={dehydrated:null,treeContext:null,retryLane:0};function lu(t){return{baseLanes:t,cachePool:Cm()}}function uu(t,n,r){return t=t!==null?t.childLanes&~r:0,n&&(t|=rn),t}function kp(t,n,r){var c=n.pendingProps,f=!1,p=(n.flags&128)!==0,y;if((y=p)||(y=t!==null&&t.memoizedState===null?!1:(ct.current&2)!==0),y&&(f=!0,n.flags&=-129),y=(n.flags&32)!==0,n.flags&=-33,t===null){if(xe){if(f?fi(n):hi(),xe){var S=vt,R;if(R=S){e:{for(R=S,S=Cn;R.nodeType!==8;){if(!S){S=null;break e}if(R=fn(R.nextSibling),R===null){S=null;break e}}S=R}S!==null?(n.memoizedState={dehydrated:S,treeContext:Ji!==null?{id:Bn,overflow:zn}:null,retryLane:536870912},R=sn(18,null,null,0),R.stateNode=S,R.return=n,n.child=R,wt=n,vt=null,R=!0):R=!1}R||Wi(n)}if(S=n.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return S.data==="$!"?n.lanes=16:n.lanes=536870912,null;qn(n)}return S=c.children,c=c.fallback,f?(hi(),f=n.mode,S=fu({mode:"hidden",children:S},f),c=ca(c,f,r,null),S.return=n,c.return=n,S.sibling=c,n.child=S,f=n.child,f.memoizedState=lu(r),f.childLanes=uu(t,y,r),n.memoizedState=cu,c):(fi(n),du(n,S))}if(R=t.memoizedState,R!==null&&(S=R.dehydrated,S!==null)){if(p)n.flags&256?(fi(n),n.flags&=-257,n=hu(t,n,r)):n.memoizedState!==null?(hi(),n.child=t.child,n.flags|=128,n=null):(hi(),f=c.fallback,S=n.mode,c=fu({mode:"visible",children:c.children},S),f=ca(f,S,r,null),f.flags|=2,c.return=n,f.return=n,c.sibling=f,n.child=c,$i(n,t.child,null,r),c=n.child,c.memoizedState=lu(r),c.childLanes=uu(t,y,r),n.memoizedState=cu,n=f);else if(fi(n),S.data==="$!"){if(y=S.nextSibling&&S.nextSibling.dataset,y)var N=y.dgst;y=N,c=Error(s(419)),c.stack="",c.digest=y,Hs({value:c,source:null,stack:null}),n=hu(t,n,r)}else if(ht||$s(t,n,r,!1),y=(r&t.childLanes)!==0,ht||y){if(y=ze,y!==null){if(c=r&-r,(c&42)!==0)c=1;else switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=64;break;case 268435456:c=134217728;break;default:c=0}if(c=(c&(y.suspendedLanes|r))!==0?0:c,c!==0&&c!==R.retryLane)throw R.retryLane=c,di(t,c),Ot(y,t,c),hp}S.data==="$?"||qu(),n=hu(t,n,r)}else S.data==="$?"?(n.flags|=128,n.child=t.child,n=wT.bind(null,t),S._reactRetry=n,n=null):(t=R.treeContext,vt=fn(S.nextSibling),wt=n,xe=!0,un=null,Cn=!1,t!==null&&($t[en++]=Bn,$t[en++]=zn,$t[en++]=Ji,Bn=t.id,zn=t.overflow,Ji=n),n=du(n,c.children),n.flags|=4096);return n}return f?(hi(),f=c.fallback,S=n.mode,R=t.child,N=R.sibling,c=Ci(R,{mode:"hidden",children:c.children}),c.subtreeFlags=R.subtreeFlags&31457280,N!==null?f=Ci(N,f):(f=ca(f,S,r,null),f.flags|=2),f.return=n,c.return=n,c.sibling=f,n.child=c,c=f,f=n.child,S=t.child.memoizedState,S===null?S=lu(r):(R=S.cachePool,R!==null?(N=lt._currentValue,R=R.parent!==N?{parent:N,pool:N}:R):R=Cm(),S={baseLanes:S.baseLanes|r,cachePool:R}),f.memoizedState=S,f.childLanes=uu(t,y,r),n.memoizedState=cu,c):(fi(n),r=t.child,t=r.sibling,r=Ci(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,t!==null&&(y=n.deletions,y===null?(n.deletions=[t],n.flags|=16):y.push(t)),n.child=r,n.memoizedState=null,r)}function du(t,n){return n=fu({mode:"visible",children:n},t.mode),n.return=t,t.child=n}function fu(t,n){return Qp(t,n,0,null)}function hu(t,n,r){return $i(n,t.child,null,r),t=du(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function Cp(t,n,r){t.lanes|=n;var c=t.alternate;c!==null&&(c.lanes|=n),vu(t.return,n,r)}function mu(t,n,r,c,f){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:f}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=r,p.tailMode=f)}function Ep(t,n,r){var c=n.pendingProps,f=c.revealOrder,p=c.tail;if(yt(t,n,c.children,r),c=ct.current,(c&2)!==0)c=c&1|2,n.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Cp(t,r,n);else if(t.tag===19)Cp(t,r,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}c&=1}switch(He(ct,c),f){case"forwards":for(r=n.child,f=null;r!==null;)t=r.alternate,t!==null&&To(t)===null&&(f=r),r=r.sibling;r=f,r===null?(f=n.child,n.child=null):(f=r.sibling,r.sibling=null),mu(n,!1,f,r,p);break;case"backwards":for(r=null,f=n.child,n.child=null;f!==null;){if(t=f.alternate,t!==null&&To(t)===null){n.child=f;break}t=f.sibling,f.sibling=r,r=f,f=t}mu(n,!0,r,null,p);break;case"together":mu(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Vn(t,n,r){if(t!==null&&(n.dependencies=t.dependencies),Ei|=n.lanes,(r&n.childLanes)===0)if(t!==null){if($s(t,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(t!==null&&n.child!==t.child)throw Error(s(153));if(n.child!==null){for(t=n.child,r=Ci(t,t.pendingProps),n.child=r,r.return=n;t.sibling!==null;)t=t.sibling,r=r.sibling=Ci(t,t.pendingProps),r.return=n;r.sibling=null}return n.child}function pu(t,n){return(t.lanes&n)!==0?!0:(t=t.dependencies,!!(t!==null&&Po(t)))}function hT(t,n,r){switch(n.tag){case 3:Qr(n,n.stateNode.containerInfo),gi(n,lt,t.memoizedState.cache),qs();break;case 27:case 5:sl(n);break;case 4:Qr(n,n.stateNode.containerInfo);break;case 10:gi(n,n.type,n.memoizedProps.value);break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(fi(n),n.flags|=128,null):(r&n.child.childLanes)!==0?kp(t,n,r):(fi(n),t=Vn(t,n,r),t!==null?t.sibling:null);fi(n);break;case 19:var f=(t.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||($s(t,n,r,!1),c=(r&n.childLanes)!==0),f){if(c)return Ep(t,n,r);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),He(ct,ct.current),c)break;return null;case 22:case 23:return n.lanes=0,vp(t,n,r);case 24:gi(n,lt,t.memoizedState.cache)}return Vn(t,n,r)}function Rp(t,n,r){if(t!==null)if(t.memoizedProps!==n.pendingProps)ht=!0;else{if(!pu(t,r)&&(n.flags&128)===0)return ht=!1,hT(t,n,r);ht=(t.flags&131072)!==0}else ht=!1,xe&&(n.flags&1048576)!==0&&lm(n,go,n.index);switch(n.lanes=0,n.tag){case 16:e:{t=n.pendingProps;var c=n.elementType,f=c._init;if(c=f(c._payload),n.type=c,typeof c=="function")xu(c)?(t=aa(c,t),n.tag=1,n=Sp(null,n,c,t,r)):(n.tag=0,n=ou(null,n,c,t,r));else{if(c!=null){if(f=c.$$typeof,f===T){n.tag=11,n=mp(null,n,c,t,r);break e}else if(f===O){n.tag=14,n=pp(null,n,c,t,r);break e}}throw n=ae(c)||c,Error(s(306,n,""))}}return n;case 0:return ou(t,n,n.type,n.pendingProps,r);case 1:return c=n.type,f=aa(c,n.pendingProps),Sp(t,n,c,f,r);case 3:e:{if(Qr(n,n.stateNode.containerInfo),t===null)throw Error(s(387));var p=n.pendingProps;f=n.memoizedState,c=f.element,Su(t,n),nr(n,p,null,r);var y=n.memoizedState;if(p=y.cache,gi(n,lt,p),p!==f.cache&&yu(n,[lt],r,!0),tr(),p=y.element,f.isDehydrated)if(f={element:p,isDehydrated:!1,cache:y.cache},n.updateQueue.baseState=f,n.memoizedState=f,n.flags&256){n=Tp(t,n,p,r);break e}else if(p!==c){c=Wt(Error(s(424)),n),Hs(c),n=Tp(t,n,p,r);break e}else for(vt=fn(n.stateNode.containerInfo.firstChild),wt=n,xe=!0,un=null,Cn=!0,r=ym(n,null,p,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qs(),p===c){n=Vn(t,n,r);break e}yt(t,n,p,r)}n=n.child}return n;case 26:return Ws(t,n),t===null?(r=Og(n.type,null,n.pendingProps,null))?n.memoizedState=r:xe||(r=n.type,t=n.pendingProps,c=Xo(oi.current).createElement(r),c[kt]=n,c[Dt]=t,bt(c,r,t),ft(c),n.stateNode=c):n.memoizedState=Og(n.type,t.memoizedProps,n.pendingProps,t.memoizedState),null;case 27:return sl(n),t===null&&xe&&(c=n.stateNode=Rg(n.type,n.pendingProps,oi.current),wt=n,Cn=!0,vt=fn(c.firstChild)),c=n.pendingProps.children,t!==null||xe?yt(t,n,c,r):n.child=$i(n,null,c,r),Ws(t,n),n.child;case 5:return t===null&&xe&&((f=c=vt)&&(c=VT(c,n.type,n.pendingProps,Cn),c!==null?(n.stateNode=c,wt=n,vt=fn(c.firstChild),Cn=!1,f=!0):f=!1),f||Wi(n)),sl(n),f=n.type,p=n.pendingProps,y=t!==null?t.memoizedProps:null,c=p.children,td(f,p)?c=null:y!==null&&td(f,y)&&(n.flags|=32),n.memoizedState!==null&&(f=Vl(t,n,rT,null,null,r),vr._currentValue=f),Ws(t,n),yt(t,n,c,r),n.child;case 6:return t===null&&xe&&((t=r=vt)&&(r=FT(r,n.pendingProps,Cn),r!==null?(n.stateNode=r,wt=n,vt=null,t=!0):t=!1),t||Wi(n)),null;case 13:return kp(t,n,r);case 4:return Qr(n,n.stateNode.containerInfo),c=n.pendingProps,t===null?n.child=$i(n,null,c,r):yt(t,n,c,r),n.child;case 11:return mp(t,n,n.type,n.pendingProps,r);case 7:return yt(t,n,n.pendingProps,r),n.child;case 8:return yt(t,n,n.pendingProps.children,r),n.child;case 12:return yt(t,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,gi(n,n.type,c.value),yt(t,n,c.children,r),n.child;case 9:return f=n.type._context,c=n.pendingProps.children,ra(n),f=Ct(f),c=c(f),n.flags|=1,yt(t,n,c,r),n.child;case 14:return pp(t,n,n.type,n.pendingProps,r);case 15:return gp(t,n,n.type,n.pendingProps,r);case 19:return Ep(t,n,r);case 22:return vp(t,n,r);case 24:return ra(n),c=Ct(lt),t===null?(f=ql(),f===null&&(f=ze,p=Bl(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=r),f=p),n.memoizedState={parent:c,cache:f},bu(n),gi(n,lt,f)):((t.lanes&r)!==0&&(Su(t,n),nr(n,null,null,r),tr()),f=t.memoizedState,p=n.memoizedState,f.parent!==c?(f={parent:c,cache:c},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),gi(n,lt,c)):(c=p.cache,gi(n,lt,c),c!==f.cache&&yu(n,[lt],r,!0))),yt(t,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}var gu=Ne(null),sa=null,Fn=null;function gi(t,n,r){He(gu,n._currentValue),n._currentValue=r}function Gn(t){t._currentValue=gu.current,it(gu)}function vu(t,n,r){for(;t!==null;){var c=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),t===r)break;t=t.return}}function yu(t,n,r,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var p=f.dependencies;if(p!==null){var y=f.child;p=p.firstContext;e:for(;p!==null;){var S=p;p=f;for(var R=0;R<n.length;R++)if(S.context===n[R]){p.lanes|=r,S=p.alternate,S!==null&&(S.lanes|=r),vu(p.return,r,t),c||(y=null);break e}p=S.next}}else if(f.tag===18){if(y=f.return,y===null)throw Error(s(341));y.lanes|=r,p=y.alternate,p!==null&&(p.lanes|=r),vu(y,r,t),y=null}else y=f.child;if(y!==null)y.return=f;else for(y=f;y!==null;){if(y===t){y=null;break}if(f=y.sibling,f!==null){f.return=y.return,y=f;break}y=y.return}f=y}}function $s(t,n,r,c){t=null;for(var f=n,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var y=f.alternate;if(y===null)throw Error(s(387));if(y=y.memoizedProps,y!==null){var S=f.type;zt(f.pendingProps.value,y.value)||(t!==null?t.push(S):t=[S])}}else if(f===Kr.current){if(y=f.alternate,y===null)throw Error(s(387));y.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(vr):t=[vr])}f=f.return}t!==null&&yu(n,t,r,c),n.flags|=262144}function Po(t){for(t=t.firstContext;t!==null;){if(!zt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ra(t){sa=t,Fn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Ct(t){return _p(sa,t)}function Mo(t,n){return sa===null&&ra(t),_p(t,n)}function _p(t,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Fn===null){if(t===null)throw Error(s(308));Fn=n,t.dependencies={lanes:0,firstContext:n},t.flags|=524288}else Fn=Fn.next=n;return r}var vi=!1;function bu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Su(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function yi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function bi(t,n,r){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Ye&2)!==0){var f=c.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),c.pending=n,n=mo(t),om(t,null,r),n}return ho(t,c,n,r),mo(t)}function er(t,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194176)!==0)){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,ph(t,r)}}function Tu(t,n){var r=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var f=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var y={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?f=p=y:p=p.next=y,r=r.next}while(r!==null);p===null?f=p=n:p=p.next=n}else f=p=n;r={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=n:t.next=n,r.lastBaseUpdate=n}var ku=!1;function tr(){if(ku){var t=Ha;if(t!==null)throw t}}function nr(t,n,r,c){ku=!1;var f=t.updateQueue;vi=!1;var p=f.firstBaseUpdate,y=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var R=S,N=R.next;R.next=null,y===null?p=N:y.next=N,y=R;var V=t.alternate;V!==null&&(V=V.updateQueue,S=V.lastBaseUpdate,S!==y&&(S===null?V.firstBaseUpdate=N:S.next=N,V.lastBaseUpdate=R))}if(p!==null){var K=f.baseState;y=0,V=N=R=null,S=p;do{var L=S.lane&-536870913,H=L!==S.lane;if(H?(Re&L)===L:(c&L)===L){L!==0&&L===qa&&(ku=!0),V!==null&&(V=V.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var oe=t,me=S;L=n;var Je=r;switch(me.tag){case 1:if(oe=me.payload,typeof oe=="function"){K=oe.call(Je,K,L);break e}K=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=me.payload,L=typeof oe=="function"?oe.call(Je,K,L):oe,L==null)break e;K=ee({},K,L);break e;case 2:vi=!0}}L=S.callback,L!==null&&(t.flags|=64,H&&(t.flags|=8192),H=f.callbacks,H===null?f.callbacks=[L]:H.push(L))}else H={lane:L,tag:S.tag,payload:S.payload,callback:S.callback,next:null},V===null?(N=V=H,R=K):V=V.next=H,y|=L;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;H=S,S=H.next,H.next=null,f.lastBaseUpdate=H,f.shared.pending=null}}while(!0);V===null&&(R=K),f.baseState=R,f.firstBaseUpdate=N,f.lastBaseUpdate=V,p===null&&(f.shared.lanes=0),Ei|=y,t.lanes=y,t.memoizedState=K}}function wp(t,n){if(typeof t!="function")throw Error(s(191,t));t.call(n)}function Op(t,n){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)wp(r[t],n)}function ir(t,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&t)===t){c=void 0;var p=r.create,y=r.inst;c=p(),y.destroy=c}r=r.next}while(r!==f)}}catch(S){je(n,n.return,S)}}function Si(t,n,r){try{var c=n.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var p=f.next;c=p;do{if((c.tag&t)===t){var y=c.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,f=n;var R=r;try{S()}catch(N){je(f,R,N)}}}c=c.next}while(c!==p)}}catch(N){je(n,n.return,N)}}function xp(t){var n=t.updateQueue;if(n!==null){var r=t.stateNode;try{Op(n,r)}catch(c){je(t,t.return,c)}}}function Dp(t,n,r){r.props=aa(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(c){je(t,n,c)}}function oa(t,n){try{var r=t.ref;if(r!==null){var c=t.stateNode;switch(t.tag){case 26:case 27:case 5:var f=c;break;default:f=c}typeof r=="function"?t.refCleanup=r(f):r.current=f}}catch(p){je(t,n,p)}}function qt(t,n){var r=t.ref,c=t.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(f){je(t,n,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){je(t,n,f)}else r.current=null}function Ap(t){var n=t.type,r=t.memoizedProps,c=t.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break e;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(f){je(t,t.return,f)}}function Np(t,n,r){try{var c=t.stateNode;IT(c,t.type,r,n),c[Dt]=n}catch(f){je(t,t.return,f)}}function Pp(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27||t.tag===4}function Cu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Pp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==27&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Eu(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?r.nodeType===8?r.parentNode.insertBefore(t,n):r.insertBefore(t,n):(r.nodeType===8?(n=r.parentNode,n.insertBefore(t,r)):(n=r,n.appendChild(t)),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Qo));else if(c!==4&&c!==27&&(t=t.child,t!==null))for(Eu(t,n,r),t=t.sibling;t!==null;)Eu(t,n,r),t=t.sibling}function Uo(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?r.insertBefore(t,n):r.appendChild(t);else if(c!==4&&c!==27&&(t=t.child,t!==null))for(Uo(t,n,r),t=t.sibling;t!==null;)Uo(t,n,r),t=t.sibling}var Yn=!1,Qe=!1,Ru=!1,Mp=typeof WeakSet=="function"?WeakSet:Set,mt=null,Up=!1;function mT(t,n){if(t=t.containerInfo,$u=tc,t=Wh(t),wl(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var f=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break e}var y=0,S=-1,R=-1,N=0,V=0,K=t,L=null;t:for(;;){for(var H;K!==r||f!==0&&K.nodeType!==3||(S=y+f),K!==p||c!==0&&K.nodeType!==3||(R=y+c),K.nodeType===3&&(y+=K.nodeValue.length),(H=K.firstChild)!==null;)L=K,K=H;for(;;){if(K===t)break t;if(L===r&&++N===f&&(S=y),L===p&&++V===c&&(R=y),(H=K.nextSibling)!==null)break;K=L,L=K.parentNode}K=H}r=S===-1||R===-1?null:{start:S,end:R}}else r=null}r=r||{start:0,end:0}}else r=null;for(ed={focusedElem:t,selectionRange:r},tc=!1,mt=n;mt!==null;)if(n=mt,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,mt=t;else for(;mt!==null;){switch(n=mt,p=n.alternate,t=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,r=n,f=p.memoizedProps,p=p.memoizedState,c=r.stateNode;try{var oe=aa(r.type,f,r.elementType===r.type);t=c.getSnapshotBeforeUpdate(oe,p),c.__reactInternalSnapshotBeforeUpdate=t}catch(me){je(r,r.return,me)}}break;case 3:if((t&1024)!==0){if(t=n.stateNode.containerInfo,r=t.nodeType,r===9)ad(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":ad(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=n.sibling,t!==null){t.return=n.return,mt=t;break}mt=n.return}return oe=Up,Up=!1,oe}function Lp(t,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:Qn(t,r),c&4&&ir(5,r);break;case 1:if(Qn(t,r),c&4)if(t=r.stateNode,n===null)try{t.componentDidMount()}catch(S){je(r,r.return,S)}else{var f=aa(r.type,n.memoizedProps);n=n.memoizedState;try{t.componentDidUpdate(f,n,t.__reactInternalSnapshotBeforeUpdate)}catch(S){je(r,r.return,S)}}c&64&&xp(r),c&512&&oa(r,r.return);break;case 3:if(Qn(t,r),c&64&&(c=r.updateQueue,c!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{Op(c,t)}catch(S){je(r,r.return,S)}}break;case 26:Qn(t,r),c&512&&oa(r,r.return);break;case 27:case 5:Qn(t,r),n===null&&c&4&&Ap(r),c&512&&oa(r,r.return);break;case 12:Qn(t,r);break;case 13:Qn(t,r),c&4&&Bp(t,r);break;case 22:if(f=r.memoizedState!==null||Yn,!f){n=n!==null&&n.memoizedState!==null||Qe;var p=Yn,y=Qe;Yn=f,(Qe=n)&&!y?Ti(t,r,(r.subtreeFlags&8772)!==0):Qn(t,r),Yn=p,Qe=y}c&512&&(r.memoizedProps.mode==="manual"?oa(r,r.return):qt(r,r.return));break;default:Qn(t,r)}}function jp(t){var n=t.alternate;n!==null&&(t.alternate=null,jp(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&dl(n)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var rt=null,Ht=!1;function Kn(t,n,r){for(r=r.child;r!==null;)Ip(t,n,r),r=r.sibling}function Ip(t,n,r){if(It&&typeof It.onCommitFiberUnmount=="function")try{It.onCommitFiberUnmount(_s,r)}catch{}switch(r.tag){case 26:Qe||qt(r,n),Kn(t,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Qe||qt(r,n);var c=rt,f=Ht;for(rt=r.stateNode,Kn(t,n,r),r=r.stateNode,n=r.attributes;n.length;)r.removeAttributeNode(n[0]);dl(r),rt=c,Ht=f;break;case 5:Qe||qt(r,n);case 6:f=rt;var p=Ht;if(rt=null,Kn(t,n,r),rt=f,Ht=p,rt!==null)if(Ht)try{t=rt,c=r.stateNode,t.nodeType===8?t.parentNode.removeChild(c):t.removeChild(c)}catch(y){je(r,n,y)}else try{rt.removeChild(r.stateNode)}catch(y){je(r,n,y)}break;case 18:rt!==null&&(Ht?(n=rt,r=r.stateNode,n.nodeType===8?id(n.parentNode,r):n.nodeType===1&&id(n,r),Tr(n)):id(rt,r.stateNode));break;case 4:c=rt,f=Ht,rt=r.stateNode.containerInfo,Ht=!0,Kn(t,n,r),rt=c,Ht=f;break;case 0:case 11:case 14:case 15:Qe||Si(2,r,n),Qe||Si(4,r,n),Kn(t,n,r);break;case 1:Qe||(qt(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&Dp(r,n,c)),Kn(t,n,r);break;case 21:Kn(t,n,r);break;case 22:Qe||qt(r,n),Qe=(c=Qe)||r.memoizedState!==null,Kn(t,n,r),Qe=c;break;default:Kn(t,n,r)}}function Bp(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Tr(t)}catch(r){je(n,n.return,r)}}function pT(t){switch(t.tag){case 13:case 19:var n=t.stateNode;return n===null&&(n=t.stateNode=new Mp),n;case 22:return t=t.stateNode,n=t._retryCache,n===null&&(n=t._retryCache=new Mp),n;default:throw Error(s(435,t.tag))}}function _u(t,n){var r=pT(t);n.forEach(function(c){var f=OT.bind(null,t,c);r.has(c)||(r.add(c),c.then(f,f))})}function nn(t,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var f=r[c],p=t,y=n,S=y;e:for(;S!==null;){switch(S.tag){case 27:case 5:rt=S.stateNode,Ht=!1;break e;case 3:rt=S.stateNode.containerInfo,Ht=!0;break e;case 4:rt=S.stateNode.containerInfo,Ht=!0;break e}S=S.return}if(rt===null)throw Error(s(160));Ip(p,y,f),rt=null,Ht=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)zp(n,t),n=n.sibling}var dn=null;function zp(t,n){var r=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:nn(n,t),an(t),c&4&&(Si(3,t,t.return),ir(3,t),Si(5,t,t.return));break;case 1:nn(n,t),an(t),c&512&&(Qe||r===null||qt(r,r.return)),c&64&&Yn&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var f=dn;if(nn(n,t),an(t),c&512&&(Qe||r===null||qt(r,r.return)),c&4){var p=r!==null?r.memoizedState:null;if(c=t.memoizedState,r===null)if(c===null)if(t.stateNode===null){e:{c=t.type,r=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":p=f.getElementsByTagName("title")[0],(!p||p[xs]||p[kt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(c),f.head.insertBefore(p,f.querySelector("head > title"))),bt(p,c,r),p[kt]=t,ft(p),c=p;break e;case"link":var y=Ag("link","href",f).get(c+(r.href||""));if(y){for(var S=0;S<y.length;S++)if(p=y[S],p.getAttribute("href")===(r.href==null?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){y.splice(S,1);break t}}p=f.createElement(c),bt(p,c,r),f.head.appendChild(p);break;case"meta":if(y=Ag("meta","content",f).get(c+(r.content||""))){for(S=0;S<y.length;S++)if(p=y[S],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){y.splice(S,1);break t}}p=f.createElement(c),bt(p,c,r),f.head.appendChild(p);break;default:throw Error(s(468,c))}p[kt]=t,ft(p),c=p}t.stateNode=c}else Ng(f,t.type,t.stateNode);else t.stateNode=Dg(f,c,t.memoizedProps);else p!==c?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,c===null?Ng(f,t.type,t.stateNode):Dg(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Np(t,t.memoizedProps,r.memoizedProps)}break;case 27:if(c&4&&t.alternate===null){f=t.stateNode,p=t.memoizedProps;try{for(var R=f.firstChild;R;){var N=R.nextSibling,V=R.nodeName;R[xs]||V==="HEAD"||V==="BODY"||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&R.rel.toLowerCase()==="stylesheet"||f.removeChild(R),R=N}for(var K=t.type,L=f.attributes;L.length;)f.removeAttributeNode(L[0]);bt(f,K,p),f[kt]=t,f[Dt]=p}catch(oe){je(t,t.return,oe)}}case 5:if(nn(n,t),an(t),c&512&&(Qe||r===null||qt(r,r.return)),t.flags&32){f=t.stateNode;try{xa(f,"")}catch(oe){je(t,t.return,oe)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,Np(t,f,r!==null?r.memoizedProps:f)),c&1024&&(Ru=!0);break;case 6:if(nn(n,t),an(t),c&4){if(t.stateNode===null)throw Error(s(162));c=t.memoizedProps,r=t.stateNode;try{r.nodeValue=c}catch(oe){je(t,t.return,oe)}}break;case 3:if(Wo=null,f=dn,dn=Jo(n.containerInfo),nn(n,t),dn=f,an(t),c&4&&r!==null&&r.memoizedState.isDehydrated)try{Tr(n.containerInfo)}catch(oe){je(t,t.return,oe)}Ru&&(Ru=!1,qp(t));break;case 4:c=dn,dn=Jo(t.stateNode.containerInfo),nn(n,t),an(t),dn=c;break;case 12:nn(n,t),an(t);break;case 13:nn(n,t),an(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Uu=kn()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,_u(t,c)));break;case 22:if(c&512&&(Qe||r===null||qt(r,r.return)),R=t.memoizedState!==null,N=r!==null&&r.memoizedState!==null,V=Yn,K=Qe,Yn=V||R,Qe=K||N,nn(n,t),Qe=K,Yn=V,an(t),n=t.stateNode,n._current=t,n._visibility&=-3,n._visibility|=n._pendingVisibility&2,c&8192&&(n._visibility=R?n._visibility&-2:n._visibility|1,R&&(n=Yn||Qe,r===null||N||n||Ya(t)),t.memoizedProps===null||t.memoizedProps.mode!=="manual"))e:for(r=null,n=t;;){if(n.tag===5||n.tag===26||n.tag===27){if(r===null){N=r=n;try{if(f=N.stateNode,R)p=f.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{y=N.stateNode,S=N.memoizedProps.style;var H=S!=null&&S.hasOwnProperty("display")?S.display:null;y.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(oe){je(N,N.return,oe)}}}else if(n.tag===6){if(r===null){N=n;try{N.stateNode.nodeValue=R?"":N.memoizedProps}catch(oe){je(N,N.return,oe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===t)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=t.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,_u(t,r))));break;case 19:nn(n,t),an(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,_u(t,c)));break;case 21:break;default:nn(n,t),an(t)}}function an(t){var n=t.flags;if(n&2){try{if(t.tag!==27){e:{for(var r=t.return;r!==null;){if(Pp(r)){var c=r;break e}r=r.return}throw Error(s(160))}switch(c.tag){case 27:var f=c.stateNode,p=Cu(t);Uo(t,p,f);break;case 5:var y=c.stateNode;c.flags&32&&(xa(y,""),c.flags&=-33);var S=Cu(t);Uo(t,S,y);break;case 3:case 4:var R=c.stateNode.containerInfo,N=Cu(t);Eu(t,N,R);break;default:throw Error(s(161))}}}catch(V){je(t,t.return,V)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function qp(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var n=t;qp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),t=t.sibling}}function Qn(t,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Lp(t,n.alternate,n),n=n.sibling}function Ya(t){for(t=t.child;t!==null;){var n=t;switch(n.tag){case 0:case 11:case 14:case 15:Si(4,n,n.return),Ya(n);break;case 1:qt(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&Dp(n,n.return,r),Ya(n);break;case 26:case 27:case 5:qt(n,n.return),Ya(n);break;case 22:qt(n,n.return),n.memoizedState===null&&Ya(n);break;default:Ya(n)}t=t.sibling}}function Ti(t,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,f=t,p=n,y=p.flags;switch(p.tag){case 0:case 11:case 15:Ti(f,p,r),ir(4,p);break;case 1:if(Ti(f,p,r),c=p,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(N){je(c,c.return,N)}if(c=p,f=c.updateQueue,f!==null){var S=c.stateNode;try{var R=f.shared.hiddenCallbacks;if(R!==null)for(f.shared.hiddenCallbacks=null,f=0;f<R.length;f++)wp(R[f],S)}catch(N){je(c,c.return,N)}}r&&y&64&&xp(p),oa(p,p.return);break;case 26:case 27:case 5:Ti(f,p,r),r&&c===null&&y&4&&Ap(p),oa(p,p.return);break;case 12:Ti(f,p,r);break;case 13:Ti(f,p,r),r&&y&4&&Bp(f,p);break;case 22:p.memoizedState===null&&Ti(f,p,r),oa(p,p.return);break;default:Ti(f,p,r)}n=n.sibling}}function wu(t,n){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&Ks(r))}function Ou(t,n){t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&Ks(t))}function ki(t,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Hp(t,n,r,c),n=n.sibling}function Hp(t,n,r,c){var f=n.flags;switch(n.tag){case 0:case 11:case 15:ki(t,n,r,c),f&2048&&ir(9,n);break;case 3:ki(t,n,r,c),f&2048&&(t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&Ks(t)));break;case 12:if(f&2048){ki(t,n,r,c),t=n.stateNode;try{var p=n.memoizedProps,y=p.id,S=p.onPostCommit;typeof S=="function"&&S(y,n.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(R){je(n,n.return,R)}}else ki(t,n,r,c);break;case 23:break;case 22:p=n.stateNode,n.memoizedState!==null?p._visibility&4?ki(t,n,r,c):ar(t,n):p._visibility&4?ki(t,n,r,c):(p._visibility|=4,Ka(t,n,r,c,(n.subtreeFlags&10256)!==0)),f&2048&&wu(n.alternate,n);break;case 24:ki(t,n,r,c),f&2048&&Ou(n.alternate,n);break;default:ki(t,n,r,c)}}function Ka(t,n,r,c,f){for(f=f&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var p=t,y=n,S=r,R=c,N=y.flags;switch(y.tag){case 0:case 11:case 15:Ka(p,y,S,R,f),ir(8,y);break;case 23:break;case 22:var V=y.stateNode;y.memoizedState!==null?V._visibility&4?Ka(p,y,S,R,f):ar(p,y):(V._visibility|=4,Ka(p,y,S,R,f)),f&&N&2048&&wu(y.alternate,y);break;case 24:Ka(p,y,S,R,f),f&&N&2048&&Ou(y.alternate,y);break;default:Ka(p,y,S,R,f)}n=n.sibling}}function ar(t,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=t,c=n,f=c.flags;switch(c.tag){case 22:ar(r,c),f&2048&&wu(c.alternate,c);break;case 24:ar(r,c),f&2048&&Ou(c.alternate,c);break;default:ar(r,c)}n=n.sibling}}var sr=8192;function Qa(t){if(t.subtreeFlags&sr)for(t=t.child;t!==null;)Vp(t),t=t.sibling}function Vp(t){switch(t.tag){case 26:Qa(t),t.flags&sr&&t.memoizedState!==null&&ik(dn,t.memoizedState,t.memoizedProps);break;case 5:Qa(t);break;case 3:case 4:var n=dn;dn=Jo(t.stateNode.containerInfo),Qa(t),dn=n;break;case 22:t.memoizedState===null&&(n=t.alternate,n!==null&&n.memoizedState!==null?(n=sr,sr=16777216,Qa(t),sr=n):Qa(t));break;default:Qa(t)}}function Fp(t){var n=t.alternate;if(n!==null&&(t=n.child,t!==null)){n.child=null;do n=t.sibling,t.sibling=null,t=n;while(t!==null)}}function rr(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];mt=c,Yp(c,t)}Fp(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Gp(t),t=t.sibling}function Gp(t){switch(t.tag){case 0:case 11:case 15:rr(t),t.flags&2048&&Si(9,t,t.return);break;case 3:rr(t);break;case 12:rr(t);break;case 22:var n=t.stateNode;t.memoizedState!==null&&n._visibility&4&&(t.return===null||t.return.tag!==13)?(n._visibility&=-5,Lo(t)):rr(t);break;default:rr(t)}}function Lo(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];mt=c,Yp(c,t)}Fp(t)}for(t=t.child;t!==null;){switch(n=t,n.tag){case 0:case 11:case 15:Si(8,n,n.return),Lo(n);break;case 22:r=n.stateNode,r._visibility&4&&(r._visibility&=-5,Lo(n));break;default:Lo(n)}t=t.sibling}}function Yp(t,n){for(;mt!==null;){var r=mt;switch(r.tag){case 0:case 11:case 15:Si(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ks(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,mt=c;else e:for(r=t;mt!==null;){c=mt;var f=c.sibling,p=c.return;if(jp(c),c===r){mt=null;break e}if(f!==null){f.return=p,mt=f;break e}mt=p}}}function gT(t,n,r,c){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(t,n,r,c){return new gT(t,n,r,c)}function xu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ci(t,n){var r=t.alternate;return r===null?(r=sn(t.tag,n,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=n,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&31457280,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,n=t.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function Kp(t,n){t.flags&=31457282;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=n,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,n=r.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t}function jo(t,n,r,c,f,p){var y=0;if(c=t,typeof t=="function")xu(t)&&(y=1);else if(typeof t=="string")y=tk(t,r,Tn.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case m:return ca(r.children,f,p,n);case h:y=8,f|=24;break;case g:return t=sn(12,r,n,f|2),t.elementType=g,t.lanes=p,t;case E:return t=sn(13,r,n,f),t.elementType=E,t.lanes=p,t;case _:return t=sn(19,r,n,f),t.elementType=_,t.lanes=p,t;case j:return Qp(r,f,p,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case v:case k:y=10;break e;case b:y=9;break e;case T:y=11;break e;case O:y=14;break e;case q:y=16,c=null;break e}y=29,r=Error(s(130,t===null?"null":typeof t,"")),c=null}return n=sn(y,r,n,f),n.elementType=t,n.type=c,n.lanes=p,n}function ca(t,n,r,c){return t=sn(7,t,c,n),t.lanes=r,t}function Qp(t,n,r,c){t=sn(22,t,c,n),t.elementType=j,t.lanes=r;var f={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var p=f._current;if(p===null)throw Error(s(456));if((f._pendingVisibility&2)===0){var y=di(p,2);y!==null&&(f._pendingVisibility|=2,Ot(y,p,2))}},attach:function(){var p=f._current;if(p===null)throw Error(s(456));if((f._pendingVisibility&2)!==0){var y=di(p,2);y!==null&&(f._pendingVisibility&=-3,Ot(y,p,2))}}};return t.stateNode=f,t}function Du(t,n,r){return t=sn(6,t,null,n),t.lanes=r,t}function Au(t,n,r){return n=sn(4,t.children!==null?t.children:[],t.key,n),n.lanes=r,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function Xn(t){t.flags|=4}function Xp(t,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Pg(n)){if(n=tn.current,n!==null&&((Re&4194176)===Re?En!==null:(Re&62914560)!==Re&&(Re&536870912)===0||n!==En))throw Fs=Ll,fm;t.flags|=8192}}function Io(t,n){n!==null&&(t.flags|=4),t.flags&16384&&(n=t.tag!==22?hh():536870912,t.lanes|=n,Ja|=n)}function or(t,n){if(!xe)switch(t.tailMode){case"hidden":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Ge(t){var n=t.alternate!==null&&t.alternate.child===t.child,r=0,c=0;if(n)for(var f=t.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags&31457280,c|=f.flags&31457280,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=r,n}function vT(t,n,r){var c=n.pendingProps;switch(Ml(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ge(n),null;case 1:return Ge(n),null;case 3:return r=n.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Gn(lt),Ca(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(zs(n)?Xn(n):t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,un!==null&&(Bu(un),un=null))),Ge(n),null;case 26:return r=n.memoizedState,t===null?(Xn(n),r!==null?(Ge(n),Xp(n,r)):(Ge(n),n.flags&=-16777217)):r?r!==t.memoizedState?(Xn(n),Ge(n),Xp(n,r)):(Ge(n),n.flags&=-16777217):(t.memoizedProps!==c&&Xn(n),Ge(n),n.flags&=-16777217),null;case 27:Xr(n),r=oi.current;var f=n.type;if(t!==null&&n.stateNode!=null)t.memoizedProps!==c&&Xn(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ge(n),null}t=Tn.current,zs(n)?um(n):(t=Rg(f,c,r),n.stateNode=t,Xn(n))}return Ge(n),null;case 5:if(Xr(n),r=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&Xn(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ge(n),null}if(t=Tn.current,zs(n))um(n);else{switch(f=Xo(oi.current),t){case 1:t=f.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:t=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":t=f.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":t=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":t=f.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof c.is=="string"?f.createElement("select",{is:c.is}):f.createElement("select"),c.multiple?t.multiple=!0:c.size&&(t.size=c.size);break;default:t=typeof c.is=="string"?f.createElement(r,{is:c.is}):f.createElement(r)}}t[kt]=n,t[Dt]=c;e:for(f=n.child;f!==null;){if(f.tag===5||f.tag===6)t.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}n.stateNode=t;e:switch(bt(t,r,c),r){case"button":case"input":case"select":case"textarea":t=!!c.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Xn(n)}}return Ge(n),n.flags&=-16777217,null;case 6:if(t&&n.stateNode!=null)t.memoizedProps!==c&&Xn(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(t=oi.current,zs(n)){if(t=n.stateNode,r=n.memoizedProps,c=null,f=wt,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[kt]=n,t=!!(t.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||bg(t.nodeValue,r)),t||Wi(n)}else t=Xo(t).createTextNode(c),t[kt]=n,n.stateNode=t}return Ge(n),null;case 13:if(c=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=zs(n),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(s(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(s(317));f[kt]=n}else qs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ge(n),f=!1}else un!==null&&(Bu(un),un=null),f=!0;if(!f)return n.flags&256?(qn(n),n):(qn(n),null)}if(qn(n),(n.flags&128)!==0)return n.lanes=r,n;if(r=c!==null,t=t!==null&&t.memoizedState!==null,r){c=n.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool);var p=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048)}return r!==t&&r&&(n.child.flags|=8192),Io(n,n.updateQueue),Ge(n),null;case 4:return Ca(),t===null&&Ju(n.stateNode.containerInfo),Ge(n),null;case 10:return Gn(n.type),Ge(n),null;case 19:if(it(ct),f=n.memoizedState,f===null)return Ge(n),null;if(c=(n.flags&128)!==0,p=f.rendering,p===null)if(c)or(f,!1);else{if(Xe!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(p=To(t),p!==null){for(n.flags|=128,or(f,!1),t=p.updateQueue,n.updateQueue=t,Io(n,t),n.subtreeFlags=0,t=r,r=n.child;r!==null;)Kp(r,t),r=r.sibling;return He(ct,ct.current&1|2),n.child}t=t.sibling}f.tail!==null&&kn()>Bo&&(n.flags|=128,c=!0,or(f,!1),n.lanes=4194304)}else{if(!c)if(t=To(p),t!==null){if(n.flags|=128,c=!0,t=t.updateQueue,n.updateQueue=t,Io(n,t),or(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!xe)return Ge(n),null}else 2*kn()-f.renderingStartTime>Bo&&r!==536870912&&(n.flags|=128,c=!0,or(f,!1),n.lanes=4194304);f.isBackwards?(p.sibling=n.child,n.child=p):(t=f.last,t!==null?t.sibling=p:n.child=p,f.last=p)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=kn(),n.sibling=null,t=ct.current,He(ct,c?t&1|2:t&1),n):(Ge(n),null);case 22:case 23:return qn(n),Il(),c=n.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(Ge(n),n.subtreeFlags&6&&(n.flags|=8192)):Ge(n),r=n.updateQueue,r!==null&&Io(n,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),t!==null&&it(ea),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Gn(lt),Ge(n),null;case 25:return null}throw Error(s(156,n.tag))}function yT(t,n){switch(Ml(n),n.tag){case 1:return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Gn(lt),Ca(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 26:case 27:case 5:return Xr(n),null;case 13:if(qn(n),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(s(340));qs()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return it(ct),null;case 4:return Ca(),null;case 10:return Gn(n.type),null;case 22:case 23:return qn(n),Il(),t!==null&&it(ea),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 24:return Gn(lt),null;case 25:return null;default:return null}}function Jp(t,n){switch(Ml(n),n.tag){case 3:Gn(lt),Ca();break;case 26:case 27:case 5:Xr(n);break;case 4:Ca();break;case 13:qn(n);break;case 19:it(ct);break;case 10:Gn(n.type);break;case 22:case 23:qn(n),Il(),t!==null&&it(ea);break;case 24:Gn(lt)}}var bT={getCacheForType:function(t){var n=Ct(lt),r=n.data.get(t);return r===void 0&&(r=t(),n.data.set(t,r)),r}},ST=typeof WeakMap=="function"?WeakMap:Map,Ye=0,ze=null,Te=null,Re=0,qe=0,Vt=null,Jn=!1,Xa=!1,Nu=!1,Zn=0,Xe=0,Ei=0,la=0,Pu=0,rn=0,Ja=0,cr=null,_n=null,Mu=!1,Uu=0,Bo=1/0,zo=null,Ri=null,qo=!1,ua=null,lr=0,Lu=0,ju=null,ur=0,Iu=null;function Ft(){if((Ye&2)!==0&&Re!==0)return Re&-Re;if(X.T!==null){var t=qa;return t!==0?t:Yu()}return vh()}function Zp(){rn===0&&(rn=(Re&536870912)===0||xe?fh():536870912);var t=tn.current;return t!==null&&(t.flags|=32),rn}function Ot(t,n,r){(t===ze&&qe===2||t.cancelPendingCommit!==null)&&(Za(t,0),Wn(t,Re,rn,!1)),Os(t,r),((Ye&2)===0||t!==ze)&&(t===ze&&((Ye&2)===0&&(la|=r),Xe===4&&Wn(t,Re,rn,!1)),wn(t))}function Wp(t,n,r){if((Ye&6)!==0)throw Error(s(327));var c=!r&&(n&60)===0&&(n&t.expiredLanes)===0||ws(t,n),f=c?CT(t,n):Hu(t,n,!0),p=c;do{if(f===0){Xa&&!c&&Wn(t,n,0,!1);break}else if(f===6)Wn(t,n,0,!Jn);else{if(r=t.current.alternate,p&&!TT(r)){f=Hu(t,n,!1),p=!1;continue}if(f===2){if(p=n,t.errorRecoveryDisabledLanes&p)var y=0;else y=t.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){n=y;e:{var S=t;f=cr;var R=S.current.memoizedState.isDehydrated;if(R&&(Za(S,y).flags|=256),y=Hu(S,y,!1),y!==2){if(Nu&&!R){S.errorRecoveryDisabledLanes|=p,la|=p,f=4;break e}p=_n,_n=f,p!==null&&Bu(p)}f=y}if(p=!1,f!==2)continue}}if(f===1){Za(t,0),Wn(t,n,0,!0);break}e:{switch(c=t,f){case 0:case 1:throw Error(s(345));case 4:if((n&4194176)===n){Wn(c,n,rn,!Jn);break e}break;case 2:_n=null;break;case 3:case 5:break;default:throw Error(s(329))}if(c.finishedWork=r,c.finishedLanes=n,(n&62914560)===n&&(p=Uu+300-kn(),10<p)){if(Wn(c,n,rn,!Jn),$r(c,0)!==0)break e;c.timeoutHandle=kg($p.bind(null,c,r,_n,zo,Mu,n,rn,la,Ja,Jn,2,-0,0),p);break e}$p(c,r,_n,zo,Mu,n,rn,la,Ja,Jn,0,-0,0)}}break}while(!0);wn(t)}function Bu(t){_n===null?_n=t:_n.push.apply(_n,t)}function $p(t,n,r,c,f,p,y,S,R,N,V,K,L){var H=n.subtreeFlags;if((H&8192||(H&16785408)===16785408)&&(gr={stylesheets:null,count:0,unsuspend:nk},Vp(n),n=ak(),n!==null)){t.cancelPendingCommit=n(rg.bind(null,t,r,c,f,y,S,R,1,K,L)),Wn(t,p,y,!N);return}rg(t,r,c,f,y,S,R,V,K,L)}function TT(t){for(var n=t;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var f=r[c],p=f.getSnapshot;f=f.value;try{if(!zt(p(),f))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Wn(t,n,r,c){n&=~Pu,n&=~la,t.suspendedLanes|=n,t.pingedLanes&=~n,c&&(t.warmLanes|=n),c=t.expirationTimes;for(var f=n;0<f;){var p=31-Bt(f),y=1<<p;c[p]=-1,f&=~y}r!==0&&mh(t,r,n)}function Ho(){return(Ye&6)===0?(dr(0),!1):!0}function zu(){if(Te!==null){if(qe===0)var t=Te.return;else t=Te,Fn=sa=null,Yl(t),Ba=null,Gs=0,t=Te;for(;t!==null;)Jp(t.alternate,t),t=t.return;Te=null}}function Za(t,n){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,zT(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),zu(),ze=t,Te=r=Ci(t.current,null),Re=n,qe=0,Vt=null,Jn=!1,Xa=ws(t,n),Nu=!1,Ja=rn=Pu=la=Ei=Xe=0,_n=cr=null,Mu=!1,(n&8)!==0&&(n|=n&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=n;0<c;){var f=31-Bt(c),p=1<<f;n|=t[f],c&=~p}return Zn=n,fo(),r}function eg(t,n){be=null,X.H=Rn,n===Vs?(n=pm(),qe=3):n===fm?(n=pm(),qe=4):qe=n===hp?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Vt=n,Te===null&&(Xe=1,No(t,Wt(n,t.current)))}function tg(){var t=X.H;return X.H=Rn,t===null?Rn:t}function ng(){var t=X.A;return X.A=bT,t}function qu(){Xe=4,Jn||(Re&4194176)!==Re&&tn.current!==null||(Xa=!0),(Ei&134217727)===0&&(la&134217727)===0||ze===null||Wn(ze,Re,rn,!1)}function Hu(t,n,r){var c=Ye;Ye|=2;var f=tg(),p=ng();(ze!==t||Re!==n)&&(zo=null,Za(t,n)),n=!1;var y=Xe;e:do try{if(qe!==0&&Te!==null){var S=Te,R=Vt;switch(qe){case 8:zu(),y=6;break e;case 3:case 2:case 6:tn.current===null&&(n=!0);var N=qe;if(qe=0,Vt=null,Wa(t,S,R,N),r&&Xa){y=0;break e}break;default:N=qe,qe=0,Vt=null,Wa(t,S,R,N)}}kT(),y=Xe;break}catch(V){eg(t,V)}while(!0);return n&&t.shellSuspendCounter++,Fn=sa=null,Ye=c,X.H=f,X.A=p,Te===null&&(ze=null,Re=0,fo()),y}function kT(){for(;Te!==null;)ig(Te)}function CT(t,n){var r=Ye;Ye|=2;var c=tg(),f=ng();ze!==t||Re!==n?(zo=null,Bo=kn()+500,Za(t,n)):Xa=ws(t,n);e:do try{if(qe!==0&&Te!==null){n=Te;var p=Vt;t:switch(qe){case 1:qe=0,Vt=null,Wa(t,n,p,1);break;case 2:if(hm(p)){qe=0,Vt=null,ag(n);break}n=function(){qe===2&&ze===t&&(qe=7),wn(t)},p.then(n,n);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:hm(p)?(qe=0,Vt=null,ag(n)):(qe=0,Vt=null,Wa(t,n,p,7));break;case 5:var y=null;switch(Te.tag){case 26:y=Te.memoizedState;case 5:case 27:var S=Te;if(!y||Pg(y)){qe=0,Vt=null;var R=S.sibling;if(R!==null)Te=R;else{var N=S.return;N!==null?(Te=N,Vo(N)):Te=null}break t}}qe=0,Vt=null,Wa(t,n,p,5);break;case 6:qe=0,Vt=null,Wa(t,n,p,6);break;case 8:zu(),Xe=6;break e;default:throw Error(s(462))}}ET();break}catch(V){eg(t,V)}while(!0);return Fn=sa=null,X.H=c,X.A=f,Ye=r,Te!==null?0:(ze=null,Re=0,fo(),Xe)}function ET(){for(;Te!==null&&!Yb();)ig(Te)}function ig(t){var n=Rp(t.alternate,t,Zn);t.memoizedProps=t.pendingProps,n===null?Vo(t):Te=n}function ag(t){var n=t,r=n.alternate;switch(n.tag){case 15:case 0:n=bp(r,n,n.pendingProps,n.type,void 0,Re);break;case 11:n=bp(r,n,n.pendingProps,n.type.render,n.ref,Re);break;case 5:Yl(n);default:Jp(r,n),n=Te=Kp(n,Zn),n=Rp(r,n,Zn)}t.memoizedProps=t.pendingProps,n===null?Vo(t):Te=n}function Wa(t,n,r,c){Fn=sa=null,Yl(n),Ba=null,Gs=0;var f=n.return;try{if(fT(t,f,n,r,Re)){Xe=1,No(t,Wt(r,t.current)),Te=null;return}}catch(p){if(f!==null)throw Te=f,p;Xe=1,No(t,Wt(r,t.current)),Te=null;return}n.flags&32768?(xe||c===1?t=!0:Xa||(Re&536870912)!==0?t=!1:(Jn=t=!0,(c===2||c===3||c===6)&&(c=tn.current,c!==null&&c.tag===13&&(c.flags|=16384))),sg(n,t)):Vo(n)}function Vo(t){var n=t;do{if((n.flags&32768)!==0){sg(n,Jn);return}t=n.return;var r=vT(n.alternate,n,Zn);if(r!==null){Te=r;return}if(n=n.sibling,n!==null){Te=n;return}Te=n=t}while(n!==null);Xe===0&&(Xe=5)}function sg(t,n){do{var r=yT(t.alternate,t);if(r!==null){r.flags&=32767,Te=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(t=t.sibling,t!==null)){Te=t;return}Te=t=r}while(t!==null);Xe=6,Te=null}function rg(t,n,r,c,f,p,y,S,R,N){var V=X.T,K=se.p;try{se.p=2,X.T=null,RT(t,n,r,c,K,f,p,y,S,R,N)}finally{X.T=V,se.p=K}}function RT(t,n,r,c,f,p,y,S){do $a();while(ua!==null);if((Ye&6)!==0)throw Error(s(327));var R=t.finishedWork;if(c=t.finishedLanes,R===null)return null;if(t.finishedWork=null,t.finishedLanes=0,R===t.current)throw Error(s(177));t.callbackNode=null,t.callbackPriority=0,t.cancelPendingCommit=null;var N=R.lanes|R.childLanes;if(N|=Al,iS(t,c,N,p,y,S),t===ze&&(Te=ze=null,Re=0),(R.subtreeFlags&10256)===0&&(R.flags&10256)===0||qo||(qo=!0,Lu=N,ju=r,xT(Jr,function(){return $a(),null})),r=(R.flags&15990)!==0,(R.subtreeFlags&15990)!==0||r?(r=X.T,X.T=null,p=se.p,se.p=2,y=Ye,Ye|=4,mT(t,R),zp(R,t),XS(ed,t.containerInfo),tc=!!$u,ed=$u=null,t.current=R,Lp(t,R.alternate,R),Kb(),Ye=y,se.p=p,X.T=r):t.current=R,qo?(qo=!1,ua=t,lr=c):og(t,N),N=t.pendingLanes,N===0&&(Ri=null),Wb(R.stateNode),wn(t),n!==null)for(f=t.onRecoverableError,R=0;R<n.length;R++)N=n[R],f(N.value,{componentStack:N.stack});return(lr&3)!==0&&$a(),N=t.pendingLanes,(c&4194218)!==0&&(N&42)!==0?t===Iu?ur++:(ur=0,Iu=t):ur=0,dr(0),null}function og(t,n){(t.pooledCacheLanes&=n)===0&&(n=t.pooledCache,n!=null&&(t.pooledCache=null,Ks(n)))}function $a(){if(ua!==null){var t=ua,n=Lu;Lu=0;var r=gh(lr),c=X.T,f=se.p;try{if(se.p=32>r?32:r,X.T=null,ua===null)var p=!1;else{r=ju,ju=null;var y=ua,S=lr;if(ua=null,lr=0,(Ye&6)!==0)throw Error(s(331));var R=Ye;if(Ye|=4,Gp(y.current),Hp(y,y.current,S,r),Ye=R,dr(0,!1),It&&typeof It.onPostCommitFiberRoot=="function")try{It.onPostCommitFiberRoot(_s,y)}catch{}p=!0}return p}finally{se.p=f,X.T=c,og(t,n)}}return!1}function cg(t,n,r){n=Wt(r,n),n=ru(t.stateNode,n,2),t=bi(t,n,2),t!==null&&(Os(t,2),wn(t))}function je(t,n,r){if(t.tag===3)cg(t,t,r);else for(;n!==null;){if(n.tag===3){cg(n,t,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ri===null||!Ri.has(c))){t=Wt(r,t),r=dp(2),c=bi(n,r,2),c!==null&&(fp(r,c,n,t),Os(c,2),wn(c));break}}n=n.return}}function Vu(t,n,r){var c=t.pingCache;if(c===null){c=t.pingCache=new ST;var f=new Set;c.set(n,f)}else f=c.get(n),f===void 0&&(f=new Set,c.set(n,f));f.has(r)||(Nu=!0,f.add(r),t=_T.bind(null,t,n,r),n.then(t,t))}function _T(t,n,r){var c=t.pingCache;c!==null&&c.delete(n),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,ze===t&&(Re&r)===r&&(Xe===4||Xe===3&&(Re&62914560)===Re&&300>kn()-Uu?(Ye&2)===0&&Za(t,0):Pu|=r,Ja===Re&&(Ja=0)),wn(t)}function lg(t,n){n===0&&(n=hh()),t=di(t,n),t!==null&&(Os(t,n),wn(t))}function wT(t){var n=t.memoizedState,r=0;n!==null&&(r=n.retryLane),lg(t,r)}function OT(t,n){var r=0;switch(t.tag){case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(r=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),lg(t,r)}function xT(t,n){return ol(t,n)}var Fo=null,es=null,Fu=!1,Go=!1,Gu=!1,da=0;function wn(t){t!==es&&t.next===null&&(es===null?Fo=es=t:es=es.next=t),Go=!0,Fu||(Fu=!0,AT(DT))}function dr(t,n){if(!Gu&&Go){Gu=!0;do for(var r=!1,c=Fo;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var p=0;else{var y=c.suspendedLanes,S=c.pingedLanes;p=(1<<31-Bt(42|t)+1)-1,p&=f&~(y&~S),p=p&201326677?p&201326677|1:p?p|2:0}p!==0&&(r=!0,fg(c,p))}else p=Re,p=$r(c,c===ze?p:0),(p&3)===0||ws(c,p)||(r=!0,fg(c,p));c=c.next}while(r);Gu=!1}}function DT(){Go=Fu=!1;var t=0;da!==0&&(BT()&&(t=da),da=0);for(var n=kn(),r=null,c=Fo;c!==null;){var f=c.next,p=ug(c,n);p===0?(c.next=null,r===null?Fo=f:r.next=f,f===null&&(es=r)):(r=c,(t!==0||(p&3)!==0)&&(Go=!0)),c=f}dr(t)}function ug(t,n){for(var r=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var y=31-Bt(p),S=1<<y,R=f[y];R===-1?((S&r)===0||(S&c)!==0)&&(f[y]=nS(S,n)):R<=n&&(t.expiredLanes|=S),p&=~S}if(n=ze,r=Re,r=$r(t,t===n?r:0),c=t.callbackNode,r===0||t===n&&qe===2||t.cancelPendingCommit!==null)return c!==null&&c!==null&&cl(c),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||ws(t,r)){if(n=r&-r,n===t.callbackPriority)return n;switch(c!==null&&cl(c),gh(r)){case 2:case 8:r=uh;break;case 32:r=Jr;break;case 268435456:r=dh;break;default:r=Jr}return c=dg.bind(null,t),r=ol(r,c),t.callbackPriority=n,t.callbackNode=r,n}return c!==null&&c!==null&&cl(c),t.callbackPriority=2,t.callbackNode=null,2}function dg(t,n){var r=t.callbackNode;if($a()&&t.callbackNode!==r)return null;var c=Re;return c=$r(t,t===ze?c:0),c===0?null:(Wp(t,c,n),ug(t,kn()),t.callbackNode!=null&&t.callbackNode===r?dg.bind(null,t):null)}function fg(t,n){if($a())return null;Wp(t,n,!0)}function AT(t){qT(function(){(Ye&6)!==0?ol(lh,t):t()})}function Yu(){return da===0&&(da=fh()),da}function hg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ao(""+t)}function mg(t,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,t.id&&r.setAttribute("form",t.id),n.parentNode.insertBefore(r,n),t=new FormData(t),r.parentNode.removeChild(r),t}function NT(t,n,r,c,f){if(n==="submit"&&r&&r.stateNode===f){var p=hg((f[Dt]||null).action),y=c.submitter;y&&(n=(n=y[Dt]||null)?hg(n.formAction):y.getAttribute("formAction"),n!==null&&(p=n,y=null));var S=new co("action","action",null,c,f);t.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(da!==0){var R=y?mg(f,y):new FormData(f);tu(r,{pending:!0,data:R,method:f.method,action:p},null,R)}}else typeof p=="function"&&(S.preventDefault(),R=y?mg(f,y):new FormData(f),tu(r,{pending:!0,data:R,method:f.method,action:p},p,R))},currentTarget:f}]})}}for(var Ku=0;Ku<rm.length;Ku++){var Qu=rm[Ku],PT=Qu.toLowerCase(),MT=Qu[0].toUpperCase()+Qu.slice(1);ln(PT,"on"+MT)}ln(tm,"onAnimationEnd"),ln(nm,"onAnimationIteration"),ln(im,"onAnimationStart"),ln("dblclick","onDoubleClick"),ln("focusin","onFocus"),ln("focusout","onBlur"),ln(ZS,"onTransitionRun"),ln(WS,"onTransitionStart"),ln($S,"onTransitionCancel"),ln(am,"onTransitionEnd"),wa("onMouseEnter",["mouseout","mouseover"]),wa("onMouseLeave",["mouseout","mouseover"]),wa("onPointerEnter",["pointerout","pointerover"]),wa("onPointerLeave",["pointerout","pointerover"]),Yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),UT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fr));function pg(t,n){n=(n&4)!==0;for(var r=0;r<t.length;r++){var c=t[r],f=c.event;c=c.listeners;e:{var p=void 0;if(n)for(var y=c.length-1;0<=y;y--){var S=c[y],R=S.instance,N=S.currentTarget;if(S=S.listener,R!==p&&f.isPropagationStopped())break e;p=S,f.currentTarget=N;try{p(f)}catch(V){Ao(V)}f.currentTarget=null,p=R}else for(y=0;y<c.length;y++){if(S=c[y],R=S.instance,N=S.currentTarget,S=S.listener,R!==p&&f.isPropagationStopped())break e;p=S,f.currentTarget=N;try{p(f)}catch(V){Ao(V)}f.currentTarget=null,p=R}}}}function ke(t,n){var r=n[ul];r===void 0&&(r=n[ul]=new Set);var c=t+"__bubble";r.has(c)||(gg(n,t,2,!1),r.add(c))}function Xu(t,n,r){var c=0;n&&(c|=4),gg(r,t,c,n)}var Yo="_reactListening"+Math.random().toString(36).slice(2);function Ju(t){if(!t[Yo]){t[Yo]=!0,bh.forEach(function(r){r!=="selectionchange"&&(UT.has(r)||Xu(r,!1,t),Xu(r,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[Yo]||(n[Yo]=!0,Xu("selectionchange",!1,n))}}function gg(t,n,r,c){switch(Bg(n)){case 2:var f=ok;break;case 8:f=ck;break;default:f=ld}r=f.bind(null,n,r,t),f=void 0,!yl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(n,r,{capture:!0,passive:f}):t.addEventListener(n,r,!0):f!==void 0?t.addEventListener(n,r,{passive:f}):t.addEventListener(n,r,!1)}function Zu(t,n,r,c,f){var p=c;if((n&1)===0&&(n&2)===0&&c!==null)e:for(;;){if(c===null)return;var y=c.tag;if(y===3||y===4){var S=c.stateNode.containerInfo;if(S===f||S.nodeType===8&&S.parentNode===f)break;if(y===4)for(y=c.return;y!==null;){var R=y.tag;if((R===3||R===4)&&(R=y.stateNode.containerInfo,R===f||R.nodeType===8&&R.parentNode===f))return;y=y.return}for(;S!==null;){if(y=Gi(S),y===null)return;if(R=y.tag,R===5||R===6||R===26||R===27){c=p=y;continue e}S=S.parentNode}}c=c.return}Ah(function(){var N=p,V=gl(r),K=[];e:{var L=sm.get(t);if(L!==void 0){var H=co,oe=t;switch(t){case"keypress":if(ro(r)===0)break e;case"keydown":case"keyup":H=OS;break;case"focusin":oe="focus",H=kl;break;case"focusout":oe="blur",H=kl;break;case"beforeblur":case"afterblur":H=kl;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":H=Mh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":H=gS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":H=AS;break;case tm:case nm:case im:H=bS;break;case am:H=PS;break;case"scroll":case"scrollend":H=mS;break;case"wheel":H=US;break;case"copy":case"cut":case"paste":H=TS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":H=Lh;break;case"toggle":case"beforetoggle":H=jS}var me=(n&4)!==0,Je=!me&&(t==="scroll"||t==="scrollend"),P=me?L!==null?L+"Capture":null:L;me=[];for(var A=N,U;A!==null;){var G=A;if(U=G.stateNode,G=G.tag,G!==5&&G!==26&&G!==27||U===null||P===null||(G=As(A,P),G!=null&&me.push(hr(A,G,U))),Je)break;A=A.return}0<me.length&&(L=new H(L,oe,null,r,V),K.push({event:L,listeners:me}))}}if((n&7)===0){e:{if(L=t==="mouseover"||t==="pointerover",H=t==="mouseout"||t==="pointerout",L&&r!==pl&&(oe=r.relatedTarget||r.fromElement)&&(Gi(oe)||oe[Ea]))break e;if((H||L)&&(L=V.window===V?V:(L=V.ownerDocument)?L.defaultView||L.parentWindow:window,H?(oe=r.relatedTarget||r.toElement,H=N,oe=oe?Gi(oe):null,oe!==null&&(Je=he(oe),me=oe.tag,oe!==Je||me!==5&&me!==27&&me!==6)&&(oe=null)):(H=null,oe=N),H!==oe)){if(me=Mh,G="onMouseLeave",P="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(me=Lh,G="onPointerLeave",P="onPointerEnter",A="pointer"),Je=H==null?L:Ds(H),U=oe==null?L:Ds(oe),L=new me(G,A+"leave",H,r,V),L.target=Je,L.relatedTarget=U,G=null,Gi(V)===N&&(me=new me(P,A+"enter",oe,r,V),me.target=U,me.relatedTarget=Je,G=me),Je=G,H&&oe)t:{for(me=H,P=oe,A=0,U=me;U;U=ts(U))A++;for(U=0,G=P;G;G=ts(G))U++;for(;0<A-U;)me=ts(me),A--;for(;0<U-A;)P=ts(P),U--;for(;A--;){if(me===P||P!==null&&me===P.alternate)break t;me=ts(me),P=ts(P)}me=null}else me=null;H!==null&&vg(K,L,H,me,!1),oe!==null&&Je!==null&&vg(K,Je,oe,me,!0)}}e:{if(L=N?Ds(N):window,H=L.nodeName&&L.nodeName.toLowerCase(),H==="select"||H==="input"&&L.type==="file")var re=Fh;else if(Hh(L))if(Gh)re=KS;else{re=GS;var Se=FS}else H=L.nodeName,!H||H.toLowerCase()!=="input"||L.type!=="checkbox"&&L.type!=="radio"?N&&ml(N.elementType)&&(re=Fh):re=YS;if(re&&(re=re(t,N))){Vh(K,re,r,V);break e}Se&&Se(t,L,N),t==="focusout"&&N&&L.type==="number"&&N.memoizedProps.value!=null&&hl(L,"number",L.value)}switch(Se=N?Ds(N):window,t){case"focusin":(Hh(Se)||Se.contentEditable==="true")&&(Pa=Se,Ol=N,Bs=null);break;case"focusout":Bs=Ol=Pa=null;break;case"mousedown":xl=!0;break;case"contextmenu":case"mouseup":case"dragend":xl=!1,$h(K,r,V);break;case"selectionchange":if(JS)break;case"keydown":case"keyup":$h(K,r,V)}var ce;if(El)e:{switch(t){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else Na?zh(t,r)&&(de="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(de="onCompositionStart");de&&(jh&&r.locale!=="ko"&&(Na||de!=="onCompositionStart"?de==="onCompositionEnd"&&Na&&(ce=Nh()):(ui=V,bl="value"in ui?ui.value:ui.textContent,Na=!0)),Se=Ko(N,de),0<Se.length&&(de=new Uh(de,t,null,r,V),K.push({event:de,listeners:Se}),ce?de.data=ce:(ce=qh(r),ce!==null&&(de.data=ce)))),(ce=BS?zS(t,r):qS(t,r))&&(de=Ko(N,"onBeforeInput"),0<de.length&&(Se=new Uh("onBeforeInput","beforeinput",null,r,V),K.push({event:Se,listeners:de}),Se.data=ce)),NT(K,t,N,r,V)}pg(K,n)})}function hr(t,n,r){return{instance:t,listener:n,currentTarget:r}}function Ko(t,n){for(var r=n+"Capture",c=[];t!==null;){var f=t,p=f.stateNode;f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=As(t,r),f!=null&&c.unshift(hr(t,f,p)),f=As(t,n),f!=null&&c.push(hr(t,f,p))),t=t.return}return c}function ts(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function vg(t,n,r,c,f){for(var p=n._reactName,y=[];r!==null&&r!==c;){var S=r,R=S.alternate,N=S.stateNode;if(S=S.tag,R!==null&&R===c)break;S!==5&&S!==26&&S!==27||N===null||(R=N,f?(N=As(r,p),N!=null&&y.unshift(hr(r,N,R))):f||(N=As(r,p),N!=null&&y.push(hr(r,N,R)))),r=r.return}y.length!==0&&t.push({event:n,listeners:y})}var LT=/\r\n?/g,jT=/\u0000|\uFFFD/g;function yg(t){return(typeof t=="string"?t:""+t).replace(LT,`
`).replace(jT,"")}function bg(t,n){return n=yg(n),yg(t)===n}function Qo(){}function Ue(t,n,r,c,f,p){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||xa(t,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&xa(t,""+c);break;case"className":to(t,"class",c);break;case"tabIndex":to(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":to(t,r,c);break;case"style":xh(t,c,p);break;case"data":if(n!=="object"){to(t,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){t.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=ao(""+c),t.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(n!=="input"&&Ue(t,n,"name",f.name,f,null),Ue(t,n,"formEncType",f.formEncType,f,null),Ue(t,n,"formMethod",f.formMethod,f,null),Ue(t,n,"formTarget",f.formTarget,f,null)):(Ue(t,n,"encType",f.encType,f,null),Ue(t,n,"method",f.method,f,null),Ue(t,n,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=ao(""+c),t.setAttribute(r,c);break;case"onClick":c!=null&&(t.onclick=Qo);break;case"onScroll":c!=null&&ke("scroll",t);break;case"onScrollEnd":c!=null&&ke("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}r=ao(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""+c):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":c===!0?t.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,c):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(r,c):t.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(r):t.setAttribute(r,c);break;case"popover":ke("beforetoggle",t),ke("toggle",t),eo(t,"popover",c);break;case"xlinkActuate":In(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":In(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":In(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":In(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":In(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":In(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":In(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":In(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":In(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":eo(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=fS.get(r)||r,eo(t,r,c))}}function Wu(t,n,r,c,f,p){switch(r){case"style":xh(t,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"children":typeof c=="string"?xa(t,c):(typeof c=="number"||typeof c=="bigint")&&xa(t,""+c);break;case"onScroll":c!=null&&ke("scroll",t);break;case"onScrollEnd":c!=null&&ke("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Qo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sh.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),n=r.slice(2,f?r.length-7:void 0),p=t[Dt]||null,p=p!=null?p[r]:null,typeof p=="function"&&t.removeEventListener(n,p,f),typeof c=="function")){typeof p!="function"&&p!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(n,c,f);break e}r in t?t[r]=c:c===!0?t.setAttribute(r,""):eo(t,r,c)}}}function bt(t,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ke("error",t),ke("load",t);var c=!1,f=!1,p;for(p in r)if(r.hasOwnProperty(p)){var y=r[p];if(y!=null)switch(p){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ue(t,n,p,y,r,null)}}f&&Ue(t,n,"srcSet",r.srcSet,r,null),c&&Ue(t,n,"src",r.src,r,null);return;case"input":ke("invalid",t);var S=p=y=f=null,R=null,N=null;for(c in r)if(r.hasOwnProperty(c)){var V=r[c];if(V!=null)switch(c){case"name":f=V;break;case"type":y=V;break;case"checked":R=V;break;case"defaultChecked":N=V;break;case"value":p=V;break;case"defaultValue":S=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:Ue(t,n,c,V,r,null)}}Rh(t,p,S,R,N,y,f,!1),no(t);return;case"select":ke("invalid",t),c=y=p=null;for(f in r)if(r.hasOwnProperty(f)&&(S=r[f],S!=null))switch(f){case"value":p=S;break;case"defaultValue":y=S;break;case"multiple":c=S;default:Ue(t,n,f,S,r,null)}n=p,r=y,t.multiple=!!c,n!=null?Oa(t,!!c,n,!1):r!=null&&Oa(t,!!c,r,!0);return;case"textarea":ke("invalid",t),p=f=c=null;for(y in r)if(r.hasOwnProperty(y)&&(S=r[y],S!=null))switch(y){case"value":c=S;break;case"defaultValue":f=S;break;case"children":p=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(s(91));break;default:Ue(t,n,y,S,r,null)}wh(t,c,f,p),no(t);return;case"option":for(R in r)if(r.hasOwnProperty(R)&&(c=r[R],c!=null))switch(R){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Ue(t,n,R,c,r,null)}return;case"dialog":ke("cancel",t),ke("close",t);break;case"iframe":case"object":ke("load",t);break;case"video":case"audio":for(c=0;c<fr.length;c++)ke(fr[c],t);break;case"image":ke("error",t),ke("load",t);break;case"details":ke("toggle",t);break;case"embed":case"source":case"link":ke("error",t),ke("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(N in r)if(r.hasOwnProperty(N)&&(c=r[N],c!=null))switch(N){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Ue(t,n,N,c,r,null)}return;default:if(ml(n)){for(V in r)r.hasOwnProperty(V)&&(c=r[V],c!==void 0&&Wu(t,n,V,c,r,void 0));return}}for(S in r)r.hasOwnProperty(S)&&(c=r[S],c!=null&&Ue(t,n,S,c,r,null))}function IT(t,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,y=null,S=null,R=null,N=null,V=null;for(H in r){var K=r[H];if(r.hasOwnProperty(H)&&K!=null)switch(H){case"checked":break;case"value":break;case"defaultValue":R=K;default:c.hasOwnProperty(H)||Ue(t,n,H,null,c,K)}}for(var L in c){var H=c[L];if(K=r[L],c.hasOwnProperty(L)&&(H!=null||K!=null))switch(L){case"type":p=H;break;case"name":f=H;break;case"checked":N=H;break;case"defaultChecked":V=H;break;case"value":y=H;break;case"defaultValue":S=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,n));break;default:H!==K&&Ue(t,n,L,H,c,K)}}fl(t,y,S,R,N,V,p,f);return;case"select":H=y=S=L=null;for(p in r)if(R=r[p],r.hasOwnProperty(p)&&R!=null)switch(p){case"value":break;case"multiple":H=R;default:c.hasOwnProperty(p)||Ue(t,n,p,null,c,R)}for(f in c)if(p=c[f],R=r[f],c.hasOwnProperty(f)&&(p!=null||R!=null))switch(f){case"value":L=p;break;case"defaultValue":S=p;break;case"multiple":y=p;default:p!==R&&Ue(t,n,f,p,c,R)}n=S,r=y,c=H,L!=null?Oa(t,!!r,L,!1):!!c!=!!r&&(n!=null?Oa(t,!!r,n,!0):Oa(t,!!r,r?[]:"",!1));return;case"textarea":H=L=null;for(S in r)if(f=r[S],r.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ue(t,n,S,null,c,f)}for(y in c)if(f=c[y],p=r[y],c.hasOwnProperty(y)&&(f!=null||p!=null))switch(y){case"value":L=f;break;case"defaultValue":H=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(s(91));break;default:f!==p&&Ue(t,n,y,f,c,p)}_h(t,L,H);return;case"option":for(var oe in r)if(L=r[oe],r.hasOwnProperty(oe)&&L!=null&&!c.hasOwnProperty(oe))switch(oe){case"selected":t.selected=!1;break;default:Ue(t,n,oe,null,c,L)}for(R in c)if(L=c[R],H=r[R],c.hasOwnProperty(R)&&L!==H&&(L!=null||H!=null))switch(R){case"selected":t.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:Ue(t,n,R,L,c,H)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var me in r)L=r[me],r.hasOwnProperty(me)&&L!=null&&!c.hasOwnProperty(me)&&Ue(t,n,me,null,c,L);for(N in c)if(L=c[N],H=r[N],c.hasOwnProperty(N)&&L!==H&&(L!=null||H!=null))switch(N){case"children":case"dangerouslySetInnerHTML":if(L!=null)throw Error(s(137,n));break;default:Ue(t,n,N,L,c,H)}return;default:if(ml(n)){for(var Je in r)L=r[Je],r.hasOwnProperty(Je)&&L!==void 0&&!c.hasOwnProperty(Je)&&Wu(t,n,Je,void 0,c,L);for(V in c)L=c[V],H=r[V],!c.hasOwnProperty(V)||L===H||L===void 0&&H===void 0||Wu(t,n,V,L,c,H);return}}for(var P in r)L=r[P],r.hasOwnProperty(P)&&L!=null&&!c.hasOwnProperty(P)&&Ue(t,n,P,null,c,L);for(K in c)L=c[K],H=r[K],!c.hasOwnProperty(K)||L===H||L==null&&H==null||Ue(t,n,K,L,c,H)}var $u=null,ed=null;function Xo(t){return t.nodeType===9?t:t.ownerDocument}function Sg(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tg(t,n){if(t===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&n==="foreignObject"?0:t}function td(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var nd=null;function BT(){var t=window.event;return t&&t.type==="popstate"?t===nd?!1:(nd=t,!0):(nd=null,!1)}var kg=typeof setTimeout=="function"?setTimeout:void 0,zT=typeof clearTimeout=="function"?clearTimeout:void 0,Cg=typeof Promise=="function"?Promise:void 0,qT=typeof queueMicrotask=="function"?queueMicrotask:typeof Cg<"u"?function(t){return Cg.resolve(null).then(t).catch(HT)}:kg;function HT(t){setTimeout(function(){throw t})}function id(t,n){var r=n,c=0;do{var f=r.nextSibling;if(t.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"){if(c===0){t.removeChild(f),Tr(n);return}c--}else r!=="$"&&r!=="$?"&&r!=="$!"||c++;r=f}while(r);Tr(n)}function ad(t){var n=t.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":ad(r),dl(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function VT(t,n,r,c){for(;t.nodeType===1;){var f=r;if(t.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[xs])switch(n){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==f.rel||t.getAttribute("href")!==(f.href==null?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(n==="input"&&t.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=fn(t.nextSibling),t===null)break}return null}function FT(t,n,r){if(n==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=fn(t.nextSibling),t===null))return null;return t}function fn(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return t}function Eg(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(n===0)return t;n--}else r==="/$"&&n++}t=t.previousSibling}return null}function Rg(t,n,r){switch(n=Xo(r),t){case"html":if(t=n.documentElement,!t)throw Error(s(452));return t;case"head":if(t=n.head,!t)throw Error(s(453));return t;case"body":if(t=n.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}var on=new Map,_g=new Set;function Jo(t){return typeof t.getRootNode=="function"?t.getRootNode():t.ownerDocument}var $n=se.d;se.d={f:GT,r:YT,D:KT,C:QT,L:XT,m:JT,X:WT,S:ZT,M:$T};function GT(){var t=$n.f(),n=Ho();return t||n}function YT(t){var n=Ra(t);n!==null&&n.tag===5&&n.type==="form"?$m(n):$n.r(t)}var ns=typeof document>"u"?null:document;function wg(t,n,r){var c=ns;if(c&&typeof n=="string"&&n){var f=Jt(n);f='link[rel="'+t+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),_g.has(f)||(_g.add(f),t={rel:t,crossOrigin:r,href:n},c.querySelector(f)===null&&(n=c.createElement("link"),bt(n,"link",t),ft(n),c.head.appendChild(n)))}}function KT(t){$n.D(t),wg("dns-prefetch",t,null)}function QT(t,n){$n.C(t,n),wg("preconnect",t,n)}function XT(t,n,r){$n.L(t,n,r);var c=ns;if(c&&t&&n){var f='link[rel="preload"][as="'+Jt(n)+'"]';n==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+Jt(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+Jt(r.imageSizes)+'"]')):f+='[href="'+Jt(t)+'"]';var p=f;switch(n){case"style":p=is(t);break;case"script":p=as(t)}on.has(p)||(t=ee({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:t,as:n},r),on.set(p,t),c.querySelector(f)!==null||n==="style"&&c.querySelector(mr(p))||n==="script"&&c.querySelector(pr(p))||(n=c.createElement("link"),bt(n,"link",t),ft(n),c.head.appendChild(n)))}}function JT(t,n){$n.m(t,n);var r=ns;if(r&&t){var c=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Jt(c)+'"][href="'+Jt(t)+'"]',p=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=as(t)}if(!on.has(p)&&(t=ee({rel:"modulepreload",href:t},n),on.set(p,t),r.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(pr(p)))return}c=r.createElement("link"),bt(c,"link",t),ft(c),r.head.appendChild(c)}}}function ZT(t,n,r){$n.S(t,n,r);var c=ns;if(c&&t){var f=_a(c).hoistableStyles,p=is(t);n=n||"default";var y=f.get(p);if(!y){var S={loading:0,preload:null};if(y=c.querySelector(mr(p)))S.loading=5;else{t=ee({rel:"stylesheet",href:t,"data-precedence":n},r),(r=on.get(p))&&sd(t,r);var R=y=c.createElement("link");ft(R),bt(R,"link",t),R._p=new Promise(function(N,V){R.onload=N,R.onerror=V}),R.addEventListener("load",function(){S.loading|=1}),R.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Zo(y,n,c)}y={type:"stylesheet",instance:y,count:1,state:S},f.set(p,y)}}}function WT(t,n){$n.X(t,n);var r=ns;if(r&&t){var c=_a(r).hoistableScripts,f=as(t),p=c.get(f);p||(p=r.querySelector(pr(f)),p||(t=ee({src:t,async:!0},n),(n=on.get(f))&&rd(t,n),p=r.createElement("script"),ft(p),bt(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function $T(t,n){$n.M(t,n);var r=ns;if(r&&t){var c=_a(r).hoistableScripts,f=as(t),p=c.get(f);p||(p=r.querySelector(pr(f)),p||(t=ee({src:t,async:!0,type:"module"},n),(n=on.get(f))&&rd(t,n),p=r.createElement("script"),ft(p),bt(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function Og(t,n,r,c){var f=(f=oi.current)?Jo(f):null;if(!f)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=is(r.href),r=_a(f).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=is(r.href);var p=_a(f).hoistableStyles,y=p.get(t);if(y||(f=f.ownerDocument||f,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,y),(p=f.querySelector(mr(t)))&&!p._p&&(y.instance=p,y.state.loading=5),on.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},on.set(t,r),p||ek(f,t,r,y.state))),n&&c===null)throw Error(s(528,""));return y}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=as(r),r=_a(f).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function is(t){return'href="'+Jt(t)+'"'}function mr(t){return'link[rel="stylesheet"]['+t+"]"}function xg(t){return ee({},t,{"data-precedence":t.precedence,precedence:null})}function ek(t,n,r,c){t.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=t.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),bt(n,"link",r),ft(n),t.head.appendChild(n))}function as(t){return'[src="'+Jt(t)+'"]'}function pr(t){return"script[async]"+t}function Dg(t,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=t.querySelector('style[data-href~="'+Jt(r.href)+'"]');if(c)return n.instance=c,ft(c),c;var f=ee({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),ft(c),bt(c,"style",f),Zo(c,r.precedence,t),n.instance=c;case"stylesheet":f=is(r.href);var p=t.querySelector(mr(f));if(p)return n.state.loading|=4,n.instance=p,ft(p),p;c=xg(r),(f=on.get(f))&&sd(c,f),p=(t.ownerDocument||t).createElement("link"),ft(p);var y=p;return y._p=new Promise(function(S,R){y.onload=S,y.onerror=R}),bt(p,"link",c),n.state.loading|=4,Zo(p,r.precedence,t),n.instance=p;case"script":return p=as(r.src),(f=t.querySelector(pr(p)))?(n.instance=f,ft(f),f):(c=r,(f=on.get(p))&&(c=ee({},r),rd(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),ft(f),bt(f,"link",c),t.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,Zo(c,r.precedence,t));return n.instance}function Zo(t,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,p=f,y=0;y<c.length;y++){var S=c[y];if(S.dataset.precedence===n)p=S;else if(p!==f)break}p?p.parentNode.insertBefore(t,p.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(t,n.firstChild))}function sd(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.title==null&&(t.title=n.title)}function rd(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.integrity==null&&(t.integrity=n.integrity)}var Wo=null;function Ag(t,n,r){if(Wo===null){var c=new Map,f=Wo=new Map;f.set(r,c)}else f=Wo,c=f.get(r),c||(c=new Map,f.set(r,c));if(c.has(t))return c;for(c.set(t,null),r=r.getElementsByTagName(t),f=0;f<r.length;f++){var p=r[f];if(!(p[xs]||p[kt]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var y=p.getAttribute(n)||"";y=t+y;var S=c.get(y);S?S.push(p):c.set(y,[p])}}return c}function Ng(t,n,r){t=t.ownerDocument||t,t.head.insertBefore(r,n==="title"?t.querySelector("head > title"):null)}function tk(t,n,r){if(r===1||n.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return t=n.disabled,typeof n.precedence=="string"&&t==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Pg(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}var gr=null;function nk(){}function ik(t,n,r){if(gr===null)throw Error(s(475));var c=gr;if(n.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var f=is(r.href),p=t.querySelector(mr(f));if(p){t=p._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(c.count++,c=$o.bind(c),t.then(c,c)),n.state.loading|=4,n.instance=p,ft(p);return}p=t.ownerDocument||t,r=xg(r),(f=on.get(f))&&sd(r,f),p=p.createElement("link"),ft(p);var y=p;y._p=new Promise(function(S,R){y.onload=S,y.onerror=R}),bt(p,"link",r),n.instance=p}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(c.count++,n=$o.bind(c),t.addEventListener("load",n),t.addEventListener("error",n))}}function ak(){if(gr===null)throw Error(s(475));var t=gr;return t.stylesheets&&t.count===0&&od(t,t.stylesheets),0<t.count?function(n){var r=setTimeout(function(){if(t.stylesheets&&od(t,t.stylesheets),t.unsuspend){var c=t.unsuspend;t.unsuspend=null,c()}},6e4);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(r)}}:null}function $o(){if(this.count--,this.count===0){if(this.stylesheets)od(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ec=null;function od(t,n){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ec=new Map,n.forEach(sk,t),ec=null,$o.call(t))}function sk(t,n){if(!(n.state.loading&4)){var r=ec.get(t);if(r)var c=r.get(null);else{r=new Map,ec.set(t,r);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var y=f[p];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(r.set(y.dataset.precedence,y),c=y)}c&&r.set(null,c)}f=n.instance,y=f.getAttribute("data-precedence"),p=r.get(y)||c,p===c&&r.set(null,f),r.set(y,f),this.count++,c=$o.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),p?p.parentNode.insertBefore(f,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),n.state.loading|=4}}var vr={$$typeof:k,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function rk(t,n,r,c,f,p,y,S){this.tag=1,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ll(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ll(0),this.hiddenUpdates=ll(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function Mg(t,n,r,c,f,p,y,S,R,N,V,K){return t=new rk(t,n,r,y,S,R,N,K),n=1,p===!0&&(n|=24),p=sn(3,null,null,n),t.current=p,p.stateNode=t,n=Bl(),n.refCount++,t.pooledCache=n,n.refCount++,p.memoizedState={element:c,isDehydrated:r,cache:n},bu(p),t}function Ug(t){return t?(t=La,t):La}function Lg(t,n,r,c,f,p){f=Ug(f),c.context===null?c.context=f:c.pendingContext=f,c=yi(n),c.payload={element:r},p=p===void 0?null:p,p!==null&&(c.callback=p),r=bi(t,c,n),r!==null&&(Ot(r,t,n),er(r,t,n))}function jg(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<n?r:n}}function cd(t,n){jg(t,n),(t=t.alternate)&&jg(t,n)}function Ig(t){if(t.tag===13){var n=di(t,67108864);n!==null&&Ot(n,t,67108864),cd(t,67108864)}}var tc=!0;function ok(t,n,r,c){var f=X.T;X.T=null;var p=se.p;try{se.p=2,ld(t,n,r,c)}finally{se.p=p,X.T=f}}function ck(t,n,r,c){var f=X.T;X.T=null;var p=se.p;try{se.p=8,ld(t,n,r,c)}finally{se.p=p,X.T=f}}function ld(t,n,r,c){if(tc){var f=ud(c);if(f===null)Zu(t,n,c,nc,r),zg(t,c);else if(uk(f,t,n,r,c))c.stopPropagation();else if(zg(t,c),n&4&&-1<lk.indexOf(t)){for(;f!==null;){var p=Ra(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var y=Fi(p.pendingLanes);if(y!==0){var S=p;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var R=1<<31-Bt(y);S.entanglements[1]|=R,y&=~R}wn(p),(Ye&6)===0&&(Bo=kn()+500,dr(0))}}break;case 13:S=di(p,2),S!==null&&Ot(S,p,2),Ho(),cd(p,2)}if(p=ud(c),p===null&&Zu(t,n,c,nc,r),p===f)break;f=p}f!==null&&c.stopPropagation()}else Zu(t,n,c,null,r)}}function ud(t){return t=gl(t),dd(t)}var nc=null;function dd(t){if(nc=null,t=Gi(t),t!==null){var n=he(t);if(n===null)t=null;else{var r=n.tag;if(r===13){if(t=Be(n),t!==null)return t;t=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null)}}return nc=t,null}function Bg(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qb()){case lh:return 2;case uh:return 8;case Jr:case Xb:return 32;case dh:return 268435456;default:return 32}default:return 32}}var fd=!1,_i=null,wi=null,Oi=null,yr=new Map,br=new Map,xi=[],lk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zg(t,n){switch(t){case"focusin":case"focusout":_i=null;break;case"dragenter":case"dragleave":wi=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":yr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":br.delete(n.pointerId)}}function Sr(t,n,r,c,f,p){return t===null||t.nativeEvent!==p?(t={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:p,targetContainers:[f]},n!==null&&(n=Ra(n),n!==null&&Ig(n)),t):(t.eventSystemFlags|=c,n=t.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),t)}function uk(t,n,r,c,f){switch(n){case"focusin":return _i=Sr(_i,t,n,r,c,f),!0;case"dragenter":return wi=Sr(wi,t,n,r,c,f),!0;case"mouseover":return Oi=Sr(Oi,t,n,r,c,f),!0;case"pointerover":var p=f.pointerId;return yr.set(p,Sr(yr.get(p)||null,t,n,r,c,f)),!0;case"gotpointercapture":return p=f.pointerId,br.set(p,Sr(br.get(p)||null,t,n,r,c,f)),!0}return!1}function qg(t){var n=Gi(t.target);if(n!==null){var r=he(n);if(r!==null){if(n=r.tag,n===13){if(n=Be(r),n!==null){t.blockedOn=n,aS(t.priority,function(){if(r.tag===13){var c=Ft(),f=di(r,c);f!==null&&Ot(f,r,c),cd(r,c)}});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ic(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var r=ud(t.nativeEvent);if(r===null){r=t.nativeEvent;var c=new r.constructor(r.type,r);pl=c,r.target.dispatchEvent(c),pl=null}else return n=Ra(r),n!==null&&Ig(n),t.blockedOn=r,!1;n.shift()}return!0}function Hg(t,n,r){ic(t)&&r.delete(n)}function dk(){fd=!1,_i!==null&&ic(_i)&&(_i=null),wi!==null&&ic(wi)&&(wi=null),Oi!==null&&ic(Oi)&&(Oi=null),yr.forEach(Hg),br.forEach(Hg)}function ac(t,n){t.blockedOn===n&&(t.blockedOn=null,fd||(fd=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,dk)))}var sc=null;function Vg(t){sc!==t&&(sc=t,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){sc===t&&(sc=null);for(var n=0;n<t.length;n+=3){var r=t[n],c=t[n+1],f=t[n+2];if(typeof c!="function"){if(dd(c||r)===null)continue;break}var p=Ra(r);p!==null&&(t.splice(n,3),n-=3,tu(p,{pending:!0,data:f,method:r.method,action:c},c,f))}}))}function Tr(t){function n(R){return ac(R,t)}_i!==null&&ac(_i,t),wi!==null&&ac(wi,t),Oi!==null&&ac(Oi,t),yr.forEach(n),br.forEach(n);for(var r=0;r<xi.length;r++){var c=xi[r];c.blockedOn===t&&(c.blockedOn=null)}for(;0<xi.length&&(r=xi[0],r.blockedOn===null);)qg(r),r.blockedOn===null&&xi.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var f=r[c],p=r[c+1],y=f[Dt]||null;if(typeof p=="function")y||Vg(r);else if(y){var S=null;if(p&&p.hasAttribute("formAction")){if(f=p,y=p[Dt]||null)S=y.formAction;else if(dd(f)!==null)continue}else S=y.action;typeof S=="function"?r[c+1]=S:(r.splice(c,3),c-=3),Vg(r)}}}function hd(t){this._internalRoot=t}rc.prototype.render=hd.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=Ft();Lg(r,c,t,n,null,null)},rc.prototype.unmount=hd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;t.tag===0&&$a(),Lg(t.current,2,null,t,null,null),Ho(),n[Ea]=null}};function rc(t){this._internalRoot=t}rc.prototype.unstable_scheduleHydration=function(t){if(t){var n=vh();t={blockedOn:null,target:t,priority:n};for(var r=0;r<xi.length&&n!==0&&n<xi[r].priority;r++);xi.splice(r,0,t),r===0&&qg(t)}};var Fg=e.version;if(Fg!=="19.0.0")throw Error(s(527,Fg,"19.0.0"));se.findDOMNode=function(t){var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=J(n),t=t!==null?fe(t):null,t=t===null?null:t.stateNode,t};var fk={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:X,findFiberByHostInstance:Gi,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{_s=oc.inject(fk),It=oc}catch{}}return Cr.createRoot=function(t,n){if(!o(t))throw Error(s(299));var r=!1,c="",f=op,p=cp,y=lp,S=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(y=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(S=n.unstable_transitionCallbacks)),n=Mg(t,1,!1,null,null,r,c,f,p,y,S,null),t[Ea]=n.current,Ju(t.nodeType===8?t.parentNode:t),new hd(n)},Cr.hydrateRoot=function(t,n,r){if(!o(t))throw Error(s(299));var c=!1,f="",p=op,y=cp,S=lp,R=null,N=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(R=r.unstable_transitionCallbacks),r.formState!==void 0&&(N=r.formState)),n=Mg(t,1,!0,n,r??null,c,f,p,y,S,R,N),n.context=Ug(null),r=n.current,c=Ft(),f=yi(c),f.callback=null,bi(r,f,c),n.current.lanes=c,Os(n,c),wn(n),t[Ea]=n.current,Ju(t),new rc(n)},Cr.version="19.0.0",Cr}var ev;function Ek(){if(ev)return gd.exports;ev=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),gd.exports=Ck(),gd.exports}var Rk=Ek(),Er={},tv;function _k(){if(tv)return Er;tv=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.parse=u,Er.serialize=h;const a=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,l=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function u(b,k){const T=new l,E=b.length;if(E<2)return T;const _=(k==null?void 0:k.decode)||g;let O=0;do{const q=b.indexOf("=",O);if(q===-1)break;const j=b.indexOf(";",O),M=j===-1?E:j;if(q>M){O=b.lastIndexOf(";",q-1)+1;continue}const x=d(b,O,q),F=m(b,q,x),W=b.slice(x,F);if(T[W]===void 0){let ae=d(b,q+1,M),X=m(b,M,ae);const ee=_(b.slice(ae,X));T[W]=ee}O=M+1}while(O<E);return T}function d(b,k,T){do{const E=b.charCodeAt(k);if(E!==32&&E!==9)return k}while(++k<T);return T}function m(b,k,T){for(;k>T;){const E=b.charCodeAt(--k);if(E!==32&&E!==9)return k+1}return T}function h(b,k,T){const E=(T==null?void 0:T.encode)||encodeURIComponent;if(!a.test(b))throw new TypeError(`argument name is invalid: ${b}`);const _=E(k);if(!e.test(_))throw new TypeError(`argument val is invalid: ${k}`);let O=b+"="+_;if(!T)return O;if(T.maxAge!==void 0){if(!Number.isInteger(T.maxAge))throw new TypeError(`option maxAge is invalid: ${T.maxAge}`);O+="; Max-Age="+T.maxAge}if(T.domain){if(!i.test(T.domain))throw new TypeError(`option domain is invalid: ${T.domain}`);O+="; Domain="+T.domain}if(T.path){if(!s.test(T.path))throw new TypeError(`option path is invalid: ${T.path}`);O+="; Path="+T.path}if(T.expires){if(!v(T.expires)||!Number.isFinite(T.expires.valueOf()))throw new TypeError(`option expires is invalid: ${T.expires}`);O+="; Expires="+T.expires.toUTCString()}if(T.httpOnly&&(O+="; HttpOnly"),T.secure&&(O+="; Secure"),T.partitioned&&(O+="; Partitioned"),T.priority)switch(typeof T.priority=="string"?T.priority.toLowerCase():void 0){case"low":O+="; Priority=Low";break;case"medium":O+="; Priority=Medium";break;case"high":O+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${T.priority}`)}if(T.sameSite)switch(typeof T.sameSite=="string"?T.sameSite.toLowerCase():T.sameSite){case!0:case"strict":O+="; SameSite=Strict";break;case"lax":O+="; SameSite=Lax";break;case"none":O+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${T.sameSite}`)}return O}function g(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function v(b){return o.call(b)==="[object Date]"}return Er}_k();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var nv="popstate";function wk(a={}){function e(s,o){let{pathname:l,search:u,hash:d}=s.location;return Vd("",{pathname:l,search:u,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function i(s,o){return typeof o=="string"?o:jr(o)}return xk(e,i,null,a)}function Ke(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function Nn(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ok(){return Math.random().toString(36).substring(2,10)}function iv(a,e){return{usr:a.state,key:a.key,idx:e}}function Vd(a,e,i=null,s){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?Ss(e):e,state:i,key:e&&e.key||s||Ok()}}function jr({pathname:a="/",search:e="",hash:i=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(a+=i.charAt(0)==="#"?i:"#"+i),a}function Ss(a){let e={};if(a){let i=a.indexOf("#");i>=0&&(e.hash=a.substring(i),a=a.substring(0,i));let s=a.indexOf("?");s>=0&&(e.search=a.substring(s),a=a.substring(0,s)),a&&(e.pathname=a)}return e}function xk(a,e,i,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,u=o.history,d="POP",m=null,h=g();h==null&&(h=0,u.replaceState({...u.state,idx:h},""));function g(){return(u.state||{idx:null}).idx}function v(){d="POP";let _=g(),O=_==null?null:_-h;h=_,m&&m({action:d,location:E.location,delta:O})}function b(_,O){d="PUSH";let q=Vd(E.location,_,O);h=g()+1;let j=iv(q,h),M=E.createHref(q);try{u.pushState(j,"",M)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;o.location.assign(M)}l&&m&&m({action:d,location:E.location,delta:1})}function k(_,O){d="REPLACE";let q=Vd(E.location,_,O);h=g();let j=iv(q,h),M=E.createHref(q);u.replaceState(j,"",M),l&&m&&m({action:d,location:E.location,delta:0})}function T(_){let O=o.location.origin!=="null"?o.location.origin:o.location.href,q=typeof _=="string"?_:jr(_);return q=q.replace(/ $/,"%20"),Ke(O,`No window.location.(origin|href) available to create URL for href: ${q}`),new URL(q,O)}let E={get action(){return d},get location(){return a(o,u)},listen(_){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(nv,v),m=_,()=>{o.removeEventListener(nv,v),m=null}},createHref(_){return e(o,_)},createURL:T,encodeLocation(_){let O=T(_);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:b,replace:k,go(_){return u.go(_)}};return E}function Ty(a,e,i="/"){return Dk(a,e,i,!1)}function Dk(a,e,i,s){let o=typeof e=="string"?Ss(e):e,l=ii(o.pathname||"/",i);if(l==null)return null;let u=ky(a);Ak(u);let d=null;for(let m=0;d==null&&m<u.length;++m){let h=Hk(l);d=zk(u[m],h,s)}return d}function ky(a,e=[],i=[],s=""){let o=(l,u,d)=>{let m={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};m.relativePath.startsWith("/")&&(Ke(m.relativePath.startsWith(s),`Absolute route path "${m.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(s.length));let h=ni([s,m.relativePath]),g=i.concat(m);l.children&&l.children.length>0&&(Ke(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),ky(l.children,e,g,h)),!(l.path==null&&!l.index)&&e.push({path:h,score:Ik(h,l.index),routesMeta:g})};return a.forEach((l,u)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))o(l,u);else for(let m of Cy(l.path))o(l,u,m)}),e}function Cy(a){let e=a.split("/");if(e.length===0)return[];let[i,...s]=e,o=i.endsWith("?"),l=i.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let u=Cy(s.join("/")),d=[];return d.push(...u.map(m=>m===""?l:[l,m].join("/"))),o&&d.push(...u),d.map(m=>a.startsWith("/")&&m===""?"/":m)}function Ak(a){a.sort((e,i)=>e.score!==i.score?i.score-e.score:Bk(e.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var Nk=/^:[\w-]+$/,Pk=3,Mk=2,Uk=1,Lk=10,jk=-2,av=a=>a==="*";function Ik(a,e){let i=a.split("/"),s=i.length;return i.some(av)&&(s+=jk),e&&(s+=Mk),i.filter(o=>!av(o)).reduce((o,l)=>o+(Nk.test(l)?Pk:l===""?Uk:Lk),s)}function Bk(a,e){return a.length===e.length&&a.slice(0,-1).every((s,o)=>s===e[o])?a[a.length-1]-e[e.length-1]:0}function zk(a,e,i=!1){let{routesMeta:s}=a,o={},l="/",u=[];for(let d=0;d<s.length;++d){let m=s[d],h=d===s.length-1,g=l==="/"?e:e.slice(l.length)||"/",v=Pc({path:m.relativePath,caseSensitive:m.caseSensitive,end:h},g),b=m.route;if(!v&&h&&i&&!s[s.length-1].route.index&&(v=Pc({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},g)),!v)return null;Object.assign(o,v.params),u.push({params:o,pathname:ni([l,v.pathname]),pathnameBase:Yk(ni([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=ni([l,v.pathnameBase]))}return u}function Pc(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[i,s]=qk(a.path,a.caseSensitive,a.end),o=e.match(i);if(!o)return null;let l=o[0],u=l.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((h,{paramName:g,isOptional:v},b)=>{if(g==="*"){let T=d[b]||"";u=l.slice(0,l.length-T.length).replace(/(.)\/+$/,"$1")}const k=d[b];return v&&!k?h[g]=void 0:h[g]=(k||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:u,pattern:a}}function qk(a,e=!1,i=!0){Nn(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let s=[],o="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,m)=>(s.push({paramName:d,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return a.endsWith("*")?(s.push({paramName:"*"}),o+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?o+="\\/*$":a!==""&&a!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function Hk(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nn(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function ii(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,s=a.charAt(i);return s&&s!=="/"?null:a.slice(i)||"/"}function Vk(a,e="/"){let{pathname:i,search:s="",hash:o=""}=typeof a=="string"?Ss(a):a;return{pathname:i?i.startsWith("/")?i:Fk(i,e):e,search:Kk(s),hash:Qk(o)}}function Fk(a,e){let i=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(o=>{o===".."?i.length>1&&i.pop():o!=="."&&i.push(o)}),i.length>1?i.join("/"):"/"}function Sd(a,e,i,s){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Gk(a){return a.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function Ey(a){let e=Gk(a);return e.map((i,s)=>s===e.length-1?i.pathname:i.pathnameBase)}function Ry(a,e,i,s=!1){let o;typeof a=="string"?o=Ss(a):(o={...a},Ke(!o.pathname||!o.pathname.includes("?"),Sd("?","pathname","search",o)),Ke(!o.pathname||!o.pathname.includes("#"),Sd("#","pathname","hash",o)),Ke(!o.search||!o.search.includes("#"),Sd("#","search","hash",o)));let l=a===""||o.pathname==="",u=l?"/":o.pathname,d;if(u==null)d=i;else{let v=e.length-1;if(!s&&u.startsWith("..")){let b=u.split("/");for(;b[0]==="..";)b.shift(),v-=1;o.pathname=b.join("/")}d=v>=0?e[v]:"/"}let m=Vk(o,d),h=u&&u!=="/"&&u.endsWith("/"),g=(l||u===".")&&i.endsWith("/");return!m.pathname.endsWith("/")&&(h||g)&&(m.pathname+="/"),m}var ni=a=>a.join("/").replace(/\/\/+/g,"/"),Yk=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),Kk=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,Qk=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function Xk(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}var _y=["POST","PUT","PATCH","DELETE"];new Set(_y);var Jk=["GET",..._y];new Set(Jk);var Ts=z.createContext(null);Ts.displayName="DataRouter";var Gc=z.createContext(null);Gc.displayName="DataRouterState";var wy=z.createContext({isTransitioning:!1});wy.displayName="ViewTransition";var Zk=z.createContext(new Map);Zk.displayName="Fetchers";var Wk=z.createContext(null);Wk.displayName="Await";var Un=z.createContext(null);Un.displayName="Navigation";var Hr=z.createContext(null);Hr.displayName="Location";var ri=z.createContext({outlet:null,matches:[],isDataRoute:!1});ri.displayName="Route";var Uf=z.createContext(null);Uf.displayName="RouteError";function $k(a,{relative:e}={}){Ke(Vr(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=z.useContext(Un),{hash:o,pathname:l,search:u}=Fr(a,{relative:e}),d=l;return i!=="/"&&(d=l==="/"?i:ni([i,l])),s.createHref({pathname:d,search:u,hash:o})}function Vr(){return z.useContext(Hr)!=null}function Ta(){return Ke(Vr(),"useLocation() may be used only in the context of a <Router> component."),z.useContext(Hr).location}var Oy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function xy(a){z.useContext(Un).static||z.useLayoutEffect(a)}function eC(){let{isDataRoute:a}=z.useContext(ri);return a?hC():tC()}function tC(){Ke(Vr(),"useNavigate() may be used only in the context of a <Router> component.");let a=z.useContext(Ts),{basename:e,navigator:i}=z.useContext(Un),{matches:s}=z.useContext(ri),{pathname:o}=Ta(),l=JSON.stringify(Ey(s)),u=z.useRef(!1);return xy(()=>{u.current=!0}),z.useCallback((m,h={})=>{if(Nn(u.current,Oy),!u.current)return;if(typeof m=="number"){i.go(m);return}let g=Ry(m,JSON.parse(l),o,h.relative==="path");a==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:ni([e,g.pathname])),(h.replace?i.replace:i.push)(g,h.state,h)},[e,i,l,o,a])}z.createContext(null);function Fr(a,{relative:e}={}){let{matches:i}=z.useContext(ri),{pathname:s}=Ta(),o=JSON.stringify(Ey(i));return z.useMemo(()=>Ry(a,JSON.parse(o),s,e==="path"),[a,o,s,e])}function nC(a,e){return Dy(a,e)}function Dy(a,e,i,s){var q;Ke(Vr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o,static:l}=z.useContext(Un),{matches:u}=z.useContext(ri),d=u[u.length-1],m=d?d.params:{},h=d?d.pathname:"/",g=d?d.pathnameBase:"/",v=d&&d.route;{let j=v&&v.path||"";Ay(h,!v||j.endsWith("*")||j.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${j}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${j}"> to <Route path="${j==="/"?"*":`${j}/*`}">.`)}let b=Ta(),k;if(e){let j=typeof e=="string"?Ss(e):e;Ke(g==="/"||((q=j.pathname)==null?void 0:q.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${j.pathname}" was given in the \`location\` prop.`),k=j}else k=b;let T=k.pathname||"/",E=T;if(g!=="/"){let j=g.replace(/^\//,"").split("/");E="/"+T.replace(/^\//,"").split("/").slice(j.length).join("/")}let _=!l&&i&&i.matches&&i.matches.length>0?i.matches:Ty(a,{pathname:E});Nn(v||_!=null,`No routes matched location "${k.pathname}${k.search}${k.hash}" `),Nn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${k.pathname}${k.search}${k.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let O=oC(_&&_.map(j=>Object.assign({},j,{params:Object.assign({},m,j.params),pathname:ni([g,o.encodeLocation?o.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?g:ni([g,o.encodeLocation?o.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),u,i,s);return e&&O?z.createElement(Hr.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...k},navigationType:"POP"}},O):O}function iC(){let a=fC(),e=Xk(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),i=a instanceof Error?a.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",a),u=z.createElement(z.Fragment,null,z.createElement("p",null,"💿 Hey developer 👋"),z.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",z.createElement("code",{style:l},"ErrorBoundary")," or"," ",z.createElement("code",{style:l},"errorElement")," prop on your route.")),z.createElement(z.Fragment,null,z.createElement("h2",null,"Unexpected Application Error!"),z.createElement("h3",{style:{fontStyle:"italic"}},e),i?z.createElement("pre",{style:o},i):null,u)}var aC=z.createElement(iC,null),sC=class extends z.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){console.error("React Router caught the following error during render",a,e)}render(){return this.state.error!==void 0?z.createElement(ri.Provider,{value:this.props.routeContext},z.createElement(Uf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function rC({routeContext:a,match:e,children:i}){let s=z.useContext(Ts);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),z.createElement(ri.Provider,{value:a},i)}function oC(a,e=[],i=null,s=null){if(a==null){if(!i)return null;if(i.errors)a=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)a=i.matches;else return null}let o=a,l=i==null?void 0:i.errors;if(l!=null){let m=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);Ke(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,d=-1;if(i)for(let m=0;m<o.length;m++){let h=o[m];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=m),h.route.id){let{loaderData:g,errors:v}=i,b=h.route.loader&&!g.hasOwnProperty(h.route.id)&&(!v||v[h.route.id]===void 0);if(h.route.lazy||b){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((m,h,g)=>{let v,b=!1,k=null,T=null;i&&(v=l&&h.route.id?l[h.route.id]:void 0,k=h.route.errorElement||aC,u&&(d<0&&g===0?(Ay("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,T=null):d===g&&(b=!0,T=h.route.hydrateFallbackElement||null)));let E=e.concat(o.slice(0,g+1)),_=()=>{let O;return v?O=k:b?O=T:h.route.Component?O=z.createElement(h.route.Component,null):h.route.element?O=h.route.element:O=m,z.createElement(rC,{match:h,routeContext:{outlet:m,matches:E,isDataRoute:i!=null},children:O})};return i&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?z.createElement(sC,{location:i.location,revalidation:i.revalidation,component:k,error:v,children:_(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):_()},null)}function Lf(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cC(a){let e=z.useContext(Ts);return Ke(e,Lf(a)),e}function lC(a){let e=z.useContext(Gc);return Ke(e,Lf(a)),e}function uC(a){let e=z.useContext(ri);return Ke(e,Lf(a)),e}function jf(a){let e=uC(a),i=e.matches[e.matches.length-1];return Ke(i.route.id,`${a} can only be used on routes that contain a unique "id"`),i.route.id}function dC(){return jf("useRouteId")}function fC(){var s;let a=z.useContext(Uf),e=lC("useRouteError"),i=jf("useRouteError");return a!==void 0?a:(s=e.errors)==null?void 0:s[i]}function hC(){let{router:a}=cC("useNavigate"),e=jf("useNavigate"),i=z.useRef(!1);return xy(()=>{i.current=!0}),z.useCallback(async(o,l={})=>{Nn(i.current,Oy),i.current&&(typeof o=="number"?a.navigate(o):await a.navigate(o,{fromRouteId:e,...l}))},[a,e])}var sv={};function Ay(a,e,i){!e&&!sv[a]&&(sv[a]=!0,Nn(!1,i))}z.memo(mC);function mC({routes:a,future:e,state:i}){return Dy(a,void 0,i,e)}function Fd(a){Ke(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function pC({basename:a="/",children:e=null,location:i,navigationType:s="POP",navigator:o,static:l=!1}){Ke(!Vr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=a.replace(/^\/*/,"/"),d=z.useMemo(()=>({basename:u,navigator:o,static:l,future:{}}),[u,o,l]);typeof i=="string"&&(i=Ss(i));let{pathname:m="/",search:h="",hash:g="",state:v=null,key:b="default"}=i,k=z.useMemo(()=>{let T=ii(m,u);return T==null?null:{location:{pathname:T,search:h,hash:g,state:v,key:b},navigationType:s}},[u,m,h,g,v,b,s]);return Nn(k!=null,`<Router basename="${u}"> is not able to match the URL "${m}${h}${g}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:z.createElement(Un.Provider,{value:d},z.createElement(Hr.Provider,{children:e,value:k}))}function gC({children:a,location:e}){return nC(Gd(a),e)}function Gd(a,e=[]){let i=[];return z.Children.forEach(a,(s,o)=>{if(!z.isValidElement(s))return;let l=[...e,o];if(s.type===z.Fragment){i.push.apply(i,Gd(s.props.children,l));return}Ke(s.type===Fd,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ke(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=Gd(s.props.children,l)),i.push(u)}),i}var hc="get",mc="application/x-www-form-urlencoded";function Yc(a){return a!=null&&typeof a.tagName=="string"}function vC(a){return Yc(a)&&a.tagName.toLowerCase()==="button"}function yC(a){return Yc(a)&&a.tagName.toLowerCase()==="form"}function bC(a){return Yc(a)&&a.tagName.toLowerCase()==="input"}function SC(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function TC(a,e){return a.button===0&&(!e||e==="_self")&&!SC(a)}var cc=null;function kC(){if(cc===null)try{new FormData(document.createElement("form"),0),cc=!1}catch{cc=!0}return cc}var CC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Td(a){return a!=null&&!CC.has(a)?(Nn(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${mc}"`),null):a}function EC(a,e){let i,s,o,l,u;if(yC(a)){let d=a.getAttribute("action");s=d?ii(d,e):null,i=a.getAttribute("method")||hc,o=Td(a.getAttribute("enctype"))||mc,l=new FormData(a)}else if(vC(a)||bC(a)&&(a.type==="submit"||a.type==="image")){let d=a.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=a.getAttribute("formaction")||d.getAttribute("action");if(s=m?ii(m,e):null,i=a.getAttribute("formmethod")||d.getAttribute("method")||hc,o=Td(a.getAttribute("formenctype"))||Td(d.getAttribute("enctype"))||mc,l=new FormData(d,a),!kC()){let{name:h,type:g,value:v}=a;if(g==="image"){let b=h?`${h}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else h&&l.append(h,v)}}else{if(Yc(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=hc,s=null,o=mc,u=a}return l&&o==="text/plain"&&(u=l,l=void 0),{action:s,method:i.toLowerCase(),encType:o,formData:l,body:u}}function If(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}async function RC(a,e){if(a.id in e)return e[a.id];try{let i=await import(a.module);return e[a.id]=i,i}catch(i){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function _C(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function wC(a,e,i){let s=await Promise.all(a.map(async o=>{let l=e.routes[o.route.id];if(l){let u=await RC(l,i);return u.links?u.links():[]}return[]}));return AC(s.flat(1).filter(_C).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function rv(a,e,i,s,o,l){let u=(m,h)=>i[h]?m.route.id!==i[h].route.id:!0,d=(m,h)=>{var g;return i[h].pathname!==m.pathname||((g=i[h].route.path)==null?void 0:g.endsWith("*"))&&i[h].params["*"]!==m.params["*"]};return l==="assets"?e.filter((m,h)=>u(m,h)||d(m,h)):l==="data"?e.filter((m,h)=>{var v;let g=s.routes[m.route.id];if(!g||!g.hasLoader)return!1;if(u(m,h)||d(m,h))return!0;if(m.route.shouldRevalidate){let b=m.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((v=i[0])==null?void 0:v.params)||{},nextUrl:new URL(a,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function OC(a,e,{includeHydrateFallback:i}={}){return xC(a.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),i&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function xC(a){return[...new Set(a)]}function DC(a){let e={},i=Object.keys(a).sort();for(let s of i)e[s]=a[s];return e}function AC(a,e){let i=new Set;return new Set(e),a.reduce((s,o)=>{let l=JSON.stringify(DC(o));return i.has(l)||(i.add(l),s.push({key:l,link:o})),s},[])}function NC(a,e){let i=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return i.pathname==="/"?i.pathname="_root.data":e&&ii(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.data`:i.pathname=`${i.pathname.replace(/\/$/,"")}.data`,i}function Ny(){let a=z.useContext(Ts);return If(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function PC(){let a=z.useContext(Gc);return If(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var Bf=z.createContext(void 0);Bf.displayName="FrameworkContext";function Py(){let a=z.useContext(Bf);return If(a,"You must render this element inside a <HydratedRouter> element"),a}function MC(a,e){let i=z.useContext(Bf),[s,o]=z.useState(!1),[l,u]=z.useState(!1),{onFocus:d,onBlur:m,onMouseEnter:h,onMouseLeave:g,onTouchStart:v}=e,b=z.useRef(null);z.useEffect(()=>{if(a==="render"&&u(!0),a==="viewport"){let E=O=>{O.forEach(q=>{u(q.isIntersecting)})},_=new IntersectionObserver(E,{threshold:.5});return b.current&&_.observe(b.current),()=>{_.disconnect()}}},[a]),z.useEffect(()=>{if(s){let E=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(E)}}},[s]);let k=()=>{o(!0)},T=()=>{o(!1),u(!1)};return i?a!=="intent"?[l,b,{}]:[l,b,{onFocus:Rr(d,k),onBlur:Rr(m,T),onMouseEnter:Rr(h,k),onMouseLeave:Rr(g,T),onTouchStart:Rr(v,k)}]:[!1,b,{}]}function Rr(a,e){return i=>{a&&a(i),i.defaultPrevented||e(i)}}function UC({page:a,...e}){let{router:i}=Ny(),s=z.useMemo(()=>Ty(i.routes,a,i.basename),[i.routes,a,i.basename]);return s?z.createElement(jC,{page:a,matches:s,...e}):null}function LC(a){let{manifest:e,routeModules:i}=Py(),[s,o]=z.useState([]);return z.useEffect(()=>{let l=!1;return wC(a,e,i).then(u=>{l||o(u)}),()=>{l=!0}},[a,e,i]),s}function jC({page:a,matches:e,...i}){let s=Ta(),{manifest:o,routeModules:l}=Py(),{basename:u}=Ny(),{loaderData:d,matches:m}=PC(),h=z.useMemo(()=>rv(a,e,m,o,s,"data"),[a,e,m,o,s]),g=z.useMemo(()=>rv(a,e,m,o,s,"assets"),[a,e,m,o,s]),v=z.useMemo(()=>{if(a===s.pathname+s.search+s.hash)return[];let T=new Set,E=!1;if(e.forEach(O=>{var j;let q=o.routes[O.route.id];!q||!q.hasLoader||(!h.some(M=>M.route.id===O.route.id)&&O.route.id in d&&((j=l[O.route.id])!=null&&j.shouldRevalidate)||q.hasClientLoader?E=!0:T.add(O.route.id))}),T.size===0)return[];let _=NC(a,u);return E&&T.size>0&&_.searchParams.set("_routes",e.filter(O=>T.has(O.route.id)).map(O=>O.route.id).join(",")),[_.pathname+_.search]},[u,d,s,o,h,e,a,l]),b=z.useMemo(()=>OC(g,o),[g,o]),k=LC(g);return z.createElement(z.Fragment,null,v.map(T=>z.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...i})),b.map(T=>z.createElement("link",{key:T,rel:"modulepreload",href:T,...i})),k.map(({key:T,link:E})=>z.createElement("link",{key:T,...E})))}function IC(...a){return e=>{a.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var My=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{My&&(window.__reactRouterVersion="7.4.0")}catch{}function BC({basename:a,children:e,window:i}){let s=z.useRef();s.current==null&&(s.current=wk({window:i,v5Compat:!0}));let o=s.current,[l,u]=z.useState({action:o.action,location:o.location}),d=z.useCallback(m=>{z.startTransition(()=>u(m))},[u]);return z.useLayoutEffect(()=>o.listen(d),[o,d]),z.createElement(pC,{basename:a,children:e,location:l.location,navigationType:l.action,navigator:o})}var Uy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gt=z.forwardRef(function({onClick:e,discover:i="render",prefetch:s="none",relative:o,reloadDocument:l,replace:u,state:d,target:m,to:h,preventScrollReset:g,viewTransition:v,...b},k){let{basename:T}=z.useContext(Un),E=typeof h=="string"&&Uy.test(h),_,O=!1;if(typeof h=="string"&&E&&(_=h,My))try{let X=new URL(window.location.href),ee=h.startsWith("//")?new URL(X.protocol+h):new URL(h),le=ii(ee.pathname,T);ee.origin===X.origin&&le!=null?h=le+ee.search+ee.hash:O=!0}catch{Nn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let q=$k(h,{relative:o}),[j,M,x]=MC(s,b),F=VC(h,{replace:u,state:d,target:m,preventScrollReset:g,relative:o,viewTransition:v});function W(X){e&&e(X),X.defaultPrevented||F(X)}let ae=z.createElement("a",{...b,...x,href:_||q,onClick:O||l?e:W,ref:IC(k,M),target:m,"data-discover":!E&&i==="render"?"true":void 0});return j&&!E?z.createElement(z.Fragment,null,ae,z.createElement(UC,{page:q})):ae});Gt.displayName="Link";var zC=z.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:u,viewTransition:d,children:m,...h},g){let v=Fr(u,{relative:h.relative}),b=Ta(),k=z.useContext(Gc),{navigator:T,basename:E}=z.useContext(Un),_=k!=null&&QC(v)&&d===!0,O=T.encodeLocation?T.encodeLocation(v).pathname:v.pathname,q=b.pathname,j=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;i||(q=q.toLowerCase(),j=j?j.toLowerCase():null,O=O.toLowerCase()),j&&E&&(j=ii(j,E)||j);const M=O!=="/"&&O.endsWith("/")?O.length-1:O.length;let x=q===O||!o&&q.startsWith(O)&&q.charAt(M)==="/",F=j!=null&&(j===O||!o&&j.startsWith(O)&&j.charAt(O.length)==="/"),W={isActive:x,isPending:F,isTransitioning:_},ae=x?e:void 0,X;typeof s=="function"?X=s(W):X=[s,x?"active":null,F?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let ee=typeof l=="function"?l(W):l;return z.createElement(Gt,{...h,"aria-current":ae,className:X,ref:g,style:ee,to:u,viewTransition:d},typeof m=="function"?m(W):m)});zC.displayName="NavLink";var qC=z.forwardRef(({discover:a="render",fetcherKey:e,navigate:i,reloadDocument:s,replace:o,state:l,method:u=hc,action:d,onSubmit:m,relative:h,preventScrollReset:g,viewTransition:v,...b},k)=>{let T=YC(),E=KC(d,{relative:h}),_=u.toLowerCase()==="get"?"get":"post",O=typeof d=="string"&&Uy.test(d),q=j=>{if(m&&m(j),j.defaultPrevented)return;j.preventDefault();let M=j.nativeEvent.submitter,x=(M==null?void 0:M.getAttribute("formmethod"))||u;T(M||j.currentTarget,{fetcherKey:e,method:x,navigate:i,replace:o,state:l,relative:h,preventScrollReset:g,viewTransition:v})};return z.createElement("form",{ref:k,method:_,action:E,onSubmit:s?m:q,...b,"data-discover":!O&&a==="render"?"true":void 0})});qC.displayName="Form";function HC(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ly(a){let e=z.useContext(Ts);return Ke(e,HC(a)),e}function VC(a,{target:e,replace:i,state:s,preventScrollReset:o,relative:l,viewTransition:u}={}){let d=eC(),m=Ta(),h=Fr(a,{relative:l});return z.useCallback(g=>{if(TC(g,e)){g.preventDefault();let v=i!==void 0?i:jr(m)===jr(h);d(a,{replace:v,state:s,preventScrollReset:o,relative:l,viewTransition:u})}},[m,d,h,i,s,e,a,o,l,u])}var FC=0,GC=()=>`__${String(++FC)}__`;function YC(){let{router:a}=Ly("useSubmit"),{basename:e}=z.useContext(Un),i=dC();return z.useCallback(async(s,o={})=>{let{action:l,method:u,encType:d,formData:m,body:h}=EC(s,e);if(o.navigate===!1){let g=o.fetcherKey||GC();await a.fetch(g,i,o.action||l,{preventScrollReset:o.preventScrollReset,formData:m,body:h,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await a.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:m,body:h,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:i,flushSync:o.flushSync,viewTransition:o.viewTransition})},[a,e,i])}function KC(a,{relative:e}={}){let{basename:i}=z.useContext(Un),s=z.useContext(ri);Ke(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...Fr(a||".",{relative:e})},u=Ta();if(a==null){l.search=u.search;let d=new URLSearchParams(l.search),m=d.getAll("index");if(m.some(g=>g==="")){d.delete("index"),m.filter(v=>v).forEach(v=>d.append("index",v));let g=d.toString();l.search=g?`?${g}`:""}}return(!a||a===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(l.pathname=l.pathname==="/"?i:ni([i,l.pathname])),jr(l)}function QC(a,e={}){let i=z.useContext(wy);Ke(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Ly("useViewTransitionState"),o=Fr(a,{relative:e.relative});if(!i.isTransitioning)return!1;let l=ii(i.currentLocation.pathname,s)||i.currentLocation.pathname,u=ii(i.nextLocation.pathname,s)||i.nextLocation.pathname;return Pc(o.pathname,u)!=null||Pc(o.pathname,l)!=null}new TextEncoder;function Yd({isHomePage:a=!1}){return C.jsx("header",{className:"header",children:C.jsxs("div",{className:"container",children:[C.jsx("div",{className:"logo",children:C.jsx(Gt,{to:"/",children:C.jsx("h1",{children:"FlashSale"})})}),C.jsx("nav",{className:"nav",children:C.jsxs("ul",{children:[a?C.jsxs(C.Fragment,{children:[C.jsx("li",{children:C.jsx("a",{href:"#features",children:"기능"})}),C.jsx("li",{children:C.jsx("a",{href:"#pricing",children:"요금제"})}),C.jsx("li",{children:C.jsx("a",{href:"#faq",children:"FAQ"})})]}):C.jsx("li",{children:C.jsx(Gt,{to:"/",children:"홈으로"})}),C.jsx("li",{children:C.jsx(Gt,{to:"/live",className:"btn btn-primary",children:"라이브 방송"})})]})})]})})}function Kd({simplified:a=!1}){return C.jsx("footer",{className:"footer",children:C.jsxs("div",{className:"container",children:[C.jsxs("div",{className:"footer-content",children:[C.jsxs("div",{className:"footer-logo",children:[C.jsx("h3",{children:"FlashSale"}),C.jsx("p",{children:"한시적 특가 세일로 매출을 극대화하는 가장 쉬운 방법"})]}),!a&&C.jsxs("div",{className:"footer-links",children:[C.jsxs("div",{className:"footer-links-column",children:[C.jsx("h4",{children:"제품"}),C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Gt,{to:"/#features",children:"기능"})}),C.jsx("li",{children:C.jsx(Gt,{to:"/#pricing",children:"요금제"})}),C.jsx("li",{children:C.jsx(Gt,{to:"/#faq",children:"FAQ"})})]})]}),C.jsxs("div",{className:"footer-links-column",children:[C.jsx("h4",{children:"회사"}),C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"소개"})}),C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"블로그"})}),C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"채용"})})]})]}),C.jsxs("div",{className:"footer-links-column",children:[C.jsx("h4",{children:"법률"}),C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"이용약관"})}),C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"개인정보처리방침"})})]})]})]})]}),C.jsxs("div",{className:"footer-bottom",children:[C.jsx("p",{children:"© 2025 FlashSale. All rights reserved."}),!a&&C.jsxs("div",{className:"social-links",children:[C.jsx("a",{href:"#","aria-label":"Facebook",children:C.jsx("span",{children:"Facebook"})}),C.jsx("a",{href:"#","aria-label":"Twitter",children:C.jsx("span",{children:"Twitter"})}),C.jsx("a",{href:"#","aria-label":"Instagram",children:C.jsx("span",{children:"Instagram"})}),C.jsx("a",{href:"#","aria-label":"LinkedIn",children:C.jsx("span",{children:"LinkedIn"})})]})]})]})})}function XC(){const[a,e]=z.useState(""),i=s=>{s.preventDefault(),alert(`${a}로 신청되었습니다.`),e("")};return C.jsxs("div",{className:"app",children:[C.jsx(Yd,{isHomePage:!0}),C.jsx("section",{className:"hero",children:C.jsx("div",{className:"container",children:C.jsxs("div",{className:"hero-content",children:[C.jsxs("h2",{className:"hero-title",children:["단 하루만",C.jsx("br",{}),"특별한 할인 혜택을 제공합니다"]}),C.jsx("p",{className:"hero-description",children:"FlashSale을 통해 한정된 시간 동안 최고의 할인 혜택을 제공하고 매출을 극대화하세요."}),C.jsxs("form",{className:"signup-form",onSubmit:i,children:[C.jsx("input",{type:"email",placeholder:"이메일을 입력하세요",value:a,onChange:s=>e(s.target.value),required:!0}),C.jsx("button",{type:"submit",className:"btn btn-primary",children:"무료로 시작하기"})]}),C.jsx("p",{className:"form-note",children:"* 14일 무료 체험 후 구독이 필요합니다"})]})})}),C.jsx("section",{id:"features",className:"features",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"주요 기능"}),C.jsxs("div",{className:"features-grid",children:[C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"🚀"}),C.jsx("h3",{children:"빠른 할인 설정"}),C.jsx("p",{children:"몇 번의 클릭만으로 시간 제한 특가 세일을 설정할 수 있습니다."})]}),C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"📊"}),C.jsx("h3",{children:"실시간 매출 분석"}),C.jsx("p",{children:"할인 캠페인 효과를 실시간으로 분석하여 최적의 판매 전략을 수립할 수 있습니다."})]}),C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"🔒"}),C.jsx("h3",{children:"안전한 보안"}),C.jsx("p",{children:"모든 데이터는 암호화되어 안전하게 보호됩니다."})]}),C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"⏱️"}),C.jsx("h3",{children:"카운트다운 타이머"}),C.jsx("p",{children:"긴급성을 높이는 카운트다운 타이머로 고객의 구매 결정을 앞당길 수 있습니다."})]})]})]})}),C.jsx("section",{id:"pricing",className:"pricing",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"플랜 선택"}),C.jsxs("div",{className:"pricing-cards",children:[C.jsxs("div",{className:"pricing-card",children:[C.jsx("h3",{children:"스타터"}),C.jsxs("div",{className:"price",children:["₩29,000",C.jsx("span",{children:"/월"})]}),C.jsxs("ul",{className:"pricing-features",children:[C.jsx("li",{children:"✓ 기본 기능 접근"}),C.jsx("li",{children:"✓ 월 500회 연결"}),C.jsx("li",{children:"✓ 이메일 지원"}),C.jsx("li",{children:"✓ 기본 분석"})]}),C.jsx("button",{className:"btn btn-outline",children:"시작하기"})]}),C.jsxs("div",{className:"pricing-card featured",children:[C.jsx("div",{className:"featured-tag",children:"인기"}),C.jsx("h3",{children:"프로"}),C.jsxs("div",{className:"price",children:["₩79,000",C.jsx("span",{children:"/월"})]}),C.jsxs("ul",{className:"pricing-features",children:[C.jsx("li",{children:"✓ 모든 기본 기능"}),C.jsx("li",{children:"✓ 무제한 연결"}),C.jsx("li",{children:"✓ 우선 지원"}),C.jsx("li",{children:"✓ 고급 분석"}),C.jsx("li",{children:"✓ API 접근"})]}),C.jsx("button",{className:"btn btn-primary",children:"시작하기"})]}),C.jsxs("div",{className:"pricing-card",children:[C.jsx("h3",{children:"엔터프라이즈"}),C.jsx("div",{className:"price",children:"문의"}),C.jsxs("ul",{className:"pricing-features",children:[C.jsx("li",{children:"✓ 모든 프로 기능"}),C.jsx("li",{children:"✓ 전용 매니저"}),C.jsx("li",{children:"✓ 맞춤형 기능"}),C.jsx("li",{children:"✓ 온보딩 지원"}),C.jsx("li",{children:"✓ SLA 보장"})]}),C.jsx("button",{className:"btn btn-outline",children:"문의하기"})]})]})]})}),C.jsx("section",{id:"faq",className:"faq",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"자주 묻는 질문"}),C.jsxs("div",{className:"faq-list",children:[C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"FlashSale은 어떤 서비스인가요?"}),C.jsx("p",{children:"FlashSale은 비즈니스가 한시적인 특별 할인을 쉽게 제공할 수 있는 플랫폼입니다. 몇 번의 클릭만으로 긴급 세일 이벤트를 시작할 수 있습니다."})]}),C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"무료 체험은 어떻게 이용하나요?"}),C.jsx("p",{children:"회원가입 후 14일 동안 모든 기능을 무료로 이용할 수 있습니다. 별도의 결제 정보 없이도 시작할 수 있습니다."})]}),C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"구독을 취소할 수 있나요?"}),C.jsx("p",{children:"네, 언제든지 구독을 취소할 수 있습니다. 취소 시 다음 결제일까지 서비스를 이용할 수 있습니다."})]}),C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"기술적 지원은 어떻게 받을 수 있나요?"}),C.jsx("p",{children:"이메일 또는 실시간 채팅을 통해 언제든지 기술 지원팀에 문의할 수 있습니다. 프로 및 엔터프라이즈 요금제는 우선 지원을 받습니다."})]})]})]})}),C.jsx("section",{id:"contact",className:"contact",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"문의하기"}),C.jsx("p",{className:"contact-description",children:"더 자세한 정보가 필요하시거나 질문이 있으신가요? 언제든지 연락주세요."}),C.jsx("div",{className:"contact-form-container",children:C.jsxs("form",{className:"contact-form",children:[C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"이름",required:!0})}),C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"email",placeholder:"이메일",required:!0})}),C.jsx("div",{className:"form-group",children:C.jsx("textarea",{placeholder:"메시지",rows:5,required:!0})}),C.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:"보내기"})]})})]})}),C.jsx(Kd,{})]})}function jy(a,e){return function(){return a.apply(e,arguments)}}const{toString:JC}=Object.prototype,{getPrototypeOf:zf}=Object,Kc=(a=>e=>{const i=JC.call(e);return a[i]||(a[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),Sn=a=>(a=a.toLowerCase(),e=>Kc(e)===a),Qc=a=>e=>typeof e===a,{isArray:ks}=Array,Ir=Qc("undefined");function ZC(a){return a!==null&&!Ir(a)&&a.constructor!==null&&!Ir(a.constructor)&&Qt(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const Iy=Sn("ArrayBuffer");function WC(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&Iy(a.buffer),e}const $C=Qc("string"),Qt=Qc("function"),By=Qc("number"),Xc=a=>a!==null&&typeof a=="object",eE=a=>a===!0||a===!1,pc=a=>{if(Kc(a)!=="object")return!1;const e=zf(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},tE=Sn("Date"),nE=Sn("File"),iE=Sn("Blob"),aE=Sn("FileList"),sE=a=>Xc(a)&&Qt(a.pipe),rE=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||Qt(a.append)&&((e=Kc(a))==="formdata"||e==="object"&&Qt(a.toString)&&a.toString()==="[object FormData]"))},oE=Sn("URLSearchParams"),[cE,lE,uE,dE]=["ReadableStream","Request","Response","Headers"].map(Sn),fE=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gr(a,e,{allOwnKeys:i=!1}={}){if(a===null||typeof a>"u")return;let s,o;if(typeof a!="object"&&(a=[a]),ks(a))for(s=0,o=a.length;s<o;s++)e.call(null,a[s],s,a);else{const l=i?Object.getOwnPropertyNames(a):Object.keys(a),u=l.length;let d;for(s=0;s<u;s++)d=l[s],e.call(null,a[d],d,a)}}function zy(a,e){e=e.toLowerCase();const i=Object.keys(a);let s=i.length,o;for(;s-- >0;)if(o=i[s],e===o.toLowerCase())return o;return null}const pa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,qy=a=>!Ir(a)&&a!==pa;function Qd(){const{caseless:a}=qy(this)&&this||{},e={},i=(s,o)=>{const l=a&&zy(e,o)||o;pc(e[l])&&pc(s)?e[l]=Qd(e[l],s):pc(s)?e[l]=Qd({},s):ks(s)?e[l]=s.slice():e[l]=s};for(let s=0,o=arguments.length;s<o;s++)arguments[s]&&Gr(arguments[s],i);return e}const hE=(a,e,i,{allOwnKeys:s}={})=>(Gr(e,(o,l)=>{i&&Qt(o)?a[l]=jy(o,i):a[l]=o},{allOwnKeys:s}),a),mE=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),pE=(a,e,i,s)=>{a.prototype=Object.create(e.prototype,s),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),i&&Object.assign(a.prototype,i)},gE=(a,e,i,s)=>{let o,l,u;const d={};if(e=e||{},a==null)return e;do{for(o=Object.getOwnPropertyNames(a),l=o.length;l-- >0;)u=o[l],(!s||s(u,a,e))&&!d[u]&&(e[u]=a[u],d[u]=!0);a=i!==!1&&zf(a)}while(a&&(!i||i(a,e))&&a!==Object.prototype);return e},vE=(a,e,i)=>{a=String(a),(i===void 0||i>a.length)&&(i=a.length),i-=e.length;const s=a.indexOf(e,i);return s!==-1&&s===i},yE=a=>{if(!a)return null;if(ks(a))return a;let e=a.length;if(!By(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=a[e];return i},bE=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&zf(Uint8Array)),SE=(a,e)=>{const s=(a&&a[Symbol.iterator]).call(a);let o;for(;(o=s.next())&&!o.done;){const l=o.value;e.call(a,l[0],l[1])}},TE=(a,e)=>{let i;const s=[];for(;(i=a.exec(e))!==null;)s.push(i);return s},kE=Sn("HTMLFormElement"),CE=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,s,o){return s.toUpperCase()+o}),ov=(({hasOwnProperty:a})=>(e,i)=>a.call(e,i))(Object.prototype),EE=Sn("RegExp"),Hy=(a,e)=>{const i=Object.getOwnPropertyDescriptors(a),s={};Gr(i,(o,l)=>{let u;(u=e(o,l,a))!==!1&&(s[l]=u||o)}),Object.defineProperties(a,s)},RE=a=>{Hy(a,(e,i)=>{if(Qt(a)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const s=a[i];if(Qt(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},_E=(a,e)=>{const i={},s=o=>{o.forEach(l=>{i[l]=!0})};return ks(a)?s(a):s(String(a).split(e)),i},wE=()=>{},OE=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function xE(a){return!!(a&&Qt(a.append)&&a[Symbol.toStringTag]==="FormData"&&a[Symbol.iterator])}const DE=a=>{const e=new Array(10),i=(s,o)=>{if(Xc(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[o]=s;const l=ks(s)?[]:{};return Gr(s,(u,d)=>{const m=i(u,o+1);!Ir(m)&&(l[d]=m)}),e[o]=void 0,l}}return s};return i(a,0)},AE=Sn("AsyncFunction"),NE=a=>a&&(Xc(a)||Qt(a))&&Qt(a.then)&&Qt(a.catch),Vy=((a,e)=>a?setImmediate:e?((i,s)=>(pa.addEventListener("message",({source:o,data:l})=>{o===pa&&l===i&&s.length&&s.shift()()},!1),o=>{s.push(o),pa.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",Qt(pa.postMessage)),PE=typeof queueMicrotask<"u"?queueMicrotask.bind(pa):typeof process<"u"&&process.nextTick||Vy,B={isArray:ks,isArrayBuffer:Iy,isBuffer:ZC,isFormData:rE,isArrayBufferView:WC,isString:$C,isNumber:By,isBoolean:eE,isObject:Xc,isPlainObject:pc,isReadableStream:cE,isRequest:lE,isResponse:uE,isHeaders:dE,isUndefined:Ir,isDate:tE,isFile:nE,isBlob:iE,isRegExp:EE,isFunction:Qt,isStream:sE,isURLSearchParams:oE,isTypedArray:bE,isFileList:aE,forEach:Gr,merge:Qd,extend:hE,trim:fE,stripBOM:mE,inherits:pE,toFlatObject:gE,kindOf:Kc,kindOfTest:Sn,endsWith:vE,toArray:yE,forEachEntry:SE,matchAll:TE,isHTMLForm:kE,hasOwnProperty:ov,hasOwnProp:ov,reduceDescriptors:Hy,freezeMethods:RE,toObjectSet:_E,toCamelCase:CE,noop:wE,toFiniteNumber:OE,findKey:zy,global:pa,isContextDefined:qy,isSpecCompliantForm:xE,toJSONObject:DE,isAsyncFn:AE,isThenable:NE,setImmediate:Vy,asap:PE};function ge(a,e,i,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}B.inherits(ge,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:B.toJSONObject(this.config),code:this.code,status:this.status}}});const Fy=ge.prototype,Gy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{Gy[a]={value:a}});Object.defineProperties(ge,Gy);Object.defineProperty(Fy,"isAxiosError",{value:!0});ge.from=(a,e,i,s,o,l)=>{const u=Object.create(Fy);return B.toFlatObject(a,u,function(m){return m!==Error.prototype},d=>d!=="isAxiosError"),ge.call(u,a.message,e,i,s,o),u.cause=a,u.name=a.name,l&&Object.assign(u,l),u};const ME=null;function Xd(a){return B.isPlainObject(a)||B.isArray(a)}function Yy(a){return B.endsWith(a,"[]")?a.slice(0,-2):a}function cv(a,e,i){return a?a.concat(e).map(function(o,l){return o=Yy(o),!i&&l?"["+o+"]":o}).join(i?".":""):e}function UE(a){return B.isArray(a)&&!a.some(Xd)}const LE=B.toFlatObject(B,{},null,function(e){return/^is[A-Z]/.test(e)});function Jc(a,e,i){if(!B.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,i=B.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,_){return!B.isUndefined(_[E])});const s=i.metaTokens,o=i.visitor||g,l=i.dots,u=i.indexes,m=(i.Blob||typeof Blob<"u"&&Blob)&&B.isSpecCompliantForm(e);if(!B.isFunction(o))throw new TypeError("visitor must be a function");function h(T){if(T===null)return"";if(B.isDate(T))return T.toISOString();if(!m&&B.isBlob(T))throw new ge("Blob is not supported. Use a Buffer instead.");return B.isArrayBuffer(T)||B.isTypedArray(T)?m&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function g(T,E,_){let O=T;if(T&&!_&&typeof T=="object"){if(B.endsWith(E,"{}"))E=s?E:E.slice(0,-2),T=JSON.stringify(T);else if(B.isArray(T)&&UE(T)||(B.isFileList(T)||B.endsWith(E,"[]"))&&(O=B.toArray(T)))return E=Yy(E),O.forEach(function(j,M){!(B.isUndefined(j)||j===null)&&e.append(u===!0?cv([E],M,l):u===null?E:E+"[]",h(j))}),!1}return Xd(T)?!0:(e.append(cv(_,E,l),h(T)),!1)}const v=[],b=Object.assign(LE,{defaultVisitor:g,convertValue:h,isVisitable:Xd});function k(T,E){if(!B.isUndefined(T)){if(v.indexOf(T)!==-1)throw Error("Circular reference detected in "+E.join("."));v.push(T),B.forEach(T,function(O,q){(!(B.isUndefined(O)||O===null)&&o.call(e,O,B.isString(q)?q.trim():q,E,b))===!0&&k(O,E?E.concat(q):[q])}),v.pop()}}if(!B.isObject(a))throw new TypeError("data must be an object");return k(a),e}function lv(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function qf(a,e){this._pairs=[],a&&Jc(a,this,e)}const Ky=qf.prototype;Ky.append=function(e,i){this._pairs.push([e,i])};Ky.toString=function(e){const i=e?function(s){return e.call(this,s,lv)}:lv;return this._pairs.map(function(o){return i(o[0])+"="+i(o[1])},"").join("&")};function jE(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Qy(a,e,i){if(!e)return a;const s=i&&i.encode||jE;B.isFunction(i)&&(i={serialize:i});const o=i&&i.serialize;let l;if(o?l=o(e,i):l=B.isURLSearchParams(e)?e.toString():new qf(e,i).toString(s),l){const u=a.indexOf("#");u!==-1&&(a=a.slice(0,u)),a+=(a.indexOf("?")===-1?"?":"&")+l}return a}class uv{constructor(){this.handlers=[]}use(e,i,s){return this.handlers.push({fulfilled:e,rejected:i,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){B.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Xy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},IE=typeof URLSearchParams<"u"?URLSearchParams:qf,BE=typeof FormData<"u"?FormData:null,zE=typeof Blob<"u"?Blob:null,qE={isBrowser:!0,classes:{URLSearchParams:IE,FormData:BE,Blob:zE},protocols:["http","https","file","blob","url","data"]},Hf=typeof window<"u"&&typeof document<"u",Jd=typeof navigator=="object"&&navigator||void 0,HE=Hf&&(!Jd||["ReactNative","NativeScript","NS"].indexOf(Jd.product)<0),VE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",FE=Hf&&window.location.href||"http://localhost",GE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Hf,hasStandardBrowserEnv:HE,hasStandardBrowserWebWorkerEnv:VE,navigator:Jd,origin:FE},Symbol.toStringTag,{value:"Module"})),Rt={...GE,...qE};function YE(a,e){return Jc(a,new Rt.classes.URLSearchParams,Object.assign({visitor:function(i,s,o,l){return Rt.isNode&&B.isBuffer(i)?(this.append(s,i.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},e))}function KE(a){return B.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function QE(a){const e={},i=Object.keys(a);let s;const o=i.length;let l;for(s=0;s<o;s++)l=i[s],e[l]=a[l];return e}function Jy(a){function e(i,s,o,l){let u=i[l++];if(u==="__proto__")return!0;const d=Number.isFinite(+u),m=l>=i.length;return u=!u&&B.isArray(o)?o.length:u,m?(B.hasOwnProp(o,u)?o[u]=[o[u],s]:o[u]=s,!d):((!o[u]||!B.isObject(o[u]))&&(o[u]=[]),e(i,s,o[u],l)&&B.isArray(o[u])&&(o[u]=QE(o[u])),!d)}if(B.isFormData(a)&&B.isFunction(a.entries)){const i={};return B.forEachEntry(a,(s,o)=>{e(KE(s),o,i,0)}),i}return null}function XE(a,e,i){if(B.isString(a))try{return(e||JSON.parse)(a),B.trim(a)}catch(s){if(s.name!=="SyntaxError")throw s}return(i||JSON.stringify)(a)}const Yr={transitional:Xy,adapter:["xhr","http","fetch"],transformRequest:[function(e,i){const s=i.getContentType()||"",o=s.indexOf("application/json")>-1,l=B.isObject(e);if(l&&B.isHTMLForm(e)&&(e=new FormData(e)),B.isFormData(e))return o?JSON.stringify(Jy(e)):e;if(B.isArrayBuffer(e)||B.isBuffer(e)||B.isStream(e)||B.isFile(e)||B.isBlob(e)||B.isReadableStream(e))return e;if(B.isArrayBufferView(e))return e.buffer;if(B.isURLSearchParams(e))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return YE(e,this.formSerializer).toString();if((d=B.isFileList(e))||s.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Jc(d?{"files[]":e}:e,m&&new m,this.formSerializer)}}return l||o?(i.setContentType("application/json",!1),XE(e)):e}],transformResponse:[function(e){const i=this.transitional||Yr.transitional,s=i&&i.forcedJSONParsing,o=this.responseType==="json";if(B.isResponse(e)||B.isReadableStream(e))return e;if(e&&B.isString(e)&&(s&&!this.responseType||o)){const u=!(i&&i.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(d){if(u)throw d.name==="SyntaxError"?ge.from(d,ge.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Rt.classes.FormData,Blob:Rt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};B.forEach(["delete","get","head","post","put","patch"],a=>{Yr.headers[a]={}});const JE=B.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ZE=a=>{const e={};let i,s,o;return a&&a.split(`
`).forEach(function(u){o=u.indexOf(":"),i=u.substring(0,o).trim().toLowerCase(),s=u.substring(o+1).trim(),!(!i||e[i]&&JE[i])&&(i==="set-cookie"?e[i]?e[i].push(s):e[i]=[s]:e[i]=e[i]?e[i]+", "+s:s)}),e},dv=Symbol("internals");function _r(a){return a&&String(a).trim().toLowerCase()}function gc(a){return a===!1||a==null?a:B.isArray(a)?a.map(gc):String(a)}function WE(a){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=i.exec(a);)e[s[1]]=s[2];return e}const $E=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function kd(a,e,i,s,o){if(B.isFunction(s))return s.call(this,e,i);if(o&&(e=i),!!B.isString(e)){if(B.isString(s))return e.indexOf(s)!==-1;if(B.isRegExp(s))return s.test(e)}}function eR(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,i,s)=>i.toUpperCase()+s)}function tR(a,e){const i=B.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(a,s+i,{value:function(o,l,u){return this[s].call(this,e,o,l,u)},configurable:!0})})}let Lt=class{constructor(e){e&&this.set(e)}set(e,i,s){const o=this;function l(d,m,h){const g=_r(m);if(!g)throw new Error("header name must be a non-empty string");const v=B.findKey(o,g);(!v||o[v]===void 0||h===!0||h===void 0&&o[v]!==!1)&&(o[v||m]=gc(d))}const u=(d,m)=>B.forEach(d,(h,g)=>l(h,g,m));if(B.isPlainObject(e)||e instanceof this.constructor)u(e,i);else if(B.isString(e)&&(e=e.trim())&&!$E(e))u(ZE(e),i);else if(B.isHeaders(e))for(const[d,m]of e.entries())l(m,d,s);else e!=null&&l(i,e,s);return this}get(e,i){if(e=_r(e),e){const s=B.findKey(this,e);if(s){const o=this[s];if(!i)return o;if(i===!0)return WE(o);if(B.isFunction(i))return i.call(this,o,s);if(B.isRegExp(i))return i.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,i){if(e=_r(e),e){const s=B.findKey(this,e);return!!(s&&this[s]!==void 0&&(!i||kd(this,this[s],s,i)))}return!1}delete(e,i){const s=this;let o=!1;function l(u){if(u=_r(u),u){const d=B.findKey(s,u);d&&(!i||kd(s,s[d],d,i))&&(delete s[d],o=!0)}}return B.isArray(e)?e.forEach(l):l(e),o}clear(e){const i=Object.keys(this);let s=i.length,o=!1;for(;s--;){const l=i[s];(!e||kd(this,this[l],l,e,!0))&&(delete this[l],o=!0)}return o}normalize(e){const i=this,s={};return B.forEach(this,(o,l)=>{const u=B.findKey(s,l);if(u){i[u]=gc(o),delete i[l];return}const d=e?eR(l):String(l).trim();d!==l&&delete i[l],i[d]=gc(o),s[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const i=Object.create(null);return B.forEach(this,(s,o)=>{s!=null&&s!==!1&&(i[o]=e&&B.isArray(s)?s.join(", "):s)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,i])=>e+": "+i).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...i){const s=new this(e);return i.forEach(o=>s.set(o)),s}static accessor(e){const s=(this[dv]=this[dv]={accessors:{}}).accessors,o=this.prototype;function l(u){const d=_r(u);s[d]||(tR(o,u),s[d]=!0)}return B.isArray(e)?e.forEach(l):l(e),this}};Lt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);B.reduceDescriptors(Lt.prototype,({value:a},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(s){this[i]=s}}});B.freezeMethods(Lt);function Cd(a,e){const i=this||Yr,s=e||i,o=Lt.from(s.headers);let l=s.data;return B.forEach(a,function(d){l=d.call(i,l,o.normalize(),e?e.status:void 0)}),o.normalize(),l}function Zy(a){return!!(a&&a.__CANCEL__)}function Cs(a,e,i){ge.call(this,a??"canceled",ge.ERR_CANCELED,e,i),this.name="CanceledError"}B.inherits(Cs,ge,{__CANCEL__:!0});function Wy(a,e,i){const s=i.config.validateStatus;!i.status||!s||s(i.status)?a(i):e(new ge("Request failed with status code "+i.status,[ge.ERR_BAD_REQUEST,ge.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function nR(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function iR(a,e){a=a||10;const i=new Array(a),s=new Array(a);let o=0,l=0,u;return e=e!==void 0?e:1e3,function(m){const h=Date.now(),g=s[l];u||(u=h),i[o]=m,s[o]=h;let v=l,b=0;for(;v!==o;)b+=i[v++],v=v%a;if(o=(o+1)%a,o===l&&(l=(l+1)%a),h-u<e)return;const k=g&&h-g;return k?Math.round(b*1e3/k):void 0}}function aR(a,e){let i=0,s=1e3/e,o,l;const u=(h,g=Date.now())=>{i=g,o=null,l&&(clearTimeout(l),l=null),a.apply(null,h)};return[(...h)=>{const g=Date.now(),v=g-i;v>=s?u(h,g):(o=h,l||(l=setTimeout(()=>{l=null,u(o)},s-v)))},()=>o&&u(o)]}const Mc=(a,e,i=3)=>{let s=0;const o=iR(50,250);return aR(l=>{const u=l.loaded,d=l.lengthComputable?l.total:void 0,m=u-s,h=o(m),g=u<=d;s=u;const v={loaded:u,total:d,progress:d?u/d:void 0,bytes:m,rate:h||void 0,estimated:h&&d&&g?(d-u)/h:void 0,event:l,lengthComputable:d!=null,[e?"download":"upload"]:!0};a(v)},i)},fv=(a,e)=>{const i=a!=null;return[s=>e[0]({lengthComputable:i,total:a,loaded:s}),e[1]]},hv=a=>(...e)=>B.asap(()=>a(...e)),sR=Rt.hasStandardBrowserEnv?((a,e)=>i=>(i=new URL(i,Rt.origin),a.protocol===i.protocol&&a.host===i.host&&(e||a.port===i.port)))(new URL(Rt.origin),Rt.navigator&&/(msie|trident)/i.test(Rt.navigator.userAgent)):()=>!0,rR=Rt.hasStandardBrowserEnv?{write(a,e,i,s,o,l){const u=[a+"="+encodeURIComponent(e)];B.isNumber(i)&&u.push("expires="+new Date(i).toGMTString()),B.isString(s)&&u.push("path="+s),B.isString(o)&&u.push("domain="+o),l===!0&&u.push("secure"),document.cookie=u.join("; ")},read(a){const e=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function oR(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function cR(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function $y(a,e,i){let s=!oR(e);return a&&(s||i==!1)?cR(a,e):e}const mv=a=>a instanceof Lt?{...a}:a;function ba(a,e){e=e||{};const i={};function s(h,g,v,b){return B.isPlainObject(h)&&B.isPlainObject(g)?B.merge.call({caseless:b},h,g):B.isPlainObject(g)?B.merge({},g):B.isArray(g)?g.slice():g}function o(h,g,v,b){if(B.isUndefined(g)){if(!B.isUndefined(h))return s(void 0,h,v,b)}else return s(h,g,v,b)}function l(h,g){if(!B.isUndefined(g))return s(void 0,g)}function u(h,g){if(B.isUndefined(g)){if(!B.isUndefined(h))return s(void 0,h)}else return s(void 0,g)}function d(h,g,v){if(v in e)return s(h,g);if(v in a)return s(void 0,h)}const m={url:l,method:l,data:l,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:d,headers:(h,g,v)=>o(mv(h),mv(g),v,!0)};return B.forEach(Object.keys(Object.assign({},a,e)),function(g){const v=m[g]||o,b=v(a[g],e[g],g);B.isUndefined(b)&&v!==d||(i[g]=b)}),i}const e0=a=>{const e=ba({},a);let{data:i,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:l,headers:u,auth:d}=e;e.headers=u=Lt.from(u),e.url=Qy($y(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),d&&u.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let m;if(B.isFormData(i)){if(Rt.hasStandardBrowserEnv||Rt.hasStandardBrowserWebWorkerEnv)u.setContentType(void 0);else if((m=u.getContentType())!==!1){const[h,...g]=m?m.split(";").map(v=>v.trim()).filter(Boolean):[];u.setContentType([h||"multipart/form-data",...g].join("; "))}}if(Rt.hasStandardBrowserEnv&&(s&&B.isFunction(s)&&(s=s(e)),s||s!==!1&&sR(e.url))){const h=o&&l&&rR.read(l);h&&u.set(o,h)}return e},lR=typeof XMLHttpRequest<"u",uR=lR&&function(a){return new Promise(function(i,s){const o=e0(a);let l=o.data;const u=Lt.from(o.headers).normalize();let{responseType:d,onUploadProgress:m,onDownloadProgress:h}=o,g,v,b,k,T;function E(){k&&k(),T&&T(),o.cancelToken&&o.cancelToken.unsubscribe(g),o.signal&&o.signal.removeEventListener("abort",g)}let _=new XMLHttpRequest;_.open(o.method.toUpperCase(),o.url,!0),_.timeout=o.timeout;function O(){if(!_)return;const j=Lt.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),x={data:!d||d==="text"||d==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:j,config:a,request:_};Wy(function(W){i(W),E()},function(W){s(W),E()},x),_=null}"onloadend"in _?_.onloadend=O:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(O)},_.onabort=function(){_&&(s(new ge("Request aborted",ge.ECONNABORTED,a,_)),_=null)},_.onerror=function(){s(new ge("Network Error",ge.ERR_NETWORK,a,_)),_=null},_.ontimeout=function(){let M=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const x=o.transitional||Xy;o.timeoutErrorMessage&&(M=o.timeoutErrorMessage),s(new ge(M,x.clarifyTimeoutError?ge.ETIMEDOUT:ge.ECONNABORTED,a,_)),_=null},l===void 0&&u.setContentType(null),"setRequestHeader"in _&&B.forEach(u.toJSON(),function(M,x){_.setRequestHeader(x,M)}),B.isUndefined(o.withCredentials)||(_.withCredentials=!!o.withCredentials),d&&d!=="json"&&(_.responseType=o.responseType),h&&([b,T]=Mc(h,!0),_.addEventListener("progress",b)),m&&_.upload&&([v,k]=Mc(m),_.upload.addEventListener("progress",v),_.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(g=j=>{_&&(s(!j||j.type?new Cs(null,a,_):j),_.abort(),_=null)},o.cancelToken&&o.cancelToken.subscribe(g),o.signal&&(o.signal.aborted?g():o.signal.addEventListener("abort",g)));const q=nR(o.url);if(q&&Rt.protocols.indexOf(q)===-1){s(new ge("Unsupported protocol "+q+":",ge.ERR_BAD_REQUEST,a));return}_.send(l||null)})},dR=(a,e)=>{const{length:i}=a=a?a.filter(Boolean):[];if(e||i){let s=new AbortController,o;const l=function(h){if(!o){o=!0,d();const g=h instanceof Error?h:this.reason;s.abort(g instanceof ge?g:new Cs(g instanceof Error?g.message:g))}};let u=e&&setTimeout(()=>{u=null,l(new ge(`timeout ${e} of ms exceeded`,ge.ETIMEDOUT))},e);const d=()=>{a&&(u&&clearTimeout(u),u=null,a.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),a=null)};a.forEach(h=>h.addEventListener("abort",l));const{signal:m}=s;return m.unsubscribe=()=>B.asap(d),m}},fR=function*(a,e){let i=a.byteLength;if(i<e){yield a;return}let s=0,o;for(;s<i;)o=s+e,yield a.slice(s,o),s=o},hR=async function*(a,e){for await(const i of mR(a))yield*fR(i,e)},mR=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:i,value:s}=await e.read();if(i)break;yield s}}finally{await e.cancel()}},pv=(a,e,i,s)=>{const o=hR(a,e);let l=0,u,d=m=>{u||(u=!0,s&&s(m))};return new ReadableStream({async pull(m){try{const{done:h,value:g}=await o.next();if(h){d(),m.close();return}let v=g.byteLength;if(i){let b=l+=v;i(b)}m.enqueue(new Uint8Array(g))}catch(h){throw d(h),h}},cancel(m){return d(m),o.return()}},{highWaterMark:2})},Zc=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",t0=Zc&&typeof ReadableStream=="function",pR=Zc&&(typeof TextEncoder=="function"?(a=>e=>a.encode(e))(new TextEncoder):async a=>new Uint8Array(await new Response(a).arrayBuffer())),n0=(a,...e)=>{try{return!!a(...e)}catch{return!1}},gR=t0&&n0(()=>{let a=!1;const e=new Request(Rt.origin,{body:new ReadableStream,method:"POST",get duplex(){return a=!0,"half"}}).headers.has("Content-Type");return a&&!e}),gv=64*1024,Zd=t0&&n0(()=>B.isReadableStream(new Response("").body)),Uc={stream:Zd&&(a=>a.body)};Zc&&(a=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Uc[e]&&(Uc[e]=B.isFunction(a[e])?i=>i[e]():(i,s)=>{throw new ge(`Response type '${e}' is not supported`,ge.ERR_NOT_SUPPORT,s)})})})(new Response);const vR=async a=>{if(a==null)return 0;if(B.isBlob(a))return a.size;if(B.isSpecCompliantForm(a))return(await new Request(Rt.origin,{method:"POST",body:a}).arrayBuffer()).byteLength;if(B.isArrayBufferView(a)||B.isArrayBuffer(a))return a.byteLength;if(B.isURLSearchParams(a)&&(a=a+""),B.isString(a))return(await pR(a)).byteLength},yR=async(a,e)=>{const i=B.toFiniteNumber(a.getContentLength());return i??vR(e)},bR=Zc&&(async a=>{let{url:e,method:i,data:s,signal:o,cancelToken:l,timeout:u,onDownloadProgress:d,onUploadProgress:m,responseType:h,headers:g,withCredentials:v="same-origin",fetchOptions:b}=e0(a);h=h?(h+"").toLowerCase():"text";let k=dR([o,l&&l.toAbortSignal()],u),T;const E=k&&k.unsubscribe&&(()=>{k.unsubscribe()});let _;try{if(m&&gR&&i!=="get"&&i!=="head"&&(_=await yR(g,s))!==0){let x=new Request(e,{method:"POST",body:s,duplex:"half"}),F;if(B.isFormData(s)&&(F=x.headers.get("content-type"))&&g.setContentType(F),x.body){const[W,ae]=fv(_,Mc(hv(m)));s=pv(x.body,gv,W,ae)}}B.isString(v)||(v=v?"include":"omit");const O="credentials"in Request.prototype;T=new Request(e,{...b,signal:k,method:i.toUpperCase(),headers:g.normalize().toJSON(),body:s,duplex:"half",credentials:O?v:void 0});let q=await fetch(T);const j=Zd&&(h==="stream"||h==="response");if(Zd&&(d||j&&E)){const x={};["status","statusText","headers"].forEach(X=>{x[X]=q[X]});const F=B.toFiniteNumber(q.headers.get("content-length")),[W,ae]=d&&fv(F,Mc(hv(d),!0))||[];q=new Response(pv(q.body,gv,W,()=>{ae&&ae(),E&&E()}),x)}h=h||"text";let M=await Uc[B.findKey(Uc,h)||"text"](q,a);return!j&&E&&E(),await new Promise((x,F)=>{Wy(x,F,{data:M,headers:Lt.from(q.headers),status:q.status,statusText:q.statusText,config:a,request:T})})}catch(O){throw E&&E(),O&&O.name==="TypeError"&&/fetch/i.test(O.message)?Object.assign(new ge("Network Error",ge.ERR_NETWORK,a,T),{cause:O.cause||O}):ge.from(O,O&&O.code,a,T)}}),Wd={http:ME,xhr:uR,fetch:bR};B.forEach(Wd,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const vv=a=>`- ${a}`,SR=a=>B.isFunction(a)||a===null||a===!1,i0={getAdapter:a=>{a=B.isArray(a)?a:[a];const{length:e}=a;let i,s;const o={};for(let l=0;l<e;l++){i=a[l];let u;if(s=i,!SR(i)&&(s=Wd[(u=String(i)).toLowerCase()],s===void 0))throw new ge(`Unknown adapter '${u}'`);if(s)break;o[u||"#"+l]=s}if(!s){const l=Object.entries(o).map(([d,m])=>`adapter ${d} `+(m===!1?"is not supported by the environment":"is not available in the build"));let u=e?l.length>1?`since :
`+l.map(vv).join(`
`):" "+vv(l[0]):"as no adapter specified";throw new ge("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s},adapters:Wd};function Ed(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new Cs(null,a)}function yv(a){return Ed(a),a.headers=Lt.from(a.headers),a.data=Cd.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),i0.getAdapter(a.adapter||Yr.adapter)(a).then(function(s){return Ed(a),s.data=Cd.call(a,a.transformResponse,s),s.headers=Lt.from(s.headers),s},function(s){return Zy(s)||(Ed(a),s&&s.response&&(s.response.data=Cd.call(a,a.transformResponse,s.response),s.response.headers=Lt.from(s.response.headers))),Promise.reject(s)})}const a0="1.8.4",Wc={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{Wc[a]=function(s){return typeof s===a||"a"+(e<1?"n ":" ")+a}});const bv={};Wc.transitional=function(e,i,s){function o(l,u){return"[Axios v"+a0+"] Transitional option '"+l+"'"+u+(s?". "+s:"")}return(l,u,d)=>{if(e===!1)throw new ge(o(u," has been removed"+(i?" in "+i:"")),ge.ERR_DEPRECATED);return i&&!bv[u]&&(bv[u]=!0,console.warn(o(u," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(l,u,d):!0}};Wc.spelling=function(e){return(i,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function TR(a,e,i){if(typeof a!="object")throw new ge("options must be an object",ge.ERR_BAD_OPTION_VALUE);const s=Object.keys(a);let o=s.length;for(;o-- >0;){const l=s[o],u=e[l];if(u){const d=a[l],m=d===void 0||u(d,l,a);if(m!==!0)throw new ge("option "+l+" must be "+m,ge.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new ge("Unknown option "+l,ge.ERR_BAD_OPTION)}}const vc={assertOptions:TR,validators:Wc},On=vc.validators;let ga=class{constructor(e){this.defaults=e,this.interceptors={request:new uv,response:new uv}}async request(e,i){try{return await this._request(e,i)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const l=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=ba(this.defaults,i);const{transitional:s,paramsSerializer:o,headers:l}=i;s!==void 0&&vc.assertOptions(s,{silentJSONParsing:On.transitional(On.boolean),forcedJSONParsing:On.transitional(On.boolean),clarifyTimeoutError:On.transitional(On.boolean)},!1),o!=null&&(B.isFunction(o)?i.paramsSerializer={serialize:o}:vc.assertOptions(o,{encode:On.function,serialize:On.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),vc.assertOptions(i,{baseUrl:On.spelling("baseURL"),withXsrfToken:On.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let u=l&&B.merge(l.common,l[i.method]);l&&B.forEach(["delete","get","head","post","put","patch","common"],T=>{delete l[T]}),i.headers=Lt.concat(u,l);const d=[];let m=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(i)===!1||(m=m&&E.synchronous,d.unshift(E.fulfilled,E.rejected))});const h=[];this.interceptors.response.forEach(function(E){h.push(E.fulfilled,E.rejected)});let g,v=0,b;if(!m){const T=[yv.bind(this),void 0];for(T.unshift.apply(T,d),T.push.apply(T,h),b=T.length,g=Promise.resolve(i);v<b;)g=g.then(T[v++],T[v++]);return g}b=d.length;let k=i;for(v=0;v<b;){const T=d[v++],E=d[v++];try{k=T(k)}catch(_){E.call(this,_);break}}try{g=yv.call(this,k)}catch(T){return Promise.reject(T)}for(v=0,b=h.length;v<b;)g=g.then(h[v++],h[v++]);return g}getUri(e){e=ba(this.defaults,e);const i=$y(e.baseURL,e.url,e.allowAbsoluteUrls);return Qy(i,e.params,e.paramsSerializer)}};B.forEach(["delete","get","head","options"],function(e){ga.prototype[e]=function(i,s){return this.request(ba(s||{},{method:e,url:i,data:(s||{}).data}))}});B.forEach(["post","put","patch"],function(e){function i(s){return function(l,u,d){return this.request(ba(d||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:u}))}}ga.prototype[e]=i(),ga.prototype[e+"Form"]=i(!0)});let kR=class s0{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(l){i=l});const s=this;this.promise.then(o=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](o);s._listeners=null}),this.promise.then=o=>{let l;const u=new Promise(d=>{s.subscribe(d),l=d}).then(o);return u.cancel=function(){s.unsubscribe(l)},u},e(function(l,u,d){s.reason||(s.reason=new Cs(l,u,d),i(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const i=this._listeners.indexOf(e);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const e=new AbortController,i=s=>{e.abort(s)};return this.subscribe(i),e.signal.unsubscribe=()=>this.unsubscribe(i),e.signal}static source(){let e;return{token:new s0(function(o){e=o}),cancel:e}}};function CR(a){return function(i){return a.apply(null,i)}}function ER(a){return B.isObject(a)&&a.isAxiosError===!0}const $d={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries($d).forEach(([a,e])=>{$d[e]=a});function r0(a){const e=new ga(a),i=jy(ga.prototype.request,e);return B.extend(i,ga.prototype,e,{allOwnKeys:!0}),B.extend(i,e,null,{allOwnKeys:!0}),i.create=function(o){return r0(ba(a,o))},i}const nt=r0(Yr);nt.Axios=ga;nt.CanceledError=Cs;nt.CancelToken=kR;nt.isCancel=Zy;nt.VERSION=a0;nt.toFormData=Jc;nt.AxiosError=ge;nt.Cancel=nt.CanceledError;nt.all=function(e){return Promise.all(e)};nt.spread=CR;nt.isAxiosError=ER;nt.mergeConfig=ba;nt.AxiosHeaders=Lt;nt.formToJSON=a=>Jy(B.isHTMLForm(a)?new FormData(a):a);nt.getAdapter=i0.getAdapter;nt.HttpStatusCode=$d;nt.default=nt;const{Axios:oO,AxiosError:cO,CanceledError:lO,isCancel:uO,CancelToken:dO,VERSION:fO,all:hO,Cancel:mO,isAxiosError:pO,spread:gO,toFormData:vO,AxiosHeaders:yO,HttpStatusCode:bO,formToJSON:SO,getAdapter:TO,mergeConfig:kO}=nt;var Sv={};function RR(a,e){return e.forEach(function(i){i&&typeof i!="string"&&!Array.isArray(i)&&Object.keys(i).forEach(function(s){if(s!=="default"&&!(s in a)){var o=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return i[s]}})}})}),Object.freeze(a)}var _R=Object.defineProperty,wR=(a,e,i)=>e in a?_R(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,Tv=(a,e,i)=>wR(a,typeof e!="symbol"?e+"":e,i);class Kt{constructor(){Tv(this,"_locking"),Tv(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const i=new Promise(o=>e=()=>{this._locks-=1,o()}),s=this._locking.then(()=>e);return this._locking=this._locking.then(()=>i),s}}function We(a,e){if(!a)throw new Error(e)}const OR=34028234663852886e22,xR=-34028234663852886e22,DR=4294967295,AR=2147483647,NR=-2147483648;function yc(a){if(typeof a!="number")throw new Error("invalid int 32: "+typeof a);if(!Number.isInteger(a)||a>AR||a<NR)throw new Error("invalid int 32: "+a)}function ef(a){if(typeof a!="number")throw new Error("invalid uint 32: "+typeof a);if(!Number.isInteger(a)||a>DR||a<0)throw new Error("invalid uint 32: "+a)}function o0(a){if(typeof a!="number")throw new Error("invalid float 32: "+typeof a);if(Number.isFinite(a)&&(a>OR||a<xR))throw new Error("invalid float 32: "+a)}const c0=Symbol("@bufbuild/protobuf/enum-type");function PR(a){const e=a[c0];return We(e,"missing enum type on enum object"),e}function l0(a,e,i,s){a[c0]=u0(e,i.map(o=>({no:o.no,name:o.name,localName:a[o.no]})))}function u0(a,e,i){const s=Object.create(null),o=Object.create(null),l=[];for(const u of e){const d=d0(u);l.push(d),s[u.name]=d,o[u.no]=d}return{typeName:a,values:l,findName(u){return s[u]},findNumber(u){return o[u]}}}function MR(a,e,i){const s={};for(const o of e){const l=d0(o);s[l.localName]=l.no,s[l.no]=l.localName}return l0(s,a,e),s}function d0(a){return"localName"in a?a:Object.assign(Object.assign({},a),{localName:a.name})}class Vf{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,i){const s=this.getType(),o=s.runtime.bin,l=o.makeReadOptions(i);return o.readMessage(this,l.readerFactory(e),e.byteLength,l),this}fromJson(e,i){const s=this.getType(),o=s.runtime.json,l=o.makeReadOptions(i);return o.readMessage(s,e,l,this),this}fromJsonString(e,i){let s;try{s=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(s,i)}toBinary(e){const i=this.getType(),s=i.runtime.bin,o=s.makeWriteOptions(e),l=o.writerFactory();return s.writeMessage(this,l,o),l.finish()}toJson(e){const i=this.getType(),s=i.runtime.json,o=s.makeWriteOptions(e);return s.writeMessage(this,o)}toJsonString(e){var i;const s=this.toJson(e);return JSON.stringify(s,null,(i=e==null?void 0:e.prettySpaces)!==null&&i!==void 0?i:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function UR(a,e,i,s){var o;const l=(o=s==null?void 0:s.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),u={[l]:function(d){a.util.initFields(this),a.util.initPartial(d,this)}}[l];return Object.setPrototypeOf(u.prototype,new Vf),Object.assign(u,{runtime:a,typeName:e,fields:a.util.newFieldList(i),fromBinary(d,m){return new u().fromBinary(d,m)},fromJson(d,m){return new u().fromJson(d,m)},fromJsonString(d,m){return new u().fromJsonString(d,m)},equals(d,m){return a.util.equals(u,d,m)}}),u}function LR(){let a=0,e=0;for(let s=0;s<28;s+=7){let o=this.buf[this.pos++];if(a|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}let i=this.buf[this.pos++];if(a|=(i&15)<<28,e=(i&112)>>4,(i&128)==0)return this.assertBounds(),[a,e];for(let s=3;s<=31;s+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}throw new Error("invalid varint")}function Rd(a,e,i){for(let l=0;l<28;l=l+7){const u=a>>>l,d=!(!(u>>>7)&&e==0),m=(d?u|128:u)&255;if(i.push(m),!d)return}const s=a>>>28&15|(e&7)<<4,o=e>>3!=0;if(i.push((o?s|128:s)&255),!!o){for(let l=3;l<31;l=l+7){const u=e>>>l,d=!!(u>>>7),m=(d?u|128:u)&255;if(i.push(m),!d)return}i.push(e>>>31&1)}}const bc=4294967296;function kv(a){const e=a[0]==="-";e&&(a=a.slice(1));const i=1e6;let s=0,o=0;function l(u,d){const m=Number(a.slice(u,d));o*=i,s=s*i+m,s>=bc&&(o=o+(s/bc|0),s=s%bc)}return l(-24,-18),l(-18,-12),l(-12,-6),l(-6),e?h0(s,o):Ff(s,o)}function jR(a,e){let i=Ff(a,e);const s=i.hi&2147483648;s&&(i=h0(i.lo,i.hi));const o=f0(i.lo,i.hi);return s?"-"+o:o}function f0(a,e){if({lo:a,hi:e}=IR(a,e),e<=2097151)return String(bc*e+a);const i=a&16777215,s=(a>>>24|e<<8)&16777215,o=e>>16&65535;let l=i+s*6777216+o*6710656,u=s+o*8147497,d=o*2;const m=1e7;return l>=m&&(u+=Math.floor(l/m),l%=m),u>=m&&(d+=Math.floor(u/m),u%=m),d.toString()+Cv(u)+Cv(l)}function IR(a,e){return{lo:a>>>0,hi:e>>>0}}function Ff(a,e){return{lo:a|0,hi:e|0}}function h0(a,e){return e=~e,a?a=~a+1:e+=1,Ff(a,e)}const Cv=a=>{const e=String(a);return"0000000".slice(e.length)+e};function Ev(a,e){if(a>=0){for(;a>127;)e.push(a&127|128),a=a>>>7;e.push(a)}else{for(let i=0;i<9;i++)e.push(a&127|128),a=a>>7;e.push(1)}}function BR(){let a=this.buf[this.pos++],e=a&127;if((a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<7,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<14,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<21,(a&128)==0)return this.assertBounds(),e;a=this.buf[this.pos++],e|=(a&15)<<28;for(let i=5;(a&128)!==0&&i<10;i++)a=this.buf[this.pos++];if((a&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function zR(){const a=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof a.getBigInt64=="function"&&typeof a.getBigUint64=="function"&&typeof a.setBigInt64=="function"&&typeof a.setBigUint64=="function"&&(typeof process!="object"||typeof Sv!="object"||Sv.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),l=BigInt("9223372036854775807"),u=BigInt("0"),d=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(m){const h=typeof m=="bigint"?m:BigInt(m);if(h>l||h<o)throw new Error("int64 invalid: ".concat(m));return h},uParse(m){const h=typeof m=="bigint"?m:BigInt(m);if(h>d||h<u)throw new Error("uint64 invalid: ".concat(m));return h},enc(m){return a.setBigInt64(0,this.parse(m),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},uEnc(m){return a.setBigInt64(0,this.uParse(m),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},dec(m,h){return a.setInt32(0,m,!0),a.setInt32(4,h,!0),a.getBigInt64(0,!0)},uDec(m,h){return a.setInt32(0,m,!0),a.setInt32(4,h,!0),a.getBigUint64(0,!0)}}}const i=o=>We(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),s=o=>We(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),i(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),s(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),i(o),kv(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),s(o),kv(o)},dec(o,l){return jR(o,l)},uDec(o,l){return f0(o,l)}}}const Fe=zR();var Y;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})(Y||(Y={}));var zi;(function(a){a[a.BIGINT=0]="BIGINT",a[a.STRING=1]="STRING"})(zi||(zi={}));function Ai(a,e,i){if(e===i)return!0;if(a==Y.BYTES){if(!(e instanceof Uint8Array)||!(i instanceof Uint8Array)||e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==i[s])return!1;return!0}switch(a){case Y.UINT64:case Y.FIXED64:case Y.INT64:case Y.SFIXED64:case Y.SINT64:return e==i}return!1}function gs(a,e){switch(a){case Y.BOOL:return!1;case Y.UINT64:case Y.FIXED64:case Y.INT64:case Y.SFIXED64:case Y.SINT64:return e==0?Fe.zero:"0";case Y.DOUBLE:case Y.FLOAT:return 0;case Y.BYTES:return new Uint8Array(0);case Y.STRING:return"";default:return 0}}function m0(a,e){switch(a){case Y.BOOL:return e===!1;case Y.STRING:return e==="";case Y.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var tt;(function(a){a[a.Varint=0]="Varint",a[a.Bit64=1]="Bit64",a[a.LengthDelimited=2]="LengthDelimited",a[a.StartGroup=3]="StartGroup",a[a.EndGroup=4]="EndGroup",a[a.Bit32=5]="Bit32"})(tt||(tt={}));class qR{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let i=new Uint8Array(e),s=0;for(let o=0;o<this.chunks.length;o++)i.set(this.chunks[o],s),s+=this.chunks[o].length;return this.chunks=[],i}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),i=this.stack.pop();if(!i)throw new Error("invalid state, fork stack empty");return this.chunks=i.chunks,this.buf=i.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,i){return this.uint32((e<<3|i)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ef(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return yc(e),Ev(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let i=this.textEncoder.encode(e);return this.uint32(i.byteLength),this.raw(i)}float(e){o0(e);let i=new Uint8Array(4);return new DataView(i.buffer).setFloat32(0,e,!0),this.raw(i)}double(e){let i=new Uint8Array(8);return new DataView(i.buffer).setFloat64(0,e,!0),this.raw(i)}fixed32(e){ef(e);let i=new Uint8Array(4);return new DataView(i.buffer).setUint32(0,e,!0),this.raw(i)}sfixed32(e){yc(e);let i=new Uint8Array(4);return new DataView(i.buffer).setInt32(0,e,!0),this.raw(i)}sint32(e){return yc(e),e=(e<<1^e>>31)>>>0,Ev(e,this.buf),this}sfixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=Fe.enc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}fixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=Fe.uEnc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}int64(e){let i=Fe.enc(e);return Rd(i.lo,i.hi,this.buf),this}sint64(e){let i=Fe.enc(e),s=i.hi>>31,o=i.lo<<1^s,l=(i.hi<<1|i.lo>>>31)^s;return Rd(o,l,this.buf),this}uint64(e){let i=Fe.uEnc(e);return Rd(i.lo,i.hi,this.buf),this}}class HR{constructor(e,i){this.varint64=LR,this.uint32=BR,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=i??new TextDecoder}tag(){let e=this.uint32(),i=e>>>3,s=e&7;if(i<=0||s<0||s>5)throw new Error("illegal tag: field no "+i+" wire type "+s);return[i,s]}skip(e,i){let s=this.pos;switch(e){case tt.Varint:for(;this.buf[this.pos++]&128;);break;case tt.Bit64:this.pos+=4;case tt.Bit32:this.pos+=4;break;case tt.LengthDelimited:let o=this.uint32();this.pos+=o;break;case tt.StartGroup:for(;;){const[l,u]=this.tag();if(u===tt.EndGroup){if(i!==void 0&&l!==i)throw new Error("invalid end group tag");break}this.skip(u,l)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(s,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Fe.dec(...this.varint64())}uint64(){return Fe.uDec(...this.varint64())}sint64(){let[e,i]=this.varint64(),s=-(e&1);return e=(e>>>1|(i&1)<<31)^s,i=i>>>1^s,Fe.dec(e,i)}bool(){let[e,i]=this.varint64();return e!==0||i!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Fe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Fe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),i=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(i,i+e)}string(){return this.textDecoder.decode(this.bytes())}}function VR(a,e,i,s){let o;return{typeName:e,extendee:i,get field(){if(!o){const l=typeof s=="function"?s():s;l.name=e.split(".").pop(),l.jsonName="[".concat(e,"]"),o=a.util.newFieldList([l]).list()[0]}return o},runtime:a}}function p0(a){const e=a.field.localName,i=Object.create(null);return i[e]=FR(a),[i,()=>i[e]]}function FR(a){const e=a.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return gs(e.T,e.L);case"message":const i=e.T,s=new i;return i.fieldWrapper?i.fieldWrapper.unwrapField(s):s;case"map":throw"map fields are not allowed to be extensions"}}function GR(a,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let i=a.length-1;i>=0;--i)if(a[i].no==e.no)return[a[i]];return[]}return a.filter(i=>i.no===e.no)}let ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),$c=[];for(let a=0;a<ei.length;a++)$c[ei[a].charCodeAt(0)]=a;$c[45]=ei.indexOf("+");$c[95]=ei.indexOf("/");const g0={dec(a){let e=a.length*3/4;a[a.length-2]=="="?e-=2:a[a.length-1]=="="&&(e-=1);let i=new Uint8Array(e),s=0,o=0,l,u=0;for(let d=0;d<a.length;d++){if(l=$c[a.charCodeAt(d)],l===void 0)switch(a[d]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:u=l,o=1;break;case 1:i[s++]=u<<2|(l&48)>>4,u=l,o=2;break;case 2:i[s++]=(u&15)<<4|(l&60)>>2,u=l,o=3;break;case 3:i[s++]=(u&3)<<6|l,o=0;break}}if(o==1)throw Error("invalid base64 string.");return i.subarray(0,s)},enc(a){let e="",i=0,s,o=0;for(let l=0;l<a.length;l++)switch(s=a[l],i){case 0:e+=ei[s>>2],o=(s&3)<<4,i=1;break;case 1:e+=ei[o|s>>4],o=(s&15)<<2,i=2;break;case 2:e+=ei[o|s>>6],e+=ei[s&63],i=0;break}return i&&(e+=ei[o],e+="=",i==1&&(e+="=")),e}};function YR(a,e,i){y0(e,a);const s=e.runtime.bin.makeReadOptions(i),o=GR(a.getType().runtime.bin.listUnknownFields(a),e.field),[l,u]=p0(e);for(const d of o)e.runtime.bin.readField(l,s.readerFactory(d.data),e.field,d.wireType,s);return u()}function KR(a,e,i,s){y0(e,a);const o=e.runtime.bin.makeReadOptions(s),l=e.runtime.bin.makeWriteOptions(s);if(v0(a,e)){const h=a.getType().runtime.bin.listUnknownFields(a).filter(g=>g.no!=e.field.no);a.getType().runtime.bin.discardUnknownFields(a);for(const g of h)a.getType().runtime.bin.onUnknownField(a,g.no,g.wireType,g.data)}const u=l.writerFactory();let d=e.field;!d.opt&&!d.repeated&&(d.kind=="enum"||d.kind=="scalar")&&(d=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(d,i,u,l);const m=o.readerFactory(u.finish());for(;m.pos<m.len;){const[h,g]=m.tag(),v=m.skip(g,h);a.getType().runtime.bin.onUnknownField(a,h,g,v)}}function v0(a,e){const i=a.getType();return e.extendee.typeName===i.typeName&&!!i.runtime.bin.listUnknownFields(a).find(s=>s.no==e.field.no)}function y0(a,e){We(a.extendee.typeName==e.getType().typeName,"extension ".concat(a.typeName," can only be applied to message ").concat(a.extendee.typeName))}function b0(a,e){const i=a.localName;if(a.repeated)return e[i].length>0;if(a.oneof)return e[a.oneof.localName].case===i;switch(a.kind){case"enum":case"scalar":return a.opt||a.req?e[i]!==void 0:a.kind=="enum"?e[i]!==a.T.values[0].no:!m0(a.T,e[i]);case"message":return e[i]!==void 0;case"map":return Object.keys(e[i]).length>0}}function Rv(a,e){const i=a.localName,s=!a.opt&&!a.req;if(a.repeated)e[i]=[];else if(a.oneof)e[a.oneof.localName]={case:void 0};else switch(a.kind){case"map":e[i]={};break;case"enum":e[i]=s?a.T.values[0].no:void 0;break;case"scalar":e[i]=s?gs(a.T,a.L):void 0;break;case"message":e[i]=void 0;break}}function va(a,e){if(a===null||typeof a!="object"||!Object.getOwnPropertyNames(Vf.prototype).every(s=>s in a&&typeof a[s]=="function"))return!1;const i=a.getType();return i===null||typeof i!="function"||!("typeName"in i)||typeof i.typeName!="string"?!1:e===void 0?!0:i.typeName==e.typeName}function S0(a,e){return va(e)||!a.fieldWrapper?e:a.fieldWrapper.wrapField(e)}Y.DOUBLE,Y.FLOAT,Y.INT64,Y.UINT64,Y.INT32,Y.UINT32,Y.BOOL,Y.STRING,Y.BYTES;const _v={ignoreUnknownFields:!1},wv={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function QR(a){return a?Object.assign(Object.assign({},_v),a):_v}function XR(a){return a?Object.assign(Object.assign({},wv),a):wv}const Lc=Symbol(),Sc=Symbol();function JR(){return{makeReadOptions:QR,makeWriteOptions:XR,readMessage(a,e,i,s){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(a.typeName," from JSON: ").concat(Dn(e)));s=s??new a;const o=new Map,l=i.typeRegistry;for(const[u,d]of Object.entries(e)){const m=a.fields.findJsonName(u);if(m){if(m.oneof){if(d===null&&m.kind=="scalar")continue;const h=o.get(m.oneof);if(h!==void 0)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: multiple keys for oneof "').concat(m.oneof.name,'" present: "').concat(h,'", "').concat(u,'"'));o.set(m.oneof,u)}Ov(s,d,m,i,a)}else{let h=!1;if(l!=null&&l.findExtension&&u.startsWith("[")&&u.endsWith("]")){const g=l.findExtension(u.substring(1,u.length-1));if(g&&g.extendee.typeName==a.typeName){h=!0;const[v,b]=p0(g);Ov(v,d,g.field,i,g),KR(s,g,b(),i)}}if(!h&&!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: key "').concat(u,'" is unknown'))}}return s},writeMessage(a,e){const i=a.getType(),s={};let o;try{for(o of i.fields.byNumber()){if(!b0(o,a)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!WR(o))continue}const u=o.oneof?a[o.oneof.localName].value:a[o.localName],d=xv(o,u,e);d!==void 0&&(s[e.useProtoFieldName?o.name:o.jsonName]=d)}const l=e.typeRegistry;if(l!=null&&l.findExtensionFor)for(const u of i.runtime.bin.listUnknownFields(a)){const d=l.findExtensionFor(i.typeName,u.no);if(d&&v0(a,d)){const m=YR(a,d,e),h=xv(d.field,m,e);h!==void 0&&(s[d.field.jsonName]=h)}}}catch(l){const u=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),d=l instanceof Error?l.message:String(l);throw new Error(u+(d.length>0?": ".concat(d):""))}return s},readScalar(a,e,i){return Pr(a,e,i??zi.BIGINT,!0)},writeScalar(a,e,i){if(e!==void 0&&(i||m0(a,e)))return Tc(a,e)},debug:Dn}}function Dn(a){if(a===null)return"null";switch(typeof a){case"object":return Array.isArray(a)?"array":"object";case"string":return a.length>100?"string":'"'.concat(a.split('"').join('\\"'),'"');default:return String(a)}}function Ov(a,e,i,s,o){let l=i.localName;if(i.repeated){if(We(i.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e)));const u=a[l];for(const d of e){if(d===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(d)));switch(i.kind){case"message":u.push(i.T.fromJson(d,s));break;case"enum":const m=_d(i.T,d,s.ignoreUnknownFields,!0);m!==Sc&&u.push(m);break;case"scalar":try{u.push(Pr(i.T,d,i.L,!0))}catch(h){let g="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(d));throw h instanceof Error&&h.message.length>0&&(g+=": ".concat(h.message)),new Error(g)}break}}}else if(i.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e)));const u=a[l];for(const[d,m]of Object.entries(e)){if(m===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: map value null"));let h;try{h=ZR(i.K,d)}catch(g){let v="cannot decode map key for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e));throw g instanceof Error&&g.message.length>0&&(v+=": ".concat(g.message)),new Error(v)}switch(i.V.kind){case"message":u[h]=i.V.T.fromJson(m,s);break;case"enum":const g=_d(i.V.T,m,s.ignoreUnknownFields,!0);g!==Sc&&(u[h]=g);break;case"scalar":try{u[h]=Pr(i.V.T,m,zi.BIGINT,!0)}catch(v){let b="cannot decode map value for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e));throw v instanceof Error&&v.message.length>0&&(b+=": ".concat(v.message)),new Error(b)}break}}}else switch(i.oneof&&(a=a[i.oneof.localName]={case:l},l="value"),i.kind){case"message":const u=i.T;if(e===null&&u.typeName!="google.protobuf.Value")return;let d=a[l];va(d)?d.fromJson(e,s):(a[l]=d=u.fromJson(e,s),u.fieldWrapper&&!i.oneof&&(a[l]=u.fieldWrapper.unwrapField(d)));break;case"enum":const m=_d(i.T,e,s.ignoreUnknownFields,!1);switch(m){case Lc:Rv(i,a);break;case Sc:break;default:a[l]=m;break}break;case"scalar":try{const h=Pr(i.T,e,i.L,!1);switch(h){case Lc:Rv(i,a);break;default:a[l]=h;break}}catch(h){let g="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e));throw h instanceof Error&&h.message.length>0&&(g+=": ".concat(h.message)),new Error(g)}break}}function ZR(a,e){if(a===Y.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Pr(a,e,zi.BIGINT,!0).toString()}function Pr(a,e,i,s){if(e===null)return s?gs(a,i):Lc;switch(a){case Y.DOUBLE:case Y.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return a==Y.FLOAT&&o0(o),o;case Y.INT32:case Y.FIXED32:case Y.SFIXED32:case Y.SINT32:case Y.UINT32:let l;if(typeof e=="number"?l=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(l=Number(e)),l===void 0)break;return a==Y.UINT32||a==Y.FIXED32?ef(l):yc(l),l;case Y.INT64:case Y.SFIXED64:case Y.SINT64:if(typeof e!="number"&&typeof e!="string")break;const u=Fe.parse(e);return i?u.toString():u;case Y.FIXED64:case Y.UINT64:if(typeof e!="number"&&typeof e!="string")break;const d=Fe.uParse(e);return i?d.toString():d;case Y.BOOL:if(typeof e!="boolean")break;return e;case Y.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Y.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return g0.dec(e)}throw new Error}function _d(a,e,i,s){if(e===null)return a.typeName=="google.protobuf.NullValue"?0:s?a.values[0].no:Lc;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=a.findName(e);if(o!==void 0)return o.no;if(i)return Sc;break}throw new Error("cannot decode enum ".concat(a.typeName," from JSON: ").concat(Dn(e)))}function WR(a){return a.repeated||a.kind=="map"?!0:!(a.oneof||a.kind=="message"||a.opt||a.req)}function xv(a,e,i){if(a.kind=="map"){We(typeof e=="object"&&e!=null);const s={},o=Object.entries(e);switch(a.V.kind){case"scalar":for(const[u,d]of o)s[u.toString()]=Tc(a.V.T,d);break;case"message":for(const[u,d]of o)s[u.toString()]=d.toJson(i);break;case"enum":const l=a.V.T;for(const[u,d]of o)s[u.toString()]=wd(l,d,i.enumAsInteger);break}return i.emitDefaultValues||o.length>0?s:void 0}if(a.repeated){We(Array.isArray(e));const s=[];switch(a.kind){case"scalar":for(let o=0;o<e.length;o++)s.push(Tc(a.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)s.push(wd(a.T,e[o],i.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)s.push(e[o].toJson(i));break}return i.emitDefaultValues||s.length>0?s:void 0}switch(a.kind){case"scalar":return Tc(a.T,e);case"enum":return wd(a.T,e,i.enumAsInteger);case"message":return S0(a.T,e).toJson(i)}}function wd(a,e,i){var s;if(We(typeof e=="number"),a.typeName=="google.protobuf.NullValue")return null;if(i)return e;const o=a.findNumber(e);return(s=o==null?void 0:o.name)!==null&&s!==void 0?s:e}function Tc(a,e){switch(a){case Y.INT32:case Y.SFIXED32:case Y.SINT32:case Y.FIXED32:case Y.UINT32:return We(typeof e=="number"),e;case Y.FLOAT:case Y.DOUBLE:return We(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case Y.STRING:return We(typeof e=="string"),e;case Y.BOOL:return We(typeof e=="boolean"),e;case Y.UINT64:case Y.FIXED64:case Y.INT64:case Y.SFIXED64:case Y.SINT64:return We(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case Y.BYTES:return We(e instanceof Uint8Array),g0.enc(e)}}const rs=Symbol("@bufbuild/protobuf/unknown-fields"),Dv={readUnknownFields:!0,readerFactory:a=>new HR(a)},Av={writeUnknownFields:!0,writerFactory:()=>new qR};function $R(a){return a?Object.assign(Object.assign({},Dv),a):Dv}function e1(a){return a?Object.assign(Object.assign({},Av),a):Av}function t1(){return{makeReadOptions:$R,makeWriteOptions:e1,listUnknownFields(a){var e;return(e=a[rs])!==null&&e!==void 0?e:[]},discardUnknownFields(a){delete a[rs]},writeUnknownFields(a,e){const s=a[rs];if(s)for(const o of s)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(a,e,i,s){const o=a;Array.isArray(o[rs])||(o[rs]=[]),o[rs].push({no:e,wireType:i,data:s})},readMessage(a,e,i,s,o){const l=a.getType(),u=o?e.len:e.pos+i;let d,m;for(;e.pos<u&&([d,m]=e.tag(),!(o===!0&&m==tt.EndGroup));){const h=l.fields.find(d);if(!h){const g=e.skip(m,d);s.readUnknownFields&&this.onUnknownField(a,d,m,g);continue}Nv(a,e,h,m,s)}if(o&&(m!=tt.EndGroup||d!==i))throw new Error("invalid end group tag")},readField:Nv,writeMessage(a,e,i){const s=a.getType();for(const o of s.fields.byNumber()){if(!b0(o,a)){if(o.req)throw new Error("cannot encode field ".concat(s.typeName,".").concat(o.name," to binary: required field not set"));continue}const l=o.oneof?a[o.oneof.localName].value:a[o.localName];Pv(o,l,e,i)}return i.writeUnknownFields&&this.writeUnknownFields(a,e),e},writeField(a,e,i,s){e!==void 0&&Pv(a,e,i,s)}}}function Nv(a,e,i,s,o){let{repeated:l,localName:u}=i;switch(i.oneof&&(a=a[i.oneof.localName],a.case!=u&&delete a.value,a.case=u,u="value"),i.kind){case"scalar":case"enum":const d=i.kind=="enum"?Y.INT32:i.T;let m=jc;if(i.kind=="scalar"&&i.L>0&&(m=i1),l){let b=a[u];if(s==tt.LengthDelimited&&d!=Y.STRING&&d!=Y.BYTES){let T=e.uint32()+e.pos;for(;e.pos<T;)b.push(m(e,d))}else b.push(m(e,d))}else a[u]=m(e,d);break;case"message":const h=i.T;l?a[u].push(kc(e,new h,o,i)):va(a[u])?kc(e,a[u],o,i):(a[u]=kc(e,new h,o,i),h.fieldWrapper&&!i.oneof&&!i.repeated&&(a[u]=h.fieldWrapper.unwrapField(a[u])));break;case"map":let[g,v]=n1(i,e,o);a[u][g]=v;break}}function kc(a,e,i,s){const o=e.getType().runtime.bin,l=s==null?void 0:s.delimited;return o.readMessage(e,a,l?s.no:a.uint32(),i,l),e}function n1(a,e,i){const s=e.uint32(),o=e.pos+s;let l,u;for(;e.pos<o;){const[d]=e.tag();switch(d){case 1:l=jc(e,a.K);break;case 2:switch(a.V.kind){case"scalar":u=jc(e,a.V.T);break;case"enum":u=e.int32();break;case"message":u=kc(e,new a.V.T,i,void 0);break}break}}if(l===void 0&&(l=gs(a.K,zi.BIGINT)),typeof l!="string"&&typeof l!="number"&&(l=l.toString()),u===void 0)switch(a.V.kind){case"scalar":u=gs(a.V.T,zi.BIGINT);break;case"enum":u=a.V.T.values[0].no;break;case"message":u=new a.V.T;break}return[l,u]}function i1(a,e){const i=jc(a,e);return typeof i=="bigint"?i.toString():i}function jc(a,e){switch(e){case Y.STRING:return a.string();case Y.BOOL:return a.bool();case Y.DOUBLE:return a.double();case Y.FLOAT:return a.float();case Y.INT32:return a.int32();case Y.INT64:return a.int64();case Y.UINT64:return a.uint64();case Y.FIXED64:return a.fixed64();case Y.BYTES:return a.bytes();case Y.FIXED32:return a.fixed32();case Y.SFIXED32:return a.sfixed32();case Y.SFIXED64:return a.sfixed64();case Y.SINT64:return a.sint64();case Y.UINT32:return a.uint32();case Y.SINT32:return a.sint32()}}function Pv(a,e,i,s){We(e!==void 0);const o=a.repeated;switch(a.kind){case"scalar":case"enum":let l=a.kind=="enum"?Y.INT32:a.T;if(o)if(We(Array.isArray(e)),a.packed)s1(i,l,a.no,e);else for(const u of e)Mr(i,l,a.no,u);else Mr(i,l,a.no,e);break;case"message":if(o){We(Array.isArray(e));for(const u of e)Mv(i,s,a,u)}else Mv(i,s,a,e);break;case"map":We(typeof e=="object"&&e!=null);for(const[u,d]of Object.entries(e))a1(i,s,a,u,d);break}}function a1(a,e,i,s,o){a.tag(i.no,tt.LengthDelimited),a.fork();let l=s;switch(i.K){case Y.INT32:case Y.FIXED32:case Y.UINT32:case Y.SFIXED32:case Y.SINT32:l=Number.parseInt(s);break;case Y.BOOL:We(s=="true"||s=="false"),l=s=="true";break}switch(Mr(a,i.K,1,l),i.V.kind){case"scalar":Mr(a,i.V.T,2,o);break;case"enum":Mr(a,Y.INT32,2,o);break;case"message":We(o!==void 0),a.tag(2,tt.LengthDelimited).bytes(o.toBinary(e));break}a.join()}function Mv(a,e,i,s){const o=S0(i.T,s);i.delimited?a.tag(i.no,tt.StartGroup).raw(o.toBinary(e)).tag(i.no,tt.EndGroup):a.tag(i.no,tt.LengthDelimited).bytes(o.toBinary(e))}function Mr(a,e,i,s){We(s!==void 0);let[o,l]=T0(e);a.tag(i,o)[l](s)}function s1(a,e,i,s){if(!s.length)return;a.tag(i,tt.LengthDelimited).fork();let[,o]=T0(e);for(let l=0;l<s.length;l++)a[o](s[l]);a.join()}function T0(a){let e=tt.Varint;switch(a){case Y.BYTES:case Y.STRING:e=tt.LengthDelimited;break;case Y.DOUBLE:case Y.FIXED64:case Y.SFIXED64:e=tt.Bit64;break;case Y.FIXED32:case Y.SFIXED32:case Y.FLOAT:e=tt.Bit32;break}const i=Y[a].toLowerCase();return[e,i]}function r1(){return{setEnumType:l0,initPartial(a,e){if(a===void 0)return;const i=e.getType();for(const s of i.fields.byMember()){const o=s.localName,l=e,u=a;if(u[o]!=null)switch(s.kind){case"oneof":const d=u[o].case;if(d===void 0)continue;const m=s.findField(d);let h=u[o].value;m&&m.kind=="message"&&!va(h,m.T)?h=new m.T(h):m&&m.kind==="scalar"&&m.T===Y.BYTES&&(h=wr(h)),l[o]={case:d,value:h};break;case"scalar":case"enum":let g=u[o];s.T===Y.BYTES&&(g=s.repeated?g.map(wr):wr(g)),l[o]=g;break;case"map":switch(s.V.kind){case"scalar":case"enum":if(s.V.T===Y.BYTES)for(const[k,T]of Object.entries(u[o]))l[o][k]=wr(T);else Object.assign(l[o],u[o]);break;case"message":const b=s.V.T;for(const k of Object.keys(u[o])){let T=u[o][k];b.fieldWrapper||(T=new b(T)),l[o][k]=T}break}break;case"message":const v=s.T;if(s.repeated)l[o]=u[o].map(b=>va(b,v)?b:new v(b));else{const b=u[o];v.fieldWrapper?v.typeName==="google.protobuf.BytesValue"?l[o]=wr(b):l[o]=b:l[o]=va(b,v)?b:new v(b)}break}}},equals(a,e,i){return e===i?!0:!e||!i?!1:a.fields.byMember().every(s=>{const o=e[s.localName],l=i[s.localName];if(s.repeated){if(o.length!==l.length)return!1;switch(s.kind){case"message":return o.every((u,d)=>s.T.equals(u,l[d]));case"scalar":return o.every((u,d)=>Ai(s.T,u,l[d]));case"enum":return o.every((u,d)=>Ai(Y.INT32,u,l[d]))}throw new Error("repeated cannot contain ".concat(s.kind))}switch(s.kind){case"message":return s.T.equals(o,l);case"enum":return Ai(Y.INT32,o,l);case"scalar":return Ai(s.T,o,l);case"oneof":if(o.case!==l.case)return!1;const u=s.findField(o.case);if(u===void 0)return!0;switch(u.kind){case"message":return u.T.equals(o.value,l.value);case"enum":return Ai(Y.INT32,o.value,l.value);case"scalar":return Ai(u.T,o.value,l.value)}throw new Error("oneof cannot contain ".concat(u.kind));case"map":const d=Object.keys(o).concat(Object.keys(l));switch(s.V.kind){case"message":const m=s.V.T;return d.every(g=>m.equals(o[g],l[g]));case"enum":return d.every(g=>Ai(Y.INT32,o[g],l[g]));case"scalar":const h=s.V.T;return d.every(g=>Ai(h,o[g],l[g]))}break}})},clone(a){const e=a.getType(),i=new e,s=i;for(const o of e.fields.byMember()){const l=a[o.localName];let u;if(o.repeated)u=l.map(lc);else if(o.kind=="map"){u=s[o.localName];for(const[d,m]of Object.entries(l))u[d]=lc(m)}else o.kind=="oneof"?u=o.findField(l.case)?{case:l.case,value:lc(l.value)}:{case:void 0}:u=lc(l);s[o.localName]=u}for(const o of e.runtime.bin.listUnknownFields(a))e.runtime.bin.onUnknownField(s,o.no,o.wireType,o.data);return i}}}function lc(a){if(a===void 0)return a;if(va(a))return a.clone();if(a instanceof Uint8Array){const e=new Uint8Array(a.byteLength);return e.set(a),e}return a}function wr(a){return a instanceof Uint8Array?a:new Uint8Array(a)}function o1(a,e,i){return{syntax:a,json:JR(),bin:t1(),util:Object.assign(Object.assign({},r1()),{newFieldList:e,initFields:i}),makeMessageType(s,o,l){return UR(this,s,o,l)},makeEnum:MR,makeEnumType:u0,getEnumType:PR,makeExtension(s,o,l){return VR(this,s,o,l)}}}class c1{constructor(e,i){this._fields=e,this._normalizer=i}findJsonName(e){if(!this.jsonNames){const i={};for(const s of this.list())i[s.jsonName]=i[s.name]=s;this.jsonNames=i}return this.jsonNames[e]}find(e){if(!this.numbers){const i={};for(const s of this.list())i[s.no]=s;this.numbers=i}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,i)=>e.no-i.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let i;for(const s of this.list())s.oneof?s.oneof!==i&&(i=s.oneof,e.push(i)):e.push(s)}return this.members}}function k0(a,e){const i=C0(a);return e?i:m1(h1(i))}function l1(a){return k0(a,!1)}const u1=C0;function C0(a){let e=!1;const i=[];for(let s=0;s<a.length;s++){let o=a.charAt(s);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),i.push(o);break}}return i.join("")}const d1=new Set(["constructor","toString","toJSON","valueOf"]),f1=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),E0=a=>"".concat(a,"$"),h1=a=>f1.has(a)?E0(a):a,m1=a=>d1.has(a)?E0(a):a;class p1{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=l1(e)}addField(e){We(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let i=0;i<this.fields.length;i++)this._lookup[this.fields[i].localName]=this.fields[i]}return this._lookup[e]}}function g1(a,e){var i,s,o,l,u,d;const m=[];let h;for(const g of typeof a=="function"?a():a){const v=g;if(v.localName=k0(g.name,g.oneof!==void 0),v.jsonName=(i=g.jsonName)!==null&&i!==void 0?i:u1(g.name),v.repeated=(s=g.repeated)!==null&&s!==void 0?s:!1,g.kind=="scalar"&&(v.L=(o=g.L)!==null&&o!==void 0?o:zi.BIGINT),v.delimited=(l=g.delimited)!==null&&l!==void 0?l:!1,v.req=(u=g.req)!==null&&u!==void 0?u:!1,v.opt=(d=g.opt)!==null&&d!==void 0?d:!1,g.packed===void 0&&(v.packed=g.kind=="enum"||g.kind=="scalar"&&g.T!=Y.BYTES&&g.T!=Y.STRING),g.oneof!==void 0){const b=typeof g.oneof=="string"?g.oneof:g.oneof.name;(!h||h.name!=b)&&(h=new p1(b)),v.oneof=h,h.addField(v)}m.push(v)}return m}const I=o1("proto3",a=>new c1(a,e=>g1(e)),a=>{for(const e of a.getType().fields.byMember()){if(e.opt)continue;const i=e.localName,s=a;if(e.repeated){s[i]=[];continue}switch(e.kind){case"oneof":s[i]={case:void 0};break;case"enum":s[i]=0;break;case"map":s[i]={};break;case"scalar":s[i]=gs(e.T,e.L);break}}});class Mt extends Vf{constructor(e){super(),this.seconds=Fe.zero,this.nanos=0,I.util.initPartial(e,this)}fromJson(e,i){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(I.json.debug(e)));const s=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!s)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(s[1]+"-"+s[2]+"-"+s[3]+"T"+s[4]+":"+s[5]+":"+s[6]+(s[8]?s[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Fe.parse(o/1e3),this.nanos=0,s[7]&&(this.nanos=parseInt("1"+s[7]+"0".repeat(9-s[7].length))-1e9),this}toJson(e){const i=Number(this.seconds)*1e3;if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let s="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?s="."+o.substring(0,3)+"Z":o.substring(6)==="000"?s="."+o.substring(0,6)+"Z":s="."+o+"Z"}return new Date(i).toISOString().replace(".000Z",s)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Mt.fromDate(new Date)}static fromDate(e){const i=e.getTime();return new Mt({seconds:Fe.parse(Math.floor(i/1e3)),nanos:i%1e3*1e6})}static fromBinary(e,i){return new Mt().fromBinary(e,i)}static fromJson(e,i){return new Mt().fromJson(e,i)}static fromJsonString(e,i){return new Mt().fromJsonString(e,i)}static equals(e,i){return I.util.equals(Mt,e,i)}}Mt.runtime=I;Mt.typeName="google.protobuf.Timestamp";Mt.fields=I.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const v1=I.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Mt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:y1,repeated:!0},{no:5,name:"events",kind:"message",T:S1,repeated:!0}]),y1=I.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:b1,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),b1=I.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Mt},{no:3,name:"value",kind:"scalar",T:2}]),S1=I.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Mt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Mt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),R0=I.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"REGRESSION"},{no:1,name:"SIMULCAST"}]),gn=I.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),ot=I.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),Gf=I.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Nr=I.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Br=I.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),yn=I.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),os=I.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),T1=I.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),An=I.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),Yf=I.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:Ic,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:j0}]),Ic=I.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),k1=I.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:I.getEnumType(ot),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),zr=I.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:I.getEnumType(tf)},{no:4,name:"tracks",kind:"message",T:ls,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:k1},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:I.getEnumType(Bc)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:I.getEnumType(yn)}]),tf=I.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Bc=I.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),Yt=I.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),C1=I.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ya,repeated:!0}]),ls=I.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:I.getEnumType(gn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:I.getEnumType(ot)},{no:10,name:"layers",kind:"message",T:ya,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:C1,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:I.getEnumType(Yt)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:j0},{no:19,name:"audio_features",kind:"enum",T:I.getEnumType(An),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:I.getEnumType(R0)}]),ya=I.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:I.getEnumType(Gf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),Pt=I.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:I.getEnumType(we)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:w0,oneof:"value"},{no:3,name:"speaker",kind:"message",T:E1,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:O0,oneof:"value"},{no:7,name:"transcription",kind:"message",T:R1,oneof:"value"},{no:8,name:"metrics",kind:"message",T:v1,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:nf,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:x0,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:D0,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:A0,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:sf,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:rf,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:of,oneof:"value"}]),we=I.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),E1=I.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:_0,repeated:!0}]),_0=I.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),w0=I.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),O0=I.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),R1=I.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:_1,repeated:!0}]),_1=I.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),nf=I.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),x0=I.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),D0=I.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),A0=I.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:N0,oneof:"value"}]),N0=I.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),P0=I.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),w1=I.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:I.getEnumType(M0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),M0=I.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),O1=I.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:I.getEnumType(U0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),U0=I.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),L0=I.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Uv},{no:2,name:"screen",kind:"message",T:Uv},{no:3,name:"resume_connection",kind:"enum",T:I.getEnumType(Br)},{no:4,name:"disabled_codecs",kind:"message",T:x1},{no:5,name:"force_relay",kind:"enum",T:I.getEnumType(Br)}]),Uv=I.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:I.getEnumType(Br)}]),x1=I.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:Ic,repeated:!0},{no:2,name:"publish",kind:"message",T:Ic,repeated:!0}]),j0=I.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),af=I.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),I0=I.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:I.getEnumType(af)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),B0=I.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),sf=I.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:I.getEnumType(Yt)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:I0,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:B0,oneof:"content_header"}],{localName:"DataStream_Header"}),rf=I.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),of=I.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),vn=I.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),cf=I.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),D1=I.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),A1=I.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Sa,oneof:"message"},{no:2,name:"answer",kind:"message",T:Sa,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Kf,oneof:"message"},{no:4,name:"add_track",kind:"message",T:uf,oneof:"message"},{no:5,name:"mute",kind:"message",T:Qf,oneof:"message"},{no:6,name:"subscription",kind:"message",T:el,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:z0,oneof:"message"},{no:8,name:"leave",kind:"message",T:tl,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:H0,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Y0,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:K0,oneof:"message"},{no:13,name:"simulate",kind:"message",T:xn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:V0,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:X0,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:q0,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:L1,oneof:"message"}]),Lv=I.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:N1,oneof:"message"},{no:2,name:"answer",kind:"message",T:Sa,oneof:"message"},{no:3,name:"offer",kind:"message",T:Sa,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Kf,oneof:"message"},{no:5,name:"update",kind:"message",T:U1,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Xf,oneof:"message"},{no:8,name:"leave",kind:"message",T:tl,oneof:"message"},{no:9,name:"mute",kind:"message",T:Qf,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:j1,oneof:"message"},{no:11,name:"room_update",kind:"message",T:I1,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:z1,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:H1,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:F1,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:G1,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:M1,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:P1,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Y1,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:X1,oneof:"message"},{no:22,name:"request_response",kind:"message",T:J1,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:Z1,oneof:"message"}]),lf=I.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),uf=I.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:I.getEnumType(gn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:I.getEnumType(ot)},{no:9,name:"layers",kind:"message",T:ya,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:lf,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:I.getEnumType(Yt)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:I.getEnumType(R0)}]),Kf=I.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:I.getEnumType(vn)},{no:3,name:"final",kind:"scalar",T:8}]),Qf=I.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),N1=I.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Yf},{no:2,name:"participant",kind:"message",T:zr},{no:3,name:"other_participants",kind:"message",T:zr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:F0,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:L0},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:w1},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:Ic,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),P1=I.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:F0,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:L0}]),Xf=I.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ls}]),M1=I.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Sa=I.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),U1=I.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:zr,repeated:!0}]),el=I.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:P0,repeated:!0}]),z0=I.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:I.getEnumType(Gf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),q0=I.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:I.getEnumType(An),repeated:!0}]),L1=I.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),tl=I.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:I.getEnumType(yn)},{no:3,name:"action",kind:"enum",T:I.getEnumType(ds)},{no:4,name:"regions",kind:"message",T:K1}]),ds=I.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),H0=I.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ya,repeated:!0}]),V0=I.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),F0=I.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),j1=I.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:_0,repeated:!0}]),I1=I.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Yf}]),B1=I.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:I.getEnumType(Nr)},{no:3,name:"score",kind:"scalar",T:2}]),z1=I.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:B1,repeated:!0}]),q1=I.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:I.getEnumType(cf)}]),H1=I.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:q1,repeated:!0}]),Jf=I.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:I.getEnumType(Gf)},{no:2,name:"enabled",kind:"scalar",T:8}]),V1=I.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Jf,repeated:!0}]),F1=I.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Jf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:V1,repeated:!0}]),G0=I.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Y0=I.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:G0,repeated:!0}]),G1=I.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),K0=I.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Sa},{no:2,name:"subscription",kind:"message",T:el},{no:3,name:"publish_tracks",kind:"message",T:Xf,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Q0,repeated:!0},{no:5,name:"offer",kind:"message",T:Sa},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),Q0=I.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:I.getEnumType(vn)}]),xn=I.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:I.getEnumType(D1),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),X0=I.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Y1=I.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),K1=I.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:Q1,repeated:!0}]),Q1=I.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),X1=I.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:I.getEnumType(T1)}]),J1=I.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:I.getEnumType(Zf)},{no:3,name:"message",kind:"scalar",T:9}]),Zf=I.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),Z1=I.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function W1(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Cc={exports:{}},$1=Cc.exports,jv;function e_(){return jv||(jv=1,function(a){(function(e,i){a.exports?a.exports=i():e.log=i()})($1,function(){var e=function(){},i="undefined",s=typeof window!==i&&typeof window.navigator!==i&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],l={},u=null;function d(E,_){var O=E[_];if(typeof O.bind=="function")return O.bind(E);try{return Function.prototype.bind.call(O,E)}catch{return function(){return Function.prototype.apply.apply(O,[E,arguments])}}}function m(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(E){return E==="debug"&&(E="log"),typeof console===i?!1:E==="trace"&&s?m:console[E]!==void 0?d(console,E):console.log!==void 0?d(console,"log"):e}function g(){for(var E=this.getLevel(),_=0;_<o.length;_++){var O=o[_];this[O]=_<E?e:this.methodFactory(O,E,this.name)}if(this.log=this.debug,typeof console===i&&E<this.levels.SILENT)return"No console available for logging"}function v(E){return function(){typeof console!==i&&(g.call(this),this[E].apply(this,arguments))}}function b(E,_,O){return h(E)||v.apply(this,arguments)}function k(E,_){var O=this,q,j,M,x="loglevel";typeof E=="string"?x+=":"+E:typeof E=="symbol"&&(x=void 0);function F(le){var Oe=(o[le]||"silent").toUpperCase();if(!(typeof window===i||!x)){try{window.localStorage[x]=Oe;return}catch{}try{window.document.cookie=encodeURIComponent(x)+"="+Oe+";"}catch{}}}function W(){var le;if(!(typeof window===i||!x)){try{le=window.localStorage[x]}catch{}if(typeof le===i)try{var Oe=window.document.cookie,dt=encodeURIComponent(x),xt=Oe.indexOf(dt+"=");xt!==-1&&(le=/^([^;]+)/.exec(Oe.slice(xt+dt.length+1))[1])}catch{}return O.levels[le]===void 0&&(le=void 0),le}}function ae(){if(!(typeof window===i||!x)){try{window.localStorage.removeItem(x)}catch{}try{window.document.cookie=encodeURIComponent(x)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function X(le){var Oe=le;if(typeof Oe=="string"&&O.levels[Oe.toUpperCase()]!==void 0&&(Oe=O.levels[Oe.toUpperCase()]),typeof Oe=="number"&&Oe>=0&&Oe<=O.levels.SILENT)return Oe;throw new TypeError("log.setLevel() called with invalid level: "+le)}O.name=E,O.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},O.methodFactory=_||b,O.getLevel=function(){return M??j??q},O.setLevel=function(le,Oe){return M=X(le),Oe!==!1&&F(M),g.call(O)},O.setDefaultLevel=function(le){j=X(le),W()||O.setLevel(le,!1)},O.resetLevel=function(){M=null,ae(),g.call(O)},O.enableAll=function(le){O.setLevel(O.levels.TRACE,le)},O.disableAll=function(le){O.setLevel(O.levels.SILENT,le)},O.rebuild=function(){if(u!==O&&(q=X(u.getLevel())),g.call(O),u===O)for(var le in l)l[le].rebuild()},q=X(u?u.getLevel():"WARN");var ee=W();ee!=null&&(M=X(ee)),g.call(O)}u=new k,u.getLogger=function(_){if(typeof _!="symbol"&&typeof _!="string"||_==="")throw new TypeError("You must supply a name when creating a logger.");var O=l[_];return O||(O=l[_]=new k(_,u.methodFactory)),O};var T=typeof window!==i?window.log:void 0;return u.noConflict=function(){return typeof window!==i&&window.log===u&&(window.log=T),u},u.getLoggers=function(){return l},u.default=u,u})}(Cc)),Cc.exports}var nl=e_(),df;(function(a){a[a.trace=0]="trace",a[a.debug=1]="debug",a[a.info=2]="info",a[a.warn=3]="warn",a[a.error=4]="error",a[a.silent=5]="silent"})(df||(df={}));var bn;(function(a){a.Default="livekit",a.Room="livekit-room",a.Participant="livekit-participant",a.Track="livekit-track",a.Publication="livekit-track-publication",a.Engine="livekit-engine",a.Signal="livekit-signal",a.PCManager="livekit-pc-manager",a.PCTransport="livekit-pc-transport",a.E2EE="lk-e2ee"})(bn||(bn={}));let Ce=nl.getLogger("livekit");Object.values(bn).map(a=>nl.getLogger(a));Ce.setDefaultLevel(df.info);function ai(a){const e=nl.getLogger(a);return e.setDefaultLevel(Ce.getLevel()),e}const t_=nl.getLogger("lk-e2ee"),Or=7e3,n_=[0,300,2*2*300,3*3*300,4*4*300,Or,Or,Or,Or,Or];class i_{constructor(e){this._retryDelays=e!==void 0?[...e]:n_}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const i=this._retryDelays[e.retryCount];return e.retryCount<=1?i:i+Math.random()*1e3}}function a_(a,e){var i={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(i[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(a);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(a,s[o])&&(i[s[o]]=a[s[o]]);return i}function w(a,e,i,s){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function d(g){try{h(s.next(g))}catch(v){u(v)}}function m(g){try{h(s.throw(g))}catch(v){u(v)}}function h(g){g.done?l(g.value):o(g.value).then(d,m)}h((s=s.apply(a,e||[])).next())})}function Iv(a){var e=typeof Symbol=="function"&&Symbol.iterator,i=e&&a[e],s=0;if(i)return i.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&s>=a.length&&(a=void 0),{value:a&&a[s++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ui(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],i;return e?e.call(a):(a=typeof Iv=="function"?Iv(a):a[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(l){i[l]=a[l]&&function(u){return new Promise(function(d,m){u=a[l](u),o(d,m,u.done,u.value)})}}function o(l,u,d,m){Promise.resolve(m).then(function(h){l({value:h,done:d})},u)}}var uc={exports:{}},Bv;function s_(){if(Bv)return uc.exports;Bv=1;var a=typeof Reflect=="object"?Reflect:null,e=a&&typeof a.apply=="function"?a.apply:function(x,F,W){return Function.prototype.apply.call(x,F,W)},i;a&&typeof a.ownKeys=="function"?i=a.ownKeys:Object.getOwnPropertySymbols?i=function(x){return Object.getOwnPropertyNames(x).concat(Object.getOwnPropertySymbols(x))}:i=function(x){return Object.getOwnPropertyNames(x)};function s(M){console&&console.warn&&console.warn(M)}var o=Number.isNaN||function(x){return x!==x};function l(){l.init.call(this)}uc.exports=l,uc.exports.once=O,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var u=10;function d(M){if(typeof M!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof M)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(M){if(typeof M!="number"||M<0||o(M))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+M+".");u=M}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(x){if(typeof x!="number"||x<0||o(x))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+x+".");return this._maxListeners=x,this};function m(M){return M._maxListeners===void 0?l.defaultMaxListeners:M._maxListeners}l.prototype.getMaxListeners=function(){return m(this)},l.prototype.emit=function(x){for(var F=[],W=1;W<arguments.length;W++)F.push(arguments[W]);var ae=x==="error",X=this._events;if(X!==void 0)ae=ae&&X.error===void 0;else if(!ae)return!1;if(ae){var ee;if(F.length>0&&(ee=F[0]),ee instanceof Error)throw ee;var le=new Error("Unhandled error."+(ee?" ("+ee.message+")":""));throw le.context=ee,le}var Oe=X[x];if(Oe===void 0)return!1;if(typeof Oe=="function")e(Oe,this,F);else for(var dt=Oe.length,xt=T(Oe,dt),W=0;W<dt;++W)e(xt[W],this,F);return!0};function h(M,x,F,W){var ae,X,ee;if(d(F),X=M._events,X===void 0?(X=M._events=Object.create(null),M._eventsCount=0):(X.newListener!==void 0&&(M.emit("newListener",x,F.listener?F.listener:F),X=M._events),ee=X[x]),ee===void 0)ee=X[x]=F,++M._eventsCount;else if(typeof ee=="function"?ee=X[x]=W?[F,ee]:[ee,F]:W?ee.unshift(F):ee.push(F),ae=m(M),ae>0&&ee.length>ae&&!ee.warned){ee.warned=!0;var le=new Error("Possible EventEmitter memory leak detected. "+ee.length+" "+String(x)+" listeners added. Use emitter.setMaxListeners() to increase limit");le.name="MaxListenersExceededWarning",le.emitter=M,le.type=x,le.count=ee.length,s(le)}return M}l.prototype.addListener=function(x,F){return h(this,x,F,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(x,F){return h(this,x,F,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(M,x,F){var W={fired:!1,wrapFn:void 0,target:M,type:x,listener:F},ae=g.bind(W);return ae.listener=F,W.wrapFn=ae,ae}l.prototype.once=function(x,F){return d(F),this.on(x,v(this,x,F)),this},l.prototype.prependOnceListener=function(x,F){return d(F),this.prependListener(x,v(this,x,F)),this},l.prototype.removeListener=function(x,F){var W,ae,X,ee,le;if(d(F),ae=this._events,ae===void 0)return this;if(W=ae[x],W===void 0)return this;if(W===F||W.listener===F)--this._eventsCount===0?this._events=Object.create(null):(delete ae[x],ae.removeListener&&this.emit("removeListener",x,W.listener||F));else if(typeof W!="function"){for(X=-1,ee=W.length-1;ee>=0;ee--)if(W[ee]===F||W[ee].listener===F){le=W[ee].listener,X=ee;break}if(X<0)return this;X===0?W.shift():E(W,X),W.length===1&&(ae[x]=W[0]),ae.removeListener!==void 0&&this.emit("removeListener",x,le||F)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(x){var F,W,ae;if(W=this._events,W===void 0)return this;if(W.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):W[x]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete W[x]),this;if(arguments.length===0){var X=Object.keys(W),ee;for(ae=0;ae<X.length;++ae)ee=X[ae],ee!=="removeListener"&&this.removeAllListeners(ee);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(F=W[x],typeof F=="function")this.removeListener(x,F);else if(F!==void 0)for(ae=F.length-1;ae>=0;ae--)this.removeListener(x,F[ae]);return this};function b(M,x,F){var W=M._events;if(W===void 0)return[];var ae=W[x];return ae===void 0?[]:typeof ae=="function"?F?[ae.listener||ae]:[ae]:F?_(ae):T(ae,ae.length)}l.prototype.listeners=function(x){return b(this,x,!0)},l.prototype.rawListeners=function(x){return b(this,x,!1)},l.listenerCount=function(M,x){return typeof M.listenerCount=="function"?M.listenerCount(x):k.call(M,x)},l.prototype.listenerCount=k;function k(M){var x=this._events;if(x!==void 0){var F=x[M];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function T(M,x){for(var F=new Array(x),W=0;W<x;++W)F[W]=M[W];return F}function E(M,x){for(;x+1<M.length;x++)M[x]=M[x+1];M.pop()}function _(M){for(var x=new Array(M.length),F=0;F<x.length;++F)x[F]=M[F].listener||M[F];return x}function O(M,x){return new Promise(function(F,W){function ae(ee){M.removeListener(x,X),W(ee)}function X(){typeof M.removeListener=="function"&&M.removeListener("error",ae),F([].slice.call(arguments))}j(M,x,X,{once:!0}),x!=="error"&&q(M,ae,{once:!0})})}function q(M,x,F){typeof M.on=="function"&&j(M,"error",x,F)}function j(M,x,F,W){if(typeof M.on=="function")W.once?M.once(x,F):M.on(x,F);else if(typeof M.addEventListener=="function")M.addEventListener(x,function ae(X){W.once&&M.removeEventListener(x,ae),F(X)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof M)}return uc.exports}var Ln=s_();let J0=!0,Z0=!0;function Ec(a,e,i){const s=a.match(e);return s&&s.length>=i&&parseInt(s[i],10)}function ka(a,e,i){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,o=s.addEventListener;s.addEventListener=function(u,d){if(u!==e)return o.apply(this,arguments);const m=h=>{const g=i(h);g&&(d.handleEvent?d.handleEvent(g):d(g))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,m),o.apply(this,[u,m])};const l=s.removeEventListener;s.removeEventListener=function(u,d){if(u!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(d))return l.apply(this,arguments);const m=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[u,m])},Object.defineProperty(s,"on"+e,{get(){return this["_on"+e]},set(u){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),u&&this.addEventListener(e,this["_on"+e]=u)},enumerable:!0,configurable:!0})}function r_(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(J0=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function o_(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(Z0=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function W0(){if(typeof window=="object"){if(J0)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Wf(a,e){Z0&&console.warn(a+" is deprecated, please use "+e+" instead.")}function c_(a){const e={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:i}=a;if(i.userAgentData&&i.userAgentData.brands){const s=i.userAgentData.brands.find(o=>o.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(i.mozGetUserMedia)e.browser="firefox",e.version=Ec(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)e.browser="chrome",e.version=Ec(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(a.RTCPeerConnection&&i.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Ec(i.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function zv(a){return Object.prototype.toString.call(a)==="[object Object]"}function $0(a){return zv(a)?Object.keys(a).reduce(function(e,i){const s=zv(a[i]),o=s?$0(a[i]):a[i],l=s&&!Object.keys(o).length;return o===void 0||l?e:Object.assign(e,{[i]:o})},{}):a}function ff(a,e,i){!e||i.has(e.id)||(i.set(e.id,e),Object.keys(e).forEach(s=>{s.endsWith("Id")?ff(a,a.get(e[s]),i):s.endsWith("Ids")&&e[s].forEach(o=>{ff(a,a.get(o),i)})}))}function qv(a,e,i){const s=i?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const l=[];return a.forEach(u=>{u.type==="track"&&u.trackIdentifier===e.id&&l.push(u)}),l.forEach(u=>{a.forEach(d=>{d.type===s&&d.trackId===u.id&&ff(a,d,o)})}),o}const Hv=W0;function eb(a,e){const i=a&&a.navigator;if(!i.mediaDevices)return;const s=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const m={};return Object.keys(d).forEach(h=>{if(h==="require"||h==="advanced"||h==="mediaSource")return;const g=typeof d[h]=="object"?d[h]:{ideal:d[h]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const v=function(b,k){return b?b+k.charAt(0).toUpperCase()+k.slice(1):k==="deviceId"?"sourceId":k};if(g.ideal!==void 0){m.optional=m.optional||[];let b={};typeof g.ideal=="number"?(b[v("min",h)]=g.ideal,m.optional.push(b),b={},b[v("max",h)]=g.ideal,m.optional.push(b)):(b[v("",h)]=g.ideal,m.optional.push(b))}g.exact!==void 0&&typeof g.exact!="number"?(m.mandatory=m.mandatory||{},m.mandatory[v("",h)]=g.exact):["min","max"].forEach(b=>{g[b]!==void 0&&(m.mandatory=m.mandatory||{},m.mandatory[v(b,h)]=g[b])})}),d.advanced&&(m.optional=(m.optional||[]).concat(d.advanced)),m},o=function(d,m){if(e.version>=61)return m(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const h=function(g,v,b){v in g&&!(b in g)&&(g[b]=g[v],delete g[v])};d=JSON.parse(JSON.stringify(d)),h(d.audio,"autoGainControl","googAutoGainControl"),h(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=s(d.audio)}if(d&&typeof d.video=="object"){let h=d.video.facingMode;h=h&&(typeof h=="object"?h:{ideal:h});const g=e.version<66;if(h&&(h.exact==="user"||h.exact==="environment"||h.ideal==="user"||h.ideal==="environment")&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete d.video.facingMode;let v;if(h.exact==="environment"||h.ideal==="environment"?v=["back","rear"]:(h.exact==="user"||h.ideal==="user")&&(v=["front"]),v)return i.mediaDevices.enumerateDevices().then(b=>{b=b.filter(T=>T.kind==="videoinput");let k=b.find(T=>v.some(E=>T.label.toLowerCase().includes(E)));return!k&&b.length&&v.includes("back")&&(k=b[b.length-1]),k&&(d.video.deviceId=h.exact?{exact:k.deviceId}:{ideal:k.deviceId}),d.video=s(d.video),Hv("chrome: "+JSON.stringify(d)),m(d)})}d.video=s(d.video)}return Hv("chrome: "+JSON.stringify(d)),m(d)},l=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},u=function(d,m,h){o(d,g=>{i.webkitGetUserMedia(g,m,v=>{h&&h(l(v))})})};if(i.getUserMedia=u.bind(i),i.mediaDevices.getUserMedia){const d=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(m){return o(m,h=>d(h).then(g=>{if(h.audio&&!g.getAudioTracks().length||h.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(l(g))))}}}function tb(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function nb(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===o.track.id):l={track:o.track};const u=new Event("track");u.track=o.track,u.receiver=l,u.transceiver={receiver:l},u.streams=[s.stream],this.dispatchEvent(u)}),s.stream.getTracks().forEach(o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===o.id):l={track:o};const u=new Event("track");u.track=o,u.receiver=l,u.transceiver={receiver:l},u.streams=[s.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else ka(a,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function ib(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const e=function(o,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=o.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:o}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(d,m){let h=o.apply(this,arguments);return h||(h=e(this,d),this._senders.push(h)),h};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(d){l.apply(this,arguments);const m=this._senders.indexOf(d);m!==-1&&this._senders.splice(m,1)}}const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],i.apply(this,[l]),l.getTracks().forEach(u=>{this._senders.push(e(this,u))})};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],s.apply(this,[l]),l.getTracks().forEach(u=>{const d=this._senders.find(m=>m.track===u);d&&this._senders.splice(this._senders.indexOf(d),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const e=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ab(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const i=a.RTCPeerConnection.prototype.getSenders;i&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=i.apply(this,[]);return l.forEach(u=>u._pc=this),l});const s=a.RTCPeerConnection.prototype.addTrack;s&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(u=>qv(u,l.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const i=a.RTCPeerConnection.prototype.getReceivers;i&&(a.RTCPeerConnection.prototype.getReceivers=function(){const o=i.apply(this,[]);return o.forEach(l=>l._pc=this),o}),ka(a,"track",s=>(s.receiver._pc=s.srcElement,s)),a.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(l=>qv(l,o.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const s=arguments[0];let o,l,u;return this.getSenders().forEach(d=>{d.track===s&&(o?u=!0:o=d)}),this.getReceivers().forEach(d=>(d.track===s&&(l?u=!0:l=d),d.track===s)),u||o&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function sb(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(u,d){if(!d)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const m=e.apply(this,arguments);return this._shimmedLocalStreams[d.id]?this._shimmedLocalStreams[d.id].indexOf(m)===-1&&this._shimmedLocalStreams[d.id].push(m):this._shimmedLocalStreams[d.id]=[d,m],m};const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(v=>v.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const d=this.getSenders();i.apply(this,arguments);const m=this.getSenders().filter(h=>d.indexOf(h)===-1);this._shimmedLocalStreams[u.id]=[u].concat(m)};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],s.apply(this,arguments)};const o=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(d=>{const m=this._shimmedLocalStreams[d].indexOf(u);m!==-1&&this._shimmedLocalStreams[d].splice(m,1),this._shimmedLocalStreams[d].length===1&&delete this._shimmedLocalStreams[d]}),o.apply(this,arguments)}}function rb(a,e){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&e.version>=65)return sb(a);const i=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const g=i.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(v=>this._reverseStreams[v.id])};const s=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(v=>{if(this.getSenders().find(k=>k.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const v=new a.MediaStream(g.getTracks());this._streams[g.id]=v,this._reverseStreams[v.id]=g,g=v}s.apply(this,[g])};const o=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},a.RTCPeerConnection.prototype.addTrack=function(g,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find(E=>E===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(E=>E.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const T=this._streams[v.id];if(T)T.addTrack(g),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const E=new a.MediaStream([g]);this._streams[v.id]=E,this._reverseStreams[E.id]=v,this.addStream(E)}return this.getSenders().find(E=>E.track===g)};function l(h,g){let v=g.sdp;return Object.keys(h._reverseStreams||[]).forEach(b=>{const k=h._reverseStreams[b],T=h._streams[k.id];v=v.replace(new RegExp(T.id,"g"),k.id)}),new RTCSessionDescription({type:g.type,sdp:v})}function u(h,g){let v=g.sdp;return Object.keys(h._reverseStreams||[]).forEach(b=>{const k=h._reverseStreams[b],T=h._streams[k.id];v=v.replace(new RegExp(k.id,"g"),T.id)}),new RTCSessionDescription({type:g.type,sdp:v})}["createOffer","createAnswer"].forEach(function(h){const g=a.RTCPeerConnection.prototype[h],v={[h](){const b=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[T=>{const E=l(this,T);b[0].apply(null,[E])},T=>{b[1]&&b[1].apply(null,T)},arguments[2]]):g.apply(this,arguments).then(T=>l(this,T))}};a.RTCPeerConnection.prototype[h]=v[h]});const d=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=u(this,arguments[0]),d.apply(this,arguments))};const m=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const h=m.get.apply(this);return h.type===""?h:l(this,h)}}),a.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(g._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let b;Object.keys(this._streams).forEach(k=>{this._streams[k].getTracks().find(E=>g.track===E)&&(b=this._streams[k])}),b&&(b.getTracks().length===1?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function hf(a,e){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=a.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};a.RTCPeerConnection.prototype[i]=o[i]})}function ob(a,e){ka(a,"negotiationneeded",i=>{const s=i.target;if(!((e.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return i})}var Vv=Object.freeze({__proto__:null,fixNegotiationNeeded:ob,shimAddTrackRemoveTrack:rb,shimAddTrackRemoveTrackWithNative:sb,shimGetSendersWithDtmf:ib,shimGetUserMedia:eb,shimMediaStream:tb,shimOnTrack:nb,shimPeerConnection:hf,shimSenderReceiverGetStats:ab});function cb(a,e){const i=a&&a.navigator,s=a&&a.MediaStreamTrack;if(i.getUserMedia=function(o,l,u){Wf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(o).then(l,u)},!(e.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const o=function(u,d,m){d in u&&!(m in u)&&(u[m]=u[d],delete u[d])},l=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u.audio,"autoGainControl","mozAutoGainControl"),o(u.audio,"noiseSuppression","mozNoiseSuppression")),l(u)},s&&s.prototype.getSettings){const u=s.prototype.getSettings;s.prototype.getSettings=function(){const d=u.apply(this,arguments);return o(d,"mozAutoGainControl","autoGainControl"),o(d,"mozNoiseSuppression","noiseSuppression"),d}}if(s&&s.prototype.applyConstraints){const u=s.prototype.applyConstraints;s.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d,"autoGainControl","mozAutoGainControl"),o(d,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[d])}}}}function l_(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return s.video===!0?s.video={mediaSource:e}:s.video.mediaSource=e,a.navigator.mediaDevices.getUserMedia(s)})}function lb(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mf(a,e){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const l=a.RTCPeerConnection.prototype[o],u={[o](){return arguments[0]=new(o==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};a.RTCPeerConnection.prototype[o]=u[o]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[l,u,d]=arguments;return s.apply(this,[l||null]).then(m=>{if(e.version<53&&!u)try{m.forEach(h=>{h.type=i[h.type]||h.type})}catch(h){if(h.name!=="TypeError")throw h;m.forEach((g,v)=>{m.set(v,Object.assign({},g,{type:i[g.type]||g.type}))})}return m}).then(u,d)}}function ub(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const e=a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(l=>l._pc=this),o});const i=a.RTCPeerConnection.prototype.addTrack;i&&(a.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function db(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s}),ka(a,"track",i=>(i.receiver._pc=i.srcElement,i)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function fb(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){Wf("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&i.getTracks().includes(s.track)&&this.removeTrack(s)})})}function hb(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function mb(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.addTransceiver;e&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const o=s.length>0;o&&s.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(o){const{sender:u}=l,d=u.getParameters();(!("encodings"in d)||d.encodings.length===1&&Object.keys(d.encodings[0]).length===0)&&(d.encodings=s,u.sendEncodings=s,this.setParametersPromises.push(u.setParameters(d).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return l})}function pb(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const e=a.RTCRtpSender.prototype.getParameters;e&&(a.RTCRtpSender.prototype.getParameters=function(){const s=e.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function gb(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function vb(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Fv=Object.freeze({__proto__:null,shimAddTransceiver:mb,shimCreateAnswer:vb,shimCreateOffer:gb,shimGetDisplayMedia:l_,shimGetParameters:pb,shimGetUserMedia:cb,shimOnTrack:lb,shimPeerConnection:mf,shimRTCDataChannel:hb,shimReceiverGetStats:db,shimRemoveStream:fb,shimSenderGetStats:ub});function yb(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(o=>e.call(this,o,s)),s.getVideoTracks().forEach(o=>e.call(this,o,s))},a.RTCPeerConnection.prototype.addTrack=function(s){for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];return l&&l.forEach(d=>{this._localStreams?this._localStreams.includes(d)||this._localStreams.push(d):this._localStreams=[d]}),e.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(i);if(s===-1)return;this._localStreams.splice(s,1);const o=i.getTracks();this.getSenders().forEach(l=>{o.includes(l.track)&&this.removeTrack(l)})})}}function bb(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const l=new Event("addstream");l.stream=o,this.dispatchEvent(l)})})}});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(l=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(l)>=0)return;s._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,s.dispatchEvent(u)})}),e.apply(s,arguments)}}}function Sb(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const e=a.RTCPeerConnection.prototype,i=e.createOffer,s=e.createAnswer,o=e.setLocalDescription,l=e.setRemoteDescription,u=e.addIceCandidate;e.createOffer=function(h,g){const v=arguments.length>=2?arguments[2]:arguments[0],b=i.apply(this,[v]);return g?(b.then(h,g),Promise.resolve()):b},e.createAnswer=function(h,g){const v=arguments.length>=2?arguments[2]:arguments[0],b=s.apply(this,[v]);return g?(b.then(h,g),Promise.resolve()):b};let d=function(m,h,g){const v=o.apply(this,[m]);return g?(v.then(h,g),Promise.resolve()):v};e.setLocalDescription=d,d=function(m,h,g){const v=l.apply(this,[m]);return g?(v.then(h,g),Promise.resolve()):v},e.setRemoteDescription=d,d=function(m,h,g){const v=u.apply(this,[m]);return g?(v.then(h,g),Promise.resolve()):v},e.addIceCandidate=d}function Tb(a){const e=a&&a.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const i=e.mediaDevices,s=i.getUserMedia.bind(i);e.mediaDevices.getUserMedia=o=>s(kb(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(s,o,l){e.mediaDevices.getUserMedia(s).then(o,l)}).bind(e))}function kb(a){return a&&a.video!==void 0?Object.assign({},a,{video:$0(a.video)}):a}function Cb(a){if(!a.RTCPeerConnection)return;const e=a.RTCPeerConnection;a.RTCPeerConnection=function(s,o){if(s&&s.iceServers){const l=[];for(let u=0;u<s.iceServers.length;u++){let d=s.iceServers[u];d.urls===void 0&&d.url?(Wf("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,l.push(d)):l.push(s.iceServers[u])}s.iceServers=l}return new e(s,o)},a.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Eb(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Rb(a){const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const o=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):s.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const l=this.getTransceivers().find(u=>u.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function _b(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var Gv=Object.freeze({__proto__:null,shimAudioContext:_b,shimCallbacksAPI:Sb,shimConstraints:kb,shimCreateOfferLegacy:Rb,shimGetUserMedia:Tb,shimLocalStreamsAPI:yb,shimRTCIceServerUrls:Cb,shimRemoteStreamsAPI:bb,shimTrackEventTransceiver:Eb}),Od={exports:{}},Yv;function u_(){return Yv||(Yv=1,function(a){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(i){return i.trim().split(`
`).map(s=>s.trim())},e.splitSections=function(i){return i.split(`
m=`).map((o,l)=>(l>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(i){const s=e.splitSections(i);return s&&s[0]},e.getMediaSections=function(i){const s=e.splitSections(i);return s.shift(),s},e.matchPrefix=function(i,s){return e.splitLines(i).filter(o=>o.indexOf(s)===0)},e.parseCandidate=function(i){let s;i.indexOf("a=candidate:")===0?s=i.substring(12).split(" "):s=i.substring(10).split(" ");const o={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":o.relatedAddress=s[l+1];break;case"rport":o.relatedPort=parseInt(s[l+1],10);break;case"tcptype":o.tcpType=s[l+1];break;case"ufrag":o.ufrag=s[l+1],o.usernameFragment=s[l+1];break;default:o[s[l]]===void 0&&(o[s[l]]=s[l+1]);break}return o},e.writeCandidate=function(i){const s=[];s.push(i.foundation);const o=i.component;o==="rtp"?s.push(1):o==="rtcp"?s.push(2):s.push(o),s.push(i.protocol.toUpperCase()),s.push(i.priority),s.push(i.address||i.ip),s.push(i.port);const l=i.type;return s.push("typ"),s.push(l),l!=="host"&&i.relatedAddress&&i.relatedPort&&(s.push("raddr"),s.push(i.relatedAddress),s.push("rport"),s.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(s.push("ufrag"),s.push(i.usernameFragment||i.ufrag)),"candidate:"+s.join(" ")},e.parseIceOptions=function(i){return i.substring(14).split(" ")},e.parseRtpMap=function(i){let s=i.substring(9).split(" ");const o={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),o.name=s[0],o.clockRate=parseInt(s[1],10),o.channels=s.length===3?parseInt(s[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(i){let s=i.payloadType;i.preferredPayloadType!==void 0&&(s=i.preferredPayloadType);const o=i.channels||i.numChannels||1;return"a=rtpmap:"+s+" "+i.name+"/"+i.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(i){const s=i.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},e.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},e.parseFmtp=function(i){const s={};let o;const l=i.substring(i.indexOf(" ")+1).split(";");for(let u=0;u<l.length;u++)o=l[u].trim().split("="),s[o[0].trim()]=o[1];return s},e.writeFmtp=function(i){let s="",o=i.payloadType;if(i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const l=[];Object.keys(i.parameters).forEach(u=>{i.parameters[u]!==void 0?l.push(u+"="+i.parameters[u]):l.push(u)}),s+="a=fmtp:"+o+" "+l.join(";")+`\r
`}return s},e.parseRtcpFb=function(i){const s=i.substring(i.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},e.writeRtcpFb=function(i){let s="",o=i.payloadType;return i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+o+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},e.parseSsrcMedia=function(i){const s=i.indexOf(" "),o={ssrc:parseInt(i.substring(7,s),10)},l=i.indexOf(":",s);return l>-1?(o.attribute=i.substring(s+1,l),o.value=i.substring(l+1)):o.attribute=i.substring(s+1),o},e.parseSsrcGroup=function(i){const s=i.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(o=>parseInt(o,10))}},e.getMid=function(i){const s=e.matchPrefix(i,"a=mid:")[0];if(s)return s.substring(6)},e.parseFingerprint=function(i){const s=i.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},e.getDtlsParameters=function(i,s){return{role:"auto",fingerprints:e.matchPrefix(i+s,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(i,s){let o="a=setup:"+s+`\r
`;return i.fingerprints.forEach(l=>{o+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),o},e.parseCryptoLine=function(i){const s=i.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},e.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?e.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const s=i.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},e.getCryptoParameters=function(i,s){return e.matchPrefix(i+s,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(i,s){const o=e.matchPrefix(i+s,"a=ice-ufrag:")[0],l=e.matchPrefix(i+s,"a=ice-pwd:")[0];return o&&l?{usernameFragment:o.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(i){let s="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(s+=`a=ice-lite\r
`),s},e.parseRtpParameters=function(i){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=e.splitLines(i)[0].split(" ");s.profile=l[2];for(let d=3;d<l.length;d++){const m=l[d],h=e.matchPrefix(i,"a=rtpmap:"+m+" ")[0];if(h){const g=e.parseRtpMap(h),v=e.matchPrefix(i,"a=fmtp:"+m+" ");switch(g.parameters=v.length?e.parseFmtp(v[0]):{},g.rtcpFeedback=e.matchPrefix(i,"a=rtcp-fb:"+m+" ").map(e.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase());break}}}e.matchPrefix(i,"a=extmap:").forEach(d=>{s.headerExtensions.push(e.parseExtmap(d))});const u=e.matchPrefix(i,"a=rtcp-fb:* ").map(e.parseRtcpFb);return s.codecs.forEach(d=>{u.forEach(m=>{d.rtcpFeedback.find(g=>g.type===m.type&&g.parameter===m.parameter)||d.rtcpFeedback.push(m)})}),s},e.writeRtpDescription=function(i,s){let o="";o+="m="+i+" ",o+=s.codecs.length>0?"9":"0",o+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=s.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(u=>{o+=e.writeRtpMap(u),o+=e.writeFmtp(u),o+=e.writeRtcpFb(u)});let l=0;return s.codecs.forEach(u=>{u.maxptime>l&&(l=u.maxptime)}),l>0&&(o+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(u=>{o+=e.writeExtmap(u)}),o},e.parseRtpEncodingParameters=function(i){const s=[],o=e.parseRtpParameters(i),l=o.fecMechanisms.indexOf("RED")!==-1,u=o.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(i,"a=ssrc:").map(b=>e.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),m=d.length>0&&d[0].ssrc;let h;const g=e.matchPrefix(i,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(T=>parseInt(T,10)));g.length>0&&g[0].length>1&&g[0][0]===m&&(h=g[0][1]),o.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let k={ssrc:m,codecPayloadType:parseInt(b.parameters.apt,10)};m&&h&&(k.rtx={ssrc:h}),s.push(k),l&&(k=JSON.parse(JSON.stringify(k)),k.fec={ssrc:m,mechanism:u?"red+ulpfec":"red"},s.push(k))}}),s.length===0&&m&&s.push({ssrc:m});let v=e.matchPrefix(i,"b=");return v.length&&(v[0].indexOf("b=TIAS:")===0?v=parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?v=parseInt(v[0].substring(5),10)*1e3*.95-50*40*8:v=void 0,s.forEach(b=>{b.maxBitrate=v})),s},e.parseRtcpParameters=function(i){const s={},o=e.matchPrefix(i,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];o&&(s.cname=o.value,s.ssrc=o.ssrc);const l=e.matchPrefix(i,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const u=e.matchPrefix(i,"a=rtcp-mux");return s.mux=u.length>0,s},e.writeRtcpParameters=function(i){let s="";return i.reducedSize&&(s+=`a=rtcp-rsize\r
`),i.mux&&(s+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(s+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),s},e.parseMsid=function(i){let s;const o=e.matchPrefix(i,"a=msid:");if(o.length===1)return s=o[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=e.matchPrefix(i,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");if(l.length>0)return s=l[0].value.split(" "),{stream:s[0],track:s[1]}},e.parseSctpDescription=function(i){const s=e.parseMLine(i),o=e.matchPrefix(i,"a=max-message-size:");let l;o.length>0&&(l=parseInt(o[0].substring(19),10)),isNaN(l)&&(l=65536);const u=e.matchPrefix(i,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const d=e.matchPrefix(i,"a=sctpmap:");if(d.length>0){const m=d[0].substring(10).split(" ");return{port:parseInt(m[0],10),protocol:m[1],maxMessageSize:l}}},e.writeSctpDescription=function(i,s){let o=[];return i.protocol!=="DTLS/SCTP"?o=["m="+i.kind+" 9 "+i.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:o=["m="+i.kind+" 9 "+i.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&o.push("a=max-message-size:"+s.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(i,s,o){let l;const u=s!==void 0?s:2;return i?l=i:l=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+l+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(i,s){const o=e.splitLines(i);for(let l=0;l<o.length;l++)switch(o[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[l].substring(2)}return s?e.getDirection(s):"sendrecv"},e.getKind=function(i){return e.splitLines(i)[0].split(" ")[0].substring(2)},e.isRejected=function(i){return i.split(" ",2)[1]==="0"},e.parseMLine=function(i){const o=e.splitLines(i)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(i){const o=e.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const s=e.splitLines(i);for(let o=0;o<s.length;o++)if(s[o].length<2||s[o].charAt(1)!=="=")return!1;return!0},a.exports=e}(Od)),Od.exports}var wb=u_(),fs=W1(wb),d_=RR({__proto__:null,default:fs},[wb]);function Rc(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const e=a.RTCIceCandidate;a.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const o=new e(s),l=fs.parseCandidate(s.candidate);for(const u in l)u in o||Object.defineProperty(o,u,{value:l[u]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(s)},a.RTCIceCandidate.prototype=e.prototype,ka(a,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new a.RTCIceCandidate(i.candidate),writable:"false"}),i))}function pf(a){!a.RTCIceCandidate||a.RTCIceCandidate&&"relayProtocol"in a.RTCIceCandidate.prototype||ka(a,"icecandidate",e=>{if(e.candidate){const i=fs.parseCandidate(e.candidate.candidate);i.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return e})}function _c(a,e){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const i=function(d){if(!d||!d.sdp)return!1;const m=fs.splitSections(d.sdp);return m.shift(),m.some(h=>{const g=fs.parseMLine(h);return g&&g.kind==="application"&&g.protocol.indexOf("SCTP")!==-1})},s=function(d){const m=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(m===null||m.length<2)return-1;const h=parseInt(m[1],10);return h!==h?-1:h},o=function(d){let m=65536;return e.browser==="firefox"&&(e.version<57?d===-1?m=16384:m=2147483637:e.version<60?m=e.version===57?65535:65536:m=2147483637),m},l=function(d,m){let h=65536;e.browser==="firefox"&&e.version===57&&(h=65535);const g=fs.matchPrefix(d.sdp,"a=max-message-size:");return g.length>0?h=parseInt(g[0].substring(19),10):e.browser==="firefox"&&m!==-1&&(h=2147483637),h},u=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:m}=this.getConfiguration();m==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const m=s(arguments[0]),h=o(m),g=l(arguments[0],m);let v;h===0&&g===0?v=Number.POSITIVE_INFINITY:h===0||g===0?v=Math.max(h,g):v=Math.min(h,g);const b={};Object.defineProperty(b,"maxMessageSize",{get(){return v}}),this._sctp=b}return u.apply(this,arguments)}}function wc(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function e(s,o){const l=s.send;s.send=function(){const d=arguments[0],m=d.length||d.size||d.byteLength;if(s.readyState==="open"&&o.sctp&&m>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const i=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const o=i.apply(this,arguments);return e(o,this),o},ka(a,"datachannel",s=>(e(s.channel,s.target),s))}function gf(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const e=a.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const s=e[i];e[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const l=o.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const u=new Event("connectionstatechange",o);l.dispatchEvent(u)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function vf(a,e){if(!a.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const i=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=o.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&o instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:o.type,sdp:l}):o.sdp=l}return i.apply(this,arguments)}}function Oc(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.addIceCandidate;!i||i.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function xc(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.setLocalDescription;!i||i.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return i.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?i.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>i.apply(this,[u]))})}var f_=Object.freeze({__proto__:null,removeExtmapAllowMixed:vf,shimAddIceCandidateNullOrEmpty:Oc,shimConnectionState:gf,shimMaxMessageSize:_c,shimParameterlessSetLocalDescription:xc,shimRTCIceCandidate:Rc,shimRTCIceCandidateRelayProtocol:pf,shimSendThrowTypeError:wc});function h_(){let{window:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=W0,s=c_(a),o={browserDetails:s,commonShim:f_,extractVersion:Ec,disableLog:r_,disableWarnings:o_,sdp:d_};switch(s.browser){case"chrome":if(!Vv||!hf||!e.shimChrome)return i("Chrome shim is not included in this adapter release."),o;if(s.version===null)return i("Chrome shim can not determine version, not shimming."),o;i("adapter.js shimming chrome."),o.browserShim=Vv,Oc(a,s),xc(a),eb(a,s),tb(a),hf(a,s),nb(a),rb(a,s),ib(a),ab(a),ob(a,s),Rc(a),pf(a),gf(a),_c(a,s),wc(a),vf(a,s);break;case"firefox":if(!Fv||!mf||!e.shimFirefox)return i("Firefox shim is not included in this adapter release."),o;i("adapter.js shimming firefox."),o.browserShim=Fv,Oc(a,s),xc(a),cb(a,s),mf(a,s),lb(a),fb(a),ub(a),db(a),hb(a),mb(a),pb(a),gb(a),vb(a),Rc(a),gf(a),_c(a,s),wc(a);break;case"safari":if(!Gv||!e.shimSafari)return i("Safari shim is not included in this adapter release."),o;i("adapter.js shimming safari."),o.browserShim=Gv,Oc(a,s),xc(a),Cb(a),Rb(a),Sb(a),yb(a),bb(a),Eb(a),Tb(a),_b(a),Rc(a),pf(a),_c(a,s),wc(a),vf(a,s);break;default:i("Unsupported browser!");break}return o}h_({window:typeof window>"u"?void 0:window});const m_=10,dc="lk_e2ee",p_="LKFrameEncryptionKey",g_={sharedKey:!1,ratchetSalt:p_,ratchetWindowSize:8,failureTolerance:m_,keyringSize:16};var Ii;(function(a){a.SetKey="setKey",a.RatchetRequest="ratchetRequest",a.KeyRatcheted="keyRatcheted"})(Ii||(Ii={}));var Kv;(function(a){a.KeyRatcheted="keyRatcheted"})(Kv||(Kv={}));var ji;(function(a){a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError"})(ji||(ji={}));var Qv;(function(a){a.Error="cryptorError"})(Qv||(Qv={}));function v_(){return y_()||yf()}function yf(){return typeof window.RTCRtpScriptTransform<"u"}function y_(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class CO extends Ln.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(i,s)=>{Ce.debug("key ratcheted event received",{material:i,keyIndex:s})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},g_),e),this.on(Ii.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,i,s){const o={key:e,participantIdentity:i,keyIndex:s};if(!this.options.sharedKey&&!i)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(i??"shared","-").concat(s??0),o),this.emit(Ii.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,i){this.emit(Ii.RatchetRequest,e,i)}}class Hi extends Error{constructor(e,i){super(i||"an error has occured"),this.name="LiveKitError",this.code=e}}var _e;(function(a){a[a.NotAllowed=0]="NotAllowed",a[a.ServerUnreachable=1]="ServerUnreachable",a[a.InternalError=2]="InternalError",a[a.Cancelled=3]="Cancelled",a[a.LeaveRequest=4]="LeaveRequest"})(_e||(_e={}));class Ie extends Hi{constructor(e,i,s,o){super(1,e),this.name="ConnectionError",this.status=s,this.reason=i,this.context=o,this.reasonName=_e[i]}}class $f extends Hi{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class ti extends Hi{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class b_ extends Hi{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class ut extends Hi{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class bf extends Hi{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class S_ extends Hi{constructor(e,i){super(15,e),this.name="PublishTrackError",this.status=i}}class Xv extends Hi{constructor(e,i){super(15,e),this.reason=i,this.reasonName=typeof i=="string"?i:Zf[i]}}var zc;(function(a){a.PermissionDenied="PermissionDenied",a.NotFound="NotFound",a.DeviceInUse="DeviceInUse",a.Other="Other"})(zc||(zc={}));(function(a){function e(i){if(i&&"name"in i)return i.name==="NotFoundError"||i.name==="DevicesNotFoundError"?a.NotFound:i.name==="NotAllowedError"||i.name==="PermissionDeniedError"?a.PermissionDenied:i.name==="NotReadableError"||i.name==="TrackStartError"?a.DeviceInUse:a.Other}a.getFailure=e})(zc||(zc={}));var Jv;(function(a){a[a.InvalidKey=0]="InvalidKey",a[a.MissingKey=1]="MissingKey",a[a.InternalError=2]="InternalError"})(Jv||(Jv={}));var Z;(function(a){a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting",a.Reconnected="reconnected",a.Disconnected="disconnected",a.ConnectionStateChanged="connectionStateChanged",a.MediaDevicesChanged="mediaDevicesChanged",a.ParticipantConnected="participantConnected",a.ParticipantDisconnected="participantDisconnected",a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalAudioSilenceDetected="localAudioSilenceDetected",a.ActiveSpeakersChanged="activeSpeakersChanged",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.ParticipantAttributesChanged="participantAttributesChanged",a.RoomMetadataChanged="roomMetadataChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.AudioPlaybackStatusChanged="audioPlaybackChanged",a.VideoPlaybackStatusChanged="videoPlaybackChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.SignalConnected="signalConnected",a.RecordingStatusChanged="recordingStatusChanged",a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ActiveDeviceChanged="activeDeviceChanged",a.ChatMessage="chatMessage",a.LocalTrackSubscribed="localTrackSubscribed",a.MetricsReceived="metricsReceived"})(Z||(Z={}));var ie;(function(a){a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.IsSpeakingChanged="isSpeakingChanged",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.MediaDevicesError="mediaDevicesError",a.AudioStreamAcquired="audioStreamAcquired",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.PCTrackAdded="pcTrackAdded",a.AttributesChanged="attributesChanged",a.LocalTrackSubscribed="localTrackSubscribed",a.ChatMessage="chatMessage"})(ie||(ie={}));var te;(function(a){a.TransportsCreated="transportsCreated",a.Connected="connected",a.Disconnected="disconnected",a.Resuming="resuming",a.Resumed="resumed",a.Restarting="restarting",a.Restarted="restarted",a.SignalResumed="signalResumed",a.SignalRestarted="signalRestarted",a.Closing="closing",a.MediaTrackAdded="mediaTrackAdded",a.ActiveSpeakersUpdate="activeSpeakersUpdate",a.DataPacketReceived="dataPacketReceived",a.RTPVideoMapUpdate="rtpVideoMapUpdate",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ParticipantUpdate="participantUpdate",a.RoomUpdate="roomUpdate",a.SpeakersChanged="speakersChanged",a.StreamStateChanged="streamStateChanged",a.ConnectionQualityUpdate="connectionQualityUpdate",a.SubscriptionError="subscriptionError",a.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",a.RemoteMute="remoteMute",a.SubscribedQualityUpdate="subscribedQualityUpdate",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackSubscribed="localTrackSubscribed",a.Offline="offline",a.SignalRequestResponse="signalRequestResponse"})(te||(te={}));var $;(function(a){a.Message="message",a.Muted="muted",a.Unmuted="unmuted",a.Restarted="restarted",a.Ended="ended",a.Subscribed="subscribed",a.Unsubscribed="unsubscribed",a.UpdateSettings="updateSettings",a.UpdateSubscription="updateSubscription",a.AudioPlaybackStarted="audioPlaybackStarted",a.AudioPlaybackFailed="audioPlaybackFailed",a.AudioSilenceDetected="audioSilenceDetected",a.VisibilityChanged="visibilityChanged",a.VideoDimensionsChanged="videoDimensionsChanged",a.VideoPlaybackStarted="videoPlaybackStarted",a.VideoPlaybackFailed="videoPlaybackFailed",a.ElementAttached="elementAttached",a.ElementDetached="elementDetached",a.UpstreamPaused="upstreamPaused",a.UpstreamResumed="upstreamResumed",a.SubscriptionPermissionChanged="subscriptionPermissionChanged",a.SubscriptionStatusChanged="subscriptionStatusChanged",a.SubscriptionFailed="subscriptionFailed",a.TrackProcessorUpdate="trackProcessorUpdate",a.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",a.TranscriptionReceived="transcriptionReceived",a.TimeSyncUpdate="timeSyncUpdate"})($||($={}));function T_(a){if(!(typeof a>"u"))return typeof structuredClone=="function"?structuredClone(a):JSON.parse(JSON.stringify(a))}const k_=/version\/(\d+(\.?_?\d+)+)/i;let xd;function Pn(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const i=navigator.userAgent.toLowerCase();if(xd===void 0||e){const s=C_.find(o=>{let{test:l}=o;return l.test(i)});xd=s==null?void 0:s.describe(i)}return xd}const C_=[{test:/firefox|iceweasel|fxios/i,describe(a){return{name:"Firefox",version:Dc(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Dd(a)}}},{test:/chrom|crios|crmo/i,describe(a){return{name:"Chrome",version:Dc(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Dd(a)}}},{test:/safari|applewebkit/i,describe(a){return{name:"Safari",version:Dc(k_,a),os:a.includes("mobile/")?"iOS":"macOS",osVersion:Dd(a)}}}];function Dc(a,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=e.match(a);return s&&s.length>=i&&s[i]||""}function Dd(a){return a.includes("mac os")?Dc(/\(.+?(\d+_\d+(:?_\d+)?)/,a,1).replace(/_/g,"."):void 0}var E_="2.9.9";const R_=E_,__=15;class St{}St.setTimeout=function(){return setTimeout(...arguments)};St.setInterval=function(){return setInterval(...arguments)};St.clearTimeout=function(){return clearTimeout(...arguments)};St.clearInterval=function(){return clearInterval(...arguments)};const w_=5e3,xr=[];var cn;(function(a){a[a.LOW=0]="LOW",a[a.MEDIUM=1]="MEDIUM",a[a.HIGH=2]="HIGH"})(cn||(cn={}));class Q extends Ln.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Q.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Ce,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),w_):this.handleAppVisibilityChanged()},this.log=ai((o=s.loggerName)!==null&&o!==void 0?o:bn.Track),this.loggerContextCb=s.loggerContextCb,this.setMaxListeners(100),this.kind=i,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Q.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Pe(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let i="audio";this.kind===Q.Kind.Video&&(i="video"),this.attachedElements.length===0&&this.kind===Q.Kind.Video&&this.addAppVisibilityListener(),e||(i==="audio"&&(xr.forEach(l=>{l.parentElement===null&&!e&&(e=l)}),e&&xr.splice(xr.indexOf(e),1)),e||(e=document.createElement(i))),this.attachedElements.includes(e)||this.attachedElements.push(e),us(this.mediaStreamTrack,e);const s=e.srcObject.getTracks(),o=s.some(l=>l.kind==="audio");return e.play().then(()=>{this.emit(o?$.AudioPlaybackStarted:$.VideoPlaybackStarted)}).catch(l=>{l.name==="NotAllowedError"?this.emit(o?$.AudioPlaybackFailed:$.VideoPlaybackFailed,l):l.name==="AbortError"?Ce.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):Ce.warn("could not playback ".concat(o?"audio":"video"),l),o&&e&&s.some(u=>u.kind==="video")&&l.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit($.ElementAttached,e),e}detach(e){try{if(e){hs(this.mediaStreamTrack,e);const s=this.attachedElements.indexOf(e);return s>=0&&(this.attachedElements.splice(s,1),this.recycleElement(e),this.emit($.ElementDetached,e)),e}const i=[];return this.attachedElements.forEach(s=>{hs(this.mediaStreamTrack,s),i.push(s),this.recycleElement(s),this.emit($.ElementDetached,s)}),this.attachedElements=[],i}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ai(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let i=!0;e.pause(),xr.forEach(s=>{s.parentElement||(i=!1)}),i&&xr.push(e)}}handleAppVisibilityChanged(){return w(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Q.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Ut()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Ut()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function us(a,e){let i;e.srcObject instanceof MediaStream?i=e.srcObject:i=new MediaStream;let s;a.kind==="audio"?s=i.getAudioTracks():s=i.getVideoTracks(),s.includes(a)||(s.forEach(o=>{i.removeTrack(o)}),i.addTrack(a)),(!qi()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=i.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==i&&(e.srcObject=i,(qi()||vs())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=i,e.play().catch(()=>{})},0))}function hs(a,e){if(e.srcObject instanceof MediaStream){const i=e.srcObject;i.removeTrack(a),i.getTracks().length>0?e.srcObject=i:e.srcObject=null}}(function(a){let e;(function(h){h.Audio="audio",h.Video="video",h.Unknown="unknown"})(e=a.Kind||(a.Kind={}));let i;(function(h){h.Camera="camera",h.Microphone="microphone",h.ScreenShare="screen_share",h.ScreenShareAudio="screen_share_audio",h.Unknown="unknown"})(i=a.Source||(a.Source={}));let s;(function(h){h.Active="active",h.Paused="paused",h.Unknown="unknown"})(s=a.StreamState||(a.StreamState={}));function o(h){switch(h){case e.Audio:return gn.AUDIO;case e.Video:return gn.VIDEO;default:return gn.DATA}}a.kindToProto=o;function l(h){switch(h){case gn.AUDIO:return e.Audio;case gn.VIDEO:return e.Video;default:return e.Unknown}}a.kindFromProto=l;function u(h){switch(h){case i.Camera:return ot.CAMERA;case i.Microphone:return ot.MICROPHONE;case i.ScreenShare:return ot.SCREEN_SHARE;case i.ScreenShareAudio:return ot.SCREEN_SHARE_AUDIO;default:return ot.UNKNOWN}}a.sourceToProto=u;function d(h){switch(h){case ot.CAMERA:return i.Camera;case ot.MICROPHONE:return i.Microphone;case ot.SCREEN_SHARE:return i.ScreenShare;case ot.SCREEN_SHARE_AUDIO:return i.ScreenShareAudio;default:return i.Unknown}}a.sourceFromProto=d;function m(h){switch(h){case cf.ACTIVE:return s.Active;case cf.PAUSED:return s.Paused;default:return s.Unknown}}a.streamStateFromProto=m})(Q);class Le{constructor(e,i,s,o,l){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(i!==void 0&&s!==void 0)this.width=e,this.height=i,this.aspectRatio=e/i,this.encoding={maxBitrate:s,maxFramerate:o,priority:l};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const O_=["vp8","h264"],x_=["vp8","h264","vp9","av1"];function D_(a){return!!O_.find(e=>e===a)}var Zv;(function(a){a[a.REGRESSION=0]="REGRESSION",a[a.SIMULCAST=1]="SIMULCAST"})(Zv||(Zv={}));var Sf;(function(a){a.telephone={maxBitrate:12e3},a.speech={maxBitrate:24e3},a.music={maxBitrate:48e3},a.musicStereo={maxBitrate:64e3},a.musicHighQuality={maxBitrate:96e3},a.musicHighQualityStereo={maxBitrate:128e3}})(Sf||(Sf={}));const qr={h90:new Le(160,90,9e4,20),h180:new Le(320,180,16e4,20),h216:new Le(384,216,18e4,20),h360:new Le(640,360,45e4,20),h540:new Le(960,540,8e5,25),h720:new Le(1280,720,17e5,30),h1080:new Le(1920,1080,3e6,30),h1440:new Le(2560,1440,5e6,30),h2160:new Le(3840,2160,8e6,30)},Tf={h120:new Le(160,120,7e4,20),h180:new Le(240,180,125e3,20),h240:new Le(320,240,14e4,20),h360:new Le(480,360,33e4,20),h480:new Le(640,480,5e5,20),h540:new Le(720,540,6e5,25),h720:new Le(960,720,13e5,30),h1080:new Le(1440,1080,23e5,30),h1440:new Le(1920,1440,38e5,30)},eh={h360fps3:new Le(640,360,2e5,3,"medium"),h360fps15:new Le(640,360,4e5,15,"medium"),h720fps5:new Le(1280,720,8e5,5,"medium"),h720fps15:new Le(1280,720,15e5,15,"medium"),h720fps30:new Le(1280,720,2e6,30,"medium"),h1080fps15:new Le(1920,1080,25e5,15,"medium"),h1080fps30:new Le(1920,1080,5e6,30,"medium"),original:new Le(0,0,7e6,30,"medium")},A_="|",Wv="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function N_(a){const e=a.split(A_);return e.length>1?[e[0],a.substr(e[0].length+1)]:[a,""]}function jt(a){return w(this,void 0,void 0,function*(){return new Promise(e=>St.setTimeout(e,a))})}function kf(){return"addTransceiver"in RTCPeerConnection.prototype}function Cf(){return"addTrack"in RTCPeerConnection.prototype}function P_(){if(!("getCapabilities"in RTCRtpSender)||qi())return!1;const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType==="video/AV1"){e=!0;break}}return e}function M_(){if(!("getCapabilities"in RTCRtpSender)||vs())return!1;if(qi()){const i=Pn();if(i!=null&&i.version&&ys(i.version,"16")<0)return!1}const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType==="video/VP9"){e=!0;break}}return e}function Ur(a){return a==="av1"||a==="vp9"}function Ef(a){return document?(a||(a=document.createElement("audio")),"setSinkId"in a):!1}function U_(){return typeof RTCPeerConnection>"u"?!1:kf()||Cf()}function vs(){var a;return((a=Pn())===null||a===void 0?void 0:a.name)==="Firefox"}function qi(){var a;return((a=Pn())===null||a===void 0?void 0:a.name)==="Safari"}function L_(){const a=Pn();return(a==null?void 0:a.name)==="Safari"&&a.version.startsWith("17.")}function Ob(){var a,e;return Ut()?(e=(a=navigator.userAgentData)===null||a===void 0?void 0:a.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function j_(){const a=Pn(),e="17.2";if(a)return a.name!=="Safari"&&a.os!=="iOS"||a.os==="iOS"&&a.osVersion&&ys(e,a.osVersion)>=0?!0:a.name==="Safari"&&ys(e,a.version)>=0}function Ut(){return typeof document<"u"}function Mn(){return navigator.product=="ReactNative"}function Rf(a){return a.hostname.endsWith(".livekit.cloud")||a.hostname.endsWith(".livekit.run")}function xb(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Db(){if(!Mn())return;let a=xb();if(a)return a.platform}function $v(){if(Ut())return window.devicePixelRatio;if(Mn()){let a=xb();if(a)return a.devicePixelRatio}return 1}function ys(a,e){const i=a.split("."),s=e.split("."),o=Math.min(i.length,s.length);for(let l=0;l<o;++l){const u=parseInt(i[l],10),d=parseInt(s[l],10);if(u>d)return 1;if(u<d)return-1;if(l===o-1&&u===d)return 0}return a===""&&e!==""?-1:e===""?1:i.length==s.length?0:i.length<s.length?-1:1}function I_(a){for(const e of a)e.target.handleResize(e)}function B_(a){for(const e of a)e.target.handleVisibilityChanged(e)}let Ad=null;const ey=()=>(Ad||(Ad=new ResizeObserver(I_)),Ad);let Nd=null;const ty=()=>(Nd||(Nd=new IntersectionObserver(B_,{root:null,rootMargin:"0px"})),Nd);function z_(){var a;const e=new O1({sdk:U0.JS,protocol:__,version:R_});return Mn()&&(e.os=(a=Db())!==null&&a!==void 0?a:""),e}function ny(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=a,o.height=e;const l=o.getContext("2d");l==null||l.fillRect(0,0,o.width,o.height),s&&l&&(l.beginPath(),l.arc(a/2,e/2,50,0,Math.PI*2,!0),l.closePath(),l.fillStyle="grey",l.fill());const u=o.captureStream(),[d]=u.getTracks();if(!d)throw Error("Could not get empty media stream video track");return d.enabled=i,d}let Dr;function Pd(){if(!Dr){const a=new AudioContext,e=a.createOscillator(),i=a.createGain();i.gain.setValueAtTime(0,0);const s=a.createMediaStreamDestination();if(e.connect(i),i.connect(s),e.start(),[Dr]=s.stream.getAudioTracks(),!Dr)throw Error("Could not get empty media stream audio track");Dr.enabled=!1}return Dr.clone()}class Ab{constructor(e,i){this.onFinally=i,this.promise=new Promise((s,o)=>w(this,void 0,void 0,function*(){this.resolve=s,this.reject=o,e&&(yield e(s,o))})).finally(()=>{var s;return(s=this.onFinally)===null||s===void 0?void 0:s.call(this)})}}function q_(a){return x_.includes(a)}function Bi(a){if(typeof a=="string"||typeof a=="number")return a;if(Array.isArray(a))return a[0];if(a.exact)return Array.isArray(a.exact)?a.exact[0]:a.exact;if(a.ideal)return Array.isArray(a.ideal)?a.ideal[0]:a.ideal;throw Error("could not unwrap constraint")}function H_(a){return a.startsWith("http")?a.replace(/^(http)/,"ws"):a}function iy(a){return a.startsWith("ws")?a.replace(/^(ws)/,"http"):a}function V_(a,e){return a.segments.map(i=>{let{id:s,text:o,language:l,startTime:u,endTime:d,final:m}=i;var h;const g=(h=e.get(s))!==null&&h!==void 0?h:Date.now(),v=Date.now();return m?e.delete(s):e.set(s,g),{id:s,text:o,startTime:Number.parseInt(u.toString()),endTime:Number.parseInt(d.toString()),final:m,language:l,firstReceivedTime:g,lastReceivedTime:v}})}function F_(a){const{id:e,timestamp:i,message:s,editTimestamp:o}=a;return{id:e,timestamp:Number.parseInt(i.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:s}}function ay(a){switch(a.reason){case _e.LeaveRequest:return a.context;case _e.Cancelled:return yn.CLIENT_INITIATED;case _e.NotAllowed:return yn.USER_REJECTED;case _e.ServerUnreachable:return yn.JOIN_FAILURE;default:return yn.UNKNOWN_REASON}}function Ac(a){return a!==void 0?Number(a):void 0}function ha(a){return a!==void 0?BigInt(a):void 0}function ms(a){return!!a&&!(a instanceof MediaStreamTrack)&&a.isLocal}function si(a){return!!a&&a.kind==Q.Kind.Audio}function Es(a){return!!a&&a.kind==Q.Kind.Video}function Ni(a){return ms(a)&&Es(a)}function ma(a){return ms(a)&&si(a)}function _f(a){return!!a&&!a.isLocal}function G_(a){return!!a&&!a.isLocal}function Md(a){return _f(a)&&Es(a)}function Y_(a){return a.isLocal}function K_(a,e){const i=[];let s=new TextEncoder().encode(a);for(;s.length>e;){let o=e;for(;o>0;){const l=s[o];if(l!==void 0&&(l&192)!==128)break;o--}i.push(s.slice(0,o)),s=s.slice(o)}return s.length>0&&i.push(s),i}function Nb(a,e,i){var s,o,l,u,d;const{optionsWithoutProcessor:m,audioProcessor:h,videoProcessor:g}=th(a??{}),v=e==null?void 0:e.processor,b=i==null?void 0:i.processor,k=(s=T_(m))!==null&&s!==void 0?s:{};return k.audio===!0&&(k.audio={}),k.video===!0&&(k.video={}),k.audio&&(wf(k.audio,e),(o=(u=k.audio).deviceId)!==null&&o!==void 0||(u.deviceId="default"),(h||v)&&(k.audio.processor=h??v)),k.video&&(wf(k.video,i),(l=(d=k.video).deviceId)!==null&&l!==void 0||(d.deviceId="default"),(g||b)&&(k.video.processor=g??b)),k}function wf(a,e){return Object.keys(e).forEach(i=>{a[i]===void 0&&(a[i]=e[i])}),a}function il(a){var e,i,s,o;const l={};if(a.video)if(typeof a.video=="object"){const u={},d=u,m=a.video;Object.keys(m).forEach(h=>{switch(h){case"resolution":wf(d,m.resolution);break;default:d[h]=m[h]}}),l.video=u,(e=(s=l.video).deviceId)!==null&&e!==void 0||(s.deviceId="default")}else l.video=a.video?{deviceId:"default"}:!1;else l.video=!1;return a.audio?typeof a.audio=="object"?(l.audio=a.audio,(i=(o=l.audio).deviceId)!==null&&i!==void 0||(o.deviceId="default")):l.audio={deviceId:"default"}:l.audio=!1,l}function Pb(a){return w(this,arguments,void 0,function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const s=Mb();if(s){const o=s.createAnalyser();o.fftSize=2048;const l=o.frequencyBinCount,u=new Uint8Array(l);s.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield jt(i),o.getByteTimeDomainData(u);const m=u.some(h=>h!==128&&h!==0);return s.close(),!m}return!1}()})}function Mb(){var a;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const i=new e({latencyHint:"interactive"});if(i.state==="suspended"&&typeof window<"u"&&(!((a=window.document)===null||a===void 0)&&a.body)){const s=()=>w(this,void 0,void 0,function*(){var o;try{i.state==="suspended"&&(yield i.resume())}catch(l){console.warn("Error trying to auto-resume audio context",l)}(o=window.document.body)===null||o===void 0||o.removeEventListener("click",s)});window.document.body.addEventListener("click",s)}return i}}function sy(a){return a===Q.Source.Microphone?"audioinput":a===Q.Source.Camera?"videoinput":void 0}function Q_(a){var e,i;let s=(e=a.video)!==null&&e!==void 0?e:!0;return a.resolution&&a.resolution.width>0&&a.resolution.height>0&&(s=typeof s=="boolean"?{}:s,qi()?s=Object.assign(Object.assign({},s),{width:{max:a.resolution.width},height:{max:a.resolution.height},frameRate:a.resolution.frameRate}):s=Object.assign(Object.assign({},s),{width:{ideal:a.resolution.width},height:{ideal:a.resolution.height},frameRate:a.resolution.frameRate})),{audio:(i=a.audio)!==null&&i!==void 0?i:!1,video:s,controller:a.controller,selfBrowserSurface:a.selfBrowserSurface,surfaceSwitching:a.surfaceSwitching,systemAudio:a.systemAudio,preferCurrentTab:a.preferCurrentTab}}function Nc(a){return a.split("/")[1].toLowerCase()}function X_(a){const e=[];return a.forEach(i=>{i.track!==void 0&&e.push(new Xf({cid:i.track.mediaStreamID,track:i.trackInfo}))}),e}function Pe(a){return"mediaStreamTrack"in a?{trackID:a.sid,source:a.source,muted:a.isMuted,enabled:a.mediaStreamTrack.enabled,kind:a.kind,streamID:a.mediaStreamID,streamTrackID:a.mediaStreamTrack.id}:{trackID:a.trackSid,enabled:a.isEnabled,muted:a.isMuted,trackInfo:Object.assign({mimeType:a.mimeType,name:a.trackName,encrypted:a.isEncrypted,kind:a.kind,source:a.source},a.track?Pe(a.track):{})}}function J_(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function Z_(a,e){var i;a===void 0&&(a={}),e===void 0&&(e={});const s=[...Object.keys(e),...Object.keys(a)],o={};for(const l of s)a[l]!==e[l]&&(o[l]=(i=e[l])!==null&&i!==void 0?i:"");return o}function th(a){const e=Object.assign({},a);let i,s;return typeof e.audio=="object"&&e.audio.processor&&(i=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(s=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:e}}function W_(a){switch(a){case ot.CAMERA:return Q.Source.Camera;case ot.MICROPHONE:return Q.Source.Microphone;case ot.SCREEN_SHARE:return Q.Source.ScreenShare;case ot.SCREEN_SHARE_AUDIO:return Q.Source.ScreenShareAudio;default:return Q.Source.Unknown}}class $_ extends Ln.EventEmitter{constructor(e){super(),this.onWorkerMessage=i=>{var s,o;const{kind:l,data:u}=i.data;switch(l){case"error":Ce.error(u.error.message),this.emit(ji.EncryptionError,u.error);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(d=>{this.postKey(d)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(d=>{this.postKey(d)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity))this.emit(ji.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const d=(o=this.room)===null||o===void 0?void 0:o.getParticipantByIdentity(u.participantIdentity);if(!d)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(ji.ParticipantEncryptionStatusChanged,u.enabled,d)}break;case"ratchetKey":this.keyProvider.emit(Ii.KeyRatcheted,u.material,u.keyIndex);break}},this.onWorkerError=i=>{Ce.error("e2ee worker encountered an error:",{error:i.error}),this.emit(ji.EncryptionError,i.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!v_())throw new $f("tried to setup end-to-end encryption on an unsupported browser");if(Ce.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const i={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:t_.getLevel()}};this.worker&&(Ce.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(i))}}setParticipantCryptorEnabled(e,i){Ce.debug("set e2ee to ".concat(e," for participant ").concat(i)),this.postEnable(e,i)}setSifTrailer(e){!e||e.length===0?Ce.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(te.RTPVideoMapUpdate,i=>{this.postRTPMap(i)})}setupEventListeners(e,i){e.on(Z.TrackPublished,(s,o)=>this.setParticipantCryptorEnabled(s.trackInfo.encryption!==Yt.NONE,o.identity)),e.on(Z.ConnectionStateChanged,s=>{s===Ae.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{this.setParticipantCryptorEnabled(l.trackInfo.encryption!==Yt.NONE,o.identity)})})}).on(Z.TrackUnsubscribed,(s,o,l)=>{var u;const d={kind:"removeTransform",data:{participantIdentity:l.identity,trackId:s.mediaStreamID}};(u=this.worker)===null||u===void 0||u.postMessage(d)}).on(Z.TrackSubscribed,(s,o,l)=>{this.setupE2EEReceiver(s,l.identity,o.trackInfo)}).on(Z.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");i.getKeys().forEach(s=>{this.postKey(s)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(ie.LocalTrackPublished,s=>w(this,void 0,void 0,function*(){this.setupE2EESender(s.track,s.track.sender)})),i.on(Ii.SetKey,s=>this.postKey(s)).on(Ii.RatchetRequest,(s,o)=>this.postRatchetRequest(s,o))}postRatchetRequest(e,i){if(!this.worker)throw Error("could not ratchet key, worker is missing");const s={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:i}};this.worker.postMessage(s)}postKey(e){let{key:i,participantIdentity:s,keyIndex:o}=e;var l;if(!this.worker)throw Error("could not set key, worker is missing");const u={kind:"setKey",data:{participantIdentity:s,isPublisher:s===((l=this.room)===null||l===void 0?void 0:l.localParticipant.identity),key:i,keyIndex:o}};this.worker.postMessage(u)}postEnable(e,i){if(this.worker){const s={kind:"enable",data:{enabled:e,participantIdentity:i}};this.worker.postMessage(s)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var i;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const s={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const i={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(i)}setupE2EEReceiver(e,i,s){if(e.receiver){if(!(s!=null&&s.mimeType)||s.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,i,e.kind==="video"?Nc(s.mimeType):void 0)}}setupE2EESender(e,i){if(!ms(e)||!i){i||Ce.warn("early return because sender is not ready");return}this.handleSender(i,e.mediaStreamID,void 0)}handleReceiver(e,i,s,o){return w(this,void 0,void 0,function*(){if(this.worker){if(yf()){const l={kind:"decode",participantIdentity:s,trackId:i,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{if(dc in e&&o){const m={kind:"updateCodec",data:{trackId:i,codec:o,participantIdentity:s}};this.worker.postMessage(m);return}let l=e.writableStream,u=e.readableStream;if(!l||!u){const m=e.createEncodedStreams();e.writableStream=m.writable,l=m.writable,e.readableStream=m.readable,u=m.readable}const d={kind:"decode",data:{readableStream:u,writableStream:l,trackId:i,codec:o,participantIdentity:s}};this.worker.postMessage(d,[u,l])}e[dc]=!0}})}handleSender(e,i,s){var o;if(!(dc in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(yf()){Ce.info("initialize script transform");const l={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:i,codec:s};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{Ce.info("initialize encoded streams");const l=e.createEncodedStreams(),u={kind:"encode",data:{readableStream:l.readable,writableStream:l.writable,codec:s,trackId:i,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(u,[l.readable,l.writable])}e[dc]=!0}}}const Ud="default";class gt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new gt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return w(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l;if(((l=gt.userMediaPromiseMap)===null||l===void 0?void 0:l.size)>0){Ce.debug("awaiting getUserMedia promise");try{i?yield gt.userMediaPromiseMap.get(i):yield Promise.all(gt.userMediaPromiseMap.values())}catch{Ce.warn("error waiting for media permissons")}}let u=yield navigator.mediaDevices.enumerateDevices();if(o&&!(qi()&&s.hasDeviceInUse(i))&&(u.filter(m=>m.kind===i).length===0||u.some(m=>{const h=m.label==="",g=i?m.kind===i:!0;return h&&g}))){const m={video:i!=="audioinput"&&i!=="audiooutput",audio:i!=="videoinput"&&{deviceId:"default"}},h=yield navigator.mediaDevices.getUserMedia(m);u=yield navigator.mediaDevices.enumerateDevices(),h.getTracks().forEach(g=>{g.stop()})}return s._previousDevices=u,i&&(u=u.filter(d=>d.kind===i)),u}()})}normalizeDeviceId(e,i,s){return w(this,void 0,void 0,function*(){if(i!==Ud)return i;const o=yield this.getDevices(e),l=o.find(d=>d.deviceId===Ud);if(!l){Ce.warn("could not reliably determine default device");return}const u=o.find(d=>d.deviceId!==Ud&&d.groupId===(s??l.groupId));if(!u){Ce.warn("could not reliably determine default device");return}return u==null?void 0:u.deviceId})}hasDeviceInUse(e){return e?gt.userMediaPromiseMap.has(e):gt.userMediaPromiseMap.size>0}}gt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];gt.userMediaPromiseMap=new Map;var Lr;(function(a){a[a.WAITING=0]="WAITING",a[a.RUNNING=1]="RUNNING",a[a.COMPLETED=2]="COMPLETED"})(Lr||(Lr={}));class ew{constructor(){this.pendingTasks=new Map,this.taskMutex=new Kt,this.nextTaskIndex=0}run(e){return w(this,void 0,void 0,function*(){const i={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Lr.WAITING};this.pendingTasks.set(i.id,i);const s=yield this.taskMutex.lock();try{return i.executedAt=Date.now(),i.status=Lr.RUNNING,yield e()}finally{i.status=Lr.COMPLETED,this.pendingTasks.delete(i.id),s()}})}flush(){return w(this,void 0,void 0,function*(){return this.run(()=>w(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const tw=["syncState","trickle","offer","answer","simulate","leave"];function nw(a){const e=tw.indexOf(a.case)>=0;return Ce.trace("request allowed to bypass queue:",{canPass:e,req:a}),e}var Ve;(function(a){a[a.CONNECTING=0]="CONNECTING",a[a.CONNECTED=1]="CONNECTED",a[a.RECONNECTING=2]="RECONNECTING",a[a.DISCONNECTING=3]="DISCONNECTING",a[a.DISCONNECTED=4]="DISCONNECTED"})(Ve||(Ve={}));class nh{get currentState(){return this.state}get isDisconnected(){return this.state===Ve.DISCONNECTING||this.state===Ve.DISCONNECTED}get isEstablishingConnection(){return this.state===Ve.CONNECTING||this.state===Ve.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;this.rtt=0,this.state=Ve.DISCONNECTED,this.log=Ce,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=ai((s=i.loggerName)!==null&&s!==void 0?s:bn.Signal),this.loggerContextCb=i.loggerContextCb,this.useJSON=e,this.requestQueue=new ew,this.queuedRequests=[],this.closingLock=new Kt,this.connectionLock=new Kt,this.state=Ve.DISCONNECTED}get logContext(){var e,i;return(i=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&i!==void 0?i:{}}join(e,i,s,o){return w(this,void 0,void 0,function*(){return this.state=Ve.CONNECTING,this.options=s,yield this.connect(e,i,s,o)})}reconnect(e,i,s,o){return w(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Ve.RECONNECTING,this.clearPingInterval(),yield this.connect(e,i,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:s,reconnectReason:o}))})}connect(e,i,s,o){this.connectOptions=s;const l=new URL(H_(e)),u=l.pathname.endsWith("/");l.pathname+=u?"rtc":"/rtc";const d=z_(),m=iw(i,d,s);for(const[h,g]of m)l.searchParams.set(h,g);return new Promise((h,g)=>w(this,void 0,void 0,function*(){const v=yield this.connectionLock.lock();try{const b=()=>w(this,void 0,void 0,function*(){this.close(),clearTimeout(k),g(new Ie("room connection has been cancelled (signal)",_e.Cancelled))}),k=setTimeout(()=>{this.close(),g(new Ie("room connection has timed out (signal)",_e.ServerUnreachable))},s.websocketTimeout);o!=null&&o.aborted&&b(),o==null||o.addEventListener("abort",b);const T=new URL(l.toString());T.searchParams.has("access_token")&&T.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(T),Object.assign({reconnect:s.reconnect,reconnectReason:s.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(l.toString()),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(k)},this.ws.onerror=E=>w(this,void 0,void 0,function*(){if(this.state!==Ve.CONNECTED){this.state=Ve.DISCONNECTED,clearTimeout(k);try{const _=new URL(l.toString());_.protocol="http".concat(_.protocol.substring(2)),_.pathname+="/validate";const O=yield fetch(_);if(O.status.toFixed(0).startsWith("4")){const q=yield O.text();g(new Ie(q,_e.NotAllowed,O.status))}else g(new Ie("Internal error",_e.InternalError,O.status))}catch(_){g(new Ie(_ instanceof Error?_.message:"server was not reachable",_e.ServerUnreachable))}return}this.handleWSError(E)}),this.ws.onmessage=E=>w(this,void 0,void 0,function*(){var _,O,q;let j;if(typeof E.data=="string"){const M=JSON.parse(E.data);j=Lv.fromJson(M,{ignoreUnknownFields:!0})}else if(E.data instanceof ArrayBuffer)j=Lv.fromBinary(new Uint8Array(E.data));else{this.log.error("could not decode websocket message: ".concat(typeof E.data),this.logContext);return}if(this.state!==Ve.CONNECTED){let M=!1;if(((_=j.message)===null||_===void 0?void 0:_.case)==="join"?(this.state=Ve.CONNECTED,o==null||o.removeEventListener("abort",b),this.pingTimeoutDuration=j.message.value.pingTimeout,this.pingIntervalDuration=j.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),h(j.message.value)):this.state===Ve.RECONNECTING&&j.message.case!=="leave"?(this.state=Ve.CONNECTED,o==null||o.removeEventListener("abort",b),this.startPingInterval(),((O=j.message)===null||O===void 0?void 0:O.case)==="reconnect"?h(j.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),h(void 0),M=!0)):this.isEstablishingConnection&&j.message.case==="leave"?g(new Ie("Received leave request while trying to (re)connect",_e.LeaveRequest,void 0,j.message.value.reason)):s.reconnect||g(new Ie("did not receive join response, got ".concat((q=j.message)===null||q===void 0?void 0:q.case," instead"),_e.InternalError)),!M)return}this.signalLatency&&(yield jt(this.signalLatency)),this.handleSignalResponse(j)}),this.ws.onclose=E=>{this.isEstablishingConnection&&g(new Ie("Websocket got closed during a (re)connection attempt",_e.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:E.reason,code:E.code,wasClean:E.wasClean,state:this.state})),this.handleOnClose(E.reason)}}finally{v()}}))}close(){return w(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const s=yield e.closingLock.lock();try{if(e.clearPingInterval(),i&&(e.state=Ve.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const o=new Promise(l=>{e.ws?e.ws.onclose=()=>{l()}:l()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([o,jt(250)])),e.ws=void 0}}finally{i&&(e.state=Ve.DISCONNECTED),s()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:qc(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:qc(e)})}sendIceCandidate(e,i){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Kf({candidateInit:JSON.stringify(e),target:i})})}sendMuteTrack(e,i){return this.sendRequest({case:"mute",value:new Qf({sid:e,muted:i})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,i){return w(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const d=l.getNextRequestId();return yield l.sendRequest({case:"updateMetadata",value:new V0({requestId:d,metadata:s,name:o,attributes:u})}),d}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,i){return this.sendRequest({case:"updateLayers",value:new H0({trackSid:e,layers:i})})}sendUpdateSubscriptionPermissions(e,i){return this.sendRequest({case:"subscriptionPermission",value:new Y0({allParticipants:e,trackPermissions:i})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Fe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new X0({timestamp:Fe.parse(Date.now()),rtt:Fe.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,i){return this.sendRequest({case:"updateAudioTrack",value:new q0({trackSid:e,features:i})})}sendLeave(){return this.sendRequest({case:"leave",value:new tl({reason:yn.CLIENT_INITIATED,action:ds.DISCONNECT})})}sendRequest(e){return w(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!o&&!nw(i)&&s.state===Ve.RECONNECTING){s.queuedRequests.push(()=>w(s,void 0,void 0,function*(){yield this.sendRequest(i,!0)}));return}if(o||(yield s.requestQueue.flush()),s.signalLatency&&(yield jt(s.signalLatency)),!s.ws||s.ws.readyState!==s.ws.OPEN){s.log.error("cannot send signal request before connected, type: ".concat(i==null?void 0:i.case),s.logContext);return}const u=new A1({message:i});try{s.useJSON?s.ws.send(u.toJsonString()):s.ws.send(u.toBinary())}catch(d){s.log.error("error sending signal message",Object.assign(Object.assign({},s.logContext),{error:d}))}}()})}handleSignalResponse(e){var i,s;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let l=!1;if(o.case==="answer"){const u=ry(o.value);this.onAnswer&&this.onAnswer(u)}else if(o.case==="offer"){const u=ry(o.value);this.onOffer&&this.onOffer(u)}else if(o.case==="trickle"){const u=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(u,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((i=o.value.participants)!==null&&i!==void 0?i:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((s=o.value.speakers)!==null&&s!==void 0?s:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),l=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));l||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return w(this,void 0,void 0,function*(){if(this.state===Ve.DISCONNECTED)return;const i=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),i&&i(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=St.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&St.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=St.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&St.clearInterval(this.pingInterval)}}function ry(a){const e={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=a.type;break}return e}function qc(a){return new Sa({sdp:a.sdp,type:a.type})}function iw(a,e,i){var s;const o=new URLSearchParams;return o.set("access_token",a),i.reconnect&&(o.set("reconnect","1"),i.sid&&o.set("sid",i.sid)),o.set("auto_subscribe",i.autoSubscribe?"1":"0"),o.set("sdk",Mn()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),i.adaptiveStream&&o.set("adaptive_stream","1"),i.reconnectReason&&o.set("reconnect_reason",i.reconnectReason.toString()),!((s=navigator.connection)===null||s===void 0)&&s.type&&o.set("network",navigator.connection.type),o}var hn={},Ld={},jd={exports:{}},oy;function ih(){if(oy)return jd.exports;oy=1;var a=jd.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var i="candidate:%s %d %s %d %s %d typ %s";return i+=e.raddr!=null?" raddr %s rport %d":"%v%v",i+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(i+=" generation %d"),i+=e["network-id"]!=null?" network-id %d":"%v",i+=e["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var i="ssrc:%d";return e.attribute!=null&&(i+=" %s",e.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var i="mediaclk:";return i+=e.id!=null?"id=%s %s":"%v%s",i+=e.mediaClockValue!=null?"=%s":"",i+=e.rateNumerator!=null?" rate=%s":"",i+=e.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(a).forEach(function(e){var i=a[e];i.forEach(function(s){s.reg||(s.reg=/(.*)/),s.format||(s.format="%s")})}),jd.exports}var cy;function aw(){return cy||(cy=1,function(a){var e=function(d){return String(Number(d))===d?Number(d):d},i=function(d,m,h,g){if(g&&!h)m[g]=e(d[1]);else for(var v=0;v<h.length;v+=1)d[v+1]!=null&&(m[h[v]]=e(d[v+1]))},s=function(d,m,h){var g=d.name&&d.names;d.push&&!m[d.push]?m[d.push]=[]:g&&!m[d.name]&&(m[d.name]={});var v=d.push?{}:g?m[d.name]:m;i(h.match(d.reg),v,d.names,d.name),d.push&&m[d.push].push(v)},o=ih(),l=RegExp.prototype.test.bind(/^([a-z])=(.*)/);a.parse=function(d){var m={},h=[],g=m;return d.split(/(\r\n|\r|\n)/).filter(l).forEach(function(v){var b=v[0],k=v.slice(2);b==="m"&&(h.push({rtp:[],fmtp:[]}),g=h[h.length-1]);for(var T=0;T<(o[b]||[]).length;T+=1){var E=o[b][T];if(E.reg.test(k))return s(E,g,k)}}),m.media=h,m};var u=function(d,m){var h=m.split(/=(.+)/,2);return h.length===2?d[h[0]]=e(h[1]):h.length===1&&m.length>1&&(d[h[0]]=void 0),d};a.parseParams=function(d){return d.split(/;\s?/).reduce(u,{})},a.parseFmtpConfig=a.parseParams,a.parsePayloads=function(d){return d.toString().split(" ").map(Number)},a.parseRemoteCandidates=function(d){for(var m=[],h=d.split(" ").map(e),g=0;g<h.length;g+=3)m.push({component:h[g],ip:h[g+1],port:h[g+2]});return m},a.parseImageAttributes=function(d){return d.split(" ").map(function(m){return m.substring(1,m.length-1).split(",").reduce(u,{})})},a.parseSimulcastStreamList=function(d){return d.split(";").map(function(m){return m.split(",").map(function(h){var g,v=!1;return h[0]!=="~"?g=e(h):(g=e(h.substring(1,h.length)),v=!0),{scid:g,paused:v}})})}}(Ld)),Ld}var Id,ly;function sw(){if(ly)return Id;ly=1;var a=ih(),e=/%[sdv%]/g,i=function(u){var d=1,m=arguments,h=m.length;return u.replace(e,function(g){if(d>=h)return g;var v=m[d];switch(d+=1,g){case"%%":return"%";case"%s":return String(v);case"%d":return Number(v);case"%v":return""}})},s=function(u,d,m){var h=d.format instanceof Function?d.format(d.push?m:m[d.name]):d.format,g=[u+"="+h];if(d.names)for(var v=0;v<d.names.length;v+=1){var b=d.names[v];d.name?g.push(m[d.name][b]):g.push(m[d.names[v]])}else g.push(m[d.name]);return i.apply(null,g)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];return Id=function(u,d){d=d||{},u.version==null&&(u.version=0),u.name==null&&(u.name=" "),u.media.forEach(function(v){v.payloads==null&&(v.payloads="")});var m=d.outerOrder||o,h=d.innerOrder||l,g=[];return m.forEach(function(v){a[v].forEach(function(b){b.name in u&&u[b.name]!=null?g.push(s(v,b,u)):b.push in u&&u[b.push]!=null&&u[b.push].forEach(function(k){g.push(s(v,b,k))})})}),u.media.forEach(function(v){g.push(s("m",a.m[0],v)),h.forEach(function(b){a[b].forEach(function(k){k.name in v&&v[k.name]!=null?g.push(s(b,k,v)):k.push in v&&v[k.push]!=null&&v[k.push].forEach(function(T){g.push(s(b,k,T))})})})}),g.join(`\r
`)+`\r
`},Id}var uy;function rw(){if(uy)return hn;uy=1;var a=aw(),e=sw(),i=ih();return hn.grammar=i,hn.write=e,hn.parse=a.parse,hn.parseParams=a.parseParams,hn.parseFmtpConfig=a.parseFmtpConfig,hn.parsePayloads=a.parsePayloads,hn.parseRemoteCandidates=a.parseRemoteCandidates,hn.parseImageAttributes=a.parseImageAttributes,hn.parseSimulcastStreamList=a.parseSimulcastStreamList,hn}var Pi=rw();function ah(a,e,i){var s,o,l;e===void 0&&(e=50),i===void 0&&(i={});var u=(s=i.isImmediate)!=null&&s,d=(o=i.callback)!=null&&o,m=i.maxWait,h=Date.now(),g=[];function v(){if(m!==void 0){var k=Date.now()-h;if(k+e>=m)return m-k}return e}var b=function(){var k=[].slice.call(arguments),T=this;return new Promise(function(E,_){var O=u&&l===void 0;if(l!==void 0&&clearTimeout(l),l=setTimeout(function(){if(l=void 0,h=Date.now(),!u){var j=a.apply(T,k);d&&d(j),g.forEach(function(M){return(0,M.resolve)(j)}),g=[]}},v()),O){var q=a.apply(T,k);return d&&d(q),E(q)}g.push({resolve:E,reject:_})})};return b.cancel=function(k){l!==void 0&&clearTimeout(l),g.forEach(function(T){return(0,T.reject)(k)}),g=[]},b}const ow=.7,cw=20,ps={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class dy extends Ln.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;super(),this.log=Ce,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=ah(o=>w(this,void 0,void 0,function*(){this.emit(ps.NegotiationStarted);try{yield this.createAndSendOffer()}catch(l){if(o)o(l);else throw l}}),cw),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ai((s=i.loggerName)!==null&&s!==void 0?s:bn.PCTransport),this.loggerOptions=i,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=i=>{var s;i.candidate&&((s=this.onIceCandidate)===null||s===void 0||s.call(this,i.candidate))},e.onicecandidateerror=i=>{var s;(s=this.onIceCandidateError)===null||s===void 0||s.call(this,i)},e.oniceconnectionstatechange=()=>{var i;(i=this.onIceConnectionStateChange)===null||i===void 0||i.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var i;(i=this.onSignalingStatechange)===null||i===void 0||i.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,e.connectionState)},e.ondatachannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},e.ontrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},e}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return w(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return w(this,void 0,void 0,function*(){var i;let s;if(e.type==="offer"){let{stereoMids:o,nackMids:l}=lw(e);this.remoteStereoMids=o,this.remoteNackMids=l}else if(e.type==="answer"){const o=Pi.parse((i=e.sdp)!==null&&i!==void 0?i:"");o.media.forEach(l=>{l.type==="audio"&&this.trackBitrates.some(u=>{if(!u.transceiver||l.mid!=u.transceiver.mid)return!1;let d=0;if(l.rtp.some(h=>h.codec.toUpperCase()===u.codec.toUpperCase()?(d=h.payload,!0):!1),d===0)return!0;let m=!1;for(const h of l.fmtp)if(h.payload===d){h.config=h.config.split(";").filter(g=>!g.includes("maxaveragebitrate")).join(";"),u.maxbr>0&&(h.config+=";maxaveragebitrate=".concat(u.maxbr*1e3)),m=!0;break}return m||u.maxbr>0&&l.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(u.maxbr*1e3)}),!0})}),s=Pi.write(o)}yield this.setMungedSDP(e,s,!0),this.pendingCandidates.forEach(o=>{this.pc.addIceCandidate(o)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(ps.NegotiationComplete),e.sdp&&Pi.parse(e.sdp).media.forEach(l=>{l.type==="video"&&this.emit(ps.RTPVideoPayloadTypes,l.rtp)}))})}createAndSendOffer(e){return w(this,void 0,void 0,function*(){var i;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const l=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&l)yield this._pc.setRemoteDescription(l);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const s=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:s.sdp},this.logContext));const o=Pi.parse((i=s.sdp)!==null&&i!==void 0?i:"");o.media.forEach(l=>{hy(l),l.type==="audio"?fy(l,[],[]):l.type==="video"&&this.trackBitrates.some(u=>{if(!l.msid||!u.cid||!l.msid.includes(u.cid))return!1;let d=0;if(l.rtp.some(h=>h.codec.toUpperCase()===u.codec.toUpperCase()?(d=h.payload,!0):!1),d===0||(Ur(u.codec)&&this.ensureVideoDDExtensionForSVC(l,o),u.codec!=="av1"))return!0;const m=Math.round(u.maxbr*ow);for(const h of l.fmtp)if(h.payload===d){h.config.includes("x-google-start-bitrate")||(h.config+=";x-google-start-bitrate=".concat(m));break}return!0})}),yield this.setMungedSDP(s,Pi.write(o)),this.onOffer(s)})}createAndSetAnswer(){return w(this,void 0,void 0,function*(){var e;const i=yield this.pc.createAnswer(),s=Pi.parse((e=i.sdp)!==null&&e!==void 0?e:"");return s.media.forEach(o=>{hy(o),o.type==="audio"&&fy(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(i,Pi.write(s)),i})}createDataChannel(e,i){return this.pc.createDataChannel(e,i)}addTransceiver(e,i){return this.pc.addTransceiver(e,i)}addTrack(e){if(!this._pc)throw new ut("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var i;if(!this._pc)throw new ut("PC closed, cannot configure");return(i=this._pc)===null||i===void 0?void 0:i.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var i;return(i=this._pc)===null||i===void 0?void 0:i.removeTrack(e)}getConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&i!==void 0?i:"closed"}getICEConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&i!==void 0?i:"closed"}getSignallingState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&i!==void 0?i:"closed"}getTransceivers(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&i!==void 0?i:[]}getSenders(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&i!==void 0?i:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return w(this,void 0,void 0,function*(){var e;if(!this._pc)return;let i="";const s=new Map,o=new Map;if((yield this._pc.getStats()).forEach(d=>{switch(d.type){case"transport":i=d.selectedCandidatePairId;break;case"candidate-pair":i===""&&d.selected&&(i=d.id),s.set(d.id,d);break;case"remote-candidate":o.set(d.id,"".concat(d.address,":").concat(d.port));break}}),i==="")return;const u=(e=s.get(i))===null||e===void 0?void 0:e.remoteCandidateId;if(u!==void 0)return o.get(u)})}setMungedSDP(e,i,s){return w(this,void 0,void 0,function*(){if(i){const o=e.sdp;e.sdp=i;try{this.log.debug("setting munged ".concat(s?"remote":"local"," description"),this.logContext),s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(l){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:l,sdp:i})),e.sdp=o}}try{s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let l="unknown error";o instanceof Error?l=o.message:typeof o=="string"&&(l=o);const u={error:l,sdp:e.sdp};throw!s&&this.pc.remoteDescription&&(u.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:u})),new bf(l)}})}ensureVideoDDExtensionForSVC(e,i){var s,o;if(!((s=e.ext)===null||s===void 0?void 0:s.some(u=>u.uri===Wv))){if(this.ddExtID===0){let u=0;i.media.forEach(d=>{var m;d.type==="video"&&((m=d.ext)===null||m===void 0||m.forEach(h=>{h.value>u&&(u=h.value)}))}),this.ddExtID=u+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:Wv})}}}function fy(a,e,i){let s=0;a.rtp.some(o=>o.codec==="opus"?(s=o.payload,!0):!1),s>0&&(a.rtcpFb||(a.rtcpFb=[]),i.includes(a.mid)&&!a.rtcpFb.some(o=>o.payload===s&&o.type==="nack")&&a.rtcpFb.push({payload:s,type:"nack"}),e.includes(a.mid)&&a.fmtp.some(o=>o.payload===s?(o.config.includes("stereo=1")||(o.config+=";stereo=1"),!0):!1))}function lw(a){var e;const i=[],s=[],o=Pi.parse((e=a.sdp)!==null&&e!==void 0?e:"");let l=0;return o.media.forEach(u=>{var d;u.type==="audio"&&(u.rtp.some(m=>m.codec==="opus"?(l=m.payload,!0):!1),!((d=u.rtcpFb)===null||d===void 0)&&d.some(m=>m.payload===l&&m.type==="nack")&&s.push(u.mid),u.fmtp.some(m=>m.payload===l?(m.config.includes("sprop-stereo=1")&&i.push(u.mid),!0):!1))}),{stereoMids:i,nackMids:s}}function hy(a){if(a.connection){const e=a.connection.ip.indexOf(":")>=0;(a.connection.version===4&&e||a.connection.version===6&&!e)&&(a.connection.ip="0.0.0.0",a.connection.version=4)}}const Of="vp8",uw={audioPreset:Sf.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:eh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Of,backupCodec:!0},Ub={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},Lb={deviceId:"default",resolution:qr.h720.resolution},dw={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new i_,disconnectOnPageLeave:!0,webAudioMix:!1},sh={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var Ze;(function(a){a[a.NEW=0]="NEW",a[a.CONNECTING=1]="CONNECTING",a[a.CONNECTED=2]="CONNECTED",a[a.FAILED=3]="FAILED",a[a.CLOSING=4]="CLOSING",a[a.CLOSED=5]="CLOSED"})(Ze||(Ze={}));class fw{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,i,s){var o;this.peerConnectionTimeout=sh.peerConnectionTimeout,this.log=Ce,this.updateState=()=>{var l;const u=this.state,d=this.requiredTransports.map(m=>m.getConnectionState());d.every(m=>m==="connected")?this.state=Ze.CONNECTED:d.some(m=>m==="failed")?this.state=Ze.FAILED:d.some(m=>m==="connecting")?this.state=Ze.CONNECTING:d.every(m=>m==="closed")?this.state=Ze.CLOSED:d.some(m=>m==="closed")?this.state=Ze.CLOSING:d.every(m=>m==="new")&&(this.state=Ze.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat(Ze[u]," to ").concat(Ze[this.state]),this.logContext),(l=this.onStateChange)===null||l===void 0||l.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=ai((o=s.loggerName)!==null&&o!==void 0?o:bn.PCManager),this.loggerOptions=s,this.isPublisherConnectionRequired=!i,this.isSubscriberConnectionRequired=i,this.publisher=new dy(e,s),this.subscriber=new dy(e,s),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=l=>{var u;(u=this.onIceCandidate)===null||u===void 0||u.call(this,l,vn.PUBLISHER)},this.subscriber.onIceCandidate=l=>{var u;(u=this.onIceCandidate)===null||u===void 0||u.call(this,l,vn.SUBSCRIBER)},this.subscriber.onDataChannel=l=>{var u;(u=this.onDataChannel)===null||u===void 0||u.call(this,l)},this.subscriber.onTrack=l=>{var u;(u=this.onTrack)===null||u===void 0||u.call(this,l)},this.publisher.onOffer=l=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,l)},this.state=Ze.NEW,this.connectionLock=new Kt,this.remoteOfferLock=new Kt}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return w(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const i of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(i)}catch(s){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:s}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return w(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,i){return w(this,void 0,void 0,function*(){i===vn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return w(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const i=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{i()}})}updateConfiguration(e,i){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),i&&this.triggerIceRestart()}ensurePCTransportConnection(e,i){return w(this,void 0,void 0,function*(){var s;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((s=this.requiredTransports)===null||s===void 0?void 0:s.map(l=>this.ensureTransportConnected(l,e,i)))}finally{o()}})}negotiate(e){return w(this,void 0,void 0,function*(){return new Promise((i,s)=>w(this,void 0,void 0,function*(){const o=setTimeout(()=>{s("negotiation timed out")},this.peerConnectionTimeout),l=()=>{clearTimeout(o),s("negotiation aborted")};e.signal.addEventListener("abort",l),this.publisher.once(ps.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(ps.NegotiationComplete,()=>{clearTimeout(o),i()})}),yield this.publisher.negotiate(u=>{clearTimeout(o),s(u)})}))})}addPublisherTransceiver(e,i){return this.publisher.addTransceiver(e,i)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,i){return this.publisher.createDataChannel(e,i)}getConnectedAddress(e){return e===vn.PUBLISHER?this.publisher.getConnectedAddress():e===vn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,i){return w(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(s.getConnectionState()!=="connected")return new Promise((m,h)=>w(l,void 0,void 0,function*(){const g=()=>{this.log.warn("abort transport connection",this.logContext),St.clearTimeout(v),h(new Ie("room connection has been cancelled",_e.Cancelled))};o!=null&&o.signal.aborted&&g(),o==null||o.signal.addEventListener("abort",g);const v=St.setTimeout(()=>{o==null||o.signal.removeEventListener("abort",g),h(new Ie("could not establish pc connection",_e.InternalError))},u);for(;this.state!==Ze.CONNECTED;)if(yield jt(50),o!=null&&o.signal.aborted){h(new Ie("room connection has been cancelled",_e.Cancelled));return}St.clearTimeout(v),o==null||o.signal.removeEventListener("abort",g),m()}))}()})}}class $e extends Error{constructor(e,i,s){super(i),this.code=e,this.message=my(i,$e.MAX_MESSAGE_BYTES),this.data=s?my(s,$e.MAX_DATA_BYTES):void 0}static fromProto(e){return new $e(e.code,e.message,e.data)}toProto(){return new N0({code:this.code,message:this.message,data:this.data})}static builtIn(e,i){return new $e($e.ErrorCode[e],$e.ErrorMessage[e],i)}}$e.MAX_MESSAGE_BYTES=256;$e.MAX_DATA_BYTES=15360;$e.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};$e.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const jb=15360;function rh(a){return new TextEncoder().encode(a).length}function my(a,e){if(rh(a)<=e)return a;let i=0,s=a.length;const o=new TextEncoder;for(;i<s;){const l=Math.floor((i+s+1)/2);o.encode(a.slice(0,l)).length<=e?i=l:s=l-1}return a.slice(0,i)}const oh=2e3;function al(a,e){if(!e)return 0;let i,s;return"bytesReceived"in a?(i=a.bytesReceived,s=e.bytesReceived):"bytesSent"in a&&(i=a.bytesSent,s=e.bytesSent),i===void 0||s===void 0||a.timestamp===void 0||e.timestamp===void 0?0:(i-s)*8*1e3/(a.timestamp-e.timestamp)}const hw=1e3;class Ib extends Q{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,i,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=arguments.length>4?arguments[4]:void 0;super(e,i,l),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=ah(()=>w(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>w(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit($.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new Kt,this.pauseUpstreamLock=new Kt,this.processorLock=new Kt,this.restartLock=new Kt,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),s&&(this._constraints=s)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Q.Kind.Video)return;const{width:e,height:i}=this._mediaStreamTrack.getSettings();if(e&&i)return{width:e,height:i}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,i;return(i=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&i!==void 0?i:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,i){return w(this,void 0,void 0,function*(){var s;if(e===this._mediaStreamTrack&&!i)return;this._mediaStreamTrack&&(this.attachedElements.forEach(l=>{hs(this._mediaStreamTrack,l)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){const l=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(us(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}finally{l()}}this.sender&&((s=this.sender.transport)===null||s===void 0?void 0:s.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(l=>{us(o??e,l)}))})}waitForDimensions(){return w(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hw;return function*(){var s;if(e.kind===Q.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((s=Pn())===null||s===void 0?void 0:s.os)==="iOS"&&(yield jt(10));const o=Date.now();for(;Date.now()-o<i;){const l=e.dimensions;if(l)return l;yield jt(50)}throw new ti("unable to get track dimensions after timeout")}()})}setDeviceId(e){return w(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Bi(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Bi(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return w(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===Q.Source.ScreenShare)return;const{deviceId:s,groupId:o}=e._mediaStreamTrack.getSettings(),l=e.kind===Q.Kind.Audio?"audioinput":"videoinput";return i?gt.getInstance().normalizeDeviceId(l,s,o):s}()})}mute(){return w(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return w(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,i){return w(this,void 0,void 0,function*(){if(!this.sender)throw new ti("unable to replace an unpublished track");let s,o;return typeof i=="boolean"?s=i:i!==void 0&&(s=i.userProvidedTrack,o=i.stopProcessor),this.providedByUser=s??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return w(this,void 0,void 0,function*(){this.manuallyStopped=!1;const i=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:s}=e,o=a_(e,["deviceId"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const l={audio:!1,video:!1};this.kind===Q.Kind.Video?l.video=s?{deviceId:s}:!0:l.audio=s?{deviceId:s}:!0,this.attachedElements.forEach(m=>{hs(this.mediaStreamTrack,m)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const d=(yield navigator.mediaDevices.getUserMedia(l)).getTracks()[0];return yield d.applyConstraints(o),d.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(d),this._constraints=e,this.emit($.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{i()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return w(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Ob()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return w(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit($.UpstreamPaused,this);const s=Pn();if((s==null?void 0:s.name)==="Safari"&&ys(s.version,"12.0")<0)throw new $f("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{i()}})}resumeUpstream(){return w(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit($.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{i()}})}getRTCStatsReport(){return w(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return w(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l;const u=yield s.processorLock.lock();try{s.log.debug("setting up processor",s.logContext);const d=document.createElement(s.kind),m={kind:s.kind,track:s._mediaStreamTrack,element:d,audioContext:s.audioContext};if(yield i.init(m),s.log.debug("processor initialized",s.logContext),s.processor&&(yield s.stopProcessor()),s.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(us(s._mediaStreamTrack,d),d.muted=!0,d.play().catch(h=>s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{error:h}))),s.processor=i,s.processorElement=d,s.processor.processedTrack){for(const h of s.attachedElements)h!==s.processorElement&&o&&(hs(s._mediaStreamTrack,h),us(s.processor.processedTrack,h));yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(s.processor.processedTrack)}s.emit($.TrackProcessorUpdate,s.processor)}finally{u()}}()})}getProcessor(){return this.processor}stopProcessor(){return w(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var s,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(s=e.processor.processedTrack)===null||s===void 0||s.stop(),yield e.processor.destroy(),e.processor=void 0,i||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit($.TrackProcessorUpdate))}()})}}class Hc extends Ib{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;super(e,Q.Kind.Audio,i,s,l),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>w(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let u;try{u=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}u&&this.prevStats&&(this._currentBitrate=al(u,this.prevStats)),this.prevStats=u}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,An.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,An.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return w(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return w(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const s=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Bi(this._constraints.deviceId);return this.source===Q.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||s)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{i()}})}restartTrack(e){return w(this,void 0,void 0,function*(){let i;if(e){const s=il({audio:e});typeof s.audio!="boolean"&&(i=s.audio)}yield this.restart(i)})}restart(e){const i=Object.create(null,{restart:{get:()=>super.restart}});return w(this,void 0,void 0,function*(){const s=yield i.restart.call(this,e);return this.checkForSilence(),s})}startMonitor(){Ut()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},oh)))}setProcessor(e){return w(this,void 0,void 0,function*(){var i;const s=yield this.processorLock.lock();try{if(!Mn()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit($.TrackProcessorUpdate,this.processor)}finally{s()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return w(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const i=yield this.sender.getStats();let s;return i.forEach(o=>{o.type==="outbound-rtp"&&(s={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),s})}checkForSilence(){return w(this,void 0,void 0,function*(){const e=yield Pb(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit($.AudioSilenceDetected)),e})}}function Bb(a,e,i){switch(a.kind){case"audio":return new Hc(a,e,!1,void 0,i);case"video":return new Vc(a,e,!1,i);default:throw new ti("unsupported track type: ".concat(a.kind))}}const mw=Object.values(qr),pw=Object.values(Tf),gw=Object.values(eh),vw=[qr.h180,qr.h360],yw=[Tf.h180,Tf.h360],bw=a=>[{scaleResolutionDownBy:2,fps:a.encoding.maxFramerate}].map(i=>{var s,o;return new Le(Math.floor(a.width/i.scaleResolutionDownBy),Math.floor(a.height/i.scaleResolutionDownBy),Math.max(15e4,Math.floor(a.encoding.maxBitrate/(Math.pow(i.scaleResolutionDownBy,2)*(((s=a.encoding.maxFramerate)!==null&&s!==void 0?s:30)/((o=i.fps)!==null&&o!==void 0?o:30))))),i.fps,a.encoding.priority)}),xf=["q","h","f"];function Df(a,e,i,s){var o,l;let u=s==null?void 0:s.videoEncoding;a&&(u=s==null?void 0:s.screenShareEncoding);const d=s==null?void 0:s.simulcast,m=s==null?void 0:s.scalabilityMode,h=s==null?void 0:s.videoCodec;if(!u&&!d&&!m||!e||!i)return[{}];u||(u=Tw(a,e,i,h),Ce.debug("using video encoding",u));const g=u.maxFramerate,v=new Le(e,i,u.maxBitrate,u.maxFramerate,u.priority);if(m&&Ur(h)){const T=new zb(m),E=[];if(T.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(m));const _=Pn();if(qi()||Mn()||(_==null?void 0:_.name)==="Chrome"&&ys(_==null?void 0:_.version,"113")<0){const O=T.suffix=="h"?2:3;for(let q=0;q<T.spatial;q+=1)E.push({rid:xf[2-q],maxBitrate:u.maxBitrate/Math.pow(O,q),maxFramerate:v.encoding.maxFramerate});E[0].scalabilityMode=m}else E.push({maxBitrate:u.maxBitrate,maxFramerate:v.encoding.maxFramerate,scalabilityMode:m});return v.encoding.priority&&(E[0].priority=v.encoding.priority,E[0].networkPriority=v.encoding.priority),Ce.debug("using svc encoding",{encodings:E}),E}if(!d)return[u];let b=[];a?b=(o=gy(s==null?void 0:s.screenShareSimulcastLayers))!==null&&o!==void 0?o:py(a,v):b=(l=gy(s==null?void 0:s.videoSimulcastLayers))!==null&&l!==void 0?l:py(a,v);let k;if(b.length>0){const T=b[0];b.length>1&&([,k]=b);const E=Math.max(e,i);if(E>=960&&k)return Bd(e,i,[T,k,v],g);if(E>=480)return Bd(e,i,[T,v],g)}return Bd(e,i,[v])}function Sw(a,e,i){var s,o,l,u;if(!i.backupCodec||i.backupCodec===!0||i.backupCodec.codec===i.videoCodec)return;e!==i.backupCodec.codec&&Ce.warn("requested a different codec than specified as backup",{serverRequested:e,backup:i.backupCodec.codec}),i.videoCodec=e,i.videoEncoding=i.backupCodec.encoding;const d=a.mediaStreamTrack.getSettings(),m=(s=d.width)!==null&&s!==void 0?s:(o=a.dimensions)===null||o===void 0?void 0:o.width,h=(l=d.height)!==null&&l!==void 0?l:(u=a.dimensions)===null||u===void 0?void 0:u.height;return a.source===Q.Source.ScreenShare&&i.simulcast&&(i.simulcast=!1),Df(a.source===Q.Source.ScreenShare,m,h,i)}function Tw(a,e,i,s){const o=kw(a,e,i);let{encoding:l}=o[0];const u=Math.max(e,i);for(let d=0;d<o.length;d+=1){const m=o[d];if(l=m.encoding,m.width>=u)break}if(s)switch(s){case"av1":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.7;break;case"vp9":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.85;break}return l}function kw(a,e,i){if(a)return gw;const s=e>i?e/i:i/e;return Math.abs(s-16/9)<Math.abs(s-4/3)?mw:pw}function py(a,e){if(a)return bw(e);const{width:i,height:s}=e,o=i>s?i/s:s/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?vw:yw}function Bd(a,e,i,s){const o=[];if(i.forEach((l,u)=>{if(u>=xf.length)return;const d=Math.min(a,e),h={rid:xf[u],scaleResolutionDownBy:Math.max(1,d/Math.min(l.width,l.height)),maxBitrate:l.encoding.maxBitrate},g=s&&l.encoding.maxFramerate?Math.min(s,l.encoding.maxFramerate):l.encoding.maxFramerate;g&&(h.maxFramerate=g);const v=vs()||u===0;l.encoding.priority&&v&&(h.priority=l.encoding.priority,h.networkPriority=l.encoding.priority),o.push(h)}),Mn()&&Db()==="ios"){let l;o.forEach(d=>{l?d.maxFramerate&&d.maxFramerate>l&&(l=d.maxFramerate):l=d.maxFramerate});let u=!0;o.forEach(d=>{var m;d.maxFramerate!=l&&(u&&(u=!1,Ce.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Ce.info('Setting framerate of encoding "'.concat((m=d.rid)!==null&&m!==void 0?m:"",'" to ').concat(l)),d.maxFramerate=l)})}return o}function gy(a){if(a)return a.sort((e,i)=>{const{encoding:s}=e,{encoding:o}=i;return s.maxBitrate>o.maxBitrate?1:s.maxBitrate<o.maxBitrate?-1:s.maxBitrate===o.maxBitrate&&s.maxFramerate&&o.maxFramerate?s.maxFramerate>o.maxFramerate?1:-1:0})}class zb{constructor(e){const i=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!i)throw new Error("invalid scalability mode");if(this.spatial=parseInt(i[1]),this.temporal=parseInt(i[2]),i.length>3)switch(i[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=i[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function Cw(a){return a.source===Q.Source.ScreenShare||a.constraints.height&&Bi(a.constraints.height)>=1080?"maintain-resolution":"balanced"}const Ew=5e3;class Vc extends Ib{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,Q.Kind.Video,i,s,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>w(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}const u=new Map(l.map(d=>[d.rid,d]));if(this.prevStats){let d=0;u.forEach((m,h)=>{var g;const v=(g=this.prevStats)===null||g===void 0?void 0:g.get(h);d+=al(m,v)}),this._currentBitrate=d}this.prevStats=u}),this.senderLock=new Kt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var i;if(this.signalClient=e,!Ut())return;const s=(i=this.sender)===null||i===void 0?void 0:i.getParameters();s&&(this.encodings=s.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},oh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return w(this,void 0,void 0,function*(){var i,s,o,l,u;yield e.pauseUpstream.call(this);try{for(var d=!0,m=Ui(this.simulcastCodecs.values()),h;h=yield m.next(),i=h.done,!i;d=!0)l=h.value,d=!1,yield(u=l.sender)===null||u===void 0?void 0:u.replaceTrack(null)}catch(g){s={error:g}}finally{try{!d&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(s)throw s.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return w(this,void 0,void 0,function*(){var i,s,o,l,u;yield e.resumeUpstream.call(this);try{for(var d=!0,m=Ui(this.simulcastCodecs.values()),h;h=yield m.next(),i=h.done,!i;d=!0){l=h.value,d=!1;const g=l;yield(u=g.sender)===null||u===void 0?void 0:u.replaceTrack(g.mediaStreamTrack)}}catch(g){s={error:g}}finally{try{!d&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(s)throw s.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return w(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return w(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.source===Q.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{i()}})}setTrackMuted(e){super.setTrackMuted(e);for(const i of this.simulcastCodecs.values())i.mediaStreamTrack.enabled=!e}getSenderStats(){return w(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const i=[],s=yield this.sender.getStats();return s.forEach(o=>{var l;if(o.type==="outbound-rtp"){const u={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(l=o.rid)!==null&&l!==void 0?l:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},d=s.get(o.remoteId);d&&(u.jitter=d.jitter,u.packetsLost=d.packetsLost,u.roundTripTime=d.roundTripTime),i.push(u)}}),i.sort((o,l)=>{var u,d;return((u=l.frameWidth)!==null&&u!==void 0?u:0)-((d=o.frameWidth)!==null&&d!==void 0?d:0)}),i})}setPublishingQuality(e){const i=[];for(let s=cn.LOW;s<=cn.HIGH;s+=1)i.push(new Jf({quality:s,enabled:s<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(i)}restartTrack(e){return w(this,void 0,void 0,function*(){var i,s,o,l,u;let d;if(e){const v=il({video:e});typeof v.video!="boolean"&&(d=v.video)}yield this.restart(d);try{for(var m=!0,h=Ui(this.simulcastCodecs.values()),g;g=yield h.next(),i=g.done,!i;m=!0){l=g.value,m=!1;const v=l;v.sender&&((u=v.sender.transport)===null||u===void 0?void 0:u.state)!=="closed"&&(v.mediaStreamTrack=this.mediaStreamTrack.clone(),yield v.sender.replaceTrack(v.mediaStreamTrack))}}catch(v){s={error:v}}finally{try{!m&&!i&&(o=h.return)&&(yield o.call(h))}finally{if(s)throw s.error}}})}setProcessor(e){const i=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return w(this,arguments,void 0,function(s){var o=this;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var u,d,m,h,g,v;if(yield i.setProcessor.call(o,s,l),!((g=o.processor)===null||g===void 0)&&g.processedTrack)try{for(var b=!0,k=Ui(o.simulcastCodecs.values()),T;T=yield k.next(),u=T.done,!u;b=!0)h=T.value,b=!1,yield(v=h.sender)===null||v===void 0?void 0:v.replaceTrack(o.processor.processedTrack)}catch(E){d={error:E}}finally{try{!b&&!u&&(m=k.return)&&(yield m.call(k))}finally{if(d)throw d.error}}}()})}setDegradationPreference(e){return w(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const i=this.sender.getParameters();i.degradationPreference=e,this.sender.setParameters(i)}catch(i){this.log.warn("failed to set degradationPreference",Object.assign({error:i},this.logContext))}})}addSimulcastTrack(e,i){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const s={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:i};return this.simulcastCodecs.set(e,s),s}setSimulcastTrackSender(e,i){const s=this.simulcastCodecs.get(e);s&&(s.sender=i,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Ew))}setPublishingCodecs(e){return w(this,void 0,void 0,function*(){var i,s,o,l,u,d,m;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const h=[];try{for(i=!0,s=Ui(e);o=yield s.next(),l=o.done,!l;i=!0){m=o.value,i=!1;const g=m;if(!this.codec||this.codec===g.codec)yield this.setPublishingLayers(g.qualities);else{const v=this.simulcastCodecs.get(g.codec);if(this.log.debug("try setPublishingCodec for ".concat(g.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:v})),!v||!v.sender){for(const b of g.qualities)if(b.enabled){h.push(g.codec);break}}else v.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(g.codec),this.logContext),yield vy(v.sender,v.encodings,g.qualities,this.senderLock,this.log,this.logContext))}}}catch(g){u={error:g}}finally{try{!i&&!l&&(d=s.return)&&(yield d.call(s))}finally{if(u)throw u.error}}return h})}setPublishingLayers(e){return w(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield vy(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return w(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Ob()&&this.isInBackground&&this.source===Q.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function vy(a,e,i,s,o,l){return w(this,void 0,void 0,function*(){const u=yield s.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},l),{sender:a,qualities:i,senderEncodings:e}));try{const d=a.getParameters(),{encodings:m}=d;if(!m)return;if(m.length!==e.length){o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},l),{encodings:m,senderEncodings:e}));return}let h=!1;!1&&m[0].scalabilityMode||m.forEach((v,b)=>{var k;let T=(k=v.rid)!==null&&k!==void 0?k:"";T===""&&(T="q");const E=qb(T),_=i.find(O=>O.quality===E);_&&v.active!==_.enabled&&(h=!0,v.active=_.enabled,o.debug("setting layer ".concat(_.quality," to ").concat(v.active?"enabled":"disabled"),l),vs()&&(_.enabled?(v.scaleResolutionDownBy=e[b].scaleResolutionDownBy,v.maxBitrate=e[b].maxBitrate,v.maxFrameRate=e[b].maxFrameRate):(v.scaleResolutionDownBy=4,v.maxBitrate=10,v.maxFrameRate=2)))}),h&&(d.encodings=m,o.debug("setting encodings",Object.assign(Object.assign({},l),{encodings:d.encodings})),yield a.setParameters(d))}finally{u()}})}function qb(a){switch(a){case"f":return cn.HIGH;case"h":return cn.MEDIUM;case"q":return cn.LOW;default:return cn.HIGH}}function yy(a,e,i,s){if(!i)return[new ya({quality:cn.HIGH,width:a,height:e,bitrate:0,ssrc:0})];if(s){const o=i[0].scalabilityMode,l=new zb(o),u=[],d=l.suffix=="h"?1.5:2,m=l.suffix=="h"?2:3;for(let h=0;h<l.spatial;h+=1)u.push(new ya({quality:Math.min(cn.HIGH,l.spatial-1)-h,width:Math.ceil(a/Math.pow(d,h)),height:Math.ceil(e/Math.pow(d,h)),bitrate:i[0].maxBitrate?Math.ceil(i[0].maxBitrate/Math.pow(m,h)):0,ssrc:0}));return u}return i.map(o=>{var l,u,d;const m=(l=o.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let h=qb((u=o.rid)!==null&&u!==void 0?u:"");return new ya({quality:h,width:Math.ceil(a/m),height:Math.ceil(e/m),bitrate:(d=o.maxBitrate)!==null&&d!==void 0?d:0,ssrc:0})})}const by="_lossy",Sy="_reliable",Rw=2*1e3,zd="leave-reconnect";var mn;(function(a){a[a.New=0]="New",a[a.Connected=1]="Connected",a[a.Disconnected=2]="Disconnected",a[a.Reconnecting=3]="Reconnecting",a[a.Closed=4]="Closed"})(mn||(mn={}));class _w extends Ln.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var i;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=sh.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=mn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Ce,this.handleDataChannel=s=>w(this,[s],void 0,function(o){var l=this;let{channel:u}=o;return function*(){if(u){if(u.label===Sy)l.reliableDCSub=u;else if(u.label===by)l.lossyDCSub=u;else return;l.log.debug("on data channel ".concat(u.id,", ").concat(u.label),l.logContext),u.onmessage=l.handleDataMessage}}()}),this.handleDataMessage=s=>w(this,void 0,void 0,function*(){var o,l;const u=yield this.dataProcessLock.lock();try{let d;if(s.data instanceof ArrayBuffer)d=s.data;else if(s.data instanceof Blob)d=yield s.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:s.data}));return}const m=Pt.fromBinary(new Uint8Array(d));((o=m.value)===null||o===void 0?void 0:o.case)==="speaker"?this.emit(te.ActiveSpeakersUpdate,m.value.value.speakers):(((l=m.value)===null||l===void 0?void 0:l.case)==="user"&&Ow(m,m.value.value),this.emit(te.DataPacketReceived,m))}finally{u()}}),this.handleDataError=s=>{const l=s.currentTarget.maxRetransmits===0?"lossy":"reliable";if(s instanceof ErrorEvent&&s.error){const{error:u}=s.error;this.log.error("DataChannel error on ".concat(l,": ").concat(s.message),Object.assign(Object.assign({},this.logContext),{error:u}))}else this.log.error("Unknown DataChannel error on ".concat(l),Object.assign(Object.assign({},this.logContext),{event:s}))},this.handleBufferedAmountLow=s=>{const l=s.currentTarget.maxRetransmits===0?we.LOSSY:we.RELIABLE;this.updateAndEmitDCBufferStatus(l)},this.handleDisconnect=(s,o)=>{if(this._isClosed)return;this.log.warn("".concat(s," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const l=m=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(m,"ms. giving up"),this.logContext),this.emit(te.Disconnected),this.close()},u=Date.now()-this.reconnectStart;let d=this.getNextRetryDelay({elapsedMs:u,retryCount:this.reconnectAttempts});if(d===null){l(u);return}s===zd&&(d=0),this.log.debug("reconnecting in ".concat(d,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=St.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),d)},this.waitForRestarted=()=>new Promise((s,o)=>{this.pcState===mn.Connected&&s();const l=()=>{this.off(te.Disconnected,u),s()},u=()=>{this.off(te.Restarted,l),o()};this.once(te.Restarted,l),this.once(te.Disconnected,u)}),this.updateAndEmitDCBufferStatus=s=>{const o=this.isBufferStatusLow(s);typeof o<"u"&&o!==this.dcBufferStatus.get(s)&&(this.dcBufferStatus.set(s,o),this.emit(te.DCBufferStatusChanged,o,s))},this.isBufferStatusLow=s=>{const o=this.dataChannelForKind(s);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Ve.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(os.RR_SIGNAL_DISCONNECTED))},this.log=ai((i=e.loggerName)!==null&&i!==void 0?i:bn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new nh(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Kt,this.dataProcessLock=new Kt,this.dcBufferStatus=new Map([[we.LOSSY,!0],[we.RELIABLE,!0]]),this.client.onParticipantUpdate=s=>this.emit(te.ParticipantUpdate,s),this.client.onConnectionQuality=s=>this.emit(te.ConnectionQualityUpdate,s),this.client.onRoomUpdate=s=>this.emit(te.RoomUpdate,s),this.client.onSubscriptionError=s=>this.emit(te.SubscriptionError,s),this.client.onSubscriptionPermissionUpdate=s=>this.emit(te.SubscriptionPermissionUpdate,s),this.client.onSpeakersChanged=s=>this.emit(te.SpeakersChanged,s),this.client.onStreamStateUpdate=s=>this.emit(te.StreamStateChanged,s),this.client.onRequestResponse=s=>this.emit(te.SignalRequestResponse,s)}get logContext(){var e,i,s,o,l,u,d,m;return{room:(i=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||i===void 0?void 0:i.name,roomID:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.room)===null||o===void 0?void 0:o.sid,participant:(u=(l=this.latestJoinResponse)===null||l===void 0?void 0:l.participant)===null||u===void 0?void 0:u.identity,pID:(m=(d=this.latestJoinResponse)===null||d===void 0?void 0:d.participant)===null||m===void 0?void 0:m.sid}}join(e,i,s,o){return w(this,void 0,void 0,function*(){this.url=e,this.token=i,this.signalOpts=s,this.maxJoinAttempts=s.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const l=yield this.client.join(e,i,s,o);return this._isClosed=!1,this.latestJoinResponse=l,this.subscriberPrimary=l.subscriberPrimary,this.pcManager||(yield this.configure(l)),(!this.subscriberPrimary||l.fastPublish)&&this.negotiate(),this.clientConfiguration=l.clientConfiguration,l}catch(l){if(l instanceof Ie&&l.reason===_e.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,i,s,o);throw l}})}close(){return w(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(te.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return w(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const i=s=>{s&&(s.close(),s.onbufferedamountlow=null,s.onclose=null,s.onclosing=null,s.onerror=null,s.onmessage=null,s.onopen=null)};i(this.lossyDC),i(this.lossyDCSub),i(this.reliableDC),i(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return w(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ti("a track with the same ID has already been published");return new Promise((i,s)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],s(new Ie("publication of local track timed out, no response from server",_e.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:l=>{clearTimeout(o),i(l)},reject:()=>{clearTimeout(o),s(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:i}=this.pendingTrackResolvers[e.track.id];i&&i(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(i){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:i}))}return!1}updateMuteStatus(e,i){this.client.sendMuteTrack(e,i)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return w(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return w(this,void 0,void 0,function*(){var i,s;if(this.pcManager&&this.pcManager.currentState!==Ze.NEW)return;this.participantSid=(i=e.participant)===null||i===void 0?void 0:i.sid;const o=this.makeRTCConfiguration(e);this.pcManager=new fw(o,e.subscriberPrimary,this.loggerOptions),this.emit(te.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(l,u)=>{this.client.sendIceCandidate(l,u)},this.pcManager.onPublisherOffer=l=>{this.client.sendOffer(l)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(l,u,d)=>w(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(l),this.logContext),["closed","disconnected","failed"].includes(u)&&(this.publisherConnectionPromise=void 0),l===Ze.CONNECTED){const g=this.pcState===mn.New;this.pcState=mn.Connected,g&&this.emit(te.Connected,e)}else l===Ze.FAILED&&this.pcState===mn.Connected&&(this.pcState=mn.Disconnected,this.handleDisconnect("peerconnection failed",d==="failed"?os.RR_SUBSCRIBER_FAILED:os.RR_PUBLISHER_FAILED));const m=this.client.isDisconnected||this.client.currentState===Ve.RECONNECTING,h=[Ze.FAILED,Ze.CLOSING,Ze.CLOSED].includes(l);m&&h&&!this._isClosed&&this.emit(te.Offline)}),this.pcManager.onTrack=l=>{this.emit(te.MediaTrackAdded,l.track,l.streams[0],l.receiver)},ww((s=e.serverInfo)===null||s===void 0?void 0:s.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>w(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,i)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:i})),this.pcManager.addIceCandidate(e,i))},this.client.onOffer=e=>w(this,void 0,void 0,function*(){if(!this.pcManager)return;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(i)}),this.client.onLocalTrackPublished=e=>{var i;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(i=e.track)===null||i===void 0?void 0:i.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:s}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],s(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(te.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(te.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,i)=>{this.emit(te.RemoteMute,e,i)},this.client.onSubscribedQualityUpdate=e=>{this.emit(te.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",os.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case ds.DISCONNECT:this.emit(te.Disconnected,e==null?void 0:e.reason),this.close();break;case ds.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(zd);break;case ds.RESUME:this.handleDisconnect(zd)}}}makeRTCConfiguration(e){var i;const s=Object.assign({},this.rtcConfig);if(!((i=this.signalOpts)===null||i===void 0)&&i.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),s.encodedInsertableStreams=!0),e.iceServers&&!s.iceServers){const o=[];e.iceServers.forEach(l=>{const u={urls:l.urls};l.username&&(u.username=l.username),l.credential&&(u.credential=l.credential),o.push(u)}),s.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Br.ENABLED&&(s.iceTransportPolicy="relay"),s.sdpSemantics="unified-plan",s.continualGatheringPolicy="gather_continually",s}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(by,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Sy,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,i,s){return w(this,void 0,void 0,function*(){if(kf())return yield this.createTransceiverRTCRtpSender(e,i,s);if(Cf())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new ut("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,i,s,o){return w(this,void 0,void 0,function*(){if(kf())return this.createSimulcastTransceiverSender(e,i,s,o);if(Cf())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new ut("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,i,s){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),Es(e)&&(e.codec=i.videoCodec);const l={direction:"sendonly",streams:o};return s&&(l.sendEncodings=s),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,l)).sender})}createSimulcastTransceiverSender(e,i,s,o){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");const l={direction:"sendonly"};o&&(l.sendEncodings=o);const u=yield this.pcManager.addPublisherTransceiver(i.mediaStreamTrack,l);if(s.videoCodec)return e.setSimulcastTrackSender(s.videoCodec,u.sender),u.sender})}createRTCRtpSender(e){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return w(this,void 0,void 0,function*(){var i,s,o;if(!this._isClosed){if(this.attemptingReconnect){Ce.warn("already attempting reconnect, returning early",this.logContext);return}(((i=this.clientConfiguration)===null||i===void 0?void 0:i.resumeConnection)===Br.DISABLED||((o=(s=this.pcManager)===null||s===void 0?void 0:s.currentState)!==null&&o!==void 0?o:Ze.NEW)===Ze.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(l){this.reconnectAttempts+=1;let u=!0;l instanceof ut?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:l})),u=!1):l instanceof cs||(this.fullReconnectOnNext=!0),u?this.handleDisconnect("reconnect",os.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(te.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(i){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:i}))}return null}restartConnection(e){return w(this,void 0,void 0,function*(){var i,s,o;try{if(!this.url||!this.token)throw new ut("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(te.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let l;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new cs;l=yield this.join(e??this.url,this.token,this.signalOpts)}catch(u){throw u instanceof Ie&&u.reason===_e.NotAllowed?new ut("could not reconnect, token might be expired"):new cs}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(te.SignalRestarted,l),yield this.waitForPCReconnected(),this.client.currentState!==Ve.CONNECTED)throw new cs("Signal connection got severed during reconnect");(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),this.emit(te.Restarted)}catch(l){const u=yield(s=this.regionUrlProvider)===null||s===void 0?void 0:s.getNextBestRegionUrl();if(u){yield this.restartConnection(u);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),l}})}resumeConnection(e){return w(this,void 0,void 0,function*(){var i;if(!this.url||!this.token)throw new ut("could not reconnect, url or token not saved");if(!this.pcManager)throw new ut("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(te.Resuming);let s;try{this.setupSignalClientCallbacks(),s=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let l="";throw o instanceof Error&&(l=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof Ie&&o.reason===_e.NotAllowed?new ut("could not reconnect, token might be expired"):o instanceof Ie&&o.reason===_e.LeaveRequest?o:new cs(l)}if(this.emit(te.SignalResumed),s){const o=this.makeRTCConfiguration(s);this.pcManager.updateConfiguration(o)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Ve.CONNECTED)throw new cs("Signal connection got severed during reconnect");this.client.setReconnected(),((i=this.reliableDC)===null||i===void 0?void 0:i.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(te.Resumed)})}waitForPCInitialConnection(e,i){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(i,e)})}waitForPCReconnected(){return w(this,void 0,void 0,function*(){this.pcState=mn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield jt(Rw),!this.pcManager)throw new ut("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=mn.Connected}catch(e){throw this.pcState=mn.Disconnected,new Ie("could not establish PC connection, ".concat(e.message),_e.InternalError)}})}publishRpcResponse(e,i,s,o){return w(this,void 0,void 0,function*(){const l=new Pt({destinationIdentities:[e],kind:we.RELIABLE,value:{case:"rpcResponse",value:new A0({requestId:i,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:s??""}})}});yield this.sendDataPacket(l,we.RELIABLE)})}publishRpcAck(e,i){return w(this,void 0,void 0,function*(){const s=new Pt({destinationIdentities:[e],kind:we.RELIABLE,value:{case:"rpcAck",value:new D0({requestId:i})}});yield this.sendDataPacket(s,we.RELIABLE)})}sendDataPacket(e,i){return w(this,void 0,void 0,function*(){const s=e.toBinary();yield this.ensurePublisherConnected(i);const o=this.dataChannelForKind(i);o&&o.send(s),this.updateAndEmitDCBufferStatus(i)})}waitForBufferStatusLow(e){return new Promise((i,s)=>w(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))i();else{const o=()=>s("Engine closed");for(this.once(te.Closing,o);!this.dcBufferStatus.get(e);)yield jt(10);this.off(te.Closing,o),i()}}))}ensureDataTransportConnected(e){return w(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var l;if(!s.pcManager)throw new ut("PC manager is closed");const u=o?s.pcManager.subscriber:s.pcManager.publisher,d=o?"Subscriber":"Publisher";if(!u)throw new Ie("".concat(d," connection not set"),_e.InternalError);let m=!1;!o&&!s.dataChannelForKind(i,o)&&(s.createDataChannels(),m=!0),!m&&!o&&!s.pcManager.publisher.isICEConnected&&s.pcManager.publisher.getICEConnectionState()!=="checking"&&(m=!0),m&&s.negotiate();const h=s.dataChannelForKind(i,o);if((h==null?void 0:h.readyState)==="open")return;const g=new Date().getTime()+s.peerConnectionTimeout;for(;new Date().getTime()<g;){if(u.isICEConnected&&((l=s.dataChannelForKind(i,o))===null||l===void 0?void 0:l.readyState)==="open")return;yield jt(50)}throw new Ie("could not establish ".concat(d," connection, state: ").concat(u.getICEConnectionState()),_e.InternalError)}()})}ensurePublisherConnected(e){return w(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==Ze.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return w(this,void 0,void 0,function*(){return new Promise((e,i)=>w(this,void 0,void 0,function*(){if(!this.pcManager){i(new bf("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const s=new AbortController,o=()=>{s.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&i("cannot negotiate on closed engine"),this.on(te.Closing,o),this.pcManager.publisher.once(ps.RTPVideoPayloadTypes,l=>{const u=new Map;l.forEach(d=>{const m=d.codec.toLowerCase();q_(m)&&u.set(d.payload,m)}),this.emit(te.RTPVideoMapUpdate,u)});try{yield this.pcManager.negotiate(s),e()}catch(l){l instanceof bf&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",os.RR_UNKNOWN),i(l)}finally{this.off(te.Closing,o)}}))})}dataChannelForKind(e,i){if(i){if(e===we.LOSSY)return this.lossyDCSub;if(e===we.RELIABLE)return this.reliableDCSub}else{if(e===we.LOSSY)return this.lossyDC;if(e===we.RELIABLE)return this.reliableDC}}sendSyncState(e,i){var s,o;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const l=this.pcManager.subscriber.getLocalDescription(),u=this.pcManager.subscriber.getRemoteDescription(),d=(o=(s=this.signalOpts)===null||s===void 0?void 0:s.autoSubscribe)!==null&&o!==void 0?o:!0,m=new Array,h=new Array;e.forEach(g=>{g.isDesired!==d&&m.push(g.trackSid),g.isEnabled||h.push(g.trackSid)}),this.client.sendSyncState(new K0({answer:l?qc({sdp:l.sdp,type:l.type}):void 0,offer:u?qc({sdp:u.sdp,type:u.type}):void 0,subscription:new el({trackSids:m,subscribe:!d,participantTracks:[]}),publishTracks:X_(i),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:h}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],i=(s,o)=>{(s==null?void 0:s.id)!==void 0&&s.id!==null&&e.push(new Q0({label:s.label,id:s.id,target:o}))};return i(this.dataChannelForKind(we.LOSSY),vn.PUBLISHER),i(this.dataChannelForKind(we.RELIABLE),vn.PUBLISHER),i(this.dataChannelForKind(we.LOSSY,!0),vn.SUBSCRIBER),i(this.dataChannelForKind(we.RELIABLE,!0),vn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&St.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Ut()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Ut()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class cs extends Error{}function ww(a){return a!==void 0&&a>13}function Ow(a,e){const i=a.participantIdentity?a.participantIdentity:e.participantIdentity;a.participantIdentity=i,e.participantIdentity=i;const s=a.destinationIdentities.length!==0?a.destinationIdentities:e.destinationIdentities;a.destinationIdentities=s,e.destinationIdentities=s}class Af{constructor(e,i){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=i}updateToken(e){this.token=e}isCloud(){return Rf(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return w(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const i=this.regionSettings.regions.filter(s=>!this.attemptedRegions.find(o=>o.url===s.url));if(i.length>0){const s=i[0];return this.attemptedRegions.push(s),Ce.debug("next region: ".concat(s.region)),s.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return w(this,void 0,void 0,function*(){const i=yield fetch("".concat(xw(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(i.ok){const s=yield i.json();return this.lastUpdateAt=Date.now(),s}else throw new Ie("Could not fetch region settings: ".concat(i.statusText),i.status===401?_e.NotAllowed:_e.InternalError,i.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function xw(a){return"".concat(a.protocol.replace("ws","http"),"//").concat(a.host,"/settings")}class Hb{get info(){return this._info}constructor(e,i,s){this.reader=i,this.totalByteSize=s,this._info=e,this.bytesReceived=0}}class Dw extends Hb{handleChunkReceived(e){var i;this.bytesReceived+=e.content.byteLength;const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>w(this,void 0,void 0,function*(){try{const{done:i,value:s}=yield e.read();return i?{done:!0,value:void 0}:(this.handleChunkReceived(s),{done:!1,value:s.content})}catch{return{done:!0,value:void 0}}}),return(){return w(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return w(this,void 0,void 0,function*(){var e,i,s,o;let l=new Set;try{for(var u=!0,d=Ui(this),m;m=yield d.next(),e=m.done,!e;u=!0){o=m.value,u=!1;const h=o;l.add(h)}}catch(h){i={error:h}}finally{try{!u&&!e&&(s=d.return)&&(yield s.call(d))}finally{if(i)throw i.error}}return Array.from(l)})}}class Aw extends Hb{constructor(e,i,s){super(e,i,s),this.receivedChunks=new Map}handleChunkReceived(e){var i;const s=Ac(e.chunkIndex),o=this.receivedChunks.get(s);if(o&&o.version>e.version)return;this.receivedChunks.set(s,e),this.bytesReceived+=e.content.byteLength;const l=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,l)}[Symbol.asyncIterator](){const e=this.reader.getReader(),i=new TextDecoder;return{next:()=>w(this,void 0,void 0,function*(){try{const{done:s,value:o}=yield e.read();return s?{done:!0,value:void 0}:(this.handleChunkReceived(o),{done:!1,value:i.decode(o.content)})}catch{return{done:!0,value:void 0}}}),return(){return w(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return w(this,void 0,void 0,function*(){var e,i,s,o;let l="";try{for(var u=!0,d=Ui(this),m;m=yield d.next(),e=m.done,!e;u=!0)o=m.value,u=!1,l+=o}catch(h){i={error:h}}finally{try{!u&&!e&&(s=d.return)&&(yield s.call(d))}finally{if(i)throw i.error}}return l})}}class Nw{constructor(e,i,s){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=s,this.info=i}write(e){return this.defaultWriter.write(e)}close(){return w(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class Pw extends Nw{}class Vb extends Q{constructor(e,i,s,o,l){super(e,s,l),this.sid=i,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const i=s=>{s.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",i),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit($.Ended,this))};e.addEventListener("removetrack",i)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return w(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),oh)),J_()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var i;this.timeSyncHandle=requestAnimationFrame(()=>e());const s=(i=this.receiver)===null||i===void 0?void 0:i.getSynchronizationSources()[0];if(s){const{timestamp:o,rtpTimestamp:l}=s;l&&this.rtpTimestamp!==l&&(this.emit($.TimeSyncUpdate,{timestamp:o,rtpTimestamp:l}),this.rtpTimestamp=l)}};e()}}class Mw extends Vb{constructor(e,i,s,o,l,u){super(e,i,Q.Kind.Audio,s,u),this.monitorReceiver=()=>w(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=al(d,this.prevStats)),this.prevStats=d}),this.audioContext=o,this.webAudioPluginNodes=[],l&&(this.sinkId=l.deviceId)}setVolume(e){var i;for(const s of this.attachedElements)this.audioContext?(i=this.gainNode)===null||i===void 0||i.gain.setTargetAtTime(e,0,.1):s.volume=e;Mn()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Mn())return 1;let e=0;return this.attachedElements.forEach(i=>{i.volume>e&&(e=i.volume)}),e}setSinkId(e){return w(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(i=>{if(Ef(i))return i.setSinkId(e)}))})}attach(e){const i=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ef(e)&&e.setSinkId(this.sinkId),this.audioContext&&i&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let i;return e?(i=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(i=super.detach(),this.disconnectWebAudio()),i}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,i){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(i.srcObject);let s=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{s.connect(o),s=o}),this.gainNode=e.createGain(),s.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit($.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit($.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,i;(e=this.gainNode)===null||e===void 0||e.disconnect(),(i=this.sourceNode)===null||i===void 0||i.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return w(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i;return e.forEach(s=>{s.type==="inbound-rtp"&&(i={type:"audio",streamId:s.id,timestamp:s.timestamp,jitter:s.jitter,bytesReceived:s.bytesReceived,concealedSamples:s.concealedSamples,concealmentEvents:s.concealmentEvents,silentConcealedSamples:s.silentConcealedSamples,silentConcealmentEvents:s.silentConcealmentEvents,totalAudioEnergy:s.totalAudioEnergy,totalSamplesDuration:s.totalSamplesDuration})}),i})}}const qd=100;class Uw extends Vb{constructor(e,i,s,o,l){super(e,i,Q.Kind.Video,s,l),this.elementInfos=[],this.monitorReceiver=()=>w(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=al(u,this.prevStats)),this.prevStats=u}),this.debouncedHandleResize=ah(()=>{this.updateDimensions()},qd),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(i=>{e?hs(this._mediaStreamTrack,i):us(this._mediaStreamTrack,i)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(i=>i.element===e)===void 0){const i=new Lw(e);this.observeElementInfo(i)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(i=>i===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const i=this.elementInfos.filter(s=>s===e);for(const s of i)s.stopObserving();this.elementInfos=this.elementInfos.filter(s=>s!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let i=[];if(e)return this.stopObservingElement(e),super.detach(e);i=super.detach();for(const s of i)this.stopObservingElement(s);return i}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return w(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i,s="",o=new Map;return e.forEach(l=>{l.type==="inbound-rtp"?(s=l.codecId,i={type:"video",streamId:l.id,framesDecoded:l.framesDecoded,framesDropped:l.framesDropped,framesReceived:l.framesReceived,packetsReceived:l.packetsReceived,packetsLost:l.packetsLost,frameWidth:l.frameWidth,frameHeight:l.frameHeight,pliCount:l.pliCount,firCount:l.firCount,nackCount:l.nackCount,jitter:l.jitter,timestamp:l.timestamp,bytesReceived:l.bytesReceived,decoderImplementation:l.decoderImplementation}):l.type==="codec"&&o.set(l.id,l)}),i&&s!==""&&o.get(s)&&(i.mimeType=o.get(s).mimeType),i})}stopObservingElement(e){const i=this.elementInfos.filter(s=>s.element===e);for(const s of i)this.stopObservingElementInfo(s)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return w(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,i;const s=this.elementInfos.reduce((d,m)=>Math.max(d,m.visibilityChangedAt||0),0),o=!((i=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&i!==void 0)||i?this.isInBackground:!1,l=this.elementInfos.some(d=>d.pictureInPicture),u=this.elementInfos.some(d=>d.visible)&&!o||l;if(this.lastVisible!==u){if(!u&&Date.now()-s<qd){St.setTimeout(()=>{this.updateVisibility()},qd);return}this.lastVisible=u,this.emit($.VisibilityChanged,u,this)}}updateDimensions(){var e,i;let s=0,o=0;const l=this.getPixelDensity();for(const u of this.elementInfos){const d=u.width()*l,m=u.height()*l;d+m>s+o&&(s=d,o=m)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===s&&((i=this.lastDimensions)===null||i===void 0?void 0:i.height)===o||(this.lastDimensions={width:s,height:o},this.emit($.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const i=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return i==="screen"?$v():i||($v()>2?2:1)}}class Lw{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,i){this.onVisibilityChanged=s=>{var o;const{target:l,isIntersecting:u}=s;l===this.element&&(this.isIntersecting=u,this.isPiP=Ar(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var s,o,l;(o=(s=window.documentPictureInPicture)===null||s===void 0?void 0:s.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Ar(this.element),(l=this.handleVisibilityChanged)===null||l===void 0||l.call(this)},this.onLeavePiP=()=>{var s;this.isPiP=Ar(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.element=e,this.isIntersecting=i??Nf(e),this.isPiP=Ut()&&Ar(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,i,s;this.isIntersecting=Nf(this.element),this.isPiP=Ar(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,ty().observe(this.element),ey().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(s=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||s===void 0||s.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,i,s,o,l;(e=ty())===null||e===void 0||e.unobserve(this.element),(i=ey())===null||i===void 0||i.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(s=window.documentPictureInPicture)===null||s===void 0||s.removeEventListener("enter",this.onEnterPiP),(l=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||l===void 0||l.removeEventListener("pagehide",this.onLeavePiP)}}function Ar(a){var e,i;return document.pictureInPictureElement===a?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Nf(a,(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window):!1}function Nf(a,e){const i=e||window;let s=a.offsetTop,o=a.offsetLeft;const l=a.offsetWidth,u=a.offsetHeight,{hidden:d}=a,{display:m}=getComputedStyle(a);for(;a.offsetParent;)a=a.offsetParent,s+=a.offsetTop,o+=a.offsetLeft;return s<i.pageYOffset+i.innerHeight&&o<i.pageXOffset+i.innerWidth&&s+u>i.pageYOffset&&o+l>i.pageXOffset&&!d&&m!=="none"}class Mi extends Ln.EventEmitter{constructor(e,i,s,o){var l;super(),this.metadataMuted=!1,this.encryption=Yt.NONE,this.log=Ce,this.handleMuted=()=>{this.emit($.Muted)},this.handleUnmuted=()=>{this.emit($.Unmuted)},this.log=ai((l=o==null?void 0:o.loggerName)!==null&&l!==void 0?l:bn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=i,this.trackName=s,this.source=Q.Source.Unknown}setTrack(e){this.track&&(this.track.off($.Muted,this.handleMuted),this.track.off($.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on($.Muted,this.handleMuted),e.on($.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Pe(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Yt.NONE}get audioTrack(){if(si(this.track))return this.track}get videoTrack(){if(Es(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Q.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Q.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(a){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(a.SubscriptionStatus||(a.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(a.PermissionStatus||(a.PermissionStatus={}))})(Mi);class Pf extends Mi{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit($.Ended)},this.updateInfo(i),this.setTrack(s)}setTrack(e){this.track&&this.track.off($.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on($.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return w(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return w(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return w(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return w(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(si(this.track)){const i=this.track.getSourceTrackSettings(),s=new Set;return i.autoGainControl&&s.add(An.TF_AUTO_GAIN_CONTROL),i.echoCancellation&&s.add(An.TF_ECHO_CANCELLATION),i.noiseSuppression&&s.add(An.TF_NOISE_SUPPRESSION),i.channelCount&&i.channelCount>1&&s.add(An.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||s.add(An.TF_NO_DTX),this.track.enhancedNoiseCancellation&&s.add(An.TF_ENHANCED_NOISE_CANCELLATION),Array.from(s.values())}else return[]}}var Li;(function(a){a.Excellent="excellent",a.Good="good",a.Poor="poor",a.Lost="lost",a.Unknown="unknown"})(Li||(Li={}));function jw(a){switch(a){case Nr.EXCELLENT:return Li.Excellent;case Nr.GOOD:return Li.Good;case Nr.POOR:return Li.Poor;case Nr.LOST:return Li.Lost;default:return Li.Unknown}}class Fb extends Ln.EventEmitter{get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Bc.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,i,s,o,l,u){let d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Bc.STANDARD;var m;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Li.Unknown,this.log=Ce,this.log=ai((m=u==null?void 0:u.loggerName)!==null&&m!==void 0?m:bn.Participant),this.loggerOptions=u,this.setMaxListeners(100),this.sid=e,this.identity=i,this.name=s,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=d,this._attributes=l??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,i]of this.trackPublications)if(i.source===e)return i}getTrackPublicationByName(e){for(const[,i]of this.trackPublications)if(i.trackName===e)return i}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const i=this.getTrackPublication(Q.Source.Camera);return!(!((e=i==null?void 0:i.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const i=this.getTrackPublication(Q.Source.Microphone);return!(!((e=i==null?void 0:i.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Q.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const i=this.metadata!==e,s=this.metadata;this.metadata=e,i&&this.emit(ie.ParticipantMetadataChanged,s)}_setName(e){const i=this.name!==e;this.name=e,i&&this.emit(ie.ParticipantNameChanged,e)}_setAttributes(e){const i=Z_(this.attributes,e);this._attributes=e,Object.keys(i).length>0&&this.emit(ie.AttributesChanged,i)}setPermissions(e){var i,s,o,l,u,d;const m=this.permissions,h=e.canPublish!==((i=this.permissions)===null||i===void 0?void 0:i.canPublish)||e.canSubscribe!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((l=this.permissions)===null||l===void 0?void 0:l.hidden)||e.recorder!==((u=this.permissions)===null||u===void 0?void 0:u.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((g,v)=>{var b;return g!==((b=this.permissions)===null||b===void 0?void 0:b.canPublishSources[v])})||e.canSubscribeMetrics!==((d=this.permissions)===null||d===void 0?void 0:d.canSubscribeMetrics);return this.permissions=e,h&&this.emit(ie.ParticipantPermissionsChanged,m),h}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ie.IsSpeakingChanged,e))}setConnectionQuality(e){const i=this._connectionQuality;this._connectionQuality=jw(e),i!==this._connectionQuality&&this.emit(ie.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(i=>si(i.track)&&i.track.setAudioContext(e))}addTrackPublication(e){e.on($.Muted,()=>{this.emit(ie.TrackMuted,e)}),e.on($.Unmuted,()=>{this.emit(ie.TrackUnmuted,e)});const i=e;switch(i.track&&(i.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Q.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Q.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function Iw(a){var e,i,s;if(!a.participantSid&&!a.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new G0({participantIdentity:(e=a.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(i=a.participantSid)!==null&&i!==void 0?i:"",allTracks:(s=a.allowAll)!==null&&s!==void 0?s:!1,trackSids:a.allowedTrackSids||[]})}const fc=15e3;class Bw extends Fb{constructor(e,i,s,o,l){super(e,i,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Yt.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Ab)},this.handleReconnected=()=>{var u,d;(d=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||d===void 0||d.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var u,d;this.reconnectFuture&&(this.reconnectFuture.promise.catch(m=>this.log.warn(m.message,this.logContext)),(d=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||d===void 0||d.call(u,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=u=>{const{requestId:d,reason:m,message:h}=u,g=this.pendingSignalRequests.get(d);g&&(m!==Zf.OK&&g.reject(new Xv(h,m)),this.pendingSignalRequests.delete(d))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let d=u.value.value,m=null,h=null;d.value.case==="payload"?m=d.value.value:d.value.case==="error"&&(h=$e.fromProto(d.value.value)),this.handleIncomingRpcResponse(d.requestId,m,h);break;case"rpcAck":let g=u.value.value;this.handleIncomingRpcAck(g.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>Iw(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,d)=>{if(d===void 0&&(d=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Pe(u)));return}this.engine.updateMuteStatus(u.sid,d)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Pe(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Pe(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const d=this.audioTrackPublications.get(u.sid);if(!d){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(d.trackSid,d.getTrackFeatures())},this.handleSubscribedQualityUpdate=u=>w(this,void 0,void 0,function*(){var d,m,h,g,v,b;if(!(!((v=this.roomOptions)===null||v===void 0)&&v.dynacast))return;const k=this.videoTrackPublications.get(u.trackSid);if(!k){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(u.subscribedCodecs.length>0){if(!k.videoTrack)return;const O=yield k.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var T=!0,E=Ui(O),_;_=yield E.next(),d=_.done,!d;T=!0){g=_.value,T=!1;const q=g;D_(q)&&(this.log.debug("publish ".concat(q," for ").concat(k.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Pe(k))),yield this.publishAdditionalCodecForTrack(k.videoTrack,q,k.options))}}catch(q){m={error:q}}finally{try{!T&&!d&&(h=E.return)&&(yield h.call(E))}finally{if(m)throw m.error}}}else u.subscribedQualities.length>0&&(yield(b=k.videoTrack)===null||b===void 0?void 0:b.setPublishingLayers(u.subscribedQualities))}),this.handleLocalTrackUnpublished=u=>{const d=this.trackPublications.get(u.trackSid);if(!d){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(d.track)},this.handleTrackEnded=u=>w(this,void 0,void 0,function*(){if(u.source===Q.Source.ScreenShare||u.source===Q.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Pe(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(ma(u)||Ni(u))try{if(Ut())try{const d=yield navigator==null?void 0:navigator.permissions.query({name:u.source===Q.Source.Camera?"camera":"microphone"});if(d&&d.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),Pe(u))),d.onchange=()=>{d.state!=="denied"&&(u.isMuted||u.restartTrack(),d.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Pe(u))),ma(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Pe(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=s,this.roomOptions=o,this.setupEngine(s),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=l}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Yt.NONE}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setupEngine(e){this.engine=e,this.engine.on(te.RemoteMute,(i,s)=>{const o=this.trackPublications.get(i);!o||!o.track||(s?o.mute():o.unmute())}),this.engine.on(te.Connected,this.handleReconnected).on(te.SignalRestarted,this.handleReconnected).on(te.SignalResumed,this.handleReconnected).on(te.Restarting,this.handleReconnecting).on(te.Resuming,this.handleReconnecting).on(te.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(te.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(te.Disconnected,this.handleDisconnected).on(te.SignalRequestResponse,this.handleSignalRequestResponse).on(te.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return w(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return w(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return w(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return w(this,arguments,void 0,function(i){var s=this;let{metadata:o,name:l,attributes:u}=i;return function*(){return new Promise((d,m)=>w(s,void 0,void 0,function*(){var h,g;try{let v=!1;const b=yield this.engine.client.sendUpdateLocalMetadata((h=o??this.metadata)!==null&&h!==void 0?h:"",(g=l??this.name)!==null&&g!==void 0?g:"",u),k=performance.now();for(this.pendingSignalRequests.set(b,{resolve:d,reject:T=>{m(T),v=!0},values:{name:l,metadata:o,attributes:u}});performance.now()-k<5e3&&!v;){if((!l||this.name===l)&&(!o||this.metadata===o)&&(!u||Object.entries(u).every(T=>{let[E,_]=T;return this.attributes[E]===_||_===""&&!this.attributes[E]}))){this.pendingSignalRequests.delete(b),d();return}yield jt(50)}m(new Xv("Request to update local metadata timed out","TimeoutError"))}catch(v){v instanceof Error&&m(v)}}))}()})}setCameraEnabled(e,i,s){return this.setTrackEnabled(Q.Source.Camera,e,i,s)}setMicrophoneEnabled(e,i,s){return this.setTrackEnabled(Q.Source.Microphone,e,i,s)}setScreenShareEnabled(e,i,s){return this.setTrackEnabled(Q.Source.ScreenShare,e,i,s)}setPermissions(e){const i=this.permissions,s=super.setPermissions(e);return s&&i&&this.emit(ie.ParticipantPermissionsChanged,i),s}setE2EEEnabled(e){return w(this,void 0,void 0,function*(){this.encryptionType=e?Yt.GCM:Yt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,i,s,o){return w(this,void 0,void 0,function*(){var l,u;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:i})),this.republishPromise&&(yield this.republishPromise);let d=this.getTrackPublication(e);if(i)if(d)yield d.unmute();else{let m;if(this.pendingPublishing.has(e)){const h=yield this.waitForPendingPublicationOfSource(e);return h||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield h==null?void 0:h.unmute(),h}this.pendingPublishing.add(e);try{switch(e){case Q.Source.Camera:m=yield this.createTracks({video:(l=s)!==null&&l!==void 0?l:!0});break;case Q.Source.Microphone:m=yield this.createTracks({audio:(u=s)!==null&&u!==void 0?u:!0});break;case Q.Source.ScreenShare:m=yield this.createScreenTracks(Object.assign({},s));break;default:throw new ti(e)}}catch(h){throw m==null||m.forEach(g=>{g.stop()}),h instanceof Error&&this.emit(ie.MediaDevicesError,h),this.pendingPublishing.delete(e),h}try{const h=[];for(const v of m)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Pe(v))),h.push(this.publishTrack(v,o));[d]=yield Promise.all(h)}catch(h){throw m==null||m.forEach(g=>{g.stop()}),h}finally{this.pendingPublishing.delete(e)}}else if(!(d!=null&&d.track)&&this.pendingPublishing.has(e)&&(d=yield this.waitForPendingPublicationOfSource(e),d||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),d&&d.track)if(e===Q.Source.ScreenShare){d=yield this.unpublishTrack(d.track);const m=this.getTrackPublication(Q.Source.ScreenShareAudio);m&&m.track&&this.unpublishTrack(m.track)}else yield d.mute();return d})}enableCameraAndMicrophone(){return w(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Q.Source.Camera)||this.pendingPublishing.has(Q.Source.Microphone))){this.pendingPublishing.add(Q.Source.Camera),this.pendingPublishing.add(Q.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(i=>this.publishTrack(i)))}finally{this.pendingPublishing.delete(Q.Source.Camera),this.pendingPublishing.delete(Q.Source.Microphone)}}})}createTracks(e){return w(this,void 0,void 0,function*(){var i,s;e??(e={});const o=Nb(e,(i=this.roomOptions)===null||i===void 0?void 0:i.audioCaptureDefaults,(s=this.roomOptions)===null||s===void 0?void 0:s.videoCaptureDefaults),{audioProcessor:l,videoProcessor:u,optionsWithoutProcessor:d}=th(o),m=il(d);let h;try{h=yield navigator.mediaDevices.getUserMedia(m)}catch(g){throw g instanceof Error&&(m.audio&&(this.microphoneError=g),m.video&&(this.cameraError=g)),g}return m.audio&&(this.microphoneError=void 0,this.emit(ie.AudioStreamAcquired)),m.video&&(this.cameraError=void 0),Promise.all(h.getTracks().map(g=>w(this,void 0,void 0,function*(){const v=g.kind==="audio";let b;const k=v?m.audio:m.video;typeof k!="boolean"&&(b=k);const T=Bb(g,b,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return T.kind===Q.Kind.Video?T.source=Q.Source.Camera:T.kind===Q.Kind.Audio&&(T.source=Q.Source.Microphone,T.setAudioContext(this.audioContext)),T.mediaStream=h,si(T)&&l?yield T.setProcessor(l):Es(T)&&u&&(yield T.setProcessor(u)),T})))})}createScreenTracks(e){return w(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new $f("getDisplayMedia not supported");e.resolution===void 0&&!L_()&&(e.resolution=eh.h1080fps30.resolution);const i=Q_(e),s=yield navigator.mediaDevices.getDisplayMedia(i),o=s.getVideoTracks();if(o.length===0)throw new ti("no video track found");const l=new Vc(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});l.source=Q.Source.ScreenShare,e.contentHint&&(l.mediaStreamTrack.contentHint=e.contentHint);const u=[l];if(s.getAudioTracks().length>0){this.emit(ie.AudioStreamAcquired);const d=new Hc(s.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});d.source=Q.Source.ScreenShareAudio,u.push(d)}return u})}publishTrack(e,i){return w(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,i)})}publishOrRepublishTrack(e,i){return w(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var d,m,h,g;ma(s)&&s.setAudioContext(l.audioContext),yield(d=l.reconnectFuture)===null||d===void 0?void 0:d.promise,l.republishPromise&&!u&&(yield l.republishPromise),ms(s)&&l.pendingPublishPromises.has(s)&&(yield l.pendingPublishPromises.get(s));let v;if(s instanceof MediaStreamTrack)v=s.getConstraints();else{v=s.constraints;let O;switch(s.source){case Q.Source.Microphone:O="audioinput";break;case Q.Source.Camera:O="videoinput"}O&&l.activeDeviceMap.has(O)&&(v=Object.assign(Object.assign({},v),{deviceId:l.activeDeviceMap.get(O)}))}if(s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new Hc(s,v,!0,l.audioContext,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;case"video":s=new Vc(s,v,!0,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;default:throw new ti("unsupported MediaStreamTrack kind ".concat(s.kind))}else s.updateLoggerOptions({loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});let b;if(l.trackPublications.forEach(O=>{O.track&&O.track===s&&(b=O)}),b)return l.log.warn("track has already been published, skipping",Object.assign(Object.assign({},l.logContext),Pe(b))),b;const k="channelCount"in s.mediaStreamTrack.getSettings()&&s.mediaStreamTrack.getSettings().channelCount===2||s.mediaStreamTrack.getConstraints().channelCount===2,T=(m=o==null?void 0:o.forceStereo)!==null&&m!==void 0?m:k;T&&(o||(o={}),o.dtx===void 0&&l.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},l.logContext),Pe(s))),o.red===void 0&&l.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(h=o.dtx)!==null&&h!==void 0||(o.dtx=!1),(g=o.red)!==null&&g!==void 0||(o.red=!1));const E=Object.assign(Object.assign({},l.roomOptions.publishDefaults),o);!j_()&&l.roomOptions.e2ee&&(l.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},l.logContext)),E.simulcast=!1),E.source&&(s.source=E.source);const _=l.publish(s,E,T);l.pendingPublishPromises.set(s,_);try{return yield _}catch(O){throw O}finally{l.pendingPublishPromises.delete(s)}}()})}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Pe(e))),!1;const{canPublish:i,canPublishSources:s}=this.permissions;return i&&(s.length===0||s.map(o=>W_(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Pe(e))),!1)}publish(e,i,s){return w(this,void 0,void 0,function*(){var o,l,u,d,m,h,g,v,b,k;if(!this.hasPermissionsToPublish(e))throw new S_("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(x=>ms(e)&&x.source===e.source)&&e.source!==Q.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Pe(e))),i.stopMicTrackOnMute&&si(e)&&(e.stopOnMute=!0),e.source===Q.Source.ScreenShare&&vs()&&(i.simulcast=!1),i.videoCodec==="av1"&&!P_()&&(i.videoCodec=void 0),i.videoCodec==="vp9"&&!M_()&&(i.videoCodec=void 0),i.videoCodec===void 0&&(i.videoCodec=Of),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(x=>i.videoCodec===Nc(x.mime))||(i.videoCodec=Nc(this.enabledPublishVideoCodecs[0].mime)));const E=i.videoCodec;e.on($.Muted,this.onTrackMuted),e.on($.Unmuted,this.onTrackUnmuted),e.on($.Ended,this.handleTrackEnded),e.on($.UpstreamPaused,this.onTrackUpstreamPaused),e.on($.UpstreamResumed,this.onTrackUpstreamResumed),e.on($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const _=new uf({cid:e.mediaStreamTrack.id,name:i.name,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),disableDtx:!(!((o=i.dtx)!==null&&o!==void 0)||o),encryption:this.encryptionType,stereo:s,disableRed:this.isE2EEEnabled||!(!((l=i.red)!==null&&l!==void 0)||l),stream:i==null?void 0:i.stream,backupCodecPolicy:i==null?void 0:i.backupCodecPolicy});let O;if(e.kind===Q.Kind.Video){let x={width:0,height:0};try{x=yield e.waitForDimensions()}catch{const W=(d=(u=this.roomOptions.videoCaptureDefaults)===null||u===void 0?void 0:u.resolution)!==null&&d!==void 0?d:qr.h720.resolution;x={width:W.width,height:W.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Pe(e)),{dims:x}))}_.width=x.width,_.height=x.height,Ni(e)&&(Ur(E)&&(e.source===Q.Source.ScreenShare&&(i.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Pe(e))))),i.scalabilityMode=(m=i.scalabilityMode)!==null&&m!==void 0?m:"L3T3_KEY"),_.simulcastCodecs=[new lf({codec:E,cid:e.mediaStreamTrack.id})],i.backupCodec===!0&&(i.backupCodec={codec:Of}),i.backupCodec&&E!==i.backupCodec.codec&&_.encryption===Yt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),_.simulcastCodecs.push(new lf({codec:i.backupCodec.codec,cid:""})))),O=Df(e.source===Q.Source.ScreenShare,_.width,_.height,i),_.layers=yy(_.width,_.height,O,Ur(i.videoCodec))}else e.kind===Q.Kind.Audio&&(O=[{maxBitrate:(h=i.audioPreset)===null||h===void 0?void 0:h.maxBitrate,priority:(v=(g=i.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&v!==void 0?v:"high",networkPriority:(k=(b=i.audioPreset)===null||b===void 0?void 0:b.priority)!==null&&k!==void 0?k:"high"}]);if(!this.engine||this.engine.isClosed)throw new ut("cannot publish track when not connected");const q=()=>w(this,void 0,void 0,function*(){var x,F,W;if(!this.engine.pcManager)throw new ut("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,i,O),Ni(e)&&((x=i.degradationPreference)!==null&&x!==void 0||(i.degradationPreference=Cw(e)),e.setDegradationPreference(i.degradationPreference)),O)if(vs()&&e.kind===Q.Kind.Audio){let ae;for(const X of this.engine.pcManager.publisher.getTransceivers())if(X.sender===e.sender){ae=X;break}ae&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ae,codec:"opus",maxbr:!((F=O[0])===null||F===void 0)&&F.maxBitrate?O[0].maxBitrate/1e3:0})}else e.codec&&Ur(e.codec)&&(!((W=O[0])===null||W===void 0)&&W.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:_.cid,codec:e.codec,maxbr:O[0].maxBitrate/1e3});yield this.engine.negotiate()});let j;if(this.enabledPublishVideoCodecs.length>0)j=(yield Promise.all([this.engine.addTrack(_),q()]))[0];else{j=yield this.engine.addTrack(_);let x;if(j.codecs.forEach(F=>{x===void 0&&(x=F.mimeType)}),x&&e.kind===Q.Kind.Video){const F=Nc(x);F!==E&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Pe(e)),{codec:F})),i.videoCodec=F,O=Df(e.source===Q.Source.ScreenShare,_.width,_.height,i))}yield q()}const M=new Pf(e.kind,j,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return M.options=i,e.sid=j.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:O,trackInfo:j})),Ni(e)?e.startMonitor(this.engine.client):ma(e)&&e.startMonitor(),this.addTrackPublication(M),this.emit(ie.LocalTrackPublished,M),M})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,i,s){return w(this,void 0,void 0,function*(){var o;if(this.encryptionType!==Yt.NONE)return;let l;if(this.trackPublications.forEach(k=>{k.track&&k.track===e&&(l=k)}),!l)throw new ti("track is not published");if(!Ni(e))throw new ti("track is not a video track");const u=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),s),d=Sw(e,i,u);if(!d){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Pe(e)));return}const m=e.addSimulcastTrack(i,d);if(!m)return;const h=new uf({cid:m.mediaStreamTrack.id,type:Q.kindToProto(e.kind),muted:e.isMuted,source:Q.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:u.videoCodec,cid:m.mediaStreamTrack.id}]});if(h.layers=yy(h.width,h.height,d),!this.engine||this.engine.isClosed)throw new ut("cannot publish track when not connected");const g=()=>w(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,m,u,d),yield this.engine.negotiate()}),b=(yield Promise.all([this.engine.addTrack(h),g()]))[0];this.log.debug("published ".concat(i," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:d,trackInfo:b}))})}unpublishTrack(e,i){return w(this,void 0,void 0,function*(){var s,o;if(ms(e)){const h=this.pendingPublishPromises.get(e);h&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Pe(e))),yield h)}const l=this.getPublicationForTrack(e),u=l?Pe(l):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),u)),!l||!l.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),u));return}e=l.track,e.off($.Muted,this.onTrackMuted),e.off($.Unmuted,this.onTrackUnmuted),e.off($.Ended,this.handleTrackEnded),e.off($.UpstreamPaused,this.onTrackUpstreamPaused),e.off($.UpstreamResumed,this.onTrackUpstreamResumed),e.off($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),i===void 0&&(i=(o=(s=this.roomOptions)===null||s===void 0?void 0:s.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),i?e.stop():e.stopMonitor();let d=!1;const m=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<Ze.FAILED&&m)try{for(const h of this.engine.pcManager.publisher.getTransceivers())h.sender===m&&(h.direction="inactive",d=!0);if(this.engine.removeTrack(m)&&(d=!0),Ni(e)){for(const[,h]of e.simulcastCodecs)h.sender&&(this.engine.removeTrack(h.sender)&&(d=!0),h.sender=void 0);e.simulcastCodecs.clear()}}catch(h){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),u),{error:h}))}switch(this.trackPublications.delete(l.trackSid),l.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(l.trackSid);break;case Q.Kind.Video:this.videoTrackPublications.delete(l.trackSid);break}return this.emit(ie.LocalTrackUnpublished,l),l.setTrack(void 0),d&&(yield this.engine.negotiate()),l})}unpublishTracks(e){return w(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>this.unpublishTrack(s)))).filter(s=>!!s)})}republishAllTracks(e){return w(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){s.republishPromise&&(yield s.republishPromise),s.republishPromise=new Promise((l,u)=>w(s,void 0,void 0,function*(){try{const d=[];this.trackPublications.forEach(m=>{m.track&&(i&&(m.options=Object.assign(Object.assign({},m.options),i)),d.push(m))}),yield Promise.all(d.map(m=>w(this,void 0,void 0,function*(){const h=m.track;yield this.unpublishTrack(h,!1),o&&!h.isMuted&&h.source!==Q.Source.ScreenShare&&h.source!==Q.Source.ScreenShareAudio&&(ma(h)||Ni(h))&&!h.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:m.trackSid})),yield h.restartTrack()),yield this.publishOrRepublishTrack(h,m.options,!0)}))),l()}catch(d){u(d)}finally{this.republishPromise=void 0}})),yield s.republishPromise}()})}publishData(e){return w(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const l=o.reliable?we.RELIABLE:we.LOSSY,u=o.destinationIdentities,d=o.topic,m=new Pt({kind:l,value:{case:"user",value:new w0({participantIdentity:s.identity,payload:i,destinationIdentities:u,topic:d})}});yield s.engine.sendDataPacket(m,l)}()})}publishDtmf(e,i){return w(this,void 0,void 0,function*(){const s=new Pt({kind:we.RELIABLE,value:{case:"sipDtmf",value:new O0({code:e,digit:i})}});yield this.engine.sendDataPacket(s,we.RELIABLE)})}sendChatMessage(e,i){return w(this,void 0,void 0,function*(){const s={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:i==null?void 0:i.attachments},o=new Pt({value:{case:"chatMessage",value:new nf(Object.assign(Object.assign({},s),{timestamp:Fe.parse(s.timestamp)}))}});return yield this.engine.sendDataPacket(o,we.RELIABLE),this.emit(ie.ChatMessage,s),s})}editChatMessage(e,i){return w(this,void 0,void 0,function*(){const s=Object.assign(Object.assign({},i),{message:e,editTimestamp:Date.now()}),o=new Pt({value:{case:"chatMessage",value:new nf(Object.assign(Object.assign({},s),{timestamp:Fe.parse(s.timestamp),editTimestamp:Fe.parse(s.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,we.RELIABLE),this.emit(ie.ChatMessage,s),s})}sendText(e,i){return w(this,void 0,void 0,function*(){var s;const o=crypto.randomUUID(),u=new TextEncoder().encode(e).byteLength,d=(s=i==null?void 0:i.attachments)===null||s===void 0?void 0:s.map(()=>crypto.randomUUID()),m=new Array(d?d.length+1:1).fill(0),h=(v,b)=>{var k;m[b]=v;const T=m.reduce((E,_)=>E+_,0);(k=i==null?void 0:i.onProgress)===null||k===void 0||k.call(i,T)},g=yield this.streamText({streamId:o,totalSize:u,destinationIdentities:i==null?void 0:i.destinationIdentities,topic:i==null?void 0:i.topic,attachedStreamIds:d,attributes:i==null?void 0:i.attributes});return yield g.write(e),h(1,0),yield g.close(),i!=null&&i.attachments&&d&&(yield Promise.all(i.attachments.map((v,b)=>w(this,void 0,void 0,function*(){return this._sendFile(d[b],v,{topic:i.topic,mimeType:v.type,onProgress:k=>{h(k,b+1)}})})))),g.info})}streamText(e){return w(this,void 0,void 0,function*(){var i,s;const o=(i=e==null?void 0:e.streamId)!==null&&i!==void 0?i:crypto.randomUUID(),l={id:o,mimeType:"text/plain",timestamp:Date.now(),topic:(s=e==null?void 0:e.topic)!==null&&s!==void 0?s:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes},u=new sf({streamId:o,mimeType:l.mimeType,topic:l.topic,timestamp:ha(l.timestamp),totalLength:ha(e==null?void 0:e.totalSize),attributes:l.attributes,contentHeader:{case:"textHeader",value:new I0({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?af.UPDATE:af.CREATE})}}),d=e==null?void 0:e.destinationIdentities,m=new Pt({destinationIdentities:d,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(m,we.RELIABLE);let h=0;const g=this,v=new WritableStream({write(T){return w(this,void 0,void 0,function*(){for(const E of K_(T,fc)){yield g.engine.waitForBufferStatusLow(we.RELIABLE);const _=new rf({content:E,streamId:o,chunkIndex:ha(h)}),O=new Pt({destinationIdentities:d,value:{case:"streamChunk",value:_}});yield g.engine.sendDataPacket(O,we.RELIABLE),h+=1}})},close(){return w(this,void 0,void 0,function*(){const T=new of({streamId:o}),E=new Pt({destinationIdentities:d,value:{case:"streamTrailer",value:T}});yield g.engine.sendDataPacket(E,we.RELIABLE)})},abort(T){console.log("Sink error:",T)}});let b=()=>w(this,void 0,void 0,function*(){yield k.close()});g.engine.once(te.Closing,b);const k=new Pw(v,l,()=>this.engine.off(te.Closing,b));return k})}sendFile(e,i){return w(this,void 0,void 0,function*(){const s=crypto.randomUUID();return yield this._sendFile(s,e,i),{id:s}})}_sendFile(e,i,s){return w(this,void 0,void 0,function*(){var o,l;const u=i.size,d=new sf({totalLength:ha(u),mimeType:(o=s==null?void 0:s.mimeType)!==null&&o!==void 0?o:i.type,streamId:e,topic:s==null?void 0:s.topic,encryptionType:s==null?void 0:s.encryptionType,timestamp:ha(Date.now()),contentHeader:{case:"byteHeader",value:new B0({name:i.name})}}),m=s==null?void 0:s.destinationIdentities,h=new Pt({destinationIdentities:m,value:{case:"streamHeader",value:d}});yield this.engine.sendDataPacket(h,we.RELIABLE);function g(T){return new Promise(E=>{const _=new FileReader;_.onload=()=>{E(new Uint8Array(_.result))},_.readAsArrayBuffer(T)})}const v=Math.ceil(u/fc);for(let T=0;T<v;T++){const E=yield g(i.slice(T*fc,Math.min((T+1)*fc,u)));yield this.engine.waitForBufferStatusLow(we.RELIABLE);const _=new rf({content:E,streamId:e,chunkIndex:ha(T)}),O=new Pt({destinationIdentities:m,value:{case:"streamChunk",value:_}});yield this.engine.sendDataPacket(O,we.RELIABLE),(l=s==null?void 0:s.onProgress)===null||l===void 0||l.call(s,(T+1)/v)}const b=new of({streamId:e}),k=new Pt({destinationIdentities:m,value:{case:"streamTrailer",value:b}});yield this.engine.sendDataPacket(k,we.RELIABLE)})}performRpc(e){return w(this,arguments,void 0,function(i){var s=this;let{destinationIdentity:o,method:l,payload:u,responseTimeout:d=1e4}=i;return function*(){return new Promise((h,g)=>w(s,void 0,void 0,function*(){var v,b,k,T;if(rh(u)>jb){g($e.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((b=(v=this.engine.latestJoinResponse)===null||v===void 0?void 0:v.serverInfo)===null||b===void 0)&&b.version&&ys((T=(k=this.engine.latestJoinResponse)===null||k===void 0?void 0:k.serverInfo)===null||T===void 0?void 0:T.version,"1.8.0")<0){g($e.builtIn("UNSUPPORTED_SERVER"));return}const E=crypto.randomUUID();yield this.publishRpcRequest(o,E,l,u,d-2e3);const _=setTimeout(()=>{this.pendingAcks.delete(E),g($e.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(E),clearTimeout(O)},2e3);this.pendingAcks.set(E,{resolve:()=>{clearTimeout(_)},participantIdentity:o});const O=setTimeout(()=>{this.pendingResponses.delete(E),g($e.builtIn("RESPONSE_TIMEOUT"))},d);this.pendingResponses.set(E,{resolve:(q,j)=>{clearTimeout(O),this.pendingAcks.has(E)&&(console.warn("RPC response received before ack",E),this.pendingAcks.delete(E),clearTimeout(_)),j?g(j):h(q??"")},participantIdentity:o})}))}()})}registerRpcMethod(e,i){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=i,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const i=this.pendingAcks.get(e);i?(i.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,i,s){const o=this.pendingResponses.get(e);o?(o.resolve(i,s),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,i,s,o,l){return w(this,void 0,void 0,function*(){const u=new Pt({destinationIdentities:[e],kind:we.RELIABLE,value:{case:"rpcRequest",value:new x0({id:i,method:s,payload:o,responseTimeoutMs:l,version:1})}});yield this.engine.sendDataPacket(u,we.RELIABLE)})}handleParticipantDisconnected(e){for(const[i,{participantIdentity:s}]of this.pendingAcks)s===e&&this.pendingAcks.delete(i);for(const[i,{participantIdentity:s,resolve:o}]of this.pendingResponses)s===e&&(o(null,$e.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(i))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(i=>i.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(i=>{var s,o;const l=this.trackPublications.get(i.sid);if(l){const u=l.isMuted||((o=(s=l.track)===null||s===void 0?void 0:s.isUpstreamPaused)!==null&&o!==void 0?o:!1);u!==i.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Pe(l)),{mutedOnServer:u})),this.engine.client.sendMuteTrack(i.sid,u))}}),!0)}getPublicationForTrack(e){let i;return this.trackPublications.forEach(s=>{const o=s.track;o&&(e instanceof MediaStreamTrack?(ma(o)||Ni(o))&&o.mediaStreamTrack===e&&(i=s):e===o&&(i=s))}),i}waitForPendingPublicationOfSource(e){return w(this,void 0,void 0,function*(){const s=Date.now();for(;Date.now()<s+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(l=>{let[u]=l;return u.source===e});if(o)return o[1];yield jt(20)}})}}class zw extends Mi{constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=cn.HIGH,this.handleEnded=l=>{this.setTrack(void 0),this.emit($.Ended,l)},this.handleVisibilityChange=l=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(l),this.logContext),this.disabled=!l,this.emitTrackUpdate()},this.handleVideoDimensionsChange=l=>{this.log.debug("adaptivestream video dimensions ".concat(l.width,"x").concat(l.height),this.logContext),this.videoDimensions=l,this.emitTrackUpdate()},this.subscribed=s,this.updateInfo(i)}setSubscribed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new el({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new P0({participantSid:"",trackSids:[this.trackSid]})]});this.emit($.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(i),this.emitPermissionUpdateIfChanged(s)}get subscriptionStatus(){return this.subscribed===!1?Mi.SubscriptionStatus.Unsubscribed:super.isSubscribed?Mi.SubscriptionStatus.Subscribed:Mi.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Mi.PermissionStatus.Allowed:Mi.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var i,s;this.isManualOperationAllowed()&&(((i=this.videoDimensions)===null||i===void 0?void 0:i.width)===e.width&&((s=this.videoDimensions)===null||s===void 0?void 0:s.height)===e.height||(Md(this.track)&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Md(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const i=this.subscriptionStatus,s=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off($.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off($.VisibilityChanged,this.handleVisibilityChange),o.off($.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit($.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on($.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on($.VisibilityChanged,this.handleVisibilityChange),e.on($.Ended,this.handleEnded),this.emit($.Subscribed,e)),this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i))}setAllowed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i)}setSubscriptionError(e){this.emit($.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const i=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):i!==e.muted&&this.emit(e.muted?$.Muted:$.Unmuted)}emitSubscriptionUpdateIfChanged(e){const i=this.subscriptionStatus;e!==i&&this.emit($.SubscriptionStatusChanged,i,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit($.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Q.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Md(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new z0({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=cn.HIGH,this.emit($.UpdateSettings,e)}}class Fc extends Fb{static fromParticipantInfo(e,i,s){return new Fc(e,i.sid,i.identity,i.name,i.metadata,i.attributes,s,i.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,i,s,o,l,u,d){let m=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Bc.STANDARD;super(i,s||"",o,l,u,d,m),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on($.UpdateSettings,i=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Pe(e))),this.signalClient.sendUpdateTrackSettings(i)}),e.on($.UpdateSubscription,i=>{i.participantTracks.forEach(s=>{s.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(i)}),e.on($.SubscriptionPermissionChanged,i=>{this.emit(ie.TrackSubscriptionPermissionChanged,e,i)}),e.on($.SubscriptionStatusChanged,i=>{this.emit(ie.TrackSubscriptionStatusChanged,e,i)}),e.on($.Subscribed,i=>{this.emit(ie.TrackSubscribed,i,e)}),e.on($.Unsubscribed,i=>{this.emit(ie.TrackUnsubscribed,i,e)}),e.on($.SubscriptionFailed,i=>{this.emit(ie.TrackSubscriptionFailed,e.trackSid,i)})}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setVolume(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q.Source.Microphone;this.volumeMap.set(i,e);const s=this.getTrackPublication(i);s&&s.track&&s.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q.Source.Microphone;const i=this.getTrackPublication(e);return i&&i.track?i.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,i,s,o,l,u){let d=this.getTrackPublicationBySid(i);if(d||i.startsWith("TR")||this.trackPublications.forEach(g=>{!d&&e.kind===g.kind.toString()&&(d=g)}),!d){if(u===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:i})),this.emit(ie.TrackSubscriptionFailed,i);return}u===void 0&&(u=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,i,s,o,l,u-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Pe(d))),this.emit(ie.TrackSubscriptionFailed,i);return}const m=e.kind==="video";let h;return m?h=new Uw(e,i,o,l):h=new Mw(e,i,o,this.audioContext,this.audioOutput),h.source=d.source,h.isMuted=d.isMuted,h.setMediaStream(s),h.start(),d.setTrack(h),this.volumeMap.has(d.source)&&_f(h)&&si(h)&&h.setVolume(this.volumeMap.get(d.source)),d}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const i=new Map,s=new Map;return e.tracks.forEach(o=>{var l,u;let d=this.getTrackPublicationBySid(o.sid);if(d)d.updateInfo(o);else{const m=Q.kindFromProto(o.type);if(!m)return;d=new zw(m,o,(l=this.signalClient.connectOptions)===null||l===void 0?void 0:l.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(u=this.loggerOptions)===null||u===void 0?void 0:u.loggerName}),d.updateInfo(o),s.set(o.sid,d);const h=Array.from(this.trackPublications.values()).find(g=>g.source===(d==null?void 0:d.source));h&&d.source!==Q.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(d.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Pe(h),newTrack:Pe(d)})),this.addTrackPublication(d)}i.set(o.sid,d)}),this.trackPublications.forEach(o=>{i.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Pe(o))),this.unpublishTrack(o.trackSid,!0))}),s.forEach(o=>{this.emit(ie.TrackPublished,o)}),!0}unpublishTrack(e,i){const s=this.trackPublications.get(e);if(!s)return;const{track:o}=s;switch(o&&(o.stop(),s.setTrack(void 0)),this.trackPublications.delete(e),s.kind){case Q.Kind.Audio:this.audioTrackPublications.delete(e);break;case Q.Kind.Video:this.videoTrackPublications.delete(e);break}i&&this.emit(ie.TrackUnpublished,s)}setAudioOutput(e){return w(this,void 0,void 0,function*(){this.audioOutput=e;const i=[];this.audioTrackPublications.forEach(s=>{var o;si(s.track)&&_f(s.track)&&i.push(s.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(i)})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:s})),super.emit(e,...s)}}var Ae;(function(a){a.Disconnected="disconnected",a.Connecting="connecting",a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting"})(Ae||(Ae={}));const qw=4*1e3;class bs extends Ln.EventEmitter{constructor(e){var i,s,o,l;if(super(),i=this,this.state=Ae.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Ce,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(u,d,m)=>w(this,void 0,void 0,function*(){var h;if(!U_())throw Mn()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const g=yield this.disconnectLock.lock();if(this.state===Ae.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),g(),Promise.resolve();if(this.connectFuture)return g(),this.connectFuture.promise;this.setAndEmitConnectionState(Ae.Connecting),((h=this.regionUrlProvider)===null||h===void 0?void 0:h.getServerUrl().toString())!==u&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Rf(new URL(u))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Af(u,d):this.regionUrlProvider.updateToken(d),this.regionUrlProvider.fetchRegionSettings().then(k=>{var T;(T=this.regionUrlProvider)===null||T===void 0||T.setServerReportedRegions(k)}).catch(k=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:k}))}));const v=(k,T,E)=>w(this,void 0,void 0,function*(){var _,O;this.abortController&&this.abortController.abort();const q=new AbortController;this.abortController=q,g==null||g();try{yield this.attemptConnection(E??u,d,m,q),this.abortController=void 0,k()}catch(j){if(this.regionUrlProvider&&j instanceof Ie&&j.reason!==_e.Cancelled&&j.reason!==_e.NotAllowed){let M=null;try{M=yield this.regionUrlProvider.getNextBestRegionUrl((_=this.abortController)===null||_===void 0?void 0:_.signal)}catch(x){if(x instanceof Ie&&(x.status===401||x.reason===_e.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),T(x);return}}M&&!(!((O=this.abortController)===null||O===void 0)&&O.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(j.message,". Retrying with another region: ").concat(M),this.logContext),this.recreateEngine(),yield v(k,T,M)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ay(j)),T(j))}else{let M=yn.UNKNOWN_REASON;j instanceof Ie&&(M=ay(j)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,M),T(j)}}}),b=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Ab((k,T)=>{v(k,T,b)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(u,d,m,h,g,v)=>w(this,void 0,void 0,function*(){var b,k,T;const E=yield m.join(u,d,{autoSubscribe:h.autoSubscribe,adaptiveStream:typeof g.adaptiveStream=="object"?!0:g.adaptiveStream,maxRetries:h.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:h.websocketTimeout},v.signal);let _=E.serverInfo;if(_||(_={version:E.serverVersion,region:E.serverRegion}),this.serverInfo=_,this.log.debug("connected to Livekit Server ".concat(Object.entries(_).map(O=>{let[q,j]=O;return"".concat(q,": ").concat(j)}).join(", ")),{room:(b=E.room)===null||b===void 0?void 0:b.name,roomSid:(k=E.room)===null||k===void 0?void 0:k.sid,identity:(T=E.participant)===null||T===void 0?void 0:T.identity}),!_.version)throw new b_("unknown server version");return _.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),g.dynacast=!1),E}),this.applyJoinResponse=u=>{const d=u.participant;if(this.localParticipant.sid=d.sid,this.localParticipant.identity=d.identity,this.localParticipant.setEnabledPublishCodecs(u.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(u.sifTrailer)}catch(m){this.log.error(m instanceof Error?m.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:m}))}this.handleParticipantUpdates([d,...u.otherParticipants]),u.room&&this.handleRoomUpdate(u.room)},this.attemptConnection=(u,d,m,h)=>w(this,void 0,void 0,function*(){var g,v;this.state===Ae.Reconnecting||this.isResuming||!((g=this.engine)===null||g===void 0)&&g.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((v=this.regionUrlProvider)===null||v===void 0)&&v.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},sh),m),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const b=yield this.connectSignal(u,d,this.engine,this.connOptions,this.options,h);this.applyJoinResponse(b),this.setupLocalParticipantEvents(),this.emit(Z.SignalConnected)}catch(b){yield this.engine.close(),this.recreateEngine();const k=new Ie("could not establish signal connection",_e.ServerUnreachable);throw b instanceof Error&&(k.message="".concat(k.message,": ").concat(b.message)),b instanceof Ie&&(k.reason=b.reason,k.status=b.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:b})),k}if(h.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Ie("Connection attempt aborted",_e.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,h)}catch(b){throw yield this.engine.close(),this.recreateEngine(),b}Ut()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Ut()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ae.Connected),this.emit(Z.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var u=arguments.length,d=new Array(u),m=0;m<u;m++)d[m]=arguments[m];return w(i,[...d],void 0,function(){var h=this;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var v,b,k,T;const E=yield h.disconnectLock.lock();try{if(h.state===Ae.Disconnected){h.log.debug("already disconnected",h.logContext);return}h.log.info("disconnect from room",Object.assign({},h.logContext)),(h.state===Ae.Connecting||h.state===Ae.Reconnecting||h.isResuming)&&(h.log.warn("abort connection attempt",h.logContext),(v=h.abortController)===null||v===void 0||v.abort(),(k=(b=h.connectFuture)===null||b===void 0?void 0:b.reject)===null||k===void 0||k.call(b,new Ie("Client initiated disconnect",_e.Cancelled)),h.connectFuture=void 0),!((T=h.engine)===null||T===void 0)&&T.client.isDisconnected||(yield h.engine.client.sendLeave()),h.engine&&(yield h.engine.close()),h.handleDisconnect(g,yn.CLIENT_INITIATED),h.engine=void 0}finally{E()}}()})},this.onPageLeave=()=>w(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>w(this,void 0,void 0,function*(){const u=[],d=Pn();if(d&&d.os==="iOS"){const m="livekit-dummy-audio-el";let h=document.getElementById(m);if(!h){h=document.createElement("audio"),h.id=m,h.autoplay=!0,h.hidden=!0;const g=Pd();g.enabled=!0;const v=new MediaStream([g]);h.srcObject=v,document.addEventListener("visibilitychange",()=>{h&&(h.srcObject=document.hidden?null:v,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(h),this.once(Z.Disconnected,()=>{h==null||h.remove(),h=null})}u.push(h)}this.remoteParticipants.forEach(m=>{m.audioTrackPublications.forEach(h=>{h.track&&h.track.attachedElements.forEach(g=>{u.push(g)})})});try{yield Promise.all([this.acquireAudioContext(),...u.map(m=>(m.muted=!1,m.play()))]),this.handleAudioPlaybackStarted()}catch(m){throw this.handleAudioPlaybackFailed(m),m}}),this.startVideo=()=>w(this,void 0,void 0,function*(){const u=[];for(const d of this.remoteParticipants.values())d.videoTrackPublications.forEach(m=>{var h;(h=m.track)===null||h===void 0||h.attachedElements.forEach(g=>{u.includes(g)||u.push(g)})});yield Promise.all(u.map(d=>d.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(d=>{d.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const u of this.remoteParticipants.values())this.handleParticipantDisconnected(u.identity,u);this.setAndEmitConnectionState(Ae.Reconnecting)&&this.emit(Z.Reconnecting)},this.handleSignalRestarted=u=>w(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(u.serverRegion),Object.assign(Object.assign({},this.logContext),{region:u.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(u);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(d){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:d}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:u.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ae.Connected),this.emit(Z.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=u=>{u.forEach(d=>{var m;if(d.identity===this.localParticipant.identity){this.localParticipant.updateInfo(d);return}d.identity===""&&(d.identity=(m=this.sidToIdentity.get(d.sid))!==null&&m!==void 0?m:"");let h=this.remoteParticipants.get(d.identity);d.state===tf.DISCONNECTED?this.handleParticipantDisconnected(d.identity,h):h=this.getOrCreateParticipant(d.identity,d)})},this.handleActiveSpeakersUpdate=u=>{const d=[],m={};u.forEach(h=>{if(m[h.sid]=!0,h.sid===this.localParticipant.sid)this.localParticipant.audioLevel=h.level,this.localParticipant.setIsSpeaking(!0),d.push(this.localParticipant);else{const g=this.getRemoteParticipantBySid(h.sid);g&&(g.audioLevel=h.level,g.setIsSpeaking(!0),d.push(g))}}),m[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(h=>{m[h.sid]||(h.audioLevel=0,h.setIsSpeaking(!1))}),this.activeSpeakers=d,this.emitWhenConnected(Z.ActiveSpeakersChanged,d)},this.handleSpeakersChanged=u=>{const d=new Map;this.activeSpeakers.forEach(h=>{const g=this.remoteParticipants.get(h.identity);g&&g.sid!==h.sid||d.set(h.sid,h)}),u.forEach(h=>{let g=this.getRemoteParticipantBySid(h.sid);h.sid===this.localParticipant.sid&&(g=this.localParticipant),g&&(g.audioLevel=h.level,g.setIsSpeaking(h.active),h.active?d.set(h.sid,g):d.delete(h.sid))});const m=Array.from(d.values());m.sort((h,g)=>g.audioLevel-h.audioLevel),this.activeSpeakers=m,this.emitWhenConnected(Z.ActiveSpeakersChanged,m)},this.handleStreamStateUpdate=u=>{u.streamStates.forEach(d=>{const m=this.getRemoteParticipantBySid(d.participantSid);if(!m)return;const h=m.getTrackPublicationBySid(d.trackSid);if(!h||!h.track)return;const g=Q.streamStateFromProto(d.state);g!==h.track.streamState&&(h.track.streamState=g,m.emit(ie.TrackStreamStateChanged,h,h.track.streamState),this.emitWhenConnected(Z.TrackStreamStateChanged,h,h.track.streamState,m))})},this.handleSubscriptionPermissionUpdate=u=>{const d=this.getRemoteParticipantBySid(u.participantSid);if(!d)return;const m=d.getTrackPublicationBySid(u.trackSid);m&&m.setAllowed(u.allowed)},this.handleSubscriptionError=u=>{const d=Array.from(this.remoteParticipants.values()).find(h=>h.trackPublications.has(u.trackSid));if(!d)return;const m=d.getTrackPublicationBySid(u.trackSid);m&&m.setSubscriptionError(u.err)},this.handleDataPacket=u=>{const d=this.remoteParticipants.get(u.participantIdentity);if(u.value.case==="user")this.handleUserPacket(d,u.value.value,u.kind);else if(u.value.case==="transcription")this.handleTranscription(d,u.value.value);else if(u.value.case==="sipDtmf")this.handleSipDtmf(d,u.value.value);else if(u.value.case==="chatMessage")this.handleChatMessage(d,u.value.value);else if(u.value.case==="metrics")this.handleMetrics(u.value.value,d);else if(u.value.case==="streamHeader")this.handleStreamHeader(u.value.value,u.participantIdentity);else if(u.value.case==="streamChunk")this.handleStreamChunk(u.value.value);else if(u.value.case==="streamTrailer")this.handleStreamTrailer(u.value.value);else if(u.value.case==="rpcRequest"){const m=u.value.value;this.handleIncomingRpcRequest(u.participantIdentity,m.id,m.method,m.payload,m.responseTimeoutMs,m.version)}},this.handleUserPacket=(u,d,m)=>{this.emit(Z.DataReceived,d.payload,u,m,d.topic),u==null||u.emit(ie.DataReceived,d.payload,m)},this.handleSipDtmf=(u,d)=>{this.emit(Z.SipDTMFReceived,d,u),u==null||u.emit(ie.SipDTMFReceived,d)},this.bufferedSegments=new Map,this.handleTranscription=(u,d)=>{const m=d.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(d.transcribedParticipantIdentity),h=m==null?void 0:m.trackPublications.get(d.trackId),g=V_(d,this.transcriptionReceivedTimes);h==null||h.emit($.TranscriptionReceived,g),m==null||m.emit(ie.TranscriptionReceived,g,h),this.emit(Z.TranscriptionReceived,g,m,h)},this.handleChatMessage=(u,d)=>{const m=F_(d);this.emit(Z.ChatMessage,m,u)},this.handleMetrics=(u,d)=>{this.emit(Z.MetricsReceived,u,d)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Z.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=u=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:u})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Z.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Z.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Z.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>w(this,void 0,void 0,function*(){var u,d;const m=gt.getInstance().previousDevices,h=yield gt.getInstance().getDevices(void 0,!1),g=Pn();if((g==null?void 0:g.name)==="Chrome"&&g.os!=="iOS")for(let b of h){const k=m.find(T=>T.deviceId===b.deviceId);k&&k.label!==""&&k.kind===b.kind&&k.label!==b.label&&this.getActiveDevice(b.kind)==="default"&&this.emit(Z.ActiveDeviceChanged,b.kind,b.deviceId)}const v=["audiooutput","audioinput","videoinput"];for(let b of v){const k=h.filter(E=>E.kind===b),T=this.getActiveDevice(b);if(T===((u=m.filter(E=>E.kind===b)[0])===null||u===void 0?void 0:u.deviceId)&&k.length>0&&((d=k[0])===null||d===void 0?void 0:d.deviceId)!==T){yield this.switchActiveDevice(b,k[0].deviceId);continue}b==="audioinput"&&!qi()||b==="videoinput"||k.length>0&&!k.find(E=>E.deviceId===this.getActiveDevice(b))&&(yield this.switchActiveDevice(b,k[0].deviceId))}this.emit(Z.MediaDevicesChanged)}),this.handleRoomUpdate=u=>{const d=this.roomInfo;this.roomInfo=u,d&&d.metadata!==u.metadata&&this.emitWhenConnected(Z.RoomMetadataChanged,u.metadata),(d==null?void 0:d.activeRecording)!==u.activeRecording&&this.emitWhenConnected(Z.RecordingStatusChanged,u.activeRecording)},this.handleConnectionQualityUpdate=u=>{u.updates.forEach(d=>{if(d.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(d.quality);return}const m=this.getRemoteParticipantBySid(d.participantSid);m&&m.setConnectionQuality(d.quality)})},this.onLocalParticipantMetadataChanged=u=>{this.emit(Z.ParticipantMetadataChanged,u,this.localParticipant)},this.onLocalParticipantNameChanged=u=>{this.emit(Z.ParticipantNameChanged,u,this.localParticipant)},this.onLocalAttributesChanged=u=>{this.emit(Z.ParticipantAttributesChanged,u,this.localParticipant)},this.onLocalTrackMuted=u=>{this.emit(Z.TrackMuted,u,this.localParticipant)},this.onLocalTrackUnmuted=u=>{this.emit(Z.TrackUnmuted,u,this.localParticipant)},this.onTrackProcessorUpdate=u=>{var d;(d=u==null?void 0:u.onPublish)===null||d===void 0||d.call(u,this)},this.onLocalTrackPublished=u=>w(this,void 0,void 0,function*(){var d,m,h,g,v,b;(d=u.track)===null||d===void 0||d.on($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(m=u.track)===null||m===void 0||m.on($.Restarted,this.onLocalTrackRestarted),(v=(g=(h=u.track)===null||h===void 0?void 0:h.getProcessor())===null||g===void 0?void 0:g.onPublish)===null||v===void 0||v.call(g,this),this.emit(Z.LocalTrackPublished,u,this.localParticipant),ma(u.track)&&(yield u.track.checkForSilence())&&this.emit(Z.LocalAudioSilenceDetected,u);const k=yield(b=u.track)===null||b===void 0?void 0:b.getDeviceId(!1),T=sy(u.source);T&&k&&k!==this.localParticipant.activeDeviceMap.get(T)&&(this.localParticipant.activeDeviceMap.set(T,k),this.emit(Z.ActiveDeviceChanged,T,k))}),this.onLocalTrackUnpublished=u=>{var d,m;(d=u.track)===null||d===void 0||d.off($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(m=u.track)===null||m===void 0||m.off($.Restarted,this.onLocalTrackRestarted),this.emit(Z.LocalTrackUnpublished,u,this.localParticipant)},this.onLocalTrackRestarted=u=>w(this,void 0,void 0,function*(){const d=yield u.getDeviceId(!1),m=sy(u.source);m&&d&&d!==this.localParticipant.activeDeviceMap.get(m)&&(this.log.debug("local track restarted, setting ".concat(m," ").concat(d," active"),this.logContext),this.localParticipant.activeDeviceMap.set(m,d),this.emit(Z.ActiveDeviceChanged,m,d))}),this.onLocalConnectionQualityChanged=u=>{this.emit(Z.ConnectionQualityChanged,u,this.localParticipant)},this.onMediaDevicesError=u=>{this.emit(Z.MediaDevicesError,u)},this.onLocalParticipantPermissionsChanged=u=>{this.emit(Z.ParticipantPermissionsChanged,u,this.localParticipant)},this.onLocalChatMessageSent=u=>{this.emit(Z.ChatMessage,u,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},dw),e),this.log=ai((s=this.options.loggerName)!==null&&s!==void 0?s:bn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Ub),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Lb),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},uw),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Kt,this.localParticipant=new Bw("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Bi(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Bi(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",Bi(this.options.audioOutput.deviceId)).catch(u=>this.log.warn("Could not set audio output: ".concat(u.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),Ut()){const u=new AbortController;(l=navigator.mediaDevices)===null||l===void 0||l.addEventListener("devicechange",this.handleDeviceChange,{signal:u.signal}),bs.cleanupRegistry&&bs.cleanupRegistry.register(this,()=>{u.abort()})}}registerTextStreamHandler(e,i){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,i)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,i){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,i)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,i){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,i,s,o,l,u){return w(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,i),u!==1){yield this.engine.publishRpcResponse(e,i,null,$e.builtIn("UNSUPPORTED_VERSION"));return}const d=this.rpcHandlers.get(s);if(!d){yield this.engine.publishRpcResponse(e,i,null,$e.builtIn("UNSUPPORTED_METHOD"));return}let m=null,h=null;try{const g=yield d({requestId:i,callerIdentity:e,payload:o,responseTimeout:l});rh(g)>jb?(m=$e.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(s))):h=g}catch(g){g instanceof $e?m=g:(console.warn("Uncaught error returned by RPC handler for ".concat(s,". Returning APPLICATION_ERROR instead."),g),m=$e.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,i,h,m)})}setE2EEEnabled(e){return w(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new $_(this.options.e2ee),this.e2eeManager.on(ji.ParticipantEncryptionStatusChanged,(i,s)=>{Y_(s)&&(this.isE2EEEnabled=i),this.emit(Z.ParticipantEncryptionStatusChanged,i,s)}),this.e2eeManager.on(ji.EncryptionError,i=>this.emit(Z.EncryptionError,i)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&i!==void 0?i:!1}getSid(){return w(this,void 0,void 0,function*(){return this.state===Ae.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,i)=>{const s=o=>{o.sid!==""&&(this.engine.off(te.RoomUpdate,s),e(o.sid))};this.engine.on(te.RoomUpdate,s),this.once(Z.Disconnected,()=>{this.engine.off(te.RoomUpdate,s),i("Room disconnected before room server id was available")})})})}get name(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&i!==void 0?i:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&i!==void 0?i:0}get numPublishers(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&i!==void 0?i:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new _w(this.options),this.engine.on(te.ParticipantUpdate,this.handleParticipantUpdates).on(te.RoomUpdate,this.handleRoomUpdate).on(te.SpeakersChanged,this.handleSpeakersChanged).on(te.StreamStateChanged,this.handleStreamStateUpdate).on(te.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(te.SubscriptionError,this.handleSubscriptionError).on(te.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(te.MediaTrackAdded,(e,i,s)=>{this.onTrackAdded(e,i,s)}).on(te.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(te.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(te.DataPacketReceived,this.handleDataPacket).on(te.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ae.SignalReconnecting)&&this.emit(Z.SignalReconnecting)}).on(te.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ae.Connected)&&this.emit(Z.Reconnected)}).on(te.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ae.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(te.Restarting,this.handleRestarting).on(te.SignalRestarted,this.handleSignalRestarted).on(te.Offline,()=>{this.setAndEmitConnectionState(Ae.Reconnecting)&&this.emit(Z.Reconnecting)}).on(te.DCBufferStatusChanged,(e,i)=>{this.emit(Z.DCBufferStatusChanged,e,i)}).on(te.LocalTrackSubscribed,e=>{const i=this.localParticipant.getTrackPublications().find(s=>{let{trackSid:o}=s;return o===e});if(!i){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ie.LocalTrackSubscribed,i),this.emitWhenConnected(Z.LocalTrackSubscribed,i,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return gt.getInstance().getDevices(e,i)}prepareConnection(e,i){return w(this,void 0,void 0,function*(){if(this.state===Ae.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Rf(new URL(e))&&i){this.regionUrlProvider=new Af(e,i);const s=yield this.regionUrlProvider.getNextBestRegionUrl();s&&this.state===Ae.Disconnected&&(this.regionUrl=s,yield fetch(iy(s),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(s),this.logContext))}else yield fetch(iy(e),{method:"HEAD"})}catch(s){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:s}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,i){return w(this,void 0,void 0,function*(){let s=()=>{},o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new xn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new xn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new xn({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new xn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":s=()=>w(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new xn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":s=()=>w(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new xn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new xn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),s=()=>w(this,void 0,void 0,function*(){const l=this.engine.client.onLeave;l&&l(new tl({reason:yn.CLIENT_INITIATED,action:ds.RECONNECT}))});break;case"subscriber-bandwidth":if(i===void 0||typeof i!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new xn({scenario:{case:"subscriberBandwidth",value:ha(i)}});break;case"leave-full-reconnect":o=new xn({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield s())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,i){return w(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var d,m,h,g,v,b,k,T;let E=!0,_=!1;const O=u?{exact:o}:o;if(s==="audioinput"){_=l.localParticipant.audioTrackPublications.size===0;const q=(d=l.getActiveDevice(s))!==null&&d!==void 0?d:l.options.audioCaptureDefaults.deviceId;l.options.audioCaptureDefaults.deviceId=O;const j=Array.from(l.localParticipant.audioTrackPublications.values()).filter(M=>M.source===Q.Source.Microphone);try{E=(yield Promise.all(j.map(M=>{var x;return(x=M.audioTrack)===null||x===void 0?void 0:x.setDeviceId(O)}))).every(M=>M===!0)}catch(M){throw l.options.audioCaptureDefaults.deviceId=q,M}}else if(s==="videoinput"){_=l.localParticipant.videoTrackPublications.size===0;const q=(m=l.getActiveDevice(s))!==null&&m!==void 0?m:l.options.videoCaptureDefaults.deviceId;l.options.videoCaptureDefaults.deviceId=O;const j=Array.from(l.localParticipant.videoTrackPublications.values()).filter(M=>M.source===Q.Source.Camera);try{E=(yield Promise.all(j.map(M=>{var x;return(x=M.videoTrack)===null||x===void 0?void 0:x.setDeviceId(O)}))).every(M=>M===!0)}catch(M){throw l.options.videoCaptureDefaults.deviceId=q,M}}else if(s==="audiooutput"){if(!Ef()&&!l.options.webAudioMix||l.options.webAudioMix&&l.audioContext&&!("setSinkId"in l.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");l.options.webAudioMix&&(o=(h=yield gt.getInstance().normalizeDeviceId("audiooutput",o))!==null&&h!==void 0?h:""),(g=(T=l.options).audioOutput)!==null&&g!==void 0||(T.audioOutput={});const q=(v=l.getActiveDevice(s))!==null&&v!==void 0?v:l.options.audioOutput.deviceId;l.options.audioOutput.deviceId=o;try{l.options.webAudioMix&&((b=l.audioContext)===null||b===void 0||b.setSinkId(o)),yield Promise.all(Array.from(l.remoteParticipants.values()).map(j=>j.setAudioOutput({deviceId:o})))}catch(j){throw l.options.audioOutput.deviceId=q,j}}return(_||s==="audiooutput")&&(l.localParticipant.activeDeviceMap.set(s,s==="audiooutput"&&((k=l.options.audioOutput)===null||k===void 0?void 0:k.deviceId)||o),l.emit(Z.ActiveDeviceChanged,s,o)),E}()})}setupLocalParticipantEvents(){this.localParticipant.on(ie.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ie.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ie.AttributesChanged,this.onLocalAttributesChanged).on(ie.TrackMuted,this.onLocalTrackMuted).on(ie.TrackUnmuted,this.onLocalTrackUnmuted).on(ie.LocalTrackPublished,this.onLocalTrackPublished).on(ie.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ie.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ie.MediaDevicesError,this.onMediaDevicesError).on(ie.AudioStreamAcquired,this.startAudio).on(ie.ChatMessage,this.onLocalChatMessageSent).on(ie.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,i,s){if(this.state===Ae.Connecting||this.state===Ae.Reconnecting){const g=()=>{this.onTrackAdded(e,i,s),v()},v=()=>{this.off(Z.Reconnected,g),this.off(Z.Connected,g),this.off(Z.Disconnected,v)};this.once(Z.Reconnected,g),this.once(Z.Connected,g),this.once(Z.Disconnected,v);return}if(this.state===Ae.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=N_(i.id),l=o[0];let u=o[1],d=e.id;if(u&&u.startsWith("TR")&&(d=u),l===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const m=Array.from(this.remoteParticipants.values()).find(g=>g.sid===l);if(!m){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(l),this.logContext);return}let h;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?h=this.options.adaptiveStream:h={}),m.addSubscribedMediaTrack(e,d,i,s,h)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;var s;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==Ae.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{o.unpublishTrack(l.trackSid)})}),this.localParticipant.trackPublications.forEach(o=>{var l,u,d;o.track&&this.localParticipant.unpublishTrack(o.track,e),e?((l=o.track)===null||l===void 0||l.detach(),(u=o.track)===null||u===void 0||u.stop()):(d=o.track)===null||d===void 0||d.stopMonitor()}),this.localParticipant.off(ie.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ie.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ie.AttributesChanged,this.onLocalAttributesChanged).off(ie.TrackMuted,this.onLocalTrackMuted).off(ie.TrackUnmuted,this.onLocalTrackUnmuted).off(ie.LocalTrackPublished,this.onLocalTrackPublished).off(ie.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ie.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ie.MediaDevicesError,this.onMediaDevicesError).off(ie.AudioStreamAcquired,this.startAudio).off(ie.ChatMessage,this.onLocalChatMessageSent).off(ie.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Ut()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(s=navigator.mediaDevices)===null||s===void 0||s.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ae.Disconnected),this.emit(Z.Disconnected,i)}}}handleParticipantDisconnected(e,i){var s;this.remoteParticipants.delete(e),i&&(i.trackPublications.forEach(o=>{i.unpublishTrack(o.trackSid,!0)}),this.emit(Z.ParticipantDisconnected,i),(s=this.localParticipant)===null||s===void 0||s.handleParticipantDisconnected(i.identity))}handleStreamHeader(e,i){return w(this,void 0,void 0,function*(){var s;if(e.contentHeader.case==="byteHeader"){const o=this.byteStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let l;const u={id:e.streamId,name:(s=e.contentHeader.value.name)!==null&&s!==void 0?s:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Ac(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:m=>{l=m,this.byteStreamControllers.set(e.streamId,{info:u,controller:l,startTime:Date.now()})}});o(new Dw(u,d,Ac(e.totalLength)),{identity:i})}else if(e.contentHeader.case==="textHeader"){const o=this.textStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let l;const u={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:m=>{l=m,this.textStreamControllers.set(e.streamId,{info:u,controller:l,startTime:Date.now()})}});o(new Aw(u,d,Ac(e.totalLength)),{identity:i})}})}handleStreamChunk(e){const i=this.byteStreamControllers.get(e.streamId);i&&e.content.length>0&&i.controller.enqueue(e);const s=this.textStreamControllers.get(e.streamId);s&&e.content.length>0&&s.controller.enqueue(e)}handleStreamTrailer(e){const i=this.textStreamControllers.get(e.streamId);i&&(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close(),this.textStreamControllers.delete(e.streamId));const s=this.byteStreamControllers.get(e.streamId);s&&(s.info.attributes=Object.assign(Object.assign({},s.info.attributes),e.attributes),s.controller.close(),this.byteStreamControllers.delete(e.streamId))}acquireAudioContext(){return w(this,void 0,void 0,function*(){var e,i;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Mb())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),jt(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const s=((i=this.audioContext)===null||i===void 0?void 0:i.state)==="running";s!==this.canPlaybackAudio&&(this.audioEnabled=s,this.emit(Z.AudioPlaybackStatusChanged,s))})}createParticipant(e,i){var s;let o;return i?o=Fc.fromParticipantInfo(this.engine.client,i,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new Fc(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((s=this.options.audioOutput)===null||s===void 0)&&s.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),o}getOrCreateParticipant(e,i){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return i&&o.updateInfo(i)&&this.sidToIdentity.set(i.sid,i.identity),o}const s=this.createParticipant(e,i);return this.remoteParticipants.set(e,s),this.sidToIdentity.set(i.sid,i.identity),this.emitWhenConnected(Z.ParticipantConnected,s),s.on(ie.TrackPublished,o=>{this.emitWhenConnected(Z.TrackPublished,o,s)}).on(ie.TrackSubscribed,(o,l)=>{o.kind===Q.Kind.Audio?(o.on($.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on($.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===Q.Kind.Video&&(o.on($.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on($.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Z.TrackSubscribed,o,l,s)}).on(ie.TrackUnpublished,o=>{this.emit(Z.TrackUnpublished,o,s)}).on(ie.TrackUnsubscribed,(o,l)=>{this.emit(Z.TrackUnsubscribed,o,l,s)}).on(ie.TrackMuted,o=>{this.emitWhenConnected(Z.TrackMuted,o,s)}).on(ie.TrackUnmuted,o=>{this.emitWhenConnected(Z.TrackUnmuted,o,s)}).on(ie.ParticipantMetadataChanged,o=>{this.emitWhenConnected(Z.ParticipantMetadataChanged,o,s)}).on(ie.ParticipantNameChanged,o=>{this.emitWhenConnected(Z.ParticipantNameChanged,o,s)}).on(ie.AttributesChanged,o=>{this.emitWhenConnected(Z.ParticipantAttributesChanged,o,s)}).on(ie.ConnectionQualityChanged,o=>{this.emitWhenConnected(Z.ConnectionQualityChanged,o,s)}).on(ie.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(Z.ParticipantPermissionsChanged,o,s)}).on(ie.TrackSubscriptionStatusChanged,(o,l)=>{this.emitWhenConnected(Z.TrackSubscriptionStatusChanged,o,l,s)}).on(ie.TrackSubscriptionFailed,(o,l)=>{this.emit(Z.TrackSubscriptionFailed,o,s,l)}).on(ie.TrackSubscriptionPermissionChanged,(o,l)=>{this.emitWhenConnected(Z.TrackSubscriptionPermissionChanged,o,l,s)}),i&&s.updateInfo(i),s}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((s,o)=>(s.push(...o.getTrackPublications()),s),[]),i=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,i)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const i of e.videoTrackPublications.values())i.isSubscribed&&G_(i)&&i.emitTrackUpdate()}getRemoteParticipantBySid(e){const i=this.sidToIdentity.get(e);if(i)return this.remoteParticipants.get(i)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=St.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,yn.STATE_MISMATCH))):e=0},qw)}clearConnectionReconcile(){this.connectionReconcileInterval&&St.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(Z.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[i,s]=e;this.emit(i,...s)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(this.state===Ae.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,s]);else if(this.state===Ae.Connected)return this.emit(e,...s);return!1}simulateParticipants(e){return w(this,void 0,void 0,function*(){var i,s;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),l=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Yf({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Fe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new zr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Z.SignalConnected),this.emit(Z.Connected),this.setAndEmitConnectionState(Ae.Connected),o.video){const u=new Pf(Q.Kind.Video,new ls({source:ot.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO,name:"video-dummy"}),new Vc(o.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:ny(160*((i=l.aspectRatios[0])!==null&&i!==void 0?i:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(u),this.localParticipant.emit(ie.LocalTrackPublished,u)}if(o.audio){const u=new Pf(Q.Kind.Audio,new ls({source:ot.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO}),new Hc(o.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Pd(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(u),this.localParticipant.emit(ie.LocalTrackPublished,u)}for(let u=0;u<l.count-1;u+=1){let d=new zr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(u),state:tf.ACTIVE,tracks:[],joinedAt:Fe.parse(Date.now())});const m=this.getOrCreateParticipant(d.identity,d);if(l.video){const h=ny(160*((s=l.aspectRatios[u%l.aspectRatios.length])!==null&&s!==void 0?s:1),160,!1,!0),g=new ls({source:ot.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO});m.addSubscribedMediaTrack(h,g.sid,new MediaStream([h]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}if(l.audio){const h=Pd(),g=new ls({source:ot.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO});m.addSubscribedMediaTrack(h,g.sid,new MediaStream([h]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}m.updateInfo(d)}})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(e!==Z.ActiveSpeakersChanged&&e!==Z.TranscriptionReceived){const l=Gb(s).filter(u=>u!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l}))}return super.emit(e,...s)}}bs.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(a=>{a()});function Gb(a){return a.map(e=>{if(e)return Array.isArray(e)?Gb(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var pn;(function(a){a[a.IDLE=0]="IDLE",a[a.RUNNING=1]="RUNNING",a[a.SKIPPED=2]="SKIPPED",a[a.SUCCESS=3]="SUCCESS",a[a.FAILED=4]="FAILED"})(pn||(pn={}));class Vi extends Ln.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=pn.IDLE,this.logs=[],this.options={},this.url=e,this.token=i,this.name=this.constructor.name,this.room=new bs(s.roomOptions),this.connectOptions=s.connectOptions,this.options=s}run(e){return w(this,void 0,void 0,function*(){if(this.status!==pn.IDLE)throw Error("check is running already");this.setStatus(pn.RUNNING);try{yield this.perform()}catch(i){i instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(i.message):this.appendError(i.message))}return yield this.disconnect(),yield new Promise(i=>setTimeout(i,500)),this.status!==pn.SKIPPED&&this.setStatus(this.isSuccess()?pn.SUCCESS:pn.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return w(this,void 0,void 0,function*(){return this.room.state===Ae.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return w(this,void 0,void 0,function*(){this.room&&this.room.state!==Ae.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(pn.SKIPPED)}switchProtocol(e){return w(this,void 0,void 0,function*(){let i=!1,s=!1;if(this.room.on(Z.Reconnecting,()=>{i=!0}),this.room.once(Z.Reconnected,()=>{s=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(l=>setTimeout(l,1e3)),!i)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(s)return;yield jt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class Hw extends Vi{get description(){return"Cloud regions"}perform(){return w(this,void 0,void 0,function*(){const e=new Af(this.url,this.token);if(!e.isCloud()){this.skip();return}const i=[],s=new Set;for(let l=0;l<3;l++){const u=yield e.getNextBestRegionUrl();if(!u)break;if(s.has(u))continue;s.add(u);const d=yield this.checkCloudRegion(u);this.appendMessage("".concat(d.region," RTT: ").concat(d.rtt,"ms, duration: ").concat(d.duration,"ms")),i.push(d)}i.sort((l,u)=>(l.duration-u.duration)*.5+(l.rtt-u.rtt)*.5);const o=i[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return w(this,void 0,void 0,function*(){var i,s;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(i=this.room.serverInfo)===null||i===void 0?void 0:i.region;if(!o)throw new Error("Region not found");const l=yield this.room.localParticipant.streamText({topic:"test"}),u=1e3,m=1e6/u,h="A".repeat(u),g=Date.now();for(let T=0;T<m;T++)yield l.write(h);yield l.close();const v=Date.now(),b=yield(s=this.room.engine.pcManager)===null||s===void 0?void 0:s.publisher.getStats(),k={region:o,rtt:1e4,duration:v-g};return b==null||b.forEach(T=>{T.type==="candidate-pair"&&T.nominated&&(k.rtt=T.currentRoundTripTime*1e3)}),yield this.disconnect(),k})}}const Hd=1e4;class Vw extends Vi{get description(){return"Connection via UDP vs TCP"}perform(){return w(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),i=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-i.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-i.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=i):this.appendMessage("best connection quality via udp");const s=this.bestStats;this.appendMessage("upstream bitrate: ".concat((s.bitrateTotal/s.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((s.rttTotal/s.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((s.jitterTotal/s.count*1e3).toFixed(2)," ms")),s.packetsLost>0&&this.appendWarning("packets lost: ".concat((s.packetsLost/s.packetsSent*100).toFixed(2),"%")),s.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((s.qualityLimitationDurations.bandwidth/(Hd/1e3)*100).toFixed(2),"%")),s.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((s.qualityLimitationDurations.cpu/(Hd/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return w(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const i=document.createElement("canvas");i.width=1280,i.height=720;const s=i.getContext("2d");if(!s)throw new Error("Could not get canvas context");let o=0;const l=()=>{o=(o+1)%360,s.fillStyle="hsl(".concat(o,", 100%, 50%)"),s.fillRect(0,0,i.width,i.height),requestAnimationFrame(l)};l();const d=i.captureStream(30).getVideoTracks()[0],h=(yield this.room.localParticipant.publishTrack(d,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,g={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},v=setInterval(()=>w(this,void 0,void 0,function*(){const b=yield h.getRTCStatsReport();b==null||b.forEach(k=>{k.type==="outbound-rtp"?(g.packetsSent=k.packetsSent,g.qualityLimitationDurations=k.qualityLimitationDurations,g.bitrateTotal+=k.targetBitrate,g.count++):k.type==="remote-inbound-rtp"&&(g.packetsLost=k.packetsLost,g.rttTotal+=k.roundTripTime,g.jitterTotal+=k.jitter)})}),1e3);return yield new Promise(b=>setTimeout(b,Hd)),clearInterval(v),d.stop(),i.remove(),yield this.disconnect(),g})}}function ch(a){return w(this,void 0,void 0,function*(){var e,i;a??(a={}),(e=a.audio)!==null&&e!==void 0||(a.audio={deviceId:"default"}),(i=a.video)!==null&&i!==void 0||(a.video={deviceId:"default"});const{audioProcessor:s,videoProcessor:o}=th(a),l=Nb(a,Ub,Lb),u=il(l),d=navigator.mediaDevices.getUserMedia(u);a.audio&&(gt.userMediaPromiseMap.set("audioinput",d),d.catch(()=>gt.userMediaPromiseMap.delete("audioinput"))),a.video&&(gt.userMediaPromiseMap.set("videoinput",d),d.catch(()=>gt.userMediaPromiseMap.delete("videoinput")));const m=yield d;return Promise.all(m.getTracks().map(h=>w(this,void 0,void 0,function*(){const g=h.kind==="audio";g?l.audio:l.video;let v;const b=g?u.audio:u.video;typeof b!="boolean"&&(v=b);const k=h.getSettings().deviceId;v!=null&&v.deviceId&&Bi(v.deviceId)!==k?v.deviceId=k:v||(v={deviceId:k});const T=Bb(h,v);return T.kind===Q.Kind.Video?T.source=Q.Source.Camera:T.kind===Q.Kind.Audio&&(T.source=Q.Source.Microphone),T.mediaStream=m,si(T)&&s?yield T.setProcessor(s):Es(T)&&o&&(yield T.setProcessor(o)),T})))})}function Fw(a){return w(this,void 0,void 0,function*(){return(yield ch({audio:!1,video:a}))[0]})}function Gw(a){return w(this,void 0,void 0,function*(){return(yield ch({audio:a,video:!1}))[0]})}class Yw extends Vi{get description(){return"Can publish audio"}perform(){return w(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield Gw();if(yield Pb(s,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),i.localParticipant.publishTrack(s),yield new Promise(d=>setTimeout(d,3e3));const l=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!l)throw new Error("Could not get RTCStats");let u=0;if(l.forEach(d=>{d.type==="outbound-rtp"&&(d.kind==="audio"||!d.kind&&d.mediaType==="audio")&&(u=d.packetsSent)}),u===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(u," audio packets"))})}}class Kw extends Vi{get description(){return"Can publish video"}perform(){return w(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield Fw();yield this.checkForVideo(s.mediaStreamTrack),i.localParticipant.publishTrack(s),yield new Promise(u=>setTimeout(u,5e3));const o=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let l=0;if(o.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="video"||!u.kind&&u.mediaType==="video")&&(l+=u.packetsSent)}),l===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(l," video packets"))})}checkForVideo(e){return w(this,void 0,void 0,function*(){const i=new MediaStream;i.addTrack(e.clone());const s=document.createElement("video");s.srcObject=i,s.muted=!0,yield new Promise(o=>{s.onplay=()=>{setTimeout(()=>{var l,u,d,m;const h=document.createElement("canvas"),g=e.getSettings(),v=(u=(l=g.width)!==null&&l!==void 0?l:s.videoWidth)!==null&&u!==void 0?u:1280,b=(m=(d=g.height)!==null&&d!==void 0?d:s.videoHeight)!==null&&m!==void 0?m:720;h.width=v,h.height=b;const k=h.getContext("2d");k.drawImage(s,0,0);const E=k.getImageData(0,0,h.width,h.height).data;let _=!0;for(let O=0;O<E.length;O+=4)if(E[O]!==0||E[O+1]!==0||E[O+2]!==0){_=!1;break}_?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},s.play()}),s.remove()})}}class Qw extends Vi{get description(){return"Resuming connection after interruption"}perform(){return w(this,void 0,void 0,function*(){var e;const i=yield this.connect();let s=!1,o=!1,l;const u=new Promise(h=>{setTimeout(h,5e3),l=h}),d=()=>{s=!0};i.on(Z.SignalReconnecting,d).on(Z.Reconnecting,d).on(Z.Reconnected,()=>{o=!0,l(!0)}),(e=i.engine.client.ws)===null||e===void 0||e.close();const m=i.engine.client.onClose;if(m&&m(""),yield u,s){if(!o||i.state!==Ae.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Xw extends Vi{get description(){return"Can connect via TURN"}perform(){return w(this,void 0,void 0,function*(){var e,i;const s=new nh,o=yield s.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let l=!1,u=!1,d=!1;for(let m of o.iceServers)for(let h of m.urls)h.startsWith("turn:")?(u=!0,d=!0):h.startsWith("turns:")&&(u=!0,d=!0,l=!0),h.startsWith("stun:")&&(d=!0);d?u&&!l&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield s.close(),!((i=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||i===void 0)&&i.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(m=>setTimeout(m,0)))})}}class Jw extends Vi{get description(){return"Establishing WebRTC connection"}perform(){return w(this,void 0,void 0,function*(){let e=!1,i=!1;this.room.on(Z.SignalConnected,()=>{const s=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(o,l)=>{if(o.candidate){const u=new RTCIceCandidate(o);let d="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(Zw(u.address)?d+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,d+=" (passive)"):u.protocol==="udp"&&(i=!0)),this.appendMessage(d)}s&&s(o,l)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=o=>{o instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(o.errorCode," ").concat(o.errorText," ").concat(o.url))})});try{yield this.connect(),Ce.info("now the room is connected")}catch(s){throw this.appendWarning("ports need to be open on firewall in order to connect."),s}e||this.appendWarning("Server is not configured for ICE/TCP"),i||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Zw(a){const e=a.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const i=parseInt(e[1],10);if(i>=16&&i<=31)return!0}}return!1}class Ww extends Vi{get description(){return"Connecting to signal connection via WebSocket"}perform(){return w(this,void 0,void 0,function*(){var e,i,s;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new nh;const l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(l.serverVersion,".")),((e=l.serverInfo)===null||e===void 0?void 0:e.edition)===M0.Cloud&&(!((i=l.serverInfo)===null||i===void 0)&&i.region)&&this.appendMessage("LiveKit Cloud: ".concat((s=l.serverInfo)===null||s===void 0?void 0:s.region)),yield o.close()})}}class EO extends Ln.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=i,this.options=s}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:pn.IDLE,name:"",description:""}),e}updateCheck(e,i){this.checkResults.set(e,i),this.emit("checkUpdate",e,i)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==pn.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return w(this,void 0,void 0,function*(){const i=this.getNextCheckId(),s=new e(this.url,this.token,this.options),o=u=>{this.updateCheck(i,u)};s.on("update",o);const l=yield s.run();return s.off("update",o),l})}checkWebsocket(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Ww)})}checkWebRTC(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Jw)})}checkTURN(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Xw)})}checkReconnect(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Qw)})}checkPublishAudio(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Yw)})}checkPublishVideo(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Kw)})}checkConnectionProtocol(){return w(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(Vw);if(e.data&&"protocol"in e.data){const i=e.data;this.options.protocol=i.protocol}return e})}checkCloudRegion(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(Hw)})}}class $w{constructor(){ss(this,"room");ss(this,"handleParticipantConnected",e=>{console.log("Participant connected:",e.identity)});ss(this,"handleParticipantDisconnected",e=>{console.log("Participant disconnected:",e.identity)});ss(this,"handleDisconnect",()=>{console.log("Disconnected from room")});ss(this,"handleConnectionStateChanged",e=>{console.log("Connection state changed:",e)});this.room=new bs,this.room.on(Z.ParticipantConnected,this.handleParticipantConnected).on(Z.ParticipantDisconnected,this.handleParticipantDisconnected).on(Z.Disconnected,this.handleDisconnect).on(Z.ConnectionStateChanged,this.handleConnectionStateChanged)}async createToken(e,i,s){try{return(await nt.post("/api/create-token",{identity:e,roomName:i,metadata:{name:s}})).data.token}catch(o){throw console.error("Failed to create token:",o),new Error("토큰 생성에 실패했습니다.")}}async startBroadcast(e){try{return console.log("연결 시도할 URL:","ws://114.204.127.97:7880"),console.log("토큰 값:",e),await this.room.connect("ws://114.204.127.97:7880",e),console.log("Connected to room:",this.room.name),await this.publishLocalTracks(),this.room}catch(i){throw console.error("Failed to connect to room:",i),new Error("방송 시작에 실패했습니다.")}}async publishLocalTracks(){try{const e=await ch({audio:!0,video:!0}),i=[];for(const s of e){const o=await this.room.localParticipant.publishTrack(s);i.push(o)}return console.log("Local tracks published"),i}catch(e){throw console.error("Failed to publish local tracks:",e),new Error("카메라 및 마이크 설정에 실패했습니다.")}}async stopBroadcast(){this.room.disconnect(),console.log("Disconnected from room")}getRoom(){return this.room}getLocalParticipant(){return this.room.localParticipant}getRemoteParticipants(){return Array.from(this.room.remoteParticipants.values())}getLocalVideoTrack(){const e=this.getLocalParticipant();if(e)return Array.from(e.trackPublications.values()).find(i=>i.kind==="video")}attachVideoTrack(e){console.log("attachVideoTrack 호출됨:",e);const i=this.getLocalParticipant();if(!i)return console.error("로컬 참가자를 찾을 수 없습니다"),!1;console.log("로컬 참가자 ID:",i.identity);try{const s=Array.from(i.trackPublications.values());console.log("사용 가능한 트랙:",s.map(d=>({kind:d.kind,trackName:d.trackName,source:d.source,hasTrack:!!d.track})));const o=s.filter(d=>d.kind==="video");if(console.log("비디오 트랙 수:",o.length),o.length===0)return console.log("비디오 트랙을 찾을 수 없어 직접 미디어 스트림을 연결합니다"),this.attachDirectMediaStream(e),!0;const l=o[0];console.log("사용할 비디오 트랙:",l.trackName);const u=l.track;return u?(console.log("비디오 트랙 정보:",{id:u.sid,kind:u.kind,mediaStreamTrack:u.mediaStreamTrack?"있음":"없음"}),u.attach(e),console.log("비디오 트랙 연결 성공:",l.trackName),!0):(console.error("비디오 트랙이 없습니다"),!1)}catch(s){return console.error("비디오 트랙 연결 실패:",s),!1}}async attachDirectMediaStream(e){try{if(console.log("직접 미디어 스트림 연결 시도..."),e.srcObject)return console.log("이미 비디오 요소에 스트림이 연결되어 있습니다"),!0;const i={video:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30}},audio:!0};console.log("사용자 미디어 요청 중...",i);const s=await navigator.mediaDevices.getUserMedia(i);console.log("미디어 스트림 트랙:",s.getTracks().map(o=>({kind:o.kind,label:o.label,enabled:o.enabled,id:o.id}))),e.srcObject=s;try{await e.play(),console.log("비디오 요소 재생 시작")}catch(o){console.error("비디오 요소 재생 실패:",o),console.log("브라우저 정책으로 인해 사용자 상호작용 후 재생이 필요할 수 있습니다")}return console.log("직접 미디어 스트림 연결 성공"),!0}catch(i){return console.error("직접 미디어 스트림 연결 실패:",i),!1}}}const fa=new $w,eO=({roomName:a,userName:e})=>{const[i,s]=z.useState([]),[o,l]=z.useState(""),u=z.useRef(null);z.useEffect(()=>{m({id:Date.now().toString(),sender:"system",content:`${a} 채팅방에 오신 것을 환영합니다!`,timestamp:new Date}),setTimeout(()=>{m({id:(Date.now()+1).toString(),sender:"시청자1",content:"안녕하세요! 오늘 방송 주제가 뭔가요?",timestamp:new Date})},2e3),setTimeout(()=>{m({id:(Date.now()+2).toString(),sender:"시청자2",content:"화면이 너무 깨끗하네요! 카메라가 뭔가요?",timestamp:new Date})},5e3)},[a]),z.useEffect(()=>{d()},[i]);const d=()=>{var v;(v=u.current)==null||v.scrollIntoView({behavior:"smooth"})},m=v=>{s(b=>[...b,v])},h=v=>{v.preventDefault(),o.trim()!==""&&(m({id:Date.now().toString(),sender:e,content:o,timestamp:new Date}),l(""))},g=v=>v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return C.jsxs("div",{className:"chat-container",children:[C.jsxs("div",{className:"chat-header",children:[C.jsx("h3",{children:"라이브 채팅"}),C.jsx("span",{className:"chat-room",children:a})]}),C.jsxs("div",{className:"chat-messages",children:[i.map(v=>C.jsxs("div",{className:`chat-message ${v.sender==="system"?"system-message":""} ${v.sender===e?"my-message":""}`,children:[C.jsxs("div",{className:"message-header",children:[C.jsx("span",{className:"message-sender",children:v.sender}),C.jsx("span",{className:"message-time",children:g(v.timestamp)})]}),C.jsx("div",{className:"message-content",children:v.content})]},v.id)),C.jsx("div",{ref:u})]}),C.jsxs("form",{className:"chat-input-form",onSubmit:h,children:[C.jsx("input",{type:"text",value:o,onChange:v=>l(v.target.value),placeholder:"메시지 입력...",className:"chat-input"}),C.jsx("button",{type:"submit",className:"chat-send-btn",children:"전송"})]})]})},tO=({userName:a,roomName:e,onClose:i})=>{const[s,o]=z.useState(!0),[l,u]=z.useState(null),[d,m]=z.useState(null),[h,g]=z.useState(!1),[v,b]=z.useState(0),[k,T]=z.useState(0),E=z.useRef(null);z.useEffect(()=>{let q=null;return h&&(q=window.setInterval(()=>{T(j=>j+1)},1e3)),()=>{q&&clearInterval(q)}},[h]),z.useEffect(()=>((async()=>{try{o(!0),u(null);const j=await fa.createToken(a,e,a);console.log("토큰 생성 성공");const M=await fa.startBroadcast(j);console.log("방 연결 성공:",M.name),m(M),g(!0),console.log("localVideoRef 확인:",E),console.log("localVideoRef.current 확인:",E.current),console.log("document.getElementById 확인:",document.getElementById("video-preview")),setTimeout(()=>{try{const x=document.getElementById("video-preview");if(!x){console.error("document.getElementById로 비디오 요소를 찾을 수 없습니다");return}console.log("비디오 요소를 성공적으로 찾았습니다"),console.log("비디오 요소에 트랙 연결 시도..."),fa.attachVideoTrack(x)||console.error("비디오 트랙을 연결할 수 없습니다")}catch(x){console.error("비디오 연결 오류:",x)}},2e3),M.on("participantConnected",()=>{const x=fa.getRemoteParticipants().length;b(x)}),M.on("participantDisconnected",()=>{const x=fa.getRemoteParticipants().length;b(x)})}catch(j){console.error("방 초기화 중 오류 발생:",j),u(j instanceof Error?j.message:"방송을 시작할 수 없습니다.")}finally{o(!1)}})(),()=>{d&&fa.stopBroadcast()}),[e,a]);const _=()=>{d&&(fa.stopBroadcast(),g(!1),i())},O=q=>{const j=Math.floor(q/3600),M=Math.floor(q%3600/60),x=q%60;return[j>0?j.toString().padStart(2,"0"):null,M.toString().padStart(2,"0"),x.toString().padStart(2,"0")].filter(Boolean).join(":")};return s?C.jsxs("div",{className:"broadcaster-container loading",children:[C.jsx("div",{className:"loading-spinner"}),C.jsx("p",{children:"방송을 준비 중입니다..."})]}):l?C.jsxs("div",{className:"broadcaster-container error",children:[C.jsx("div",{className:"error-icon",children:"❌"}),C.jsx("h3",{children:"오류가 발생했습니다"}),C.jsx("p",{children:l}),C.jsx("button",{className:"btn btn-primary",onClick:i,children:"닫기"})]}):C.jsxs("div",{className:"broadcaster-container",children:[C.jsxs("div",{className:"broadcast-header",children:[C.jsxs("div",{className:"broadcast-info",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsx("span",{className:"room-name",children:e}),C.jsx("span",{className:"time-elapsed",children:O(k)})]}),C.jsxs("div",{className:"broadcast-controls",children:[C.jsxs("span",{className:"viewer-count",children:["👁️ ",v]}),C.jsx("button",{className:"btn btn-danger",onClick:_,children:"방송 종료"})]})]}),C.jsxs("div",{className:"broadcast-content",children:[C.jsx("div",{className:"video-container",children:C.jsx("video",{id:"video-preview",ref:E,autoPlay:!0,playsInline:!0,muted:!0,className:"local-video"})}),C.jsx("div",{className:"chat-container-wrapper",children:C.jsx(eO,{roomName:e,userName:a})})]}),C.jsx("div",{className:"broadcast-footer",children:C.jsx("p",{className:"broadcast-tip",children:"💡 방송 팁: 밝은 곳에서 방송하고, 명확하게 말하면 시청자들이 더 잘 이해할 수 있습니다."})})]})};function nO(){const[a,e]=z.useState(null),[i,s]=z.useState(!1),[o,l]=z.useState(""),[u,d]=z.useState(""),[m,h]=z.useState(""),[g,v]=z.useState(""),b=E=>{e(E)},k=E=>{E.preventDefault(),console.log("방송 시작 폼 제출됨:",{roomName:o,userName:u,category:m,description:g}),o&&m?(console.log("방송 시작 조건 충족"),s(!0)):console.log("방송 시작 조건 불충족:",{roomName:o,category:m})},T=()=>{s(!1)};return i?C.jsxs("div",{className:"live-page",children:[C.jsx(Yd,{isHomePage:!1}),C.jsx("main",{className:"live-container",children:C.jsx(tO,{userName:u||"익명 사용자",roomName:o,onClose:T})}),C.jsx(Kd,{simplified:!0})]}):C.jsxs("div",{className:"live-page",children:[C.jsx(Yd,{isHomePage:!1}),C.jsxs("main",{className:"live-container",children:[C.jsx("h1",{className:"live-title",children:"라이브 방송"}),C.jsx("p",{className:"live-description",children:"라이브 방송을 통해 제품을 홍보하고 실시간으로 고객과 소통하세요."}),C.jsxs("div",{className:"options-container",children:[C.jsxs("div",{className:`option-card ${a==="broadcast"?"selected":""}`,onClick:()=>b("broadcast"),children:[C.jsx("div",{className:"option-icon",children:"📹"}),C.jsx("h2",{children:"방송하기"}),C.jsx("p",{children:"제품 라이브 방송을 시작하고 고객과 실시간으로 소통하세요."}),C.jsx("button",{className:"btn btn-primary",onClick:E=>{E.stopPropagation(),b("broadcast")},children:"방송 시작하기"})]}),C.jsxs("div",{className:`option-card ${a==="watch"?"selected":""}`,onClick:()=>b("watch"),children:[C.jsx("div",{className:"option-icon",children:"👁️"}),C.jsx("h2",{children:"시청하기"}),C.jsx("p",{children:"진행 중인 라이브 방송을 확인하고 참여하세요."}),C.jsx("button",{className:"btn btn-primary",children:"라이브 찾기"})]})]}),a==="broadcast"&&C.jsxs("div",{className:"option-details",children:[C.jsx("h3",{children:"방송 시작하기"}),C.jsx("p",{children:"방송을 시작하기 전에 다음 정보를 확인해 주세요:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"제품 정보가 정확히 입력되어 있는지 확인하세요."}),C.jsx("li",{children:"카메라와 마이크 연결 상태를 확인하세요."}),C.jsx("li",{children:"인터넷 연결이 안정적인지 확인하세요."})]}),C.jsxs("form",{className:"broadcast-form",onSubmit:k,children:[C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"방송 제목",value:o,onChange:E=>l(E.target.value),required:!0})}),C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"방송자 이름",value:u,onChange:E=>d(E.target.value)})}),C.jsx("div",{className:"form-group",children:C.jsxs("select",{value:m,onChange:E=>h(E.target.value),required:!0,children:[C.jsx("option",{value:"",children:"카테고리 선택"}),C.jsx("option",{value:"fashion",children:"패션/의류"}),C.jsx("option",{value:"beauty",children:"뷰티/화장품"}),C.jsx("option",{value:"food",children:"식품"}),C.jsx("option",{value:"home",children:"홈/리빙"}),C.jsx("option",{value:"digital",children:"디지털/가전"})]})}),C.jsx("div",{className:"form-group",children:C.jsx("textarea",{placeholder:"방송 설명",rows:3,value:g,onChange:E=>v(E.target.value)})}),C.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:"방송 시작하기"})]})]}),a==="watch"&&C.jsxs("div",{className:"option-details",children:[C.jsx("h3",{children:"라이브 방송 둘러보기"}),C.jsx("p",{children:"현재 진행 중인 인기 라이브 방송:"}),C.jsxs("div",{className:"live-list",children:[C.jsxs("div",{className:"live-item",children:[C.jsxs("div",{className:"live-thumbnail",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsx("div",{className:"viewer-count",children:"👁️ 1,245"})]}),C.jsx("h4",{children:"봄맞이 신상 의류 50% 할인 특가"}),C.jsx("p",{children:"패션스토어 | 23분 전 시작"})]}),C.jsxs("div",{className:"live-item",children:[C.jsxs("div",{className:"live-thumbnail",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsx("div",{className:"viewer-count",children:"👁️ 857"})]}),C.jsx("h4",{children:"최신 스마트폰 언박싱 & 리뷰"}),C.jsx("p",{children:"테크월드 | 10분 전 시작"})]}),C.jsxs("div",{className:"live-item",children:[C.jsxs("div",{className:"live-thumbnail",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsx("div",{className:"viewer-count",children:"👁️ 492"})]}),C.jsx("h4",{children:"홈케어 제품 할인전"}),C.jsx("p",{children:"리빙마트 | 45분 전 시작"})]})]})]})]}),C.jsx(Kd,{simplified:!0})]})}function iO(){return C.jsx(BC,{children:C.jsxs(gC,{children:[C.jsx(Fd,{path:"/",element:C.jsx(XC,{})}),C.jsx(Fd,{path:"/live",element:C.jsx(nO,{})})]})})}Rk.createRoot(document.getElementById("root")).render(C.jsx(z.StrictMode,{children:C.jsx(iO,{})}));
