var pk=Object.defineProperty;var gk=(a,e,i)=>e in a?pk(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i;var ss=(a,e,i)=>gk(a,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();var gd={exports:{}},ye={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function vk(){if(Gg)return ye;Gg=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,E={};function _(D,Z,he){this.props=D,this.context=Z,this.refs=E,this.updater=he||k}_.prototype.isReactComponent={},_.prototype.setState=function(D,Z){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,Z,"setState")},_.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function x(){}x.prototype=_.prototype;function I(D,Z,he){this.props=D,this.context=Z,this.refs=E,this.updater=he||k}var U=I.prototype=new x;U.constructor=I,T(U,_.prototype),U.isPureReactComponent=!0;var N=Array.isArray,w={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function J(D,Z,he,de,se,_e){return he=_e.ref,{$$typeof:a,type:D,key:Z,ref:he!==void 0?he:null,props:_e}}function ne(D,Z){return J(D.type,Z,void 0,void 0,void 0,D.props)}function Q(D){return typeof D=="object"&&D!==null&&D.$$typeof===a}function ee(D){var Z={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(he){return Z[he]})}var le=/\/+/g;function Re(D,Z){return typeof D=="object"&&D!==null&&D.key!=null?ee(""+D.key):Z.toString(36)}function ue(){}function vt(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(ue,ue):(D.status="pending",D.then(function(Z){D.status==="pending"&&(D.status="fulfilled",D.value=Z)},function(Z){D.status==="pending"&&(D.status="rejected",D.reason=Z)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function kt(D,Z,he,de,se){var _e=typeof D;(_e==="undefined"||_e==="boolean")&&(D=null);var be=!1;if(D===null)be=!0;else switch(_e){case"bigint":case"string":case"number":be=!0;break;case"object":switch(D.$$typeof){case a:case e:be=!0;break;case g:return be=D._init,kt(be(D._payload),Z,he,de,se)}}if(be)return se=se(D),be=de===""?"."+Re(D,0):de,N(se)?(he="",be!=null&&(he=be.replace(le,"$&/")+"/"),kt(se,Z,he,"",function(at){return at})):se!=null&&(Q(se)&&(se=ne(se,he+(se.key==null||D&&D.key===se.key?"":(""+se.key).replace(le,"$&/")+"/")+be)),Z.push(se)),1;be=0;var wt=de===""?".":de+":";if(N(D))for(var Pe=0;Pe<D.length;Pe++)de=D[Pe],_e=wt+Re(de,Pe),be+=kt(de,Z,he,_e,se);else if(Pe=b(D),typeof Pe=="function")for(D=Pe.call(D),Pe=0;!(de=D.next()).done;)de=de.value,_e=wt+Re(de,Pe++),be+=kt(de,Z,he,_e,se);else if(_e==="object"){if(typeof D.then=="function")return kt(vt(D),Z,he,de,se);throw Z=String(D),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return be}function ie(D,Z,he){if(D==null)return D;var de=[],se=0;return kt(D,de,"","",function(_e){return Z.call(he,_e,se++)}),de}function ge(D){if(D._status===-1){var Z=D._result;Z=Z(),Z.then(function(he){(D._status===0||D._status===-1)&&(D._status=1,D._result=he)},function(he){(D._status===0||D._status===-1)&&(D._status=2,D._result=he)}),D._status===-1&&(D._status=0,D._result=Z)}if(D._status===1)return D._result.default;throw D._result}var me=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function ze(){}return ye.Children={map:ie,forEach:function(D,Z,he){ie(D,function(){Z.apply(this,arguments)},he)},count:function(D){var Z=0;return ie(D,function(){Z++}),Z},toArray:function(D){return ie(D,function(Z){return Z})||[]},only:function(D){if(!Q(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},ye.Component=_,ye.Fragment=i,ye.Profiler=o,ye.PureComponent=I,ye.StrictMode=s,ye.Suspense=m,ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,ye.act=function(){throw Error("act(...) is not supported in production builds of React.")},ye.cache=function(D){return function(){return D.apply(null,arguments)}},ye.cloneElement=function(D,Z,he){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var de=T({},D.props),se=D.key,_e=void 0;if(Z!=null)for(be in Z.ref!==void 0&&(_e=void 0),Z.key!==void 0&&(se=""+Z.key),Z)!F.call(Z,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&Z.ref===void 0||(de[be]=Z[be]);var be=arguments.length-2;if(be===1)de.children=he;else if(1<be){for(var wt=Array(be),Pe=0;Pe<be;Pe++)wt[Pe]=arguments[Pe+2];de.children=wt}return J(D.type,se,void 0,void 0,_e,de)},ye.createContext=function(D){return D={$$typeof:u,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:l,_context:D},D},ye.createElement=function(D,Z,he){var de,se={},_e=null;if(Z!=null)for(de in Z.key!==void 0&&(_e=""+Z.key),Z)F.call(Z,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(se[de]=Z[de]);var be=arguments.length-2;if(be===1)se.children=he;else if(1<be){for(var wt=Array(be),Pe=0;Pe<be;Pe++)wt[Pe]=arguments[Pe+2];se.children=wt}if(D&&D.defaultProps)for(de in be=D.defaultProps,be)se[de]===void 0&&(se[de]=be[de]);return J(D,_e,void 0,void 0,null,se)},ye.createRef=function(){return{current:null}},ye.forwardRef=function(D){return{$$typeof:d,render:D}},ye.isValidElement=Q,ye.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:ge}},ye.memo=function(D,Z){return{$$typeof:h,type:D,compare:Z===void 0?null:Z}},ye.startTransition=function(D){var Z=w.T,he={};w.T=he;try{var de=D(),se=w.S;se!==null&&se(he,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(ze,me)}catch(_e){me(_e)}finally{w.T=Z}},ye.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},ye.use=function(D){return w.H.use(D)},ye.useActionState=function(D,Z,he){return w.H.useActionState(D,Z,he)},ye.useCallback=function(D,Z){return w.H.useCallback(D,Z)},ye.useContext=function(D){return w.H.useContext(D)},ye.useDebugValue=function(){},ye.useDeferredValue=function(D,Z){return w.H.useDeferredValue(D,Z)},ye.useEffect=function(D,Z){return w.H.useEffect(D,Z)},ye.useId=function(){return w.H.useId()},ye.useImperativeHandle=function(D,Z,he){return w.H.useImperativeHandle(D,Z,he)},ye.useInsertionEffect=function(D,Z){return w.H.useInsertionEffect(D,Z)},ye.useLayoutEffect=function(D,Z){return w.H.useLayoutEffect(D,Z)},ye.useMemo=function(D,Z){return w.H.useMemo(D,Z)},ye.useOptimistic=function(D,Z){return w.H.useOptimistic(D,Z)},ye.useReducer=function(D,Z,he){return w.H.useReducer(D,Z,he)},ye.useRef=function(D){return w.H.useRef(D)},ye.useState=function(D){return w.H.useState(D)},ye.useSyncExternalStore=function(D,Z,he){return w.H.useSyncExternalStore(D,Z,he)},ye.useTransition=function(){return w.H.useTransition()},ye.version="19.0.0",ye}var Kg;function Mf(){return Kg||(Kg=1,gd.exports=vk()),gd.exports}var B=Mf(),vd={exports:{}},kr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yg;function yk(){if(Yg)return kr;Yg=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(s,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:a,type:s,key:u,ref:o!==void 0?o:null,props:l}}return kr.Fragment=e,kr.jsx=i,kr.jsxs=i,kr}var Qg;function bk(){return Qg||(Qg=1,vd.exports=yk()),vd.exports}var C=bk(),yd={exports:{}},Cr={},bd={exports:{}},Sd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function Sk(){return Xg||(Xg=1,function(a){function e(ie,ge){var me=ie.length;ie.push(ge);e:for(;0<me;){var ze=me-1>>>1,D=ie[ze];if(0<o(D,ge))ie[ze]=ge,ie[me]=D,me=ze;else break e}}function i(ie){return ie.length===0?null:ie[0]}function s(ie){if(ie.length===0)return null;var ge=ie[0],me=ie.pop();if(me!==ge){ie[0]=me;e:for(var ze=0,D=ie.length,Z=D>>>1;ze<Z;){var he=2*(ze+1)-1,de=ie[he],se=he+1,_e=ie[se];if(0>o(de,me))se<D&&0>o(_e,de)?(ie[ze]=_e,ie[se]=me,ze=se):(ie[ze]=de,ie[he]=me,ze=he);else if(se<D&&0>o(_e,me))ie[ze]=_e,ie[se]=me,ze=se;else break e}}return ge}function o(ie,ge){var me=ie.sortIndex-ge.sortIndex;return me!==0?me:ie.id-ge.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;a.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();a.unstable_now=function(){return u.now()-d}}var m=[],h=[],g=1,v=null,b=3,k=!1,T=!1,E=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;function U(ie){for(var ge=i(h);ge!==null;){if(ge.callback===null)s(h);else if(ge.startTime<=ie)s(h),ge.sortIndex=ge.expirationTime,e(m,ge);else break;ge=i(h)}}function N(ie){if(E=!1,U(ie),!T)if(i(m)!==null)T=!0,vt();else{var ge=i(h);ge!==null&&kt(N,ge.startTime-ie)}}var w=!1,F=-1,J=5,ne=-1;function Q(){return!(a.unstable_now()-ne<J)}function ee(){if(w){var ie=a.unstable_now();ne=ie;var ge=!0;try{e:{T=!1,E&&(E=!1,x(F),F=-1),k=!0;var me=b;try{t:{for(U(ie),v=i(m);v!==null&&!(v.expirationTime>ie&&Q());){var ze=v.callback;if(typeof ze=="function"){v.callback=null,b=v.priorityLevel;var D=ze(v.expirationTime<=ie);if(ie=a.unstable_now(),typeof D=="function"){v.callback=D,U(ie),ge=!0;break t}v===i(m)&&s(m),U(ie)}else s(m);v=i(m)}if(v!==null)ge=!0;else{var Z=i(h);Z!==null&&kt(N,Z.startTime-ie),ge=!1}}break e}finally{v=null,b=me,k=!1}ge=void 0}}finally{ge?le():w=!1}}}var le;if(typeof I=="function")le=function(){I(ee)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,ue=Re.port2;Re.port1.onmessage=ee,le=function(){ue.postMessage(null)}}else le=function(){_(ee,0)};function vt(){w||(w=!0,le())}function kt(ie,ge){F=_(function(){ie(a.unstable_now())},ge)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(ie){ie.callback=null},a.unstable_continueExecution=function(){T||k||(T=!0,vt())},a.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<ie?Math.floor(1e3/ie):5},a.unstable_getCurrentPriorityLevel=function(){return b},a.unstable_getFirstCallbackNode=function(){return i(m)},a.unstable_next=function(ie){switch(b){case 1:case 2:case 3:var ge=3;break;default:ge=b}var me=b;b=ge;try{return ie()}finally{b=me}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function(ie,ge){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var me=b;b=ie;try{return ge()}finally{b=me}},a.unstable_scheduleCallback=function(ie,ge,me){var ze=a.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ze+me:ze):me=ze,ie){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=me+D,ie={id:g++,callback:ge,priorityLevel:ie,startTime:me,expirationTime:D,sortIndex:-1},me>ze?(ie.sortIndex=me,e(h,ie),i(m)===null&&ie===i(h)&&(E?(x(F),F=-1):E=!0,kt(N,me-ze))):(ie.sortIndex=D,e(m,ie),T||k||(T=!0,vt())),ie},a.unstable_shouldYield=Q,a.unstable_wrapCallback=function(ie){var ge=b;return function(){var me=b;b=ge;try{return ie.apply(this,arguments)}finally{b=me}}}}(Sd)),Sd}var Jg;function Tk(){return Jg||(Jg=1,bd.exports=Sk()),bd.exports}var Td={exports:{}},Rt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg;function kk(){if(Zg)return Rt;Zg=1;var a=Mf();function e(m){var h="https://react.dev/errors/"+m;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+m+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(m,h,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:m,containerInfo:h,implementation:g}}var u=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(m,h){if(m==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Rt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Rt.createPortal=function(m,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(m,h,null,g)},Rt.flushSync=function(m){var h=u.T,g=s.p;try{if(u.T=null,s.p=2,m)return m()}finally{u.T=h,s.p=g,s.d.f()}},Rt.preconnect=function(m,h){typeof m=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(m,h))},Rt.prefetchDNS=function(m){typeof m=="string"&&s.d.D(m)},Rt.preinit=function(m,h){if(typeof m=="string"&&h&&typeof h.as=="string"){var g=h.as,v=d(g,h.crossOrigin),b=typeof h.integrity=="string"?h.integrity:void 0,k=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?s.d.S(m,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:k}):g==="script"&&s.d.X(m,{crossOrigin:v,integrity:b,fetchPriority:k,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Rt.preinitModule=function(m,h){if(typeof m=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=d(h.as,h.crossOrigin);s.d.M(m,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(m)},Rt.preload=function(m,h){if(typeof m=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,v=d(g,h.crossOrigin);s.d.L(m,g,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Rt.preloadModule=function(m,h){if(typeof m=="string")if(h){var g=d(h.as,h.crossOrigin);s.d.m(m,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(m)},Rt.requestFormReset=function(m){s.d.r(m)},Rt.unstable_batchedUpdates=function(m,h){return m(h)},Rt.useFormState=function(m,h,g){return u.H.useFormState(m,h,g)},Rt.useFormStatus=function(){return u.H.useHostTransitionStatus()},Rt.version="19.0.0",Rt}var Wg;function Ck(){if(Wg)return Td.exports;Wg=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),Td.exports=kk(),Td.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function Ek(){if($g)return Cr;$g=1;var a=Tk(),e=Mf(),i=Ck();function s(t){var n="https://react.dev/errors/"+t;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)n+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}var l=Symbol.for("react.element"),u=Symbol.for("react.transitional.element"),d=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),k=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),U=Symbol.for("react.offscreen"),N=Symbol.for("react.memo_cache_sentinel"),w=Symbol.iterator;function F(t){return t===null||typeof t!="object"?null:(t=w&&t[w]||t["@@iterator"],typeof t=="function"?t:null)}var J=Symbol.for("react.client.reference");function ne(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===J?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case m:return"Fragment";case d:return"Portal";case g:return"Profiler";case h:return"StrictMode";case E:return"Suspense";case _:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case k:return(t.displayName||"Context")+".Provider";case b:return(t._context.displayName||"Context")+".Consumer";case T:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case x:return n=t.displayName||null,n!==null?n:ne(t.type)||"Memo";case I:n=t._payload,t=t._init;try{return ne(t(n))}catch{}}return null}var Q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=Object.assign,le,Re;function ue(t){if(le===void 0)try{throw Error()}catch(r){var n=r.stack.trim().match(/\n( *(at )?)/);le=n&&n[1]||"",Re=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+le+t+Re}var vt=!1;function kt(t,n){if(!t||vt)return"";vt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var X=function(){throw Error()};if(Object.defineProperty(X.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(X,[])}catch(V){var j=V}Reflect.construct(t,[],X)}else{try{X.call()}catch(V){j=V}t.call(X.prototype)}}else{try{throw Error()}catch(V){j=V}(X=t())&&typeof X.catch=="function"&&X.catch(function(){})}}catch(V){if(V&&j&&typeof V.stack=="string")return[V.stack,j.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),y=p[0],S=p[1];if(y&&S){var R=y.split(`
`),P=S.split(`
`);for(f=c=0;c<R.length&&!R[c].includes("DetermineComponentFrameRoot");)c++;for(;f<P.length&&!P[f].includes("DetermineComponentFrameRoot");)f++;if(c===R.length||f===P.length)for(c=R.length-1,f=P.length-1;1<=c&&0<=f&&R[c]!==P[f];)f--;for(;1<=c&&0<=f;c--,f--)if(R[c]!==P[f]){if(c!==1||f!==1)do if(c--,f--,0>f||R[c]!==P[f]){var H=`
`+R[c].replace(" at new "," at ");return t.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",t.displayName)),H}while(1<=c&&0<=f);break}}}finally{vt=!1,Error.prepareStackTrace=r}return(r=t?t.displayName||t.name:"")?ue(r):""}function ie(t){switch(t.tag){case 26:case 27:case 5:return ue(t.type);case 16:return ue("Lazy");case 13:return ue("Suspense");case 19:return ue("SuspenseList");case 0:case 15:return t=kt(t.type,!1),t;case 11:return t=kt(t.type.render,!1),t;case 1:return t=kt(t.type,!0),t;default:return""}}function ge(t){try{var n="";do n+=ie(t),t=t.return;while(t);return n}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function me(t){var n=t,r=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(r=n.return),t=n.return;while(t)}return n.tag===3?r:null}function ze(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function D(t){if(me(t)!==t)throw Error(s(188))}function Z(t){var n=t.alternate;if(!n){if(n=me(t),n===null)throw Error(s(188));return n!==t?null:t}for(var r=t,c=n;;){var f=r.return;if(f===null)break;var p=f.alternate;if(p===null){if(c=f.return,c!==null){r=c;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===r)return D(f),t;if(p===c)return D(f),n;p=p.sibling}throw Error(s(188))}if(r.return!==c.return)r=f,c=p;else{for(var y=!1,S=f.child;S;){if(S===r){y=!0,r=f,c=p;break}if(S===c){y=!0,c=f,r=p;break}S=S.sibling}if(!y){for(S=p.child;S;){if(S===r){y=!0,r=p,c=f;break}if(S===c){y=!0,c=p,r=f;break}S=S.sibling}if(!y)throw Error(s(189))}}if(r.alternate!==c)throw Error(s(190))}if(r.tag!==3)throw Error(s(188));return r.stateNode.current===r?t:n}function he(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t;for(t=t.child;t!==null;){if(n=he(t),n!==null)return n;t=t.sibling}return null}var de=Array.isArray,se=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},be=[],wt=-1;function Pe(t){return{current:t}}function at(t){0>wt||(t.current=be[wt],be[wt]=null,wt--)}function He(t,n){wt++,be[wt]=t.current,t.current=n}var Tn=Pe(null),Rs=Pe(null),ci=Pe(null),Yr=Pe(null);function Qr(t,n){switch(He(ci,n),He(Rs,t),He(Tn,null),t=n.nodeType,t){case 9:case 11:n=(n=n.documentElement)&&(n=n.namespaceURI)?Sg(n):0;break;default:if(t=t===8?n.parentNode:n,n=t.tagName,t=t.namespaceURI)t=Sg(t),n=Tg(t,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}at(Tn),He(Tn,n)}function Ca(){at(Tn),at(Rs),at(ci)}function ol(t){t.memoizedState!==null&&He(Yr,t);var n=Tn.current,r=Tg(n,t.type);n!==r&&(He(Rs,t),He(Tn,r))}function Xr(t){Rs.current===t&&(at(Tn),at(Rs)),Yr.current===t&&(at(Yr),vr._currentValue=_e)}var cl=Object.prototype.hasOwnProperty,ll=a.unstable_scheduleCallback,ul=a.unstable_cancelCallback,Yb=a.unstable_shouldYield,Qb=a.unstable_requestPaint,kn=a.unstable_now,Xb=a.unstable_getCurrentPriorityLevel,lh=a.unstable_ImmediatePriority,uh=a.unstable_UserBlockingPriority,Jr=a.unstable_NormalPriority,Jb=a.unstable_LowPriority,dh=a.unstable_IdlePriority,Zb=a.log,Wb=a.unstable_setDisableYieldValue,_s=null,It=null;function $b(t){if(It&&typeof It.onCommitFiberRoot=="function")try{It.onCommitFiberRoot(_s,t,void 0,(t.current.flags&128)===128)}catch{}}function li(t){if(typeof Zb=="function"&&Wb(t),It&&typeof It.setStrictMode=="function")try{It.setStrictMode(_s,t)}catch{}}var Bt=Math.clz32?Math.clz32:nS,eS=Math.log,tS=Math.LN2;function nS(t){return t>>>=0,t===0?32:31-(eS(t)/tS|0)|0}var Zr=128,Wr=4194304;function Gi(t){var n=t&42;if(n!==0)return n;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function $r(t,n){var r=t.pendingLanes;if(r===0)return 0;var c=0,f=t.suspendedLanes,p=t.pingedLanes,y=t.warmLanes;t=t.finishedLanes!==0;var S=r&134217727;return S!==0?(r=S&~f,r!==0?c=Gi(r):(p&=S,p!==0?c=Gi(p):t||(y=S&~y,y!==0&&(c=Gi(y))))):(S=r&~f,S!==0?c=Gi(S):p!==0?c=Gi(p):t||(y=r&~y,y!==0&&(c=Gi(y)))),c===0?0:n!==0&&n!==c&&(n&f)===0&&(f=c&-c,y=n&-n,f>=y||f===32&&(y&4194176)!==0)?n:c}function ws(t,n){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&n)===0}function iS(t,n){switch(t){case 1:case 2:case 4:case 8:return n+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fh(){var t=Zr;return Zr<<=1,(Zr&4194176)===0&&(Zr=128),t}function hh(){var t=Wr;return Wr<<=1,(Wr&62914560)===0&&(Wr=4194304),t}function dl(t){for(var n=[],r=0;31>r;r++)n.push(t);return n}function xs(t,n){t.pendingLanes|=n,n!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function aS(t,n,r,c,f,p){var y=t.pendingLanes;t.pendingLanes=r,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=r,t.entangledLanes&=r,t.errorRecoveryDisabledLanes&=r,t.shellSuspendCounter=0;var S=t.entanglements,R=t.expirationTimes,P=t.hiddenUpdates;for(r=y&~r;0<r;){var H=31-Bt(r),X=1<<H;S[H]=0,R[H]=-1;var j=P[H];if(j!==null)for(P[H]=null,H=0;H<j.length;H++){var V=j[H];V!==null&&(V.lane&=-536870913)}r&=~X}c!==0&&mh(t,c,0),p!==0&&f===0&&t.tag!==0&&(t.suspendedLanes|=p&~(y&~n))}function mh(t,n,r){t.pendingLanes|=n,t.suspendedLanes&=~n;var c=31-Bt(n);t.entangledLanes|=n,t.entanglements[c]=t.entanglements[c]|1073741824|r&4194218}function ph(t,n){var r=t.entangledLanes|=n;for(t=t.entanglements;r;){var c=31-Bt(r),f=1<<c;f&n|t[c]&n&&(t[c]|=n),r&=~f}}function gh(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function vh(){var t=se.p;return t!==0?t:(t=window.event,t===void 0?32:Bg(t.type))}function sS(t,n){var r=se.p;try{return se.p=t,n()}finally{se.p=r}}var ui=Math.random().toString(36).slice(2),Ct="__reactFiber$"+ui,Dt="__reactProps$"+ui,Ea="__reactContainer$"+ui,fl="__reactEvents$"+ui,rS="__reactListeners$"+ui,oS="__reactHandles$"+ui,yh="__reactResources$"+ui,Os="__reactMarker$"+ui;function hl(t){delete t[Ct],delete t[Dt],delete t[fl],delete t[rS],delete t[oS]}function Ki(t){var n=t[Ct];if(n)return n;for(var r=t.parentNode;r;){if(n=r[Ea]||r[Ct]){if(r=n.alternate,n.child!==null||r!==null&&r.child!==null)for(t=Eg(t);t!==null;){if(r=t[Ct])return r;t=Eg(t)}return n}t=r,r=t.parentNode}return null}function Ra(t){if(t=t[Ct]||t[Ea]){var n=t.tag;if(n===5||n===6||n===13||n===26||n===27||n===3)return t}return null}function Ds(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t.stateNode;throw Error(s(33))}function _a(t){var n=t[yh];return n||(n=t[yh]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function ft(t){t[Os]=!0}var bh=new Set,Sh={};function Yi(t,n){wa(t,n),wa(t+"Capture",n)}function wa(t,n){for(Sh[t]=n,t=0;t<n.length;t++)bh.add(n[t])}var In=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Th={},kh={};function lS(t){return cl.call(kh,t)?!0:cl.call(Th,t)?!1:cS.test(t)?kh[t]=!0:(Th[t]=!0,!1)}function eo(t,n,r){if(lS(n))if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":t.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(n);return}}t.setAttribute(n,""+r)}}function to(t,n,r){if(r===null)t.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttribute(n,""+r)}}function Bn(t,n,r,c){if(c===null)t.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttributeNS(n,r,""+c)}}function Xt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ch(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function uS(t){var n=Ch(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,n),c=""+t[n];if(!t.hasOwnProperty(n)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var f=r.get,p=r.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return f.call(this)},set:function(y){c=""+y,p.call(this,y)}}),Object.defineProperty(t,n,{enumerable:r.enumerable}),{getValue:function(){return c},setValue:function(y){c=""+y},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function no(t){t._valueTracker||(t._valueTracker=uS(t))}function Eh(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var r=n.getValue(),c="";return t&&(c=Ch(t)?t.checked?"true":"false":t.value),t=c,t!==r?(n.setValue(t),!0):!1}function io(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var dS=/[\n"\\]/g;function Jt(t){return t.replace(dS,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function ml(t,n,r,c,f,p,y,S){t.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?t.type=y:t.removeAttribute("type"),n!=null?y==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+Xt(n)):t.value!==""+Xt(n)&&(t.value=""+Xt(n)):y!=="submit"&&y!=="reset"||t.removeAttribute("value"),n!=null?pl(t,y,Xt(n)):r!=null?pl(t,y,Xt(r)):c!=null&&t.removeAttribute("value"),f==null&&p!=null&&(t.defaultChecked=!!p),f!=null&&(t.checked=f&&typeof f!="function"&&typeof f!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+Xt(S):t.removeAttribute("name")}function Rh(t,n,r,c,f,p,y,S){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),n!=null||r!=null){if(!(p!=="submit"&&p!=="reset"||n!=null))return;r=r!=null?""+Xt(r):"",n=n!=null?""+Xt(n):r,S||n===t.value||(t.value=n),t.defaultValue=n}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=S?t.checked:!!c,t.defaultChecked=!!c,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(t.name=y)}function pl(t,n,r){n==="number"&&io(t.ownerDocument)===t||t.defaultValue===""+r||(t.defaultValue=""+r)}function xa(t,n,r,c){if(t=t.options,n){n={};for(var f=0;f<r.length;f++)n["$"+r[f]]=!0;for(r=0;r<t.length;r++)f=n.hasOwnProperty("$"+t[r].value),t[r].selected!==f&&(t[r].selected=f),f&&c&&(t[r].defaultSelected=!0)}else{for(r=""+Xt(r),n=null,f=0;f<t.length;f++){if(t[f].value===r){t[f].selected=!0,c&&(t[f].defaultSelected=!0);return}n!==null||t[f].disabled||(n=t[f])}n!==null&&(n.selected=!0)}}function _h(t,n,r){if(n!=null&&(n=""+Xt(n),n!==t.value&&(t.value=n),r==null)){t.defaultValue!==n&&(t.defaultValue=n);return}t.defaultValue=r!=null?""+Xt(r):""}function wh(t,n,r,c){if(n==null){if(c!=null){if(r!=null)throw Error(s(92));if(de(c)){if(1<c.length)throw Error(s(93));c=c[0]}r=c}r==null&&(r=""),n=r}r=Xt(n),t.defaultValue=r,c=t.textContent,c===r&&c!==""&&c!==null&&(t.value=c)}function Oa(t,n){if(n){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=n;return}}t.textContent=n}var fS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xh(t,n,r){var c=n.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?c?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="":c?t.setProperty(n,r):typeof r!="number"||r===0||fS.has(n)?n==="float"?t.cssFloat=r:t[n]=(""+r).trim():t[n]=r+"px"}function Oh(t,n,r){if(n!=null&&typeof n!="object")throw Error(s(62));if(t=t.style,r!=null){for(var c in r)!r.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var f in n)c=n[f],n.hasOwnProperty(f)&&r[f]!==c&&xh(t,f,c)}else for(var p in n)n.hasOwnProperty(p)&&xh(t,p,n[p])}function gl(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ao(t){return mS.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var vl=null;function yl(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Da=null,Aa=null;function Dh(t){var n=Ra(t);if(n&&(t=n.stateNode)){var r=t[Dt]||null;e:switch(t=n.stateNode,n.type){case"input":if(ml(t,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),n=r.name,r.type==="radio"&&n!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+Jt(""+n)+'"][type="radio"]'),n=0;n<r.length;n++){var c=r[n];if(c!==t&&c.form===t.form){var f=c[Dt]||null;if(!f)throw Error(s(90));ml(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(n=0;n<r.length;n++)c=r[n],c.form===t.form&&Eh(c)}break e;case"textarea":_h(t,r.value,r.defaultValue);break e;case"select":n=r.value,n!=null&&xa(t,!!r.multiple,n,!1)}}}var bl=!1;function Ah(t,n,r){if(bl)return t(n,r);bl=!0;try{var c=t(n);return c}finally{if(bl=!1,(Da!==null||Aa!==null)&&(Vo(),Da&&(n=Da,t=Aa,Aa=Da=null,Dh(n),t)))for(n=0;n<t.length;n++)Dh(t[n])}}function As(t,n){var r=t.stateNode;if(r===null)return null;var c=r[Dt]||null;if(c===null)return null;r=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(s(231,n,typeof r));return r}var Sl=!1;if(In)try{var Ns={};Object.defineProperty(Ns,"passive",{get:function(){Sl=!0}}),window.addEventListener("test",Ns,Ns),window.removeEventListener("test",Ns,Ns)}catch{Sl=!1}var di=null,Tl=null,so=null;function Nh(){if(so)return so;var t,n=Tl,r=n.length,c,f="value"in di?di.value:di.textContent,p=f.length;for(t=0;t<r&&n[t]===f[t];t++);var y=r-t;for(c=1;c<=y&&n[r-c]===f[p-c];c++);return so=f.slice(t,1<c?1-c:void 0)}function ro(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function oo(){return!0}function Ph(){return!1}function At(t){function n(r,c,f,p,y){this._reactName=r,this._targetInst=f,this.type=c,this.nativeEvent=p,this.target=y,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(r=t[S],this[S]=r?r(p):p[S]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?oo:Ph,this.isPropagationStopped=Ph,this}return ee(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=oo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=oo)},persist:function(){},isPersistent:oo}),n}var Qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=At(Qi),Ps=ee({},Qi,{view:0,detail:0}),pS=At(Ps),kl,Cl,Ms,lo=ee({},Ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ms&&(Ms&&t.type==="mousemove"?(kl=t.screenX-Ms.screenX,Cl=t.screenY-Ms.screenY):Cl=kl=0,Ms=t),kl)},movementY:function(t){return"movementY"in t?t.movementY:Cl}}),Mh=At(lo),gS=ee({},lo,{dataTransfer:0}),vS=At(gS),yS=ee({},Ps,{relatedTarget:0}),El=At(yS),bS=ee({},Qi,{animationName:0,elapsedTime:0,pseudoElement:0}),SS=At(bS),TS=ee({},Qi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kS=At(TS),CS=ee({},Qi,{data:0}),Uh=At(CS),ES={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_S={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wS(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=_S[t])?!!n[t]:!1}function Rl(){return wS}var xS=ee({},Ps,{key:function(t){if(t.key){var n=ES[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=ro(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?RS[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rl,charCode:function(t){return t.type==="keypress"?ro(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ro(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OS=At(xS),DS=ee({},lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lh=At(DS),AS=ee({},Ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rl}),NS=At(AS),PS=ee({},Qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),MS=At(PS),US=ee({},lo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LS=At(US),jS=ee({},Qi,{newState:0,oldState:0}),IS=At(jS),BS=[9,13,27,32],_l=In&&"CompositionEvent"in window,Us=null;In&&"documentMode"in document&&(Us=document.documentMode);var zS=In&&"TextEvent"in window&&!Us,jh=In&&(!_l||Us&&8<Us&&11>=Us),Ih=" ",Bh=!1;function zh(t,n){switch(t){case"keyup":return BS.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Na=!1;function qS(t,n){switch(t){case"compositionend":return qh(n);case"keypress":return n.which!==32?null:(Bh=!0,Ih);case"textInput":return t=n.data,t===Ih&&Bh?null:t;default:return null}}function VS(t,n){if(Na)return t==="compositionend"||!_l&&zh(t,n)?(t=Nh(),so=Tl=di=null,Na=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return jh&&n.locale!=="ko"?null:n.data;default:return null}}var HS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vh(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!HS[t.type]:n==="textarea"}function Hh(t,n,r,c){Da?Aa?Aa.push(c):Aa=[c]:Da=c,n=Yo(n,"onChange"),0<n.length&&(r=new co("onChange","change",null,r,c),t.push({event:r,listeners:n}))}var Ls=null,js=null;function FS(t){pg(t,0)}function uo(t){var n=Ds(t);if(Eh(n))return t}function Fh(t,n){if(t==="change")return n}var Gh=!1;if(In){var wl;if(In){var xl="oninput"in document;if(!xl){var Kh=document.createElement("div");Kh.setAttribute("oninput","return;"),xl=typeof Kh.oninput=="function"}wl=xl}else wl=!1;Gh=wl&&(!document.documentMode||9<document.documentMode)}function Yh(){Ls&&(Ls.detachEvent("onpropertychange",Qh),js=Ls=null)}function Qh(t){if(t.propertyName==="value"&&uo(js)){var n=[];Hh(n,js,t,yl(t)),Ah(FS,n)}}function GS(t,n,r){t==="focusin"?(Yh(),Ls=n,js=r,Ls.attachEvent("onpropertychange",Qh)):t==="focusout"&&Yh()}function KS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uo(js)}function YS(t,n){if(t==="click")return uo(n)}function QS(t,n){if(t==="input"||t==="change")return uo(n)}function XS(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var zt=typeof Object.is=="function"?Object.is:XS;function Is(t,n){if(zt(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var r=Object.keys(t),c=Object.keys(n);if(r.length!==c.length)return!1;for(c=0;c<r.length;c++){var f=r[c];if(!cl.call(n,f)||!zt(t[f],n[f]))return!1}return!0}function Xh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jh(t,n){var r=Xh(t);t=0;for(var c;r;){if(r.nodeType===3){if(c=t+r.textContent.length,t<=n&&c>=n)return{node:r,offset:n-t};t=c}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xh(r)}}function Zh(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?Zh(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function Wh(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var n=io(t.document);n instanceof t.HTMLIFrameElement;){try{var r=typeof n.contentWindow.location.href=="string"}catch{r=!1}if(r)t=n.contentWindow;else break;n=io(t.document)}return n}function Ol(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}function JS(t,n){var r=Wh(n);n=t.focusedElem;var c=t.selectionRange;if(r!==n&&n&&n.ownerDocument&&Zh(n.ownerDocument.documentElement,n)){if(c!==null&&Ol(n)){if(t=c.start,r=c.end,r===void 0&&(r=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(r,n.value.length);else if(r=(t=n.ownerDocument||document)&&t.defaultView||window,r.getSelection){r=r.getSelection();var f=n.textContent.length,p=Math.min(c.start,f);c=c.end===void 0?p:Math.min(c.end,f),!r.extend&&p>c&&(f=c,c=p,p=f),f=Jh(n,p);var y=Jh(n,c);f&&y&&(r.rangeCount!==1||r.anchorNode!==f.node||r.anchorOffset!==f.offset||r.focusNode!==y.node||r.focusOffset!==y.offset)&&(t=t.createRange(),t.setStart(f.node,f.offset),r.removeAllRanges(),p>c?(r.addRange(t),r.extend(y.node,y.offset)):(t.setEnd(y.node,y.offset),r.addRange(t)))}}for(t=[],r=n;r=r.parentNode;)r.nodeType===1&&t.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)r=t[n],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var ZS=In&&"documentMode"in document&&11>=document.documentMode,Pa=null,Dl=null,Bs=null,Al=!1;function $h(t,n,r){var c=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Al||Pa==null||Pa!==io(c)||(c=Pa,"selectionStart"in c&&Ol(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Bs&&Is(Bs,c)||(Bs=c,c=Yo(Dl,"onSelect"),0<c.length&&(n=new co("onSelect","select",null,n,r),t.push({event:n,listeners:c}),n.target=Pa)))}function Xi(t,n){var r={};return r[t.toLowerCase()]=n.toLowerCase(),r["Webkit"+t]="webkit"+n,r["Moz"+t]="moz"+n,r}var Ma={animationend:Xi("Animation","AnimationEnd"),animationiteration:Xi("Animation","AnimationIteration"),animationstart:Xi("Animation","AnimationStart"),transitionrun:Xi("Transition","TransitionRun"),transitionstart:Xi("Transition","TransitionStart"),transitioncancel:Xi("Transition","TransitionCancel"),transitionend:Xi("Transition","TransitionEnd")},Nl={},em={};In&&(em=document.createElement("div").style,"AnimationEvent"in window||(delete Ma.animationend.animation,delete Ma.animationiteration.animation,delete Ma.animationstart.animation),"TransitionEvent"in window||delete Ma.transitionend.transition);function Ji(t){if(Nl[t])return Nl[t];if(!Ma[t])return t;var n=Ma[t],r;for(r in n)if(n.hasOwnProperty(r)&&r in em)return Nl[t]=n[r];return t}var tm=Ji("animationend"),nm=Ji("animationiteration"),im=Ji("animationstart"),WS=Ji("transitionrun"),$S=Ji("transitionstart"),eT=Ji("transitioncancel"),am=Ji("transitionend"),sm=new Map,rm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function ln(t,n){sm.set(t,n),Yi(n,[t])}var Zt=[],Ua=0,Pl=0;function fo(){for(var t=Ua,n=Pl=Ua=0;n<t;){var r=Zt[n];Zt[n++]=null;var c=Zt[n];Zt[n++]=null;var f=Zt[n];Zt[n++]=null;var p=Zt[n];if(Zt[n++]=null,c!==null&&f!==null){var y=c.pending;y===null?f.next=f:(f.next=y.next,y.next=f),c.pending=f}p!==0&&om(r,f,p)}}function ho(t,n,r,c){Zt[Ua++]=t,Zt[Ua++]=n,Zt[Ua++]=r,Zt[Ua++]=c,Pl|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Ml(t,n,r,c){return ho(t,n,r,c),mo(t)}function fi(t,n){return ho(t,null,null,n),mo(t)}function om(t,n,r){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r);for(var f=!1,p=t.return;p!==null;)p.childLanes|=r,c=p.alternate,c!==null&&(c.childLanes|=r),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(f=!0)),t=p,p=p.return;f&&n!==null&&t.tag===3&&(p=t.stateNode,f=31-Bt(r),p=p.hiddenUpdates,t=p[f],t===null?p[f]=[n]:t.push(n),n.lane=r|536870912)}function mo(t){if(50<ur)throw ur=0,zu=null,Error(s(185));for(var n=t.return;n!==null;)t=n,n=t.return;return t.tag===3?t.stateNode:null}var La={},cm=new WeakMap;function Wt(t,n){if(typeof t=="object"&&t!==null){var r=cm.get(t);return r!==void 0?r:(n={value:t,source:n,stack:ge(n)},cm.set(t,n),n)}return{value:t,source:n,stack:ge(n)}}var ja=[],Ia=0,po=null,go=0,$t=[],en=0,Zi=null,zn=1,qn="";function Wi(t,n){ja[Ia++]=go,ja[Ia++]=po,po=t,go=n}function lm(t,n,r){$t[en++]=zn,$t[en++]=qn,$t[en++]=Zi,Zi=t;var c=zn;t=qn;var f=32-Bt(c)-1;c&=~(1<<f),r+=1;var p=32-Bt(n)+f;if(30<p){var y=f-f%5;p=(c&(1<<y)-1).toString(32),c>>=y,f-=y,zn=1<<32-Bt(n)+f|r<<f|c,qn=p+t}else zn=1<<p|r<<f|c,qn=t}function Ul(t){t.return!==null&&(Wi(t,1),lm(t,1,0))}function Ll(t){for(;t===po;)po=ja[--Ia],ja[Ia]=null,go=ja[--Ia],ja[Ia]=null;for(;t===Zi;)Zi=$t[--en],$t[en]=null,qn=$t[--en],$t[en]=null,zn=$t[--en],$t[en]=null}var xt=null,yt=null,De=!1,un=null,Cn=!1,jl=Error(s(519));function $i(t){var n=Error(s(418,""));throw Vs(Wt(n,t)),jl}function um(t){var n=t.stateNode,r=t.type,c=t.memoizedProps;switch(n[Ct]=t,n[Dt]=c,r){case"dialog":Ce("cancel",n),Ce("close",n);break;case"iframe":case"object":case"embed":Ce("load",n);break;case"video":case"audio":for(r=0;r<fr.length;r++)Ce(fr[r],n);break;case"source":Ce("error",n);break;case"img":case"image":case"link":Ce("error",n),Ce("load",n);break;case"details":Ce("toggle",n);break;case"input":Ce("invalid",n),Rh(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),no(n);break;case"select":Ce("invalid",n);break;case"textarea":Ce("invalid",n),wh(n,c.value,c.defaultValue,c.children),no(n)}r=c.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||n.textContent===""+r||c.suppressHydrationWarning===!0||bg(n.textContent,r)?(c.popover!=null&&(Ce("beforetoggle",n),Ce("toggle",n)),c.onScroll!=null&&Ce("scroll",n),c.onScrollEnd!=null&&Ce("scrollend",n),c.onClick!=null&&(n.onclick=Qo),n=!0):n=!1,n||$i(t)}function dm(t){for(xt=t.return;xt;)switch(xt.tag){case 3:case 27:Cn=!0;return;case 5:case 13:Cn=!1;return;default:xt=xt.return}}function zs(t){if(t!==xt)return!1;if(!De)return dm(t),De=!0,!1;var n=!1,r;if((r=t.tag!==3&&t.tag!==27)&&((r=t.tag===5)&&(r=t.type,r=!(r!=="form"&&r!=="button")||id(t.type,t.memoizedProps)),r=!r),r&&(n=!0),n&&yt&&$i(t),dm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));e:{for(t=t.nextSibling,n=0;t;){if(t.nodeType===8)if(r=t.data,r==="/$"){if(n===0){yt=fn(t.nextSibling);break e}n--}else r!=="$"&&r!=="$!"&&r!=="$?"||n++;t=t.nextSibling}yt=null}}else yt=xt?fn(t.stateNode.nextSibling):null;return!0}function qs(){yt=xt=null,De=!1}function Vs(t){un===null?un=[t]:un.push(t)}var Hs=Error(s(460)),fm=Error(s(474)),Il={then:function(){}};function hm(t){return t=t.status,t==="fulfilled"||t==="rejected"}function vo(){}function mm(t,n,r){switch(r=t[r],r===void 0?t.push(n):r!==n&&(n.then(vo,vo),n=r),n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,t===Hs?Error(s(483)):t;default:if(typeof n.status=="string")n.then(vo,vo);else{if(t=qe,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=n,t.status="pending",t.then(function(c){if(n.status==="pending"){var f=n;f.status="fulfilled",f.value=c}},function(c){if(n.status==="pending"){var f=n;f.status="rejected",f.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,t===Hs?Error(s(483)):t}throw Fs=n,Hs}}var Fs=null;function pm(){if(Fs===null)throw Error(s(459));var t=Fs;return Fs=null,t}var Ba=null,Gs=0;function yo(t){var n=Gs;return Gs+=1,Ba===null&&(Ba=[]),mm(Ba,t,n)}function Ks(t,n){n=n.props.ref,t.ref=n!==void 0?n:null}function bo(t,n){throw n.$$typeof===l?Error(s(525)):(t=Object.prototype.toString.call(n),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)))}function gm(t){var n=t._init;return n(t._payload)}function vm(t){function n(M,A){if(t){var L=M.deletions;L===null?(M.deletions=[A],M.flags|=16):L.push(A)}}function r(M,A){if(!t)return null;for(;A!==null;)n(M,A),A=A.sibling;return null}function c(M){for(var A=new Map;M!==null;)M.key!==null?A.set(M.key,M):A.set(M.index,M),M=M.sibling;return A}function f(M,A){return M=Ei(M,A),M.index=0,M.sibling=null,M}function p(M,A,L){return M.index=L,t?(L=M.alternate,L!==null?(L=L.index,L<A?(M.flags|=33554434,A):L):(M.flags|=33554434,A)):(M.flags|=1048576,A)}function y(M){return t&&M.alternate===null&&(M.flags|=33554434),M}function S(M,A,L,G){return A===null||A.tag!==6?(A=Nu(L,M.mode,G),A.return=M,A):(A=f(A,L),A.return=M,A)}function R(M,A,L,G){var re=L.type;return re===m?H(M,A,L.props.children,G,L.key):A!==null&&(A.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===I&&gm(re)===A.type)?(A=f(A,L.props),Ks(A,L),A.return=M,A):(A=jo(L.type,L.key,L.props,null,M.mode,G),Ks(A,L),A.return=M,A)}function P(M,A,L,G){return A===null||A.tag!==4||A.stateNode.containerInfo!==L.containerInfo||A.stateNode.implementation!==L.implementation?(A=Pu(L,M.mode,G),A.return=M,A):(A=f(A,L.children||[]),A.return=M,A)}function H(M,A,L,G,re){return A===null||A.tag!==7?(A=la(L,M.mode,G,re),A.return=M,A):(A=f(A,L),A.return=M,A)}function X(M,A,L){if(typeof A=="string"&&A!==""||typeof A=="number"||typeof A=="bigint")return A=Nu(""+A,M.mode,L),A.return=M,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case u:return L=jo(A.type,A.key,A.props,null,M.mode,L),Ks(L,A),L.return=M,L;case d:return A=Pu(A,M.mode,L),A.return=M,A;case I:var G=A._init;return A=G(A._payload),X(M,A,L)}if(de(A)||F(A))return A=la(A,M.mode,L,null),A.return=M,A;if(typeof A.then=="function")return X(M,yo(A),L);if(A.$$typeof===k)return X(M,Mo(M,A),L);bo(M,A)}return null}function j(M,A,L,G){var re=A!==null?A.key:null;if(typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint")return re!==null?null:S(M,A,""+L,G);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case u:return L.key===re?R(M,A,L,G):null;case d:return L.key===re?P(M,A,L,G):null;case I:return re=L._init,L=re(L._payload),j(M,A,L,G)}if(de(L)||F(L))return re!==null?null:H(M,A,L,G,null);if(typeof L.then=="function")return j(M,A,yo(L),G);if(L.$$typeof===k)return j(M,A,Mo(M,L),G);bo(M,L)}return null}function V(M,A,L,G,re){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return M=M.get(L)||null,S(A,M,""+G,re);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case u:return M=M.get(G.key===null?L:G.key)||null,R(A,M,G,re);case d:return M=M.get(G.key===null?L:G.key)||null,P(A,M,G,re);case I:var Te=G._init;return G=Te(G._payload),V(M,A,L,G,re)}if(de(G)||F(G))return M=M.get(L)||null,H(A,M,G,re,null);if(typeof G.then=="function")return V(M,A,L,yo(G),re);if(G.$$typeof===k)return V(M,A,L,Mo(A,G),re);bo(A,G)}return null}function oe(M,A,L,G){for(var re=null,Te=null,ce=A,fe=A=0,pt=null;ce!==null&&fe<L.length;fe++){ce.index>fe?(pt=ce,ce=null):pt=ce.sibling;var Ae=j(M,ce,L[fe],G);if(Ae===null){ce===null&&(ce=pt);break}t&&ce&&Ae.alternate===null&&n(M,ce),A=p(Ae,A,fe),Te===null?re=Ae:Te.sibling=Ae,Te=Ae,ce=pt}if(fe===L.length)return r(M,ce),De&&Wi(M,fe),re;if(ce===null){for(;fe<L.length;fe++)ce=X(M,L[fe],G),ce!==null&&(A=p(ce,A,fe),Te===null?re=ce:Te.sibling=ce,Te=ce);return De&&Wi(M,fe),re}for(ce=c(ce);fe<L.length;fe++)pt=V(ce,M,fe,L[fe],G),pt!==null&&(t&&pt.alternate!==null&&ce.delete(pt.key===null?fe:pt.key),A=p(pt,A,fe),Te===null?re=pt:Te.sibling=pt,Te=pt);return t&&ce.forEach(function(Ai){return n(M,Ai)}),De&&Wi(M,fe),re}function pe(M,A,L,G){if(L==null)throw Error(s(151));for(var re=null,Te=null,ce=A,fe=A=0,pt=null,Ae=L.next();ce!==null&&!Ae.done;fe++,Ae=L.next()){ce.index>fe?(pt=ce,ce=null):pt=ce.sibling;var Ai=j(M,ce,Ae.value,G);if(Ai===null){ce===null&&(ce=pt);break}t&&ce&&Ai.alternate===null&&n(M,ce),A=p(Ai,A,fe),Te===null?re=Ai:Te.sibling=Ai,Te=Ai,ce=pt}if(Ae.done)return r(M,ce),De&&Wi(M,fe),re;if(ce===null){for(;!Ae.done;fe++,Ae=L.next())Ae=X(M,Ae.value,G),Ae!==null&&(A=p(Ae,A,fe),Te===null?re=Ae:Te.sibling=Ae,Te=Ae);return De&&Wi(M,fe),re}for(ce=c(ce);!Ae.done;fe++,Ae=L.next())Ae=V(ce,M,fe,Ae.value,G),Ae!==null&&(t&&Ae.alternate!==null&&ce.delete(Ae.key===null?fe:Ae.key),A=p(Ae,A,fe),Te===null?re=Ae:Te.sibling=Ae,Te=Ae);return t&&ce.forEach(function(mk){return n(M,mk)}),De&&Wi(M,fe),re}function Ze(M,A,L,G){if(typeof L=="object"&&L!==null&&L.type===m&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case u:e:{for(var re=L.key;A!==null;){if(A.key===re){if(re=L.type,re===m){if(A.tag===7){r(M,A.sibling),G=f(A,L.props.children),G.return=M,M=G;break e}}else if(A.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===I&&gm(re)===A.type){r(M,A.sibling),G=f(A,L.props),Ks(G,L),G.return=M,M=G;break e}r(M,A);break}else n(M,A);A=A.sibling}L.type===m?(G=la(L.props.children,M.mode,G,L.key),G.return=M,M=G):(G=jo(L.type,L.key,L.props,null,M.mode,G),Ks(G,L),G.return=M,M=G)}return y(M);case d:e:{for(re=L.key;A!==null;){if(A.key===re)if(A.tag===4&&A.stateNode.containerInfo===L.containerInfo&&A.stateNode.implementation===L.implementation){r(M,A.sibling),G=f(A,L.children||[]),G.return=M,M=G;break e}else{r(M,A);break}else n(M,A);A=A.sibling}G=Pu(L,M.mode,G),G.return=M,M=G}return y(M);case I:return re=L._init,L=re(L._payload),Ze(M,A,L,G)}if(de(L))return oe(M,A,L,G);if(F(L)){if(re=F(L),typeof re!="function")throw Error(s(150));return L=re.call(L),pe(M,A,L,G)}if(typeof L.then=="function")return Ze(M,A,yo(L),G);if(L.$$typeof===k)return Ze(M,A,Mo(M,L),G);bo(M,L)}return typeof L=="string"&&L!==""||typeof L=="number"||typeof L=="bigint"?(L=""+L,A!==null&&A.tag===6?(r(M,A.sibling),G=f(A,L),G.return=M,M=G):(r(M,A),G=Nu(L,M.mode,G),G.return=M,M=G),y(M)):r(M,A)}return function(M,A,L,G){try{Gs=0;var re=Ze(M,A,L,G);return Ba=null,re}catch(ce){if(ce===Hs)throw ce;var Te=sn(29,ce,null,M.mode);return Te.lanes=G,Te.return=M,Te}finally{}}}var ea=vm(!0),ym=vm(!1),za=Pe(null),So=Pe(0);function bm(t,n){t=Wn,He(So,t),He(za,n),Wn=t|n.baseLanes}function Bl(){He(So,Wn),He(za,za.current)}function zl(){Wn=So.current,at(za),at(So)}var tn=Pe(null),En=null;function hi(t){var n=t.alternate;He(lt,lt.current&1),He(tn,t),En===null&&(n===null||za.current!==null||n.memoizedState!==null)&&(En=t)}function Sm(t){if(t.tag===22){if(He(lt,lt.current),He(tn,t),En===null){var n=t.alternate;n!==null&&n.memoizedState!==null&&(En=t)}}else mi()}function mi(){He(lt,lt.current),He(tn,tn.current)}function Vn(t){at(tn),En===t&&(En=null),at(lt)}var lt=Pe(0);function To(t){for(var n=t;n!==null;){if(n.tag===13){var r=n.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var tT=typeof AbortController<"u"?AbortController:function(){var t=[],n=this.signal={aborted:!1,addEventListener:function(r,c){t.push(c)}};this.abort=function(){n.aborted=!0,t.forEach(function(r){return r()})}},nT=a.unstable_scheduleCallback,iT=a.unstable_NormalPriority,ut={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ql(){return{controller:new tT,data:new Map,refCount:0}}function Ys(t){t.refCount--,t.refCount===0&&nT(iT,function(){t.controller.abort()})}var Qs=null,Vl=0,qa=0,Va=null;function aT(t,n){if(Qs===null){var r=Qs=[];Vl=0,qa=Qu(),Va={status:"pending",value:void 0,then:function(c){r.push(c)}}}return Vl++,n.then(Tm,Tm),n}function Tm(){if(--Vl===0&&Qs!==null){Va!==null&&(Va.status="fulfilled");var t=Qs;Qs=null,qa=0,Va=null;for(var n=0;n<t.length;n++)(0,t[n])()}}function sT(t,n){var r=[],c={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return t.then(function(){c.status="fulfilled",c.value=n;for(var f=0;f<r.length;f++)(0,r[f])(n)},function(f){for(c.status="rejected",c.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),c}var km=Q.S;Q.S=function(t,n){typeof n=="object"&&n!==null&&typeof n.then=="function"&&aT(t,n),km!==null&&km(t,n)};var ta=Pe(null);function Hl(){var t=ta.current;return t!==null?t:qe.pooledCache}function ko(t,n){n===null?He(ta,ta.current):He(ta,n.pool)}function Cm(){var t=Hl();return t===null?null:{parent:ut._currentValue,pool:t}}var pi=0,Se=null,Ue=null,st=null,Co=!1,Ha=!1,na=!1,Eo=0,Xs=0,Fa=null,rT=0;function nt(){throw Error(s(321))}function Fl(t,n){if(n===null)return!1;for(var r=0;r<n.length&&r<t.length;r++)if(!zt(t[r],n[r]))return!1;return!0}function Gl(t,n,r,c,f,p){return pi=p,Se=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Q.H=t===null||t.memoizedState===null?ia:gi,na=!1,p=r(c,f),na=!1,Ha&&(p=Rm(n,r,c,f)),Em(t),p}function Em(t){Q.H=Rn;var n=Ue!==null&&Ue.next!==null;if(pi=0,st=Ue=Se=null,Co=!1,Xs=0,Fa=null,n)throw Error(s(300));t===null||ht||(t=t.dependencies,t!==null&&Po(t)&&(ht=!0))}function Rm(t,n,r,c){Se=t;var f=0;do{if(Ha&&(Fa=null),Xs=0,Ha=!1,25<=f)throw Error(s(301));if(f+=1,st=Ue=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}Q.H=aa,p=n(r,c)}while(Ha);return p}function oT(){var t=Q.H,n=t.useState()[0];return n=typeof n.then=="function"?Js(n):n,t=t.useState()[0],(Ue!==null?Ue.memoizedState:null)!==t&&(Se.flags|=1024),n}function Kl(){var t=Eo!==0;return Eo=0,t}function Yl(t,n,r){n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~r}function Ql(t){if(Co){for(t=t.memoizedState;t!==null;){var n=t.queue;n!==null&&(n.pending=null),t=t.next}Co=!1}pi=0,st=Ue=Se=null,Ha=!1,Xs=Eo=0,Fa=null}function Nt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Se.memoizedState=st=t:st=st.next=t,st}function rt(){if(Ue===null){var t=Se.alternate;t=t!==null?t.memoizedState:null}else t=Ue.next;var n=st===null?Se.memoizedState:st.next;if(n!==null)st=n,Ue=t;else{if(t===null)throw Se.alternate===null?Error(s(467)):Error(s(310));Ue=t,t={memoizedState:Ue.memoizedState,baseState:Ue.baseState,baseQueue:Ue.baseQueue,queue:Ue.queue,next:null},st===null?Se.memoizedState=st=t:st=st.next=t}return st}var Ro;Ro=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Js(t){var n=Xs;return Xs+=1,Fa===null&&(Fa=[]),t=mm(Fa,t,n),n=Se,(st===null?n.memoizedState:st.next)===null&&(n=n.alternate,Q.H=n===null||n.memoizedState===null?ia:gi),t}function _o(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Js(t);if(t.$$typeof===k)return Et(t)}throw Error(s(438,String(t)))}function Xl(t){var n=null,r=Se.updateQueue;if(r!==null&&(n=r.memoCache),n==null){var c=Se.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(f){return f.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),r===null&&(r=Ro(),Se.updateQueue=r),r.memoCache=n,r=n.data[n.index],r===void 0)for(r=n.data[n.index]=Array(t),c=0;c<t;c++)r[c]=N;return n.index++,r}function Hn(t,n){return typeof n=="function"?n(t):n}function wo(t){var n=rt();return Jl(n,Ue,t)}function Jl(t,n,r){var c=t.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=r;var f=t.baseQueue,p=c.pending;if(p!==null){if(f!==null){var y=f.next;f.next=p.next,p.next=y}n.baseQueue=f=p,c.pending=null}if(p=t.baseState,f===null)t.memoizedState=p;else{n=f.next;var S=y=null,R=null,P=n,H=!1;do{var X=P.lane&-536870913;if(X!==P.lane?(we&X)===X:(pi&X)===X){var j=P.revertLane;if(j===0)R!==null&&(R=R.next={lane:0,revertLane:0,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),X===qa&&(H=!0);else if((pi&j)===j){P=P.next,j===qa&&(H=!0);continue}else X={lane:0,revertLane:P.revertLane,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},R===null?(S=R=X,y=p):R=R.next=X,Se.lanes|=j,Ri|=j;X=P.action,na&&r(p,X),p=P.hasEagerState?P.eagerState:r(p,X)}else j={lane:X,revertLane:P.revertLane,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},R===null?(S=R=j,y=p):R=R.next=j,Se.lanes|=X,Ri|=X;P=P.next}while(P!==null&&P!==n);if(R===null?y=p:R.next=S,!zt(p,t.memoizedState)&&(ht=!0,H&&(r=Va,r!==null)))throw r;t.memoizedState=p,t.baseState=y,t.baseQueue=R,c.lastRenderedState=p}return f===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Zl(t){var n=rt(),r=n.queue;if(r===null)throw Error(s(311));r.lastRenderedReducer=t;var c=r.dispatch,f=r.pending,p=n.memoizedState;if(f!==null){r.pending=null;var y=f=f.next;do p=t(p,y.action),y=y.next;while(y!==f);zt(p,n.memoizedState)||(ht=!0),n.memoizedState=p,n.baseQueue===null&&(n.baseState=p),r.lastRenderedState=p}return[p,c]}function _m(t,n,r){var c=Se,f=rt(),p=De;if(p){if(r===void 0)throw Error(s(407));r=r()}else r=n();var y=!zt((Ue||f).memoizedState,r);if(y&&(f.memoizedState=r,ht=!0),f=f.queue,eu(Om.bind(null,c,f,t),[t]),f.getSnapshot!==n||y||st!==null&&st.memoizedState.tag&1){if(c.flags|=2048,Ga(9,xm.bind(null,c,f,r,n),{destroy:void 0},null),qe===null)throw Error(s(349));p||(pi&60)!==0||wm(c,n,r)}return r}function wm(t,n,r){t.flags|=16384,t={getSnapshot:n,value:r},n=Se.updateQueue,n===null?(n=Ro(),Se.updateQueue=n,n.stores=[t]):(r=n.stores,r===null?n.stores=[t]:r.push(t))}function xm(t,n,r,c){n.value=r,n.getSnapshot=c,Dm(n)&&Am(t)}function Om(t,n,r){return r(function(){Dm(n)&&Am(t)})}function Dm(t){var n=t.getSnapshot;t=t.value;try{var r=n();return!zt(t,r)}catch{return!0}}function Am(t){var n=fi(t,2);n!==null&&Ot(n,t,2)}function Wl(t){var n=Nt();if(typeof t=="function"){var r=t;if(t=r(),na){li(!0);try{r()}finally{li(!1)}}}return n.memoizedState=n.baseState=t,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:t},n}function Nm(t,n,r,c){return t.baseState=r,Jl(t,Ue,typeof c=="function"?c:Hn)}function cT(t,n,r,c,f){if(Do(t))throw Error(s(485));if(t=n.action,t!==null){var p={payload:f,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){p.listeners.push(y)}};Q.T!==null?r(!0):p.isTransition=!1,c(p),r=n.pending,r===null?(p.next=n.pending=p,Pm(n,p)):(p.next=r.next,n.pending=r.next=p)}}function Pm(t,n){var r=n.action,c=n.payload,f=t.state;if(n.isTransition){var p=Q.T,y={};Q.T=y;try{var S=r(f,c),R=Q.S;R!==null&&R(y,S),Mm(t,n,S)}catch(P){$l(t,n,P)}finally{Q.T=p}}else try{p=r(f,c),Mm(t,n,p)}catch(P){$l(t,n,P)}}function Mm(t,n,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(c){Um(t,n,c)},function(c){return $l(t,n,c)}):Um(t,n,r)}function Um(t,n,r){n.status="fulfilled",n.value=r,Lm(n),t.state=r,n=t.pending,n!==null&&(r=n.next,r===n?t.pending=null:(r=r.next,n.next=r,Pm(t,r)))}function $l(t,n,r){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=r,Lm(n),n=n.next;while(n!==c)}t.action=null}function Lm(t){t=t.listeners;for(var n=0;n<t.length;n++)(0,t[n])()}function jm(t,n){return n}function Im(t,n){if(De){var r=qe.formState;if(r!==null){e:{var c=Se;if(De){if(yt){t:{for(var f=yt,p=Cn;f.nodeType!==8;){if(!p){f=null;break t}if(f=fn(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){yt=fn(f.nextSibling),c=f.data==="F!";break e}}$i(c)}c=!1}c&&(n=r[0])}}return r=Nt(),r.memoizedState=r.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jm,lastRenderedState:n},r.queue=c,r=np.bind(null,Se,c),c.dispatch=r,c=Wl(!1),p=su.bind(null,Se,!1,c.queue),c=Nt(),f={state:n,dispatch:null,action:t,pending:null},c.queue=f,r=cT.bind(null,Se,f,p,r),f.dispatch=r,c.memoizedState=t,[n,r,!1]}function Bm(t){var n=rt();return zm(n,Ue,t)}function zm(t,n,r){n=Jl(t,n,jm)[0],t=wo(Hn)[0],n=typeof n=="object"&&n!==null&&typeof n.then=="function"?Js(n):n;var c=rt(),f=c.queue,p=f.dispatch;return r!==c.memoizedState&&(Se.flags|=2048,Ga(9,lT.bind(null,f,r),{destroy:void 0},null)),[n,p,t]}function lT(t,n){t.action=n}function qm(t){var n=rt(),r=Ue;if(r!==null)return zm(n,r,t);rt(),n=n.memoizedState,r=rt();var c=r.queue.dispatch;return r.memoizedState=t,[n,c,!1]}function Ga(t,n,r,c){return t={tag:t,create:n,inst:r,deps:c,next:null},n=Se.updateQueue,n===null&&(n=Ro(),Se.updateQueue=n),r=n.lastEffect,r===null?n.lastEffect=t.next=t:(c=r.next,r.next=t,t.next=c,n.lastEffect=t),t}function Vm(){return rt().memoizedState}function xo(t,n,r,c){var f=Nt();Se.flags|=t,f.memoizedState=Ga(1|n,r,{destroy:void 0},c===void 0?null:c)}function Oo(t,n,r,c){var f=rt();c=c===void 0?null:c;var p=f.memoizedState.inst;Ue!==null&&c!==null&&Fl(c,Ue.memoizedState.deps)?f.memoizedState=Ga(n,r,p,c):(Se.flags|=t,f.memoizedState=Ga(1|n,r,p,c))}function Hm(t,n){xo(8390656,8,t,n)}function eu(t,n){Oo(2048,8,t,n)}function Fm(t,n){return Oo(4,2,t,n)}function Gm(t,n){return Oo(4,4,t,n)}function Km(t,n){if(typeof n=="function"){t=t();var r=n(t);return function(){typeof r=="function"?r():n(null)}}if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function Ym(t,n,r){r=r!=null?r.concat([t]):null,Oo(4,4,Km.bind(null,n,t),r)}function tu(){}function Qm(t,n){var r=rt();n=n===void 0?null:n;var c=r.memoizedState;return n!==null&&Fl(n,c[1])?c[0]:(r.memoizedState=[t,n],t)}function Xm(t,n){var r=rt();n=n===void 0?null:n;var c=r.memoizedState;if(n!==null&&Fl(n,c[1]))return c[0];if(c=t(),na){li(!0);try{t()}finally{li(!1)}}return r.memoizedState=[c,n],c}function nu(t,n,r){return r===void 0||(pi&1073741824)!==0?t.memoizedState=n:(t.memoizedState=r,t=Zp(),Se.lanes|=t,Ri|=t,r)}function Jm(t,n,r,c){return zt(r,n)?r:za.current!==null?(t=nu(t,r,c),zt(t,n)||(ht=!0),t):(pi&42)===0?(ht=!0,t.memoizedState=r):(t=Zp(),Se.lanes|=t,Ri|=t,n)}function Zm(t,n,r,c,f){var p=se.p;se.p=p!==0&&8>p?p:8;var y=Q.T,S={};Q.T=S,su(t,!1,n,r);try{var R=f(),P=Q.S;if(P!==null&&P(S,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var H=sT(R,c);Zs(t,n,H,Ft(t))}else Zs(t,n,c,Ft(t))}catch(X){Zs(t,n,{then:function(){},status:"rejected",reason:X},Ft())}finally{se.p=p,Q.T=y}}function uT(){}function iu(t,n,r,c){if(t.tag!==5)throw Error(s(476));var f=Wm(t).queue;Zm(t,f,n,_e,r===null?uT:function(){return $m(t),r(c)})}function Wm(t){var n=t.memoizedState;if(n!==null)return n;n={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:_e},next:null};var r={};return n.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hn,lastRenderedState:r},next:null},t.memoizedState=n,t=t.alternate,t!==null&&(t.memoizedState=n),n}function $m(t){var n=Wm(t).next.queue;Zs(t,n,{},Ft())}function au(){return Et(vr)}function ep(){return rt().memoizedState}function tp(){return rt().memoizedState}function dT(t){for(var n=t.return;n!==null;){switch(n.tag){case 24:case 3:var r=Ft();t=bi(r);var c=Si(n,t,r);c!==null&&(Ot(c,n,r),er(c,n,r)),n={cache:ql()},t.payload=n;return}n=n.return}}function fT(t,n,r){var c=Ft();r={lane:c,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Do(t)?ip(n,r):(r=Ml(t,n,r,c),r!==null&&(Ot(r,t,c),ap(r,n,c)))}function np(t,n,r){var c=Ft();Zs(t,n,r,c)}function Zs(t,n,r,c){var f={lane:c,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Do(t))ip(n,f);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=n.lastRenderedReducer,p!==null))try{var y=n.lastRenderedState,S=p(y,r);if(f.hasEagerState=!0,f.eagerState=S,zt(S,y))return ho(t,n,f,0),qe===null&&fo(),!1}catch{}finally{}if(r=Ml(t,n,f,c),r!==null)return Ot(r,t,c),ap(r,n,c),!0}return!1}function su(t,n,r,c){if(c={lane:2,revertLane:Qu(),action:c,hasEagerState:!1,eagerState:null,next:null},Do(t)){if(n)throw Error(s(479))}else n=Ml(t,r,c,2),n!==null&&Ot(n,t,2)}function Do(t){var n=t.alternate;return t===Se||n!==null&&n===Se}function ip(t,n){Ha=Co=!0;var r=t.pending;r===null?n.next=n:(n.next=r.next,r.next=n),t.pending=n}function ap(t,n,r){if((r&4194176)!==0){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,ph(t,r)}}var Rn={readContext:Et,use:_o,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useLayoutEffect:nt,useInsertionEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useSyncExternalStore:nt,useId:nt};Rn.useCacheRefresh=nt,Rn.useMemoCache=nt,Rn.useHostTransitionStatus=nt,Rn.useFormState=nt,Rn.useActionState=nt,Rn.useOptimistic=nt;var ia={readContext:Et,use:_o,useCallback:function(t,n){return Nt().memoizedState=[t,n===void 0?null:n],t},useContext:Et,useEffect:Hm,useImperativeHandle:function(t,n,r){r=r!=null?r.concat([t]):null,xo(4194308,4,Km.bind(null,n,t),r)},useLayoutEffect:function(t,n){return xo(4194308,4,t,n)},useInsertionEffect:function(t,n){xo(4,2,t,n)},useMemo:function(t,n){var r=Nt();n=n===void 0?null:n;var c=t();if(na){li(!0);try{t()}finally{li(!1)}}return r.memoizedState=[c,n],c},useReducer:function(t,n,r){var c=Nt();if(r!==void 0){var f=r(n);if(na){li(!0);try{r(n)}finally{li(!1)}}}else f=n;return c.memoizedState=c.baseState=f,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:f},c.queue=t,t=t.dispatch=fT.bind(null,Se,t),[c.memoizedState,t]},useRef:function(t){var n=Nt();return t={current:t},n.memoizedState=t},useState:function(t){t=Wl(t);var n=t.queue,r=np.bind(null,Se,n);return n.dispatch=r,[t.memoizedState,r]},useDebugValue:tu,useDeferredValue:function(t,n){var r=Nt();return nu(r,t,n)},useTransition:function(){var t=Wl(!1);return t=Zm.bind(null,Se,t.queue,!0,!1),Nt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,n,r){var c=Se,f=Nt();if(De){if(r===void 0)throw Error(s(407));r=r()}else{if(r=n(),qe===null)throw Error(s(349));(we&60)!==0||wm(c,n,r)}f.memoizedState=r;var p={value:r,getSnapshot:n};return f.queue=p,Hm(Om.bind(null,c,p,t),[t]),c.flags|=2048,Ga(9,xm.bind(null,c,p,r,n),{destroy:void 0},null),r},useId:function(){var t=Nt(),n=qe.identifierPrefix;if(De){var r=qn,c=zn;r=(c&~(1<<32-Bt(c)-1)).toString(32)+r,n=":"+n+"R"+r,r=Eo++,0<r&&(n+="H"+r.toString(32)),n+=":"}else r=rT++,n=":"+n+"r"+r.toString(32)+":";return t.memoizedState=n},useCacheRefresh:function(){return Nt().memoizedState=dT.bind(null,Se)}};ia.useMemoCache=Xl,ia.useHostTransitionStatus=au,ia.useFormState=Im,ia.useActionState=Im,ia.useOptimistic=function(t){var n=Nt();n.memoizedState=n.baseState=t;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=r,n=su.bind(null,Se,!0,r),r.dispatch=n,[t,n]};var gi={readContext:Et,use:_o,useCallback:Qm,useContext:Et,useEffect:eu,useImperativeHandle:Ym,useInsertionEffect:Fm,useLayoutEffect:Gm,useMemo:Xm,useReducer:wo,useRef:Vm,useState:function(){return wo(Hn)},useDebugValue:tu,useDeferredValue:function(t,n){var r=rt();return Jm(r,Ue.memoizedState,t,n)},useTransition:function(){var t=wo(Hn)[0],n=rt().memoizedState;return[typeof t=="boolean"?t:Js(t),n]},useSyncExternalStore:_m,useId:ep};gi.useCacheRefresh=tp,gi.useMemoCache=Xl,gi.useHostTransitionStatus=au,gi.useFormState=Bm,gi.useActionState=Bm,gi.useOptimistic=function(t,n){var r=rt();return Nm(r,Ue,t,n)};var aa={readContext:Et,use:_o,useCallback:Qm,useContext:Et,useEffect:eu,useImperativeHandle:Ym,useInsertionEffect:Fm,useLayoutEffect:Gm,useMemo:Xm,useReducer:Zl,useRef:Vm,useState:function(){return Zl(Hn)},useDebugValue:tu,useDeferredValue:function(t,n){var r=rt();return Ue===null?nu(r,t,n):Jm(r,Ue.memoizedState,t,n)},useTransition:function(){var t=Zl(Hn)[0],n=rt().memoizedState;return[typeof t=="boolean"?t:Js(t),n]},useSyncExternalStore:_m,useId:ep};aa.useCacheRefresh=tp,aa.useMemoCache=Xl,aa.useHostTransitionStatus=au,aa.useFormState=qm,aa.useActionState=qm,aa.useOptimistic=function(t,n){var r=rt();return Ue!==null?Nm(r,Ue,t,n):(r.baseState=t,[t,r.queue.dispatch])};function ru(t,n,r,c){n=t.memoizedState,r=r(c,n),r=r==null?n:ee({},n,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var ou={isMounted:function(t){return(t=t._reactInternals)?me(t)===t:!1},enqueueSetState:function(t,n,r){t=t._reactInternals;var c=Ft(),f=bi(c);f.payload=n,r!=null&&(f.callback=r),n=Si(t,f,c),n!==null&&(Ot(n,t,c),er(n,t,c))},enqueueReplaceState:function(t,n,r){t=t._reactInternals;var c=Ft(),f=bi(c);f.tag=1,f.payload=n,r!=null&&(f.callback=r),n=Si(t,f,c),n!==null&&(Ot(n,t,c),er(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var r=Ft(),c=bi(r);c.tag=2,n!=null&&(c.callback=n),n=Si(t,c,r),n!==null&&(Ot(n,t,r),er(n,t,r))}};function sp(t,n,r,c,f,p,y){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,p,y):n.prototype&&n.prototype.isPureReactComponent?!Is(r,c)||!Is(f,p):!0}function rp(t,n,r,c){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(r,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(r,c),n.state!==t&&ou.enqueueReplaceState(n,n.state,null)}function sa(t,n){var r=n;if("ref"in n){r={};for(var c in n)c!=="ref"&&(r[c]=n[c])}if(t=t.defaultProps){r===n&&(r=ee({},r));for(var f in t)r[f]===void 0&&(r[f]=t[f])}return r}var Ao=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function op(t){Ao(t)}function cp(t){console.error(t)}function lp(t){Ao(t)}function No(t,n){try{var r=t.onUncaughtError;r(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function up(t,n,r){try{var c=t.onCaughtError;c(r.value,{componentStack:r.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function cu(t,n,r){return r=bi(r),r.tag=3,r.payload={element:null},r.callback=function(){No(t,n)},r}function dp(t){return t=bi(t),t.tag=3,t}function fp(t,n,r,c){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var p=c.value;t.payload=function(){return f(p)},t.callback=function(){up(n,r,c)}}var y=r.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(t.callback=function(){up(n,r,c),typeof f!="function"&&(_i===null?_i=new Set([this]):_i.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})})}function hT(t,n,r,c,f){if(r.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=r.alternate,n!==null&&$s(n,r,f,!0),r=tn.current,r!==null){switch(r.tag){case 13:return En===null?Hu():r.alternate===null&&Je===0&&(Je=3),r.flags&=-257,r.flags|=65536,r.lanes=f,c===Il?r.flags|=16384:(n=r.updateQueue,n===null?r.updateQueue=new Set([c]):n.add(c),Gu(t,c,f)),!1;case 22:return r.flags|=65536,c===Il?r.flags|=16384:(n=r.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},r.updateQueue=n):(r=n.retryQueue,r===null?n.retryQueue=new Set([c]):r.add(c)),Gu(t,c,f)),!1}throw Error(s(435,r.tag))}return Gu(t,c,f),Hu(),!1}if(De)return n=tn.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=f,c!==jl&&(t=Error(s(422),{cause:c}),Vs(Wt(t,r)))):(c!==jl&&(n=Error(s(423),{cause:c}),Vs(Wt(n,r))),t=t.current.alternate,t.flags|=65536,f&=-f,t.lanes|=f,c=Wt(c,r),f=cu(t.stateNode,c,f),Cu(t,f),Je!==4&&(Je=2)),!1;var p=Error(s(520),{cause:c});if(p=Wt(p,r),cr===null?cr=[p]:cr.push(p),Je!==4&&(Je=2),n===null)return!0;c=Wt(c,r),r=n;do{switch(r.tag){case 3:return r.flags|=65536,t=f&-f,r.lanes|=t,t=cu(r.stateNode,c,t),Cu(r,t),!1;case 1:if(n=r.type,p=r.stateNode,(r.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(_i===null||!_i.has(p))))return r.flags|=65536,f&=-f,r.lanes|=f,f=dp(f),fp(f,t,r,c),Cu(r,f),!1}r=r.return}while(r!==null);return!1}var hp=Error(s(461)),ht=!1;function bt(t,n,r,c){n.child=t===null?ym(n,null,r,c):ea(n,t.child,r,c)}function mp(t,n,r,c,f){r=r.render;var p=n.ref;if("ref"in c){var y={};for(var S in c)S!=="ref"&&(y[S]=c[S])}else y=c;return oa(n),c=Gl(t,n,r,y,p,f),S=Kl(),t!==null&&!ht?(Yl(t,n,f),Fn(t,n,f)):(De&&S&&Ul(n),n.flags|=1,bt(t,n,c,f),n.child)}function pp(t,n,r,c,f){if(t===null){var p=r.type;return typeof p=="function"&&!Au(p)&&p.defaultProps===void 0&&r.compare===null?(n.tag=15,n.type=p,gp(t,n,p,c,f)):(t=jo(r.type,null,c,n,n.mode,f),t.ref=n.ref,t.return=n,n.child=t)}if(p=t.child,!vu(t,f)){var y=p.memoizedProps;if(r=r.compare,r=r!==null?r:Is,r(y,c)&&t.ref===n.ref)return Fn(t,n,f)}return n.flags|=1,t=Ei(p,c),t.ref=n.ref,t.return=n,n.child=t}function gp(t,n,r,c,f){if(t!==null){var p=t.memoizedProps;if(Is(p,c)&&t.ref===n.ref)if(ht=!1,n.pendingProps=c=p,vu(t,f))(t.flags&131072)!==0&&(ht=!0);else return n.lanes=t.lanes,Fn(t,n,f)}return lu(t,n,r,c,f)}function vp(t,n,r){var c=n.pendingProps,f=c.children,p=(n.stateNode._pendingVisibility&2)!==0,y=t!==null?t.memoizedState:null;if(Ws(t,n),c.mode==="hidden"||p){if((n.flags&128)!==0){if(c=y!==null?y.baseLanes|r:r,t!==null){for(f=n.child=t.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;n.childLanes=p&~c}else n.childLanes=0,n.child=null;return yp(t,n,c,r)}if((r&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},t!==null&&ko(n,y!==null?y.cachePool:null),y!==null?bm(n,y):Bl(),Sm(n);else return n.lanes=n.childLanes=536870912,yp(t,n,y!==null?y.baseLanes|r:r,r)}else y!==null?(ko(n,y.cachePool),bm(n,y),mi(),n.memoizedState=null):(t!==null&&ko(n,null),Bl(),mi());return bt(t,n,f,r),n.child}function yp(t,n,r,c){var f=Hl();return f=f===null?null:{parent:ut._currentValue,pool:f},n.memoizedState={baseLanes:r,cachePool:f},t!==null&&ko(n,null),Bl(),Sm(n),t!==null&&$s(t,n,c,!0),null}function Ws(t,n){var r=n.ref;if(r===null)t!==null&&t.ref!==null&&(n.flags|=2097664);else{if(typeof r!="function"&&typeof r!="object")throw Error(s(284));(t===null||t.ref!==r)&&(n.flags|=2097664)}}function lu(t,n,r,c,f){return oa(n),r=Gl(t,n,r,c,void 0,f),c=Kl(),t!==null&&!ht?(Yl(t,n,f),Fn(t,n,f)):(De&&c&&Ul(n),n.flags|=1,bt(t,n,r,f),n.child)}function bp(t,n,r,c,f,p){return oa(n),n.updateQueue=null,r=Rm(n,c,r,f),Em(t),c=Kl(),t!==null&&!ht?(Yl(t,n,p),Fn(t,n,p)):(De&&c&&Ul(n),n.flags|=1,bt(t,n,r,p),n.child)}function Sp(t,n,r,c,f){if(oa(n),n.stateNode===null){var p=La,y=r.contextType;typeof y=="object"&&y!==null&&(p=Et(y)),p=new r(c,p),n.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=ou,n.stateNode=p,p._reactInternals=n,p=n.stateNode,p.props=c,p.state=n.memoizedState,p.refs={},Tu(n),y=r.contextType,p.context=typeof y=="object"&&y!==null?Et(y):La,p.state=n.memoizedState,y=r.getDerivedStateFromProps,typeof y=="function"&&(ru(n,r,y,c),p.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(y=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),y!==p.state&&ou.enqueueReplaceState(p,p.state,null),nr(n,c,p,f),tr(),p.state=n.memoizedState),typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(t===null){p=n.stateNode;var S=n.memoizedProps,R=sa(r,S);p.props=R;var P=p.context,H=r.contextType;y=La,typeof H=="object"&&H!==null&&(y=Et(H));var X=r.getDerivedStateFromProps;H=typeof X=="function"||typeof p.getSnapshotBeforeUpdate=="function",S=n.pendingProps!==S,H||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S||P!==y)&&rp(n,p,c,y),yi=!1;var j=n.memoizedState;p.state=j,nr(n,c,p,f),tr(),P=n.memoizedState,S||j!==P||yi?(typeof X=="function"&&(ru(n,r,X,c),P=n.memoizedState),(R=yi||sp(n,r,R,c,j,P,y))?(H||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(n.flags|=4194308)):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=P),p.props=c,p.state=P,p.context=y,c=R):(typeof p.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{p=n.stateNode,ku(t,n),y=n.memoizedProps,H=sa(r,y),p.props=H,X=n.pendingProps,j=p.context,P=r.contextType,R=La,typeof P=="object"&&P!==null&&(R=Et(P)),S=r.getDerivedStateFromProps,(P=typeof S=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(y!==X||j!==R)&&rp(n,p,c,R),yi=!1,j=n.memoizedState,p.state=j,nr(n,c,p,f),tr();var V=n.memoizedState;y!==X||j!==V||yi||t!==null&&t.dependencies!==null&&Po(t.dependencies)?(typeof S=="function"&&(ru(n,r,S,c),V=n.memoizedState),(H=yi||sp(n,r,H,c,j,V,R)||t!==null&&t.dependencies!==null&&Po(t.dependencies))?(P||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,V,R),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,V,R)),typeof p.componentDidUpdate=="function"&&(n.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&j===t.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&j===t.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=V),p.props=c,p.state=V,p.context=R,c=H):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&j===t.memoizedState||(n.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&j===t.memoizedState||(n.flags|=1024),c=!1)}return p=c,Ws(t,n),c=(n.flags&128)!==0,p||c?(p=n.stateNode,r=c&&typeof r.getDerivedStateFromError!="function"?null:p.render(),n.flags|=1,t!==null&&c?(n.child=ea(n,t.child,null,f),n.child=ea(n,null,r,f)):bt(t,n,r,f),n.memoizedState=p.state,t=n.child):t=Fn(t,n,f),t}function Tp(t,n,r,c){return qs(),n.flags|=256,bt(t,n,r,c),n.child}var uu={dehydrated:null,treeContext:null,retryLane:0};function du(t){return{baseLanes:t,cachePool:Cm()}}function fu(t,n,r){return t=t!==null?t.childLanes&~r:0,n&&(t|=rn),t}function kp(t,n,r){var c=n.pendingProps,f=!1,p=(n.flags&128)!==0,y;if((y=p)||(y=t!==null&&t.memoizedState===null?!1:(lt.current&2)!==0),y&&(f=!0,n.flags&=-129),y=(n.flags&32)!==0,n.flags&=-33,t===null){if(De){if(f?hi(n):mi(),De){var S=yt,R;if(R=S){e:{for(R=S,S=Cn;R.nodeType!==8;){if(!S){S=null;break e}if(R=fn(R.nextSibling),R===null){S=null;break e}}S=R}S!==null?(n.memoizedState={dehydrated:S,treeContext:Zi!==null?{id:zn,overflow:qn}:null,retryLane:536870912},R=sn(18,null,null,0),R.stateNode=S,R.return=n,n.child=R,xt=n,yt=null,R=!0):R=!1}R||$i(n)}if(S=n.memoizedState,S!==null&&(S=S.dehydrated,S!==null))return S.data==="$!"?n.lanes=16:n.lanes=536870912,null;Vn(n)}return S=c.children,c=c.fallback,f?(mi(),f=n.mode,S=mu({mode:"hidden",children:S},f),c=la(c,f,r,null),S.return=n,c.return=n,S.sibling=c,n.child=S,f=n.child,f.memoizedState=du(r),f.childLanes=fu(t,y,r),n.memoizedState=uu,c):(hi(n),hu(n,S))}if(R=t.memoizedState,R!==null&&(S=R.dehydrated,S!==null)){if(p)n.flags&256?(hi(n),n.flags&=-257,n=pu(t,n,r)):n.memoizedState!==null?(mi(),n.child=t.child,n.flags|=128,n=null):(mi(),f=c.fallback,S=n.mode,c=mu({mode:"visible",children:c.children},S),f=la(f,S,r,null),f.flags|=2,c.return=n,f.return=n,c.sibling=f,n.child=c,ea(n,t.child,null,r),c=n.child,c.memoizedState=du(r),c.childLanes=fu(t,y,r),n.memoizedState=uu,n=f);else if(hi(n),S.data==="$!"){if(y=S.nextSibling&&S.nextSibling.dataset,y)var P=y.dgst;y=P,c=Error(s(419)),c.stack="",c.digest=y,Vs({value:c,source:null,stack:null}),n=pu(t,n,r)}else if(ht||$s(t,n,r,!1),y=(r&t.childLanes)!==0,ht||y){if(y=qe,y!==null){if(c=r&-r,(c&42)!==0)c=1;else switch(c){case 2:c=1;break;case 8:c=4;break;case 32:c=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:c=64;break;case 268435456:c=134217728;break;default:c=0}if(c=(c&(y.suspendedLanes|r))!==0?0:c,c!==0&&c!==R.retryLane)throw R.retryLane=c,fi(t,c),Ot(y,t,c),hp}S.data==="$?"||Hu(),n=pu(t,n,r)}else S.data==="$?"?(n.flags|=128,n.child=t.child,n=xT.bind(null,t),S._reactRetry=n,n=null):(t=R.treeContext,yt=fn(S.nextSibling),xt=n,De=!0,un=null,Cn=!1,t!==null&&($t[en++]=zn,$t[en++]=qn,$t[en++]=Zi,zn=t.id,qn=t.overflow,Zi=n),n=hu(n,c.children),n.flags|=4096);return n}return f?(mi(),f=c.fallback,S=n.mode,R=t.child,P=R.sibling,c=Ei(R,{mode:"hidden",children:c.children}),c.subtreeFlags=R.subtreeFlags&31457280,P!==null?f=Ei(P,f):(f=la(f,S,r,null),f.flags|=2),f.return=n,c.return=n,c.sibling=f,n.child=c,c=f,f=n.child,S=t.child.memoizedState,S===null?S=du(r):(R=S.cachePool,R!==null?(P=ut._currentValue,R=R.parent!==P?{parent:P,pool:P}:R):R=Cm(),S={baseLanes:S.baseLanes|r,cachePool:R}),f.memoizedState=S,f.childLanes=fu(t,y,r),n.memoizedState=uu,c):(hi(n),r=t.child,t=r.sibling,r=Ei(r,{mode:"visible",children:c.children}),r.return=n,r.sibling=null,t!==null&&(y=n.deletions,y===null?(n.deletions=[t],n.flags|=16):y.push(t)),n.child=r,n.memoizedState=null,r)}function hu(t,n){return n=mu({mode:"visible",children:n},t.mode),n.return=t,t.child=n}function mu(t,n){return Qp(t,n,0,null)}function pu(t,n,r){return ea(n,t.child,null,r),t=hu(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function Cp(t,n,r){t.lanes|=n;var c=t.alternate;c!==null&&(c.lanes|=n),bu(t.return,n,r)}function gu(t,n,r,c,f){var p=t.memoizedState;p===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:r,tailMode:f}:(p.isBackwards=n,p.rendering=null,p.renderingStartTime=0,p.last=c,p.tail=r,p.tailMode=f)}function Ep(t,n,r){var c=n.pendingProps,f=c.revealOrder,p=c.tail;if(bt(t,n,c.children,r),c=lt.current,(c&2)!==0)c=c&1|2,n.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Cp(t,r,n);else if(t.tag===19)Cp(t,r,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}c&=1}switch(He(lt,c),f){case"forwards":for(r=n.child,f=null;r!==null;)t=r.alternate,t!==null&&To(t)===null&&(f=r),r=r.sibling;r=f,r===null?(f=n.child,n.child=null):(f=r.sibling,r.sibling=null),gu(n,!1,f,r,p);break;case"backwards":for(r=null,f=n.child,n.child=null;f!==null;){if(t=f.alternate,t!==null&&To(t)===null){n.child=f;break}t=f.sibling,f.sibling=r,r=f,f=t}gu(n,!0,r,null,p);break;case"together":gu(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Fn(t,n,r){if(t!==null&&(n.dependencies=t.dependencies),Ri|=n.lanes,(r&n.childLanes)===0)if(t!==null){if($s(t,n,r,!1),(r&n.childLanes)===0)return null}else return null;if(t!==null&&n.child!==t.child)throw Error(s(153));if(n.child!==null){for(t=n.child,r=Ei(t,t.pendingProps),n.child=r,r.return=n;t.sibling!==null;)t=t.sibling,r=r.sibling=Ei(t,t.pendingProps),r.return=n;r.sibling=null}return n.child}function vu(t,n){return(t.lanes&n)!==0?!0:(t=t.dependencies,!!(t!==null&&Po(t)))}function mT(t,n,r){switch(n.tag){case 3:Qr(n,n.stateNode.containerInfo),vi(n,ut,t.memoizedState.cache),qs();break;case 27:case 5:ol(n);break;case 4:Qr(n,n.stateNode.containerInfo);break;case 10:vi(n,n.type,n.memoizedProps.value);break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(hi(n),n.flags|=128,null):(r&n.child.childLanes)!==0?kp(t,n,r):(hi(n),t=Fn(t,n,r),t!==null?t.sibling:null);hi(n);break;case 19:var f=(t.flags&128)!==0;if(c=(r&n.childLanes)!==0,c||($s(t,n,r,!1),c=(r&n.childLanes)!==0),f){if(c)return Ep(t,n,r);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),He(lt,lt.current),c)break;return null;case 22:case 23:return n.lanes=0,vp(t,n,r);case 24:vi(n,ut,t.memoizedState.cache)}return Fn(t,n,r)}function Rp(t,n,r){if(t!==null)if(t.memoizedProps!==n.pendingProps)ht=!0;else{if(!vu(t,r)&&(n.flags&128)===0)return ht=!1,mT(t,n,r);ht=(t.flags&131072)!==0}else ht=!1,De&&(n.flags&1048576)!==0&&lm(n,go,n.index);switch(n.lanes=0,n.tag){case 16:e:{t=n.pendingProps;var c=n.elementType,f=c._init;if(c=f(c._payload),n.type=c,typeof c=="function")Au(c)?(t=sa(c,t),n.tag=1,n=Sp(null,n,c,t,r)):(n.tag=0,n=lu(null,n,c,t,r));else{if(c!=null){if(f=c.$$typeof,f===T){n.tag=11,n=mp(null,n,c,t,r);break e}else if(f===x){n.tag=14,n=pp(null,n,c,t,r);break e}}throw n=ne(c)||c,Error(s(306,n,""))}}return n;case 0:return lu(t,n,n.type,n.pendingProps,r);case 1:return c=n.type,f=sa(c,n.pendingProps),Sp(t,n,c,f,r);case 3:e:{if(Qr(n,n.stateNode.containerInfo),t===null)throw Error(s(387));var p=n.pendingProps;f=n.memoizedState,c=f.element,ku(t,n),nr(n,p,null,r);var y=n.memoizedState;if(p=y.cache,vi(n,ut,p),p!==f.cache&&Su(n,[ut],r,!0),tr(),p=y.element,f.isDehydrated)if(f={element:p,isDehydrated:!1,cache:y.cache},n.updateQueue.baseState=f,n.memoizedState=f,n.flags&256){n=Tp(t,n,p,r);break e}else if(p!==c){c=Wt(Error(s(424)),n),Vs(c),n=Tp(t,n,p,r);break e}else for(yt=fn(n.stateNode.containerInfo.firstChild),xt=n,De=!0,un=null,Cn=!0,r=ym(n,null,p,r),n.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(qs(),p===c){n=Fn(t,n,r);break e}bt(t,n,p,r)}n=n.child}return n;case 26:return Ws(t,n),t===null?(r=xg(n.type,null,n.pendingProps,null))?n.memoizedState=r:De||(r=n.type,t=n.pendingProps,c=Xo(ci.current).createElement(r),c[Ct]=n,c[Dt]=t,St(c,r,t),ft(c),n.stateNode=c):n.memoizedState=xg(n.type,t.memoizedProps,n.pendingProps,t.memoizedState),null;case 27:return ol(n),t===null&&De&&(c=n.stateNode=Rg(n.type,n.pendingProps,ci.current),xt=n,Cn=!0,yt=fn(c.firstChild)),c=n.pendingProps.children,t!==null||De?bt(t,n,c,r):n.child=ea(n,null,c,r),Ws(t,n),n.child;case 5:return t===null&&De&&((f=c=yt)&&(c=FT(c,n.type,n.pendingProps,Cn),c!==null?(n.stateNode=c,xt=n,yt=fn(c.firstChild),Cn=!1,f=!0):f=!1),f||$i(n)),ol(n),f=n.type,p=n.pendingProps,y=t!==null?t.memoizedProps:null,c=p.children,id(f,p)?c=null:y!==null&&id(f,y)&&(n.flags|=32),n.memoizedState!==null&&(f=Gl(t,n,oT,null,null,r),vr._currentValue=f),Ws(t,n),bt(t,n,c,r),n.child;case 6:return t===null&&De&&((t=r=yt)&&(r=GT(r,n.pendingProps,Cn),r!==null?(n.stateNode=r,xt=n,yt=null,t=!0):t=!1),t||$i(n)),null;case 13:return kp(t,n,r);case 4:return Qr(n,n.stateNode.containerInfo),c=n.pendingProps,t===null?n.child=ea(n,null,c,r):bt(t,n,c,r),n.child;case 11:return mp(t,n,n.type,n.pendingProps,r);case 7:return bt(t,n,n.pendingProps,r),n.child;case 8:return bt(t,n,n.pendingProps.children,r),n.child;case 12:return bt(t,n,n.pendingProps.children,r),n.child;case 10:return c=n.pendingProps,vi(n,n.type,c.value),bt(t,n,c.children,r),n.child;case 9:return f=n.type._context,c=n.pendingProps.children,oa(n),f=Et(f),c=c(f),n.flags|=1,bt(t,n,c,r),n.child;case 14:return pp(t,n,n.type,n.pendingProps,r);case 15:return gp(t,n,n.type,n.pendingProps,r);case 19:return Ep(t,n,r);case 22:return vp(t,n,r);case 24:return oa(n),c=Et(ut),t===null?(f=Hl(),f===null&&(f=qe,p=ql(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=r),f=p),n.memoizedState={parent:c,cache:f},Tu(n),vi(n,ut,f)):((t.lanes&r)!==0&&(ku(t,n),nr(n,null,null,r),tr()),f=t.memoizedState,p=n.memoizedState,f.parent!==c?(f={parent:c,cache:c},n.memoizedState=f,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=f),vi(n,ut,c)):(c=p.cache,vi(n,ut,c),c!==f.cache&&Su(n,[ut],r,!0))),bt(t,n,n.pendingProps.children,r),n.child;case 29:throw n.pendingProps}throw Error(s(156,n.tag))}var yu=Pe(null),ra=null,Gn=null;function vi(t,n,r){He(yu,n._currentValue),n._currentValue=r}function Kn(t){t._currentValue=yu.current,at(yu)}function bu(t,n,r){for(;t!==null;){var c=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),t===r)break;t=t.return}}function Su(t,n,r,c){var f=t.child;for(f!==null&&(f.return=t);f!==null;){var p=f.dependencies;if(p!==null){var y=f.child;p=p.firstContext;e:for(;p!==null;){var S=p;p=f;for(var R=0;R<n.length;R++)if(S.context===n[R]){p.lanes|=r,S=p.alternate,S!==null&&(S.lanes|=r),bu(p.return,r,t),c||(y=null);break e}p=S.next}}else if(f.tag===18){if(y=f.return,y===null)throw Error(s(341));y.lanes|=r,p=y.alternate,p!==null&&(p.lanes|=r),bu(y,r,t),y=null}else y=f.child;if(y!==null)y.return=f;else for(y=f;y!==null;){if(y===t){y=null;break}if(f=y.sibling,f!==null){f.return=y.return,y=f;break}y=y.return}f=y}}function $s(t,n,r,c){t=null;for(var f=n,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var y=f.alternate;if(y===null)throw Error(s(387));if(y=y.memoizedProps,y!==null){var S=f.type;zt(f.pendingProps.value,y.value)||(t!==null?t.push(S):t=[S])}}else if(f===Yr.current){if(y=f.alternate,y===null)throw Error(s(387));y.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(t!==null?t.push(vr):t=[vr])}f=f.return}t!==null&&Su(n,t,r,c),n.flags|=262144}function Po(t){for(t=t.firstContext;t!==null;){if(!zt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function oa(t){ra=t,Gn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Et(t){return _p(ra,t)}function Mo(t,n){return ra===null&&oa(t),_p(t,n)}function _p(t,n){var r=n._currentValue;if(n={context:n,memoizedValue:r,next:null},Gn===null){if(t===null)throw Error(s(308));Gn=n,t.dependencies={lanes:0,firstContext:n},t.flags|=524288}else Gn=Gn.next=n;return r}var yi=!1;function Tu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ku(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function bi(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Si(t,n,r){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Ye&2)!==0){var f=c.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),c.pending=n,n=mo(t),om(t,null,r),n}return ho(t,c,n,r),mo(t)}function er(t,n,r){if(n=n.updateQueue,n!==null&&(n=n.shared,(r&4194176)!==0)){var c=n.lanes;c&=t.pendingLanes,r|=c,n.lanes=r,ph(t,r)}}function Cu(t,n){var r=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,r===c)){var f=null,p=null;if(r=r.firstBaseUpdate,r!==null){do{var y={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};p===null?f=p=y:p=p.next=y,r=r.next}while(r!==null);p===null?f=p=n:p=p.next=n}else f=p=n;r={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=n:t.next=n,r.lastBaseUpdate=n}var Eu=!1;function tr(){if(Eu){var t=Va;if(t!==null)throw t}}function nr(t,n,r,c){Eu=!1;var f=t.updateQueue;yi=!1;var p=f.firstBaseUpdate,y=f.lastBaseUpdate,S=f.shared.pending;if(S!==null){f.shared.pending=null;var R=S,P=R.next;R.next=null,y===null?p=P:y.next=P,y=R;var H=t.alternate;H!==null&&(H=H.updateQueue,S=H.lastBaseUpdate,S!==y&&(S===null?H.firstBaseUpdate=P:S.next=P,H.lastBaseUpdate=R))}if(p!==null){var X=f.baseState;y=0,H=P=R=null,S=p;do{var j=S.lane&-536870913,V=j!==S.lane;if(V?(we&j)===j:(c&j)===j){j!==0&&j===qa&&(Eu=!0),H!==null&&(H=H.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var oe=t,pe=S;j=n;var Ze=r;switch(pe.tag){case 1:if(oe=pe.payload,typeof oe=="function"){X=oe.call(Ze,X,j);break e}X=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=pe.payload,j=typeof oe=="function"?oe.call(Ze,X,j):oe,j==null)break e;X=ee({},X,j);break e;case 2:yi=!0}}j=S.callback,j!==null&&(t.flags|=64,V&&(t.flags|=8192),V=f.callbacks,V===null?f.callbacks=[j]:V.push(j))}else V={lane:j,tag:S.tag,payload:S.payload,callback:S.callback,next:null},H===null?(P=H=V,R=X):H=H.next=V,y|=j;if(S=S.next,S===null){if(S=f.shared.pending,S===null)break;V=S,S=V.next,V.next=null,f.lastBaseUpdate=V,f.shared.pending=null}}while(!0);H===null&&(R=X),f.baseState=R,f.firstBaseUpdate=P,f.lastBaseUpdate=H,p===null&&(f.shared.lanes=0),Ri|=y,t.lanes=y,t.memoizedState=X}}function wp(t,n){if(typeof t!="function")throw Error(s(191,t));t.call(n)}function xp(t,n){var r=t.callbacks;if(r!==null)for(t.callbacks=null,t=0;t<r.length;t++)wp(r[t],n)}function ir(t,n){try{var r=n.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&t)===t){c=void 0;var p=r.create,y=r.inst;c=p(),y.destroy=c}r=r.next}while(r!==f)}}catch(S){Ie(n,n.return,S)}}function Ti(t,n,r){try{var c=n.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var p=f.next;c=p;do{if((c.tag&t)===t){var y=c.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,f=n;var R=r;try{S()}catch(P){Ie(f,R,P)}}}c=c.next}while(c!==p)}}catch(P){Ie(n,n.return,P)}}function Op(t){var n=t.updateQueue;if(n!==null){var r=t.stateNode;try{xp(n,r)}catch(c){Ie(t,t.return,c)}}}function Dp(t,n,r){r.props=sa(t.type,t.memoizedProps),r.state=t.memoizedState;try{r.componentWillUnmount()}catch(c){Ie(t,n,c)}}function ca(t,n){try{var r=t.ref;if(r!==null){var c=t.stateNode;switch(t.tag){case 26:case 27:case 5:var f=c;break;default:f=c}typeof r=="function"?t.refCleanup=r(f):r.current=f}}catch(p){Ie(t,n,p)}}function qt(t,n){var r=t.ref,c=t.refCleanup;if(r!==null)if(typeof c=="function")try{c()}catch(f){Ie(t,n,f)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){Ie(t,n,f)}else r.current=null}function Ap(t){var n=t.type,r=t.memoizedProps,c=t.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":r.autoFocus&&c.focus();break e;case"img":r.src?c.src=r.src:r.srcSet&&(c.srcset=r.srcSet)}}catch(f){Ie(t,t.return,f)}}function Np(t,n,r){try{var c=t.stateNode;BT(c,t.type,r,n),c[Dt]=n}catch(f){Ie(t,t.return,f)}}function Pp(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27||t.tag===4}function Ru(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Pp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==27&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _u(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?r.nodeType===8?r.parentNode.insertBefore(t,n):r.insertBefore(t,n):(r.nodeType===8?(n=r.parentNode,n.insertBefore(t,r)):(n=r,n.appendChild(t)),r=r._reactRootContainer,r!=null||n.onclick!==null||(n.onclick=Qo));else if(c!==4&&c!==27&&(t=t.child,t!==null))for(_u(t,n,r),t=t.sibling;t!==null;)_u(t,n,r),t=t.sibling}function Uo(t,n,r){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?r.insertBefore(t,n):r.appendChild(t);else if(c!==4&&c!==27&&(t=t.child,t!==null))for(Uo(t,n,r),t=t.sibling;t!==null;)Uo(t,n,r),t=t.sibling}var Yn=!1,Xe=!1,wu=!1,Mp=typeof WeakSet=="function"?WeakSet:Set,mt=null,Up=!1;function pT(t,n){if(t=t.containerInfo,td=tc,t=Wh(t),Ol(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var c=r.getSelection&&r.getSelection();if(c&&c.rangeCount!==0){r=c.anchorNode;var f=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{r.nodeType,p.nodeType}catch{r=null;break e}var y=0,S=-1,R=-1,P=0,H=0,X=t,j=null;t:for(;;){for(var V;X!==r||f!==0&&X.nodeType!==3||(S=y+f),X!==p||c!==0&&X.nodeType!==3||(R=y+c),X.nodeType===3&&(y+=X.nodeValue.length),(V=X.firstChild)!==null;)j=X,X=V;for(;;){if(X===t)break t;if(j===r&&++P===f&&(S=y),j===p&&++H===c&&(R=y),(V=X.nextSibling)!==null)break;X=j,j=X.parentNode}X=V}r=S===-1||R===-1?null:{start:S,end:R}}else r=null}r=r||{start:0,end:0}}else r=null;for(nd={focusedElem:t,selectionRange:r},tc=!1,mt=n;mt!==null;)if(n=mt,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,mt=t;else for(;mt!==null;){switch(n=mt,p=n.alternate,t=n.flags,n.tag){case 0:break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,r=n,f=p.memoizedProps,p=p.memoizedState,c=r.stateNode;try{var oe=sa(r.type,f,r.elementType===r.type);t=c.getSnapshotBeforeUpdate(oe,p),c.__reactInternalSnapshotBeforeUpdate=t}catch(pe){Ie(r,r.return,pe)}}break;case 3:if((t&1024)!==0){if(t=n.stateNode.containerInfo,r=t.nodeType,r===9)rd(t);else if(r===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":rd(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=n.sibling,t!==null){t.return=n.return,mt=t;break}mt=n.return}return oe=Up,Up=!1,oe}function Lp(t,n,r){var c=r.flags;switch(r.tag){case 0:case 11:case 15:Xn(t,r),c&4&&ir(5,r);break;case 1:if(Xn(t,r),c&4)if(t=r.stateNode,n===null)try{t.componentDidMount()}catch(S){Ie(r,r.return,S)}else{var f=sa(r.type,n.memoizedProps);n=n.memoizedState;try{t.componentDidUpdate(f,n,t.__reactInternalSnapshotBeforeUpdate)}catch(S){Ie(r,r.return,S)}}c&64&&Op(r),c&512&&ca(r,r.return);break;case 3:if(Xn(t,r),c&64&&(c=r.updateQueue,c!==null)){if(t=null,r.child!==null)switch(r.child.tag){case 27:case 5:t=r.child.stateNode;break;case 1:t=r.child.stateNode}try{xp(c,t)}catch(S){Ie(r,r.return,S)}}break;case 26:Xn(t,r),c&512&&ca(r,r.return);break;case 27:case 5:Xn(t,r),n===null&&c&4&&Ap(r),c&512&&ca(r,r.return);break;case 12:Xn(t,r);break;case 13:Xn(t,r),c&4&&Bp(t,r);break;case 22:if(f=r.memoizedState!==null||Yn,!f){n=n!==null&&n.memoizedState!==null||Xe;var p=Yn,y=Xe;Yn=f,(Xe=n)&&!y?ki(t,r,(r.subtreeFlags&8772)!==0):Xn(t,r),Yn=p,Xe=y}c&512&&(r.memoizedProps.mode==="manual"?ca(r,r.return):qt(r,r.return));break;default:Xn(t,r)}}function jp(t){var n=t.alternate;n!==null&&(t.alternate=null,jp(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&hl(n)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var ot=null,Vt=!1;function Qn(t,n,r){for(r=r.child;r!==null;)Ip(t,n,r),r=r.sibling}function Ip(t,n,r){if(It&&typeof It.onCommitFiberUnmount=="function")try{It.onCommitFiberUnmount(_s,r)}catch{}switch(r.tag){case 26:Xe||qt(r,n),Qn(t,n,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Xe||qt(r,n);var c=ot,f=Vt;for(ot=r.stateNode,Qn(t,n,r),r=r.stateNode,n=r.attributes;n.length;)r.removeAttributeNode(n[0]);hl(r),ot=c,Vt=f;break;case 5:Xe||qt(r,n);case 6:f=ot;var p=Vt;if(ot=null,Qn(t,n,r),ot=f,Vt=p,ot!==null)if(Vt)try{t=ot,c=r.stateNode,t.nodeType===8?t.parentNode.removeChild(c):t.removeChild(c)}catch(y){Ie(r,n,y)}else try{ot.removeChild(r.stateNode)}catch(y){Ie(r,n,y)}break;case 18:ot!==null&&(Vt?(n=ot,r=r.stateNode,n.nodeType===8?sd(n.parentNode,r):n.nodeType===1&&sd(n,r),Tr(n)):sd(ot,r.stateNode));break;case 4:c=ot,f=Vt,ot=r.stateNode.containerInfo,Vt=!0,Qn(t,n,r),ot=c,Vt=f;break;case 0:case 11:case 14:case 15:Xe||Ti(2,r,n),Xe||Ti(4,r,n),Qn(t,n,r);break;case 1:Xe||(qt(r,n),c=r.stateNode,typeof c.componentWillUnmount=="function"&&Dp(r,n,c)),Qn(t,n,r);break;case 21:Qn(t,n,r);break;case 22:Xe||qt(r,n),Xe=(c=Xe)||r.memoizedState!==null,Qn(t,n,r),Xe=c;break;default:Qn(t,n,r)}}function Bp(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Tr(t)}catch(r){Ie(n,n.return,r)}}function gT(t){switch(t.tag){case 13:case 19:var n=t.stateNode;return n===null&&(n=t.stateNode=new Mp),n;case 22:return t=t.stateNode,n=t._retryCache,n===null&&(n=t._retryCache=new Mp),n;default:throw Error(s(435,t.tag))}}function xu(t,n){var r=gT(t);n.forEach(function(c){var f=OT.bind(null,t,c);r.has(c)||(r.add(c),c.then(f,f))})}function nn(t,n){var r=n.deletions;if(r!==null)for(var c=0;c<r.length;c++){var f=r[c],p=t,y=n,S=y;e:for(;S!==null;){switch(S.tag){case 27:case 5:ot=S.stateNode,Vt=!1;break e;case 3:ot=S.stateNode.containerInfo,Vt=!0;break e;case 4:ot=S.stateNode.containerInfo,Vt=!0;break e}S=S.return}if(ot===null)throw Error(s(160));Ip(p,y,f),ot=null,Vt=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(n.subtreeFlags&13878)for(n=n.child;n!==null;)zp(n,t),n=n.sibling}var dn=null;function zp(t,n){var r=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:nn(n,t),an(t),c&4&&(Ti(3,t,t.return),ir(3,t),Ti(5,t,t.return));break;case 1:nn(n,t),an(t),c&512&&(Xe||r===null||qt(r,r.return)),c&64&&Yn&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(r=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=r===null?c:r.concat(c))));break;case 26:var f=dn;if(nn(n,t),an(t),c&512&&(Xe||r===null||qt(r,r.return)),c&4){var p=r!==null?r.memoizedState:null;if(c=t.memoizedState,r===null)if(c===null)if(t.stateNode===null){e:{c=t.type,r=t.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":p=f.getElementsByTagName("title")[0],(!p||p[Os]||p[Ct]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(c),f.head.insertBefore(p,f.querySelector("head > title"))),St(p,c,r),p[Ct]=t,ft(p),c=p;break e;case"link":var y=Ag("link","href",f).get(c+(r.href||""));if(y){for(var S=0;S<y.length;S++)if(p=y[S],p.getAttribute("href")===(r.href==null?null:r.href)&&p.getAttribute("rel")===(r.rel==null?null:r.rel)&&p.getAttribute("title")===(r.title==null?null:r.title)&&p.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){y.splice(S,1);break t}}p=f.createElement(c),St(p,c,r),f.head.appendChild(p);break;case"meta":if(y=Ag("meta","content",f).get(c+(r.content||""))){for(S=0;S<y.length;S++)if(p=y[S],p.getAttribute("content")===(r.content==null?null:""+r.content)&&p.getAttribute("name")===(r.name==null?null:r.name)&&p.getAttribute("property")===(r.property==null?null:r.property)&&p.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&p.getAttribute("charset")===(r.charSet==null?null:r.charSet)){y.splice(S,1);break t}}p=f.createElement(c),St(p,c,r),f.head.appendChild(p);break;default:throw Error(s(468,c))}p[Ct]=t,ft(p),c=p}t.stateNode=c}else Ng(f,t.type,t.stateNode);else t.stateNode=Dg(f,c,t.memoizedProps);else p!==c?(p===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):p.count--,c===null?Ng(f,t.type,t.stateNode):Dg(f,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Np(t,t.memoizedProps,r.memoizedProps)}break;case 27:if(c&4&&t.alternate===null){f=t.stateNode,p=t.memoizedProps;try{for(var R=f.firstChild;R;){var P=R.nextSibling,H=R.nodeName;R[Os]||H==="HEAD"||H==="BODY"||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&R.rel.toLowerCase()==="stylesheet"||f.removeChild(R),R=P}for(var X=t.type,j=f.attributes;j.length;)f.removeAttributeNode(j[0]);St(f,X,p),f[Ct]=t,f[Dt]=p}catch(oe){Ie(t,t.return,oe)}}case 5:if(nn(n,t),an(t),c&512&&(Xe||r===null||qt(r,r.return)),t.flags&32){f=t.stateNode;try{Oa(f,"")}catch(oe){Ie(t,t.return,oe)}}c&4&&t.stateNode!=null&&(f=t.memoizedProps,Np(t,f,r!==null?r.memoizedProps:f)),c&1024&&(wu=!0);break;case 6:if(nn(n,t),an(t),c&4){if(t.stateNode===null)throw Error(s(162));c=t.memoizedProps,r=t.stateNode;try{r.nodeValue=c}catch(oe){Ie(t,t.return,oe)}}break;case 3:if(Wo=null,f=dn,dn=Jo(n.containerInfo),nn(n,t),dn=f,an(t),c&4&&r!==null&&r.memoizedState.isDehydrated)try{Tr(n.containerInfo)}catch(oe){Ie(t,t.return,oe)}wu&&(wu=!1,qp(t));break;case 4:c=dn,dn=Jo(t.stateNode.containerInfo),nn(n,t),an(t),dn=c;break;case 12:nn(n,t),an(t);break;case 13:nn(n,t),an(t),t.child.flags&8192&&t.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(ju=kn()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,xu(t,c)));break;case 22:if(c&512&&(Xe||r===null||qt(r,r.return)),R=t.memoizedState!==null,P=r!==null&&r.memoizedState!==null,H=Yn,X=Xe,Yn=H||R,Xe=X||P,nn(n,t),Xe=X,Yn=H,an(t),n=t.stateNode,n._current=t,n._visibility&=-3,n._visibility|=n._pendingVisibility&2,c&8192&&(n._visibility=R?n._visibility&-2:n._visibility|1,R&&(n=Yn||Xe,r===null||P||n||Ka(t)),t.memoizedProps===null||t.memoizedProps.mode!=="manual"))e:for(r=null,n=t;;){if(n.tag===5||n.tag===26||n.tag===27){if(r===null){P=r=n;try{if(f=P.stateNode,R)p=f.style,typeof p.setProperty=="function"?p.setProperty("display","none","important"):p.display="none";else{y=P.stateNode,S=P.memoizedProps.style;var V=S!=null&&S.hasOwnProperty("display")?S.display:null;y.style.display=V==null||typeof V=="boolean"?"":(""+V).trim()}}catch(oe){Ie(P,P.return,oe)}}}else if(n.tag===6){if(r===null){P=n;try{P.stateNode.nodeValue=R?"":P.memoizedProps}catch(oe){Ie(P,P.return,oe)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===t)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;r===n&&(r=null),n=n.return}r===n&&(r=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=t.updateQueue,c!==null&&(r=c.retryQueue,r!==null&&(c.retryQueue=null,xu(t,r))));break;case 19:nn(n,t),an(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,xu(t,c)));break;case 21:break;default:nn(n,t),an(t)}}function an(t){var n=t.flags;if(n&2){try{if(t.tag!==27){e:{for(var r=t.return;r!==null;){if(Pp(r)){var c=r;break e}r=r.return}throw Error(s(160))}switch(c.tag){case 27:var f=c.stateNode,p=Ru(t);Uo(t,p,f);break;case 5:var y=c.stateNode;c.flags&32&&(Oa(y,""),c.flags&=-33);var S=Ru(t);Uo(t,S,y);break;case 3:case 4:var R=c.stateNode.containerInfo,P=Ru(t);_u(t,P,R);break;default:throw Error(s(161))}}}catch(H){Ie(t,t.return,H)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function qp(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var n=t;qp(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),t=t.sibling}}function Xn(t,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)Lp(t,n.alternate,n),n=n.sibling}function Ka(t){for(t=t.child;t!==null;){var n=t;switch(n.tag){case 0:case 11:case 14:case 15:Ti(4,n,n.return),Ka(n);break;case 1:qt(n,n.return);var r=n.stateNode;typeof r.componentWillUnmount=="function"&&Dp(n,n.return,r),Ka(n);break;case 26:case 27:case 5:qt(n,n.return),Ka(n);break;case 22:qt(n,n.return),n.memoizedState===null&&Ka(n);break;default:Ka(n)}t=t.sibling}}function ki(t,n,r){for(r=r&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,f=t,p=n,y=p.flags;switch(p.tag){case 0:case 11:case 15:ki(f,p,r),ir(4,p);break;case 1:if(ki(f,p,r),c=p,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(P){Ie(c,c.return,P)}if(c=p,f=c.updateQueue,f!==null){var S=c.stateNode;try{var R=f.shared.hiddenCallbacks;if(R!==null)for(f.shared.hiddenCallbacks=null,f=0;f<R.length;f++)wp(R[f],S)}catch(P){Ie(c,c.return,P)}}r&&y&64&&Op(p),ca(p,p.return);break;case 26:case 27:case 5:ki(f,p,r),r&&c===null&&y&4&&Ap(p),ca(p,p.return);break;case 12:ki(f,p,r);break;case 13:ki(f,p,r),r&&y&4&&Bp(f,p);break;case 22:p.memoizedState===null&&ki(f,p,r),ca(p,p.return);break;default:ki(f,p,r)}n=n.sibling}}function Ou(t,n){var r=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),t=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),t!==r&&(t!=null&&t.refCount++,r!=null&&Ys(r))}function Du(t,n){t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&Ys(t))}function Ci(t,n,r,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Vp(t,n,r,c),n=n.sibling}function Vp(t,n,r,c){var f=n.flags;switch(n.tag){case 0:case 11:case 15:Ci(t,n,r,c),f&2048&&ir(9,n);break;case 3:Ci(t,n,r,c),f&2048&&(t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&Ys(t)));break;case 12:if(f&2048){Ci(t,n,r,c),t=n.stateNode;try{var p=n.memoizedProps,y=p.id,S=p.onPostCommit;typeof S=="function"&&S(y,n.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(R){Ie(n,n.return,R)}}else Ci(t,n,r,c);break;case 23:break;case 22:p=n.stateNode,n.memoizedState!==null?p._visibility&4?Ci(t,n,r,c):ar(t,n):p._visibility&4?Ci(t,n,r,c):(p._visibility|=4,Ya(t,n,r,c,(n.subtreeFlags&10256)!==0)),f&2048&&Ou(n.alternate,n);break;case 24:Ci(t,n,r,c),f&2048&&Du(n.alternate,n);break;default:Ci(t,n,r,c)}}function Ya(t,n,r,c,f){for(f=f&&(n.subtreeFlags&10256)!==0,n=n.child;n!==null;){var p=t,y=n,S=r,R=c,P=y.flags;switch(y.tag){case 0:case 11:case 15:Ya(p,y,S,R,f),ir(8,y);break;case 23:break;case 22:var H=y.stateNode;y.memoizedState!==null?H._visibility&4?Ya(p,y,S,R,f):ar(p,y):(H._visibility|=4,Ya(p,y,S,R,f)),f&&P&2048&&Ou(y.alternate,y);break;case 24:Ya(p,y,S,R,f),f&&P&2048&&Du(y.alternate,y);break;default:Ya(p,y,S,R,f)}n=n.sibling}}function ar(t,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var r=t,c=n,f=c.flags;switch(c.tag){case 22:ar(r,c),f&2048&&Ou(c.alternate,c);break;case 24:ar(r,c),f&2048&&Du(c.alternate,c);break;default:ar(r,c)}n=n.sibling}}var sr=8192;function Qa(t){if(t.subtreeFlags&sr)for(t=t.child;t!==null;)Hp(t),t=t.sibling}function Hp(t){switch(t.tag){case 26:Qa(t),t.flags&sr&&t.memoizedState!==null&&ak(dn,t.memoizedState,t.memoizedProps);break;case 5:Qa(t);break;case 3:case 4:var n=dn;dn=Jo(t.stateNode.containerInfo),Qa(t),dn=n;break;case 22:t.memoizedState===null&&(n=t.alternate,n!==null&&n.memoizedState!==null?(n=sr,sr=16777216,Qa(t),sr=n):Qa(t));break;default:Qa(t)}}function Fp(t){var n=t.alternate;if(n!==null&&(t=n.child,t!==null)){n.child=null;do n=t.sibling,t.sibling=null,t=n;while(t!==null)}}function rr(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];mt=c,Kp(c,t)}Fp(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Gp(t),t=t.sibling}function Gp(t){switch(t.tag){case 0:case 11:case 15:rr(t),t.flags&2048&&Ti(9,t,t.return);break;case 3:rr(t);break;case 12:rr(t);break;case 22:var n=t.stateNode;t.memoizedState!==null&&n._visibility&4&&(t.return===null||t.return.tag!==13)?(n._visibility&=-5,Lo(t)):rr(t);break;default:rr(t)}}function Lo(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var r=0;r<n.length;r++){var c=n[r];mt=c,Kp(c,t)}Fp(t)}for(t=t.child;t!==null;){switch(n=t,n.tag){case 0:case 11:case 15:Ti(8,n,n.return),Lo(n);break;case 22:r=n.stateNode,r._visibility&4&&(r._visibility&=-5,Lo(n));break;default:Lo(n)}t=t.sibling}}function Kp(t,n){for(;mt!==null;){var r=mt;switch(r.tag){case 0:case 11:case 15:Ti(8,r,n);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var c=r.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Ys(r.memoizedState.cache)}if(c=r.child,c!==null)c.return=r,mt=c;else e:for(r=t;mt!==null;){c=mt;var f=c.sibling,p=c.return;if(jp(c),c===r){mt=null;break e}if(f!==null){f.return=p,mt=f;break e}mt=p}}}function vT(t,n,r,c){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(t,n,r,c){return new vT(t,n,r,c)}function Au(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ei(t,n){var r=t.alternate;return r===null?(r=sn(t.tag,n,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=n,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&31457280,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,n=t.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r.refCleanup=t.refCleanup,r}function Yp(t,n){t.flags&=31457282;var r=t.alternate;return r===null?(t.childLanes=0,t.lanes=n,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,t.type=r.type,n=r.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t}function jo(t,n,r,c,f,p){var y=0;if(c=t,typeof t=="function")Au(t)&&(y=1);else if(typeof t=="string")y=nk(t,r,Tn.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case m:return la(r.children,f,p,n);case h:y=8,f|=24;break;case g:return t=sn(12,r,n,f|2),t.elementType=g,t.lanes=p,t;case E:return t=sn(13,r,n,f),t.elementType=E,t.lanes=p,t;case _:return t=sn(19,r,n,f),t.elementType=_,t.lanes=p,t;case U:return Qp(r,f,p,n);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case v:case k:y=10;break e;case b:y=9;break e;case T:y=11;break e;case x:y=14;break e;case I:y=16,c=null;break e}y=29,r=Error(s(130,t===null?"null":typeof t,"")),c=null}return n=sn(y,r,n,f),n.elementType=t,n.type=c,n.lanes=p,n}function la(t,n,r,c){return t=sn(7,t,c,n),t.lanes=r,t}function Qp(t,n,r,c){t=sn(22,t,c,n),t.elementType=U,t.lanes=r;var f={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var p=f._current;if(p===null)throw Error(s(456));if((f._pendingVisibility&2)===0){var y=fi(p,2);y!==null&&(f._pendingVisibility|=2,Ot(y,p,2))}},attach:function(){var p=f._current;if(p===null)throw Error(s(456));if((f._pendingVisibility&2)!==0){var y=fi(p,2);y!==null&&(f._pendingVisibility&=-3,Ot(y,p,2))}}};return t.stateNode=f,t}function Nu(t,n,r){return t=sn(6,t,null,n),t.lanes=r,t}function Pu(t,n,r){return n=sn(4,t.children!==null?t.children:[],t.key,n),n.lanes=r,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}function Jn(t){t.flags|=4}function Xp(t,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Pg(n)){if(n=tn.current,n!==null&&((we&4194176)===we?En!==null:(we&62914560)!==we&&(we&536870912)===0||n!==En))throw Fs=Il,fm;t.flags|=8192}}function Io(t,n){n!==null&&(t.flags|=4),t.flags&16384&&(n=t.tag!==22?hh():536870912,t.lanes|=n,Ja|=n)}function or(t,n){if(!De)switch(t.tailMode){case"hidden":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Ke(t){var n=t.alternate!==null&&t.alternate.child===t.child,r=0,c=0;if(n)for(var f=t.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags&31457280,c|=f.flags&31457280,f.return=t,f=f.sibling;else for(f=t.child;f!==null;)r|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=t,f=f.sibling;return t.subtreeFlags|=c,t.childLanes=r,n}function yT(t,n,r){var c=n.pendingProps;switch(Ll(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ke(n),null;case 1:return Ke(n),null;case 3:return r=n.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),Kn(ut),Ca(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(zs(n)?Jn(n):t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,un!==null&&(qu(un),un=null))),Ke(n),null;case 26:return r=n.memoizedState,t===null?(Jn(n),r!==null?(Ke(n),Xp(n,r)):(Ke(n),n.flags&=-16777217)):r?r!==t.memoizedState?(Jn(n),Ke(n),Xp(n,r)):(Ke(n),n.flags&=-16777217):(t.memoizedProps!==c&&Jn(n),Ke(n),n.flags&=-16777217),null;case 27:Xr(n),r=ci.current;var f=n.type;if(t!==null&&n.stateNode!=null)t.memoizedProps!==c&&Jn(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ke(n),null}t=Tn.current,zs(n)?um(n):(t=Rg(f,c,r),n.stateNode=t,Jn(n))}return Ke(n),null;case 5:if(Xr(n),r=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&Jn(n);else{if(!c){if(n.stateNode===null)throw Error(s(166));return Ke(n),null}if(t=Tn.current,zs(n))um(n);else{switch(f=Xo(ci.current),t){case 1:t=f.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:t=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":t=f.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":t=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":t=f.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof c.is=="string"?f.createElement("select",{is:c.is}):f.createElement("select"),c.multiple?t.multiple=!0:c.size&&(t.size=c.size);break;default:t=typeof c.is=="string"?f.createElement(r,{is:c.is}):f.createElement(r)}}t[Ct]=n,t[Dt]=c;e:for(f=n.child;f!==null;){if(f.tag===5||f.tag===6)t.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}n.stateNode=t;e:switch(St(t,r,c),r){case"button":case"input":case"select":case"textarea":t=!!c.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Jn(n)}}return Ke(n),n.flags&=-16777217,null;case 6:if(t&&n.stateNode!=null)t.memoizedProps!==c&&Jn(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(s(166));if(t=ci.current,zs(n)){if(t=n.stateNode,r=n.memoizedProps,c=null,f=xt,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}t[Ct]=n,t=!!(t.nodeValue===r||c!==null&&c.suppressHydrationWarning===!0||bg(t.nodeValue,r)),t||$i(n)}else t=Xo(t).createTextNode(c),t[Ct]=n,n.stateNode=t}return Ke(n),null;case 13:if(c=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(f=zs(n),c!==null&&c.dehydrated!==null){if(t===null){if(!f)throw Error(s(318));if(f=n.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(s(317));f[Ct]=n}else qs(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;Ke(n),f=!1}else un!==null&&(qu(un),un=null),f=!0;if(!f)return n.flags&256?(Vn(n),n):(Vn(n),null)}if(Vn(n),(n.flags&128)!==0)return n.lanes=r,n;if(r=c!==null,t=t!==null&&t.memoizedState!==null,r){c=n.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool);var p=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048)}return r!==t&&r&&(n.child.flags|=8192),Io(n,n.updateQueue),Ke(n),null;case 4:return Ca(),t===null&&Wu(n.stateNode.containerInfo),Ke(n),null;case 10:return Kn(n.type),Ke(n),null;case 19:if(at(lt),f=n.memoizedState,f===null)return Ke(n),null;if(c=(n.flags&128)!==0,p=f.rendering,p===null)if(c)or(f,!1);else{if(Je!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(p=To(t),p!==null){for(n.flags|=128,or(f,!1),t=p.updateQueue,n.updateQueue=t,Io(n,t),n.subtreeFlags=0,t=r,r=n.child;r!==null;)Yp(r,t),r=r.sibling;return He(lt,lt.current&1|2),n.child}t=t.sibling}f.tail!==null&&kn()>Bo&&(n.flags|=128,c=!0,or(f,!1),n.lanes=4194304)}else{if(!c)if(t=To(p),t!==null){if(n.flags|=128,c=!0,t=t.updateQueue,n.updateQueue=t,Io(n,t),or(f,!0),f.tail===null&&f.tailMode==="hidden"&&!p.alternate&&!De)return Ke(n),null}else 2*kn()-f.renderingStartTime>Bo&&r!==536870912&&(n.flags|=128,c=!0,or(f,!1),n.lanes=4194304);f.isBackwards?(p.sibling=n.child,n.child=p):(t=f.last,t!==null?t.sibling=p:n.child=p,f.last=p)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=kn(),n.sibling=null,t=lt.current,He(lt,c?t&1|2:t&1),n):(Ke(n),null);case 22:case 23:return Vn(n),zl(),c=n.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(r&536870912)!==0&&(n.flags&128)===0&&(Ke(n),n.subtreeFlags&6&&(n.flags|=8192)):Ke(n),r=n.updateQueue,r!==null&&Io(n,r.retryQueue),r=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==r&&(n.flags|=2048),t!==null&&at(ta),null;case 24:return r=null,t!==null&&(r=t.memoizedState.cache),n.memoizedState.cache!==r&&(n.flags|=2048),Kn(ut),Ke(n),null;case 25:return null}throw Error(s(156,n.tag))}function bT(t,n){switch(Ll(n),n.tag){case 1:return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return Kn(ut),Ca(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 26:case 27:case 5:return Xr(n),null;case 13:if(Vn(n),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(s(340));qs()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return at(lt),null;case 4:return Ca(),null;case 10:return Kn(n.type),null;case 22:case 23:return Vn(n),zl(),t!==null&&at(ta),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 24:return Kn(ut),null;case 25:return null;default:return null}}function Jp(t,n){switch(Ll(n),n.tag){case 3:Kn(ut),Ca();break;case 26:case 27:case 5:Xr(n);break;case 4:Ca();break;case 13:Vn(n);break;case 19:at(lt);break;case 10:Kn(n.type);break;case 22:case 23:Vn(n),zl(),t!==null&&at(ta);break;case 24:Kn(ut)}}var ST={getCacheForType:function(t){var n=Et(ut),r=n.data.get(t);return r===void 0&&(r=t(),n.data.set(t,r)),r}},TT=typeof WeakMap=="function"?WeakMap:Map,Ye=0,qe=null,ke=null,we=0,Ve=0,Ht=null,Zn=!1,Xa=!1,Mu=!1,Wn=0,Je=0,Ri=0,ua=0,Uu=0,rn=0,Ja=0,cr=null,_n=null,Lu=!1,ju=0,Bo=1/0,zo=null,_i=null,qo=!1,da=null,lr=0,Iu=0,Bu=null,ur=0,zu=null;function Ft(){if((Ye&2)!==0&&we!==0)return we&-we;if(Q.T!==null){var t=qa;return t!==0?t:Qu()}return vh()}function Zp(){rn===0&&(rn=(we&536870912)===0||De?fh():536870912);var t=tn.current;return t!==null&&(t.flags|=32),rn}function Ot(t,n,r){(t===qe&&Ve===2||t.cancelPendingCommit!==null)&&(Za(t,0),$n(t,we,rn,!1)),xs(t,r),((Ye&2)===0||t!==qe)&&(t===qe&&((Ye&2)===0&&(ua|=r),Je===4&&$n(t,we,rn,!1)),wn(t))}function Wp(t,n,r){if((Ye&6)!==0)throw Error(s(327));var c=!r&&(n&60)===0&&(n&t.expiredLanes)===0||ws(t,n),f=c?ET(t,n):Fu(t,n,!0),p=c;do{if(f===0){Xa&&!c&&$n(t,n,0,!1);break}else if(f===6)$n(t,n,0,!Zn);else{if(r=t.current.alternate,p&&!kT(r)){f=Fu(t,n,!1),p=!1;continue}if(f===2){if(p=n,t.errorRecoveryDisabledLanes&p)var y=0;else y=t.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){n=y;e:{var S=t;f=cr;var R=S.current.memoizedState.isDehydrated;if(R&&(Za(S,y).flags|=256),y=Fu(S,y,!1),y!==2){if(Mu&&!R){S.errorRecoveryDisabledLanes|=p,ua|=p,f=4;break e}p=_n,_n=f,p!==null&&qu(p)}f=y}if(p=!1,f!==2)continue}}if(f===1){Za(t,0),$n(t,n,0,!0);break}e:{switch(c=t,f){case 0:case 1:throw Error(s(345));case 4:if((n&4194176)===n){$n(c,n,rn,!Zn);break e}break;case 2:_n=null;break;case 3:case 5:break;default:throw Error(s(329))}if(c.finishedWork=r,c.finishedLanes=n,(n&62914560)===n&&(p=ju+300-kn(),10<p)){if($n(c,n,rn,!Zn),$r(c,0)!==0)break e;c.timeoutHandle=kg($p.bind(null,c,r,_n,zo,Lu,n,rn,ua,Ja,Zn,2,-0,0),p);break e}$p(c,r,_n,zo,Lu,n,rn,ua,Ja,Zn,0,-0,0)}}break}while(!0);wn(t)}function qu(t){_n===null?_n=t:_n.push.apply(_n,t)}function $p(t,n,r,c,f,p,y,S,R,P,H,X,j){var V=n.subtreeFlags;if((V&8192||(V&16785408)===16785408)&&(gr={stylesheets:null,count:0,unsuspend:ik},Hp(n),n=sk(),n!==null)){t.cancelPendingCommit=n(rg.bind(null,t,r,c,f,y,S,R,1,X,j)),$n(t,p,y,!P);return}rg(t,r,c,f,y,S,R,H,X,j)}function kT(t){for(var n=t;;){var r=n.tag;if((r===0||r===11||r===15)&&n.flags&16384&&(r=n.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var c=0;c<r.length;c++){var f=r[c],p=f.getSnapshot;f=f.value;try{if(!zt(p(),f))return!1}catch{return!1}}if(r=n.child,n.subtreeFlags&16384&&r!==null)r.return=n,n=r;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function $n(t,n,r,c){n&=~Uu,n&=~ua,t.suspendedLanes|=n,t.pingedLanes&=~n,c&&(t.warmLanes|=n),c=t.expirationTimes;for(var f=n;0<f;){var p=31-Bt(f),y=1<<p;c[p]=-1,f&=~y}r!==0&&mh(t,r,n)}function Vo(){return(Ye&6)===0?(dr(0),!1):!0}function Vu(){if(ke!==null){if(Ve===0)var t=ke.return;else t=ke,Gn=ra=null,Ql(t),Ba=null,Gs=0,t=ke;for(;t!==null;)Jp(t.alternate,t),t=t.return;ke=null}}function Za(t,n){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;r!==-1&&(t.timeoutHandle=-1,qT(r)),r=t.cancelPendingCommit,r!==null&&(t.cancelPendingCommit=null,r()),Vu(),qe=t,ke=r=Ei(t.current,null),we=n,Ve=0,Ht=null,Zn=!1,Xa=ws(t,n),Mu=!1,Ja=rn=Uu=ua=Ri=Je=0,_n=cr=null,Lu=!1,(n&8)!==0&&(n|=n&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=n;0<c;){var f=31-Bt(c),p=1<<f;n|=t[f],c&=~p}return Wn=n,fo(),r}function eg(t,n){Se=null,Q.H=Rn,n===Hs?(n=pm(),Ve=3):n===fm?(n=pm(),Ve=4):Ve=n===hp?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Ht=n,ke===null&&(Je=1,No(t,Wt(n,t.current)))}function tg(){var t=Q.H;return Q.H=Rn,t===null?Rn:t}function ng(){var t=Q.A;return Q.A=ST,t}function Hu(){Je=4,Zn||(we&4194176)!==we&&tn.current!==null||(Xa=!0),(Ri&134217727)===0&&(ua&134217727)===0||qe===null||$n(qe,we,rn,!1)}function Fu(t,n,r){var c=Ye;Ye|=2;var f=tg(),p=ng();(qe!==t||we!==n)&&(zo=null,Za(t,n)),n=!1;var y=Je;e:do try{if(Ve!==0&&ke!==null){var S=ke,R=Ht;switch(Ve){case 8:Vu(),y=6;break e;case 3:case 2:case 6:tn.current===null&&(n=!0);var P=Ve;if(Ve=0,Ht=null,Wa(t,S,R,P),r&&Xa){y=0;break e}break;default:P=Ve,Ve=0,Ht=null,Wa(t,S,R,P)}}CT(),y=Je;break}catch(H){eg(t,H)}while(!0);return n&&t.shellSuspendCounter++,Gn=ra=null,Ye=c,Q.H=f,Q.A=p,ke===null&&(qe=null,we=0,fo()),y}function CT(){for(;ke!==null;)ig(ke)}function ET(t,n){var r=Ye;Ye|=2;var c=tg(),f=ng();qe!==t||we!==n?(zo=null,Bo=kn()+500,Za(t,n)):Xa=ws(t,n);e:do try{if(Ve!==0&&ke!==null){n=ke;var p=Ht;t:switch(Ve){case 1:Ve=0,Ht=null,Wa(t,n,p,1);break;case 2:if(hm(p)){Ve=0,Ht=null,ag(n);break}n=function(){Ve===2&&qe===t&&(Ve=7),wn(t)},p.then(n,n);break e;case 3:Ve=7;break e;case 4:Ve=5;break e;case 7:hm(p)?(Ve=0,Ht=null,ag(n)):(Ve=0,Ht=null,Wa(t,n,p,7));break;case 5:var y=null;switch(ke.tag){case 26:y=ke.memoizedState;case 5:case 27:var S=ke;if(!y||Pg(y)){Ve=0,Ht=null;var R=S.sibling;if(R!==null)ke=R;else{var P=S.return;P!==null?(ke=P,Ho(P)):ke=null}break t}}Ve=0,Ht=null,Wa(t,n,p,5);break;case 6:Ve=0,Ht=null,Wa(t,n,p,6);break;case 8:Vu(),Je=6;break e;default:throw Error(s(462))}}RT();break}catch(H){eg(t,H)}while(!0);return Gn=ra=null,Q.H=c,Q.A=f,Ye=r,ke!==null?0:(qe=null,we=0,fo(),Je)}function RT(){for(;ke!==null&&!Yb();)ig(ke)}function ig(t){var n=Rp(t.alternate,t,Wn);t.memoizedProps=t.pendingProps,n===null?Ho(t):ke=n}function ag(t){var n=t,r=n.alternate;switch(n.tag){case 15:case 0:n=bp(r,n,n.pendingProps,n.type,void 0,we);break;case 11:n=bp(r,n,n.pendingProps,n.type.render,n.ref,we);break;case 5:Ql(n);default:Jp(r,n),n=ke=Yp(n,Wn),n=Rp(r,n,Wn)}t.memoizedProps=t.pendingProps,n===null?Ho(t):ke=n}function Wa(t,n,r,c){Gn=ra=null,Ql(n),Ba=null,Gs=0;var f=n.return;try{if(hT(t,f,n,r,we)){Je=1,No(t,Wt(r,t.current)),ke=null;return}}catch(p){if(f!==null)throw ke=f,p;Je=1,No(t,Wt(r,t.current)),ke=null;return}n.flags&32768?(De||c===1?t=!0:Xa||(we&536870912)!==0?t=!1:(Zn=t=!0,(c===2||c===3||c===6)&&(c=tn.current,c!==null&&c.tag===13&&(c.flags|=16384))),sg(n,t)):Ho(n)}function Ho(t){var n=t;do{if((n.flags&32768)!==0){sg(n,Zn);return}t=n.return;var r=yT(n.alternate,n,Wn);if(r!==null){ke=r;return}if(n=n.sibling,n!==null){ke=n;return}ke=n=t}while(n!==null);Je===0&&(Je=5)}function sg(t,n){do{var r=bT(t.alternate,t);if(r!==null){r.flags&=32767,ke=r;return}if(r=t.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!n&&(t=t.sibling,t!==null)){ke=t;return}ke=t=r}while(t!==null);Je=6,ke=null}function rg(t,n,r,c,f,p,y,S,R,P){var H=Q.T,X=se.p;try{se.p=2,Q.T=null,_T(t,n,r,c,X,f,p,y,S,R,P)}finally{Q.T=H,se.p=X}}function _T(t,n,r,c,f,p,y,S){do $a();while(da!==null);if((Ye&6)!==0)throw Error(s(327));var R=t.finishedWork;if(c=t.finishedLanes,R===null)return null;if(t.finishedWork=null,t.finishedLanes=0,R===t.current)throw Error(s(177));t.callbackNode=null,t.callbackPriority=0,t.cancelPendingCommit=null;var P=R.lanes|R.childLanes;if(P|=Pl,aS(t,c,P,p,y,S),t===qe&&(ke=qe=null,we=0),(R.subtreeFlags&10256)===0&&(R.flags&10256)===0||qo||(qo=!0,Iu=P,Bu=r,DT(Jr,function(){return $a(),null})),r=(R.flags&15990)!==0,(R.subtreeFlags&15990)!==0||r?(r=Q.T,Q.T=null,p=se.p,se.p=2,y=Ye,Ye|=4,pT(t,R),zp(R,t),JS(nd,t.containerInfo),tc=!!td,nd=td=null,t.current=R,Lp(t,R.alternate,R),Qb(),Ye=y,se.p=p,Q.T=r):t.current=R,qo?(qo=!1,da=t,lr=c):og(t,P),P=t.pendingLanes,P===0&&(_i=null),$b(R.stateNode),wn(t),n!==null)for(f=t.onRecoverableError,R=0;R<n.length;R++)P=n[R],f(P.value,{componentStack:P.stack});return(lr&3)!==0&&$a(),P=t.pendingLanes,(c&4194218)!==0&&(P&42)!==0?t===zu?ur++:(ur=0,zu=t):ur=0,dr(0),null}function og(t,n){(t.pooledCacheLanes&=n)===0&&(n=t.pooledCache,n!=null&&(t.pooledCache=null,Ys(n)))}function $a(){if(da!==null){var t=da,n=Iu;Iu=0;var r=gh(lr),c=Q.T,f=se.p;try{if(se.p=32>r?32:r,Q.T=null,da===null)var p=!1;else{r=Bu,Bu=null;var y=da,S=lr;if(da=null,lr=0,(Ye&6)!==0)throw Error(s(331));var R=Ye;if(Ye|=4,Gp(y.current),Vp(y,y.current,S,r),Ye=R,dr(0,!1),It&&typeof It.onPostCommitFiberRoot=="function")try{It.onPostCommitFiberRoot(_s,y)}catch{}p=!0}return p}finally{se.p=f,Q.T=c,og(t,n)}}return!1}function cg(t,n,r){n=Wt(r,n),n=cu(t.stateNode,n,2),t=Si(t,n,2),t!==null&&(xs(t,2),wn(t))}function Ie(t,n,r){if(t.tag===3)cg(t,t,r);else for(;n!==null;){if(n.tag===3){cg(n,t,r);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(_i===null||!_i.has(c))){t=Wt(r,t),r=dp(2),c=Si(n,r,2),c!==null&&(fp(r,c,n,t),xs(c,2),wn(c));break}}n=n.return}}function Gu(t,n,r){var c=t.pingCache;if(c===null){c=t.pingCache=new TT;var f=new Set;c.set(n,f)}else f=c.get(n),f===void 0&&(f=new Set,c.set(n,f));f.has(r)||(Mu=!0,f.add(r),t=wT.bind(null,t,n,r),n.then(t,t))}function wT(t,n,r){var c=t.pingCache;c!==null&&c.delete(n),t.pingedLanes|=t.suspendedLanes&r,t.warmLanes&=~r,qe===t&&(we&r)===r&&(Je===4||Je===3&&(we&62914560)===we&&300>kn()-ju?(Ye&2)===0&&Za(t,0):Uu|=r,Ja===we&&(Ja=0)),wn(t)}function lg(t,n){n===0&&(n=hh()),t=fi(t,n),t!==null&&(xs(t,n),wn(t))}function xT(t){var n=t.memoizedState,r=0;n!==null&&(r=n.retryLane),lg(t,r)}function OT(t,n){var r=0;switch(t.tag){case 13:var c=t.stateNode,f=t.memoizedState;f!==null&&(r=f.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(n),lg(t,r)}function DT(t,n){return ll(t,n)}var Fo=null,es=null,Ku=!1,Go=!1,Yu=!1,fa=0;function wn(t){t!==es&&t.next===null&&(es===null?Fo=es=t:es=es.next=t),Go=!0,Ku||(Ku=!0,NT(AT))}function dr(t,n){if(!Yu&&Go){Yu=!0;do for(var r=!1,c=Fo;c!==null;){if(t!==0){var f=c.pendingLanes;if(f===0)var p=0;else{var y=c.suspendedLanes,S=c.pingedLanes;p=(1<<31-Bt(42|t)+1)-1,p&=f&~(y&~S),p=p&201326677?p&201326677|1:p?p|2:0}p!==0&&(r=!0,fg(c,p))}else p=we,p=$r(c,c===qe?p:0),(p&3)===0||ws(c,p)||(r=!0,fg(c,p));c=c.next}while(r);Yu=!1}}function AT(){Go=Ku=!1;var t=0;fa!==0&&(zT()&&(t=fa),fa=0);for(var n=kn(),r=null,c=Fo;c!==null;){var f=c.next,p=ug(c,n);p===0?(c.next=null,r===null?Fo=f:r.next=f,f===null&&(es=r)):(r=c,(t!==0||(p&3)!==0)&&(Go=!0)),c=f}dr(t)}function ug(t,n){for(var r=t.suspendedLanes,c=t.pingedLanes,f=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var y=31-Bt(p),S=1<<y,R=f[y];R===-1?((S&r)===0||(S&c)!==0)&&(f[y]=iS(S,n)):R<=n&&(t.expiredLanes|=S),p&=~S}if(n=qe,r=we,r=$r(t,t===n?r:0),c=t.callbackNode,r===0||t===n&&Ve===2||t.cancelPendingCommit!==null)return c!==null&&c!==null&&ul(c),t.callbackNode=null,t.callbackPriority=0;if((r&3)===0||ws(t,r)){if(n=r&-r,n===t.callbackPriority)return n;switch(c!==null&&ul(c),gh(r)){case 2:case 8:r=uh;break;case 32:r=Jr;break;case 268435456:r=dh;break;default:r=Jr}return c=dg.bind(null,t),r=ll(r,c),t.callbackPriority=n,t.callbackNode=r,n}return c!==null&&c!==null&&ul(c),t.callbackPriority=2,t.callbackNode=null,2}function dg(t,n){var r=t.callbackNode;if($a()&&t.callbackNode!==r)return null;var c=we;return c=$r(t,t===qe?c:0),c===0?null:(Wp(t,c,n),ug(t,kn()),t.callbackNode!=null&&t.callbackNode===r?dg.bind(null,t):null)}function fg(t,n){if($a())return null;Wp(t,n,!0)}function NT(t){VT(function(){(Ye&6)!==0?ll(lh,t):t()})}function Qu(){return fa===0&&(fa=fh()),fa}function hg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ao(""+t)}function mg(t,n){var r=n.ownerDocument.createElement("input");return r.name=n.name,r.value=n.value,t.id&&r.setAttribute("form",t.id),n.parentNode.insertBefore(r,n),t=new FormData(t),r.parentNode.removeChild(r),t}function PT(t,n,r,c,f){if(n==="submit"&&r&&r.stateNode===f){var p=hg((f[Dt]||null).action),y=c.submitter;y&&(n=(n=y[Dt]||null)?hg(n.formAction):y.getAttribute("formAction"),n!==null&&(p=n,y=null));var S=new co("action","action",null,c,f);t.push({event:S,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(fa!==0){var R=y?mg(f,y):new FormData(f);iu(r,{pending:!0,data:R,method:f.method,action:p},null,R)}}else typeof p=="function"&&(S.preventDefault(),R=y?mg(f,y):new FormData(f),iu(r,{pending:!0,data:R,method:f.method,action:p},p,R))},currentTarget:f}]})}}for(var Xu=0;Xu<rm.length;Xu++){var Ju=rm[Xu],MT=Ju.toLowerCase(),UT=Ju[0].toUpperCase()+Ju.slice(1);ln(MT,"on"+UT)}ln(tm,"onAnimationEnd"),ln(nm,"onAnimationIteration"),ln(im,"onAnimationStart"),ln("dblclick","onDoubleClick"),ln("focusin","onFocus"),ln("focusout","onBlur"),ln(WS,"onTransitionRun"),ln($S,"onTransitionStart"),ln(eT,"onTransitionCancel"),ln(am,"onTransitionEnd"),wa("onMouseEnter",["mouseout","mouseover"]),wa("onMouseLeave",["mouseout","mouseover"]),wa("onPointerEnter",["pointerout","pointerover"]),wa("onPointerLeave",["pointerout","pointerover"]),Yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fr));function pg(t,n){n=(n&4)!==0;for(var r=0;r<t.length;r++){var c=t[r],f=c.event;c=c.listeners;e:{var p=void 0;if(n)for(var y=c.length-1;0<=y;y--){var S=c[y],R=S.instance,P=S.currentTarget;if(S=S.listener,R!==p&&f.isPropagationStopped())break e;p=S,f.currentTarget=P;try{p(f)}catch(H){Ao(H)}f.currentTarget=null,p=R}else for(y=0;y<c.length;y++){if(S=c[y],R=S.instance,P=S.currentTarget,S=S.listener,R!==p&&f.isPropagationStopped())break e;p=S,f.currentTarget=P;try{p(f)}catch(H){Ao(H)}f.currentTarget=null,p=R}}}}function Ce(t,n){var r=n[fl];r===void 0&&(r=n[fl]=new Set);var c=t+"__bubble";r.has(c)||(gg(n,t,2,!1),r.add(c))}function Zu(t,n,r){var c=0;n&&(c|=4),gg(r,t,c,n)}var Ko="_reactListening"+Math.random().toString(36).slice(2);function Wu(t){if(!t[Ko]){t[Ko]=!0,bh.forEach(function(r){r!=="selectionchange"&&(LT.has(r)||Zu(r,!1,t),Zu(r,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[Ko]||(n[Ko]=!0,Zu("selectionchange",!1,n))}}function gg(t,n,r,c){switch(Bg(n)){case 2:var f=ck;break;case 8:f=lk;break;default:f=dd}r=f.bind(null,n,r,t),f=void 0,!Sl||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),c?f!==void 0?t.addEventListener(n,r,{capture:!0,passive:f}):t.addEventListener(n,r,!0):f!==void 0?t.addEventListener(n,r,{passive:f}):t.addEventListener(n,r,!1)}function $u(t,n,r,c,f){var p=c;if((n&1)===0&&(n&2)===0&&c!==null)e:for(;;){if(c===null)return;var y=c.tag;if(y===3||y===4){var S=c.stateNode.containerInfo;if(S===f||S.nodeType===8&&S.parentNode===f)break;if(y===4)for(y=c.return;y!==null;){var R=y.tag;if((R===3||R===4)&&(R=y.stateNode.containerInfo,R===f||R.nodeType===8&&R.parentNode===f))return;y=y.return}for(;S!==null;){if(y=Ki(S),y===null)return;if(R=y.tag,R===5||R===6||R===26||R===27){c=p=y;continue e}S=S.parentNode}}c=c.return}Ah(function(){var P=p,H=yl(r),X=[];e:{var j=sm.get(t);if(j!==void 0){var V=co,oe=t;switch(t){case"keypress":if(ro(r)===0)break e;case"keydown":case"keyup":V=OS;break;case"focusin":oe="focus",V=El;break;case"focusout":oe="blur",V=El;break;case"beforeblur":case"afterblur":V=El;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=Mh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=vS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=NS;break;case tm:case nm:case im:V=SS;break;case am:V=MS;break;case"scroll":case"scrollend":V=pS;break;case"wheel":V=LS;break;case"copy":case"cut":case"paste":V=kS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=Lh;break;case"toggle":case"beforetoggle":V=IS}var pe=(n&4)!==0,Ze=!pe&&(t==="scroll"||t==="scrollend"),M=pe?j!==null?j+"Capture":null:j;pe=[];for(var A=P,L;A!==null;){var G=A;if(L=G.stateNode,G=G.tag,G!==5&&G!==26&&G!==27||L===null||M===null||(G=As(A,M),G!=null&&pe.push(hr(A,G,L))),Ze)break;A=A.return}0<pe.length&&(j=new V(j,oe,null,r,H),X.push({event:j,listeners:pe}))}}if((n&7)===0){e:{if(j=t==="mouseover"||t==="pointerover",V=t==="mouseout"||t==="pointerout",j&&r!==vl&&(oe=r.relatedTarget||r.fromElement)&&(Ki(oe)||oe[Ea]))break e;if((V||j)&&(j=H.window===H?H:(j=H.ownerDocument)?j.defaultView||j.parentWindow:window,V?(oe=r.relatedTarget||r.toElement,V=P,oe=oe?Ki(oe):null,oe!==null&&(Ze=me(oe),pe=oe.tag,oe!==Ze||pe!==5&&pe!==27&&pe!==6)&&(oe=null)):(V=null,oe=P),V!==oe)){if(pe=Mh,G="onMouseLeave",M="onMouseEnter",A="mouse",(t==="pointerout"||t==="pointerover")&&(pe=Lh,G="onPointerLeave",M="onPointerEnter",A="pointer"),Ze=V==null?j:Ds(V),L=oe==null?j:Ds(oe),j=new pe(G,A+"leave",V,r,H),j.target=Ze,j.relatedTarget=L,G=null,Ki(H)===P&&(pe=new pe(M,A+"enter",oe,r,H),pe.target=L,pe.relatedTarget=Ze,G=pe),Ze=G,V&&oe)t:{for(pe=V,M=oe,A=0,L=pe;L;L=ts(L))A++;for(L=0,G=M;G;G=ts(G))L++;for(;0<A-L;)pe=ts(pe),A--;for(;0<L-A;)M=ts(M),L--;for(;A--;){if(pe===M||M!==null&&pe===M.alternate)break t;pe=ts(pe),M=ts(M)}pe=null}else pe=null;V!==null&&vg(X,j,V,pe,!1),oe!==null&&Ze!==null&&vg(X,Ze,oe,pe,!0)}}e:{if(j=P?Ds(P):window,V=j.nodeName&&j.nodeName.toLowerCase(),V==="select"||V==="input"&&j.type==="file")var re=Fh;else if(Vh(j))if(Gh)re=QS;else{re=KS;var Te=GS}else V=j.nodeName,!V||V.toLowerCase()!=="input"||j.type!=="checkbox"&&j.type!=="radio"?P&&gl(P.elementType)&&(re=Fh):re=YS;if(re&&(re=re(t,P))){Hh(X,re,r,H);break e}Te&&Te(t,j,P),t==="focusout"&&P&&j.type==="number"&&P.memoizedProps.value!=null&&pl(j,"number",j.value)}switch(Te=P?Ds(P):window,t){case"focusin":(Vh(Te)||Te.contentEditable==="true")&&(Pa=Te,Dl=P,Bs=null);break;case"focusout":Bs=Dl=Pa=null;break;case"mousedown":Al=!0;break;case"contextmenu":case"mouseup":case"dragend":Al=!1,$h(X,r,H);break;case"selectionchange":if(ZS)break;case"keydown":case"keyup":$h(X,r,H)}var ce;if(_l)e:{switch(t){case"compositionstart":var fe="onCompositionStart";break e;case"compositionend":fe="onCompositionEnd";break e;case"compositionupdate":fe="onCompositionUpdate";break e}fe=void 0}else Na?zh(t,r)&&(fe="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(fe="onCompositionStart");fe&&(jh&&r.locale!=="ko"&&(Na||fe!=="onCompositionStart"?fe==="onCompositionEnd"&&Na&&(ce=Nh()):(di=H,Tl="value"in di?di.value:di.textContent,Na=!0)),Te=Yo(P,fe),0<Te.length&&(fe=new Uh(fe,t,null,r,H),X.push({event:fe,listeners:Te}),ce?fe.data=ce:(ce=qh(r),ce!==null&&(fe.data=ce)))),(ce=zS?qS(t,r):VS(t,r))&&(fe=Yo(P,"onBeforeInput"),0<fe.length&&(Te=new Uh("onBeforeInput","beforeinput",null,r,H),X.push({event:Te,listeners:fe}),Te.data=ce)),PT(X,t,P,r,H)}pg(X,n)})}function hr(t,n,r){return{instance:t,listener:n,currentTarget:r}}function Yo(t,n){for(var r=n+"Capture",c=[];t!==null;){var f=t,p=f.stateNode;f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=As(t,r),f!=null&&c.unshift(hr(t,f,p)),f=As(t,n),f!=null&&c.push(hr(t,f,p))),t=t.return}return c}function ts(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function vg(t,n,r,c,f){for(var p=n._reactName,y=[];r!==null&&r!==c;){var S=r,R=S.alternate,P=S.stateNode;if(S=S.tag,R!==null&&R===c)break;S!==5&&S!==26&&S!==27||P===null||(R=P,f?(P=As(r,p),P!=null&&y.unshift(hr(r,P,R))):f||(P=As(r,p),P!=null&&y.push(hr(r,P,R)))),r=r.return}y.length!==0&&t.push({event:n,listeners:y})}var jT=/\r\n?/g,IT=/\u0000|\uFFFD/g;function yg(t){return(typeof t=="string"?t:""+t).replace(jT,`
`).replace(IT,"")}function bg(t,n){return n=yg(n),yg(t)===n}function Qo(){}function Le(t,n,r,c,f,p){switch(r){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||Oa(t,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&Oa(t,""+c);break;case"className":to(t,"class",c);break;case"tabIndex":to(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":to(t,r,c);break;case"style":Oh(t,c,p);break;case"data":if(n!=="object"){to(t,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||r!=="href")){t.removeAttribute(r);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=ao(""+c),t.setAttribute(r,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(r==="formAction"?(n!=="input"&&Le(t,n,"name",f.name,f,null),Le(t,n,"formEncType",f.formEncType,f,null),Le(t,n,"formMethod",f.formMethod,f,null),Le(t,n,"formTarget",f.formTarget,f,null)):(Le(t,n,"encType",f.encType,f,null),Le(t,n,"method",f.method,f,null),Le(t,n,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(r);break}c=ao(""+c),t.setAttribute(r,c);break;case"onClick":c!=null&&(t.onclick=Qo);break;case"onScroll":c!=null&&Ce("scroll",t);break;case"onScrollEnd":c!=null&&Ce("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}r=ao(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""+c):t.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,""):t.removeAttribute(r);break;case"capture":case"download":c===!0?t.setAttribute(r,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(r,c):t.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(r,c):t.removeAttribute(r);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(r):t.setAttribute(r,c);break;case"popover":Ce("beforetoggle",t),Ce("toggle",t),eo(t,"popover",c);break;case"xlinkActuate":Bn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Bn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Bn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Bn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Bn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Bn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Bn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Bn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Bn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":eo(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=hS.get(r)||r,eo(t,r,c))}}function ed(t,n,r,c,f,p){switch(r){case"style":Oh(t,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(r=c.__html,r!=null){if(f.children!=null)throw Error(s(60));t.innerHTML=r}}break;case"children":typeof c=="string"?Oa(t,c):(typeof c=="number"||typeof c=="bigint")&&Oa(t,""+c);break;case"onScroll":c!=null&&Ce("scroll",t);break;case"onScrollEnd":c!=null&&Ce("scrollend",t);break;case"onClick":c!=null&&(t.onclick=Qo);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Sh.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),n=r.slice(2,f?r.length-7:void 0),p=t[Dt]||null,p=p!=null?p[r]:null,typeof p=="function"&&t.removeEventListener(n,p,f),typeof c=="function")){typeof p!="function"&&p!==null&&(r in t?t[r]=null:t.hasAttribute(r)&&t.removeAttribute(r)),t.addEventListener(n,c,f);break e}r in t?t[r]=c:c===!0?t.setAttribute(r,""):eo(t,r,c)}}}function St(t,n,r){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ce("error",t),Ce("load",t);var c=!1,f=!1,p;for(p in r)if(r.hasOwnProperty(p)){var y=r[p];if(y!=null)switch(p){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Le(t,n,p,y,r,null)}}f&&Le(t,n,"srcSet",r.srcSet,r,null),c&&Le(t,n,"src",r.src,r,null);return;case"input":Ce("invalid",t);var S=p=y=f=null,R=null,P=null;for(c in r)if(r.hasOwnProperty(c)){var H=r[c];if(H!=null)switch(c){case"name":f=H;break;case"type":y=H;break;case"checked":R=H;break;case"defaultChecked":P=H;break;case"value":p=H;break;case"defaultValue":S=H;break;case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(s(137,n));break;default:Le(t,n,c,H,r,null)}}Rh(t,p,S,R,P,y,f,!1),no(t);return;case"select":Ce("invalid",t),c=y=p=null;for(f in r)if(r.hasOwnProperty(f)&&(S=r[f],S!=null))switch(f){case"value":p=S;break;case"defaultValue":y=S;break;case"multiple":c=S;default:Le(t,n,f,S,r,null)}n=p,r=y,t.multiple=!!c,n!=null?xa(t,!!c,n,!1):r!=null&&xa(t,!!c,r,!0);return;case"textarea":Ce("invalid",t),p=f=c=null;for(y in r)if(r.hasOwnProperty(y)&&(S=r[y],S!=null))switch(y){case"value":c=S;break;case"defaultValue":f=S;break;case"children":p=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(s(91));break;default:Le(t,n,y,S,r,null)}wh(t,c,f,p),no(t);return;case"option":for(R in r)if(r.hasOwnProperty(R)&&(c=r[R],c!=null))switch(R){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Le(t,n,R,c,r,null)}return;case"dialog":Ce("cancel",t),Ce("close",t);break;case"iframe":case"object":Ce("load",t);break;case"video":case"audio":for(c=0;c<fr.length;c++)Ce(fr[c],t);break;case"image":Ce("error",t),Ce("load",t);break;case"details":Ce("toggle",t);break;case"embed":case"source":case"link":Ce("error",t),Ce("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(P in r)if(r.hasOwnProperty(P)&&(c=r[P],c!=null))switch(P){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,n));default:Le(t,n,P,c,r,null)}return;default:if(gl(n)){for(H in r)r.hasOwnProperty(H)&&(c=r[H],c!==void 0&&ed(t,n,H,c,r,void 0));return}}for(S in r)r.hasOwnProperty(S)&&(c=r[S],c!=null&&Le(t,n,S,c,r,null))}function BT(t,n,r,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,y=null,S=null,R=null,P=null,H=null;for(V in r){var X=r[V];if(r.hasOwnProperty(V)&&X!=null)switch(V){case"checked":break;case"value":break;case"defaultValue":R=X;default:c.hasOwnProperty(V)||Le(t,n,V,null,c,X)}}for(var j in c){var V=c[j];if(X=r[j],c.hasOwnProperty(j)&&(V!=null||X!=null))switch(j){case"type":p=V;break;case"name":f=V;break;case"checked":P=V;break;case"defaultChecked":H=V;break;case"value":y=V;break;case"defaultValue":S=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(s(137,n));break;default:V!==X&&Le(t,n,j,V,c,X)}}ml(t,y,S,R,P,H,p,f);return;case"select":V=y=S=j=null;for(p in r)if(R=r[p],r.hasOwnProperty(p)&&R!=null)switch(p){case"value":break;case"multiple":V=R;default:c.hasOwnProperty(p)||Le(t,n,p,null,c,R)}for(f in c)if(p=c[f],R=r[f],c.hasOwnProperty(f)&&(p!=null||R!=null))switch(f){case"value":j=p;break;case"defaultValue":S=p;break;case"multiple":y=p;default:p!==R&&Le(t,n,f,p,c,R)}n=S,r=y,c=V,j!=null?xa(t,!!r,j,!1):!!c!=!!r&&(n!=null?xa(t,!!r,n,!0):xa(t,!!r,r?[]:"",!1));return;case"textarea":V=j=null;for(S in r)if(f=r[S],r.hasOwnProperty(S)&&f!=null&&!c.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Le(t,n,S,null,c,f)}for(y in c)if(f=c[y],p=r[y],c.hasOwnProperty(y)&&(f!=null||p!=null))switch(y){case"value":j=f;break;case"defaultValue":V=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(s(91));break;default:f!==p&&Le(t,n,y,f,c,p)}_h(t,j,V);return;case"option":for(var oe in r)if(j=r[oe],r.hasOwnProperty(oe)&&j!=null&&!c.hasOwnProperty(oe))switch(oe){case"selected":t.selected=!1;break;default:Le(t,n,oe,null,c,j)}for(R in c)if(j=c[R],V=r[R],c.hasOwnProperty(R)&&j!==V&&(j!=null||V!=null))switch(R){case"selected":t.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:Le(t,n,R,j,c,V)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pe in r)j=r[pe],r.hasOwnProperty(pe)&&j!=null&&!c.hasOwnProperty(pe)&&Le(t,n,pe,null,c,j);for(P in c)if(j=c[P],V=r[P],c.hasOwnProperty(P)&&j!==V&&(j!=null||V!=null))switch(P){case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(s(137,n));break;default:Le(t,n,P,j,c,V)}return;default:if(gl(n)){for(var Ze in r)j=r[Ze],r.hasOwnProperty(Ze)&&j!==void 0&&!c.hasOwnProperty(Ze)&&ed(t,n,Ze,void 0,c,j);for(H in c)j=c[H],V=r[H],!c.hasOwnProperty(H)||j===V||j===void 0&&V===void 0||ed(t,n,H,j,c,V);return}}for(var M in r)j=r[M],r.hasOwnProperty(M)&&j!=null&&!c.hasOwnProperty(M)&&Le(t,n,M,null,c,j);for(X in c)j=c[X],V=r[X],!c.hasOwnProperty(X)||j===V||j==null&&V==null||Le(t,n,X,j,c,V)}var td=null,nd=null;function Xo(t){return t.nodeType===9?t:t.ownerDocument}function Sg(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tg(t,n){if(t===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&n==="foreignObject"?0:t}function id(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var ad=null;function zT(){var t=window.event;return t&&t.type==="popstate"?t===ad?!1:(ad=t,!0):(ad=null,!1)}var kg=typeof setTimeout=="function"?setTimeout:void 0,qT=typeof clearTimeout=="function"?clearTimeout:void 0,Cg=typeof Promise=="function"?Promise:void 0,VT=typeof queueMicrotask=="function"?queueMicrotask:typeof Cg<"u"?function(t){return Cg.resolve(null).then(t).catch(HT)}:kg;function HT(t){setTimeout(function(){throw t})}function sd(t,n){var r=n,c=0;do{var f=r.nextSibling;if(t.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"){if(c===0){t.removeChild(f),Tr(n);return}c--}else r!=="$"&&r!=="$?"&&r!=="$!"||c++;r=f}while(r);Tr(n)}function rd(t){var n=t.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var r=n;switch(n=n.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":rd(r),hl(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}t.removeChild(r)}}function FT(t,n,r,c){for(;t.nodeType===1;){var f=r;if(t.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Os])switch(n){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==f.rel||t.getAttribute("href")!==(f.href==null?null:f.href)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||t.getAttribute("title")!==(f.title==null?null:f.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(f.src==null?null:f.src)||t.getAttribute("type")!==(f.type==null?null:f.type)||t.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(n==="input"&&t.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=fn(t.nextSibling),t===null)break}return null}function GT(t,n,r){if(n==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=fn(t.nextSibling),t===null))return null;return t}function fn(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?"||n==="F!"||n==="F")break;if(n==="/$")return null}}return t}function Eg(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(n===0)return t;n--}else r==="/$"&&n++}t=t.previousSibling}return null}function Rg(t,n,r){switch(n=Xo(r),t){case"html":if(t=n.documentElement,!t)throw Error(s(452));return t;case"head":if(t=n.head,!t)throw Error(s(453));return t;case"body":if(t=n.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}var on=new Map,_g=new Set;function Jo(t){return typeof t.getRootNode=="function"?t.getRootNode():t.ownerDocument}var ei=se.d;se.d={f:KT,r:YT,D:QT,C:XT,L:JT,m:ZT,X:$T,S:WT,M:ek};function KT(){var t=ei.f(),n=Vo();return t||n}function YT(t){var n=Ra(t);n!==null&&n.tag===5&&n.type==="form"?$m(n):ei.r(t)}var ns=typeof document>"u"?null:document;function wg(t,n,r){var c=ns;if(c&&typeof n=="string"&&n){var f=Jt(n);f='link[rel="'+t+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),_g.has(f)||(_g.add(f),t={rel:t,crossOrigin:r,href:n},c.querySelector(f)===null&&(n=c.createElement("link"),St(n,"link",t),ft(n),c.head.appendChild(n)))}}function QT(t){ei.D(t),wg("dns-prefetch",t,null)}function XT(t,n){ei.C(t,n),wg("preconnect",t,n)}function JT(t,n,r){ei.L(t,n,r);var c=ns;if(c&&t&&n){var f='link[rel="preload"][as="'+Jt(n)+'"]';n==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+Jt(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+Jt(r.imageSizes)+'"]')):f+='[href="'+Jt(t)+'"]';var p=f;switch(n){case"style":p=is(t);break;case"script":p=as(t)}on.has(p)||(t=ee({rel:"preload",href:n==="image"&&r&&r.imageSrcSet?void 0:t,as:n},r),on.set(p,t),c.querySelector(f)!==null||n==="style"&&c.querySelector(mr(p))||n==="script"&&c.querySelector(pr(p))||(n=c.createElement("link"),St(n,"link",t),ft(n),c.head.appendChild(n)))}}function ZT(t,n){ei.m(t,n);var r=ns;if(r&&t){var c=n&&typeof n.as=="string"?n.as:"script",f='link[rel="modulepreload"][as="'+Jt(c)+'"][href="'+Jt(t)+'"]',p=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=as(t)}if(!on.has(p)&&(t=ee({rel:"modulepreload",href:t},n),on.set(p,t),r.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(pr(p)))return}c=r.createElement("link"),St(c,"link",t),ft(c),r.head.appendChild(c)}}}function WT(t,n,r){ei.S(t,n,r);var c=ns;if(c&&t){var f=_a(c).hoistableStyles,p=is(t);n=n||"default";var y=f.get(p);if(!y){var S={loading:0,preload:null};if(y=c.querySelector(mr(p)))S.loading=5;else{t=ee({rel:"stylesheet",href:t,"data-precedence":n},r),(r=on.get(p))&&od(t,r);var R=y=c.createElement("link");ft(R),St(R,"link",t),R._p=new Promise(function(P,H){R.onload=P,R.onerror=H}),R.addEventListener("load",function(){S.loading|=1}),R.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Zo(y,n,c)}y={type:"stylesheet",instance:y,count:1,state:S},f.set(p,y)}}}function $T(t,n){ei.X(t,n);var r=ns;if(r&&t){var c=_a(r).hoistableScripts,f=as(t),p=c.get(f);p||(p=r.querySelector(pr(f)),p||(t=ee({src:t,async:!0},n),(n=on.get(f))&&cd(t,n),p=r.createElement("script"),ft(p),St(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function ek(t,n){ei.M(t,n);var r=ns;if(r&&t){var c=_a(r).hoistableScripts,f=as(t),p=c.get(f);p||(p=r.querySelector(pr(f)),p||(t=ee({src:t,async:!0,type:"module"},n),(n=on.get(f))&&cd(t,n),p=r.createElement("script"),ft(p),St(p,"link",t),r.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function xg(t,n,r,c){var f=(f=ci.current)?Jo(f):null;if(!f)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(n=is(r.href),r=_a(f).hoistableStyles,c=r.get(n),c||(c={type:"style",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){t=is(r.href);var p=_a(f).hoistableStyles,y=p.get(t);if(y||(f=f.ownerDocument||f,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,y),(p=f.querySelector(mr(t)))&&!p._p&&(y.instance=p,y.state.loading=5),on.has(t)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},on.set(t,r),p||tk(f,t,r,y.state))),n&&c===null)throw Error(s(528,""));return y}if(n&&c!==null)throw Error(s(529,""));return null;case"script":return n=r.async,r=r.src,typeof r=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=as(r),r=_a(f).hoistableScripts,c=r.get(n),c||(c={type:"script",instance:null,count:0,state:null},r.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function is(t){return'href="'+Jt(t)+'"'}function mr(t){return'link[rel="stylesheet"]['+t+"]"}function Og(t){return ee({},t,{"data-precedence":t.precedence,precedence:null})}function tk(t,n,r,c){t.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=t.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),St(n,"link",r),ft(n),t.head.appendChild(n))}function as(t){return'[src="'+Jt(t)+'"]'}function pr(t){return"script[async]"+t}function Dg(t,n,r){if(n.count++,n.instance===null)switch(n.type){case"style":var c=t.querySelector('style[data-href~="'+Jt(r.href)+'"]');if(c)return n.instance=c,ft(c),c;var f=ee({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),ft(c),St(c,"style",f),Zo(c,r.precedence,t),n.instance=c;case"stylesheet":f=is(r.href);var p=t.querySelector(mr(f));if(p)return n.state.loading|=4,n.instance=p,ft(p),p;c=Og(r),(f=on.get(f))&&od(c,f),p=(t.ownerDocument||t).createElement("link"),ft(p);var y=p;return y._p=new Promise(function(S,R){y.onload=S,y.onerror=R}),St(p,"link",c),n.state.loading|=4,Zo(p,r.precedence,t),n.instance=p;case"script":return p=as(r.src),(f=t.querySelector(pr(p)))?(n.instance=f,ft(f),f):(c=r,(f=on.get(p))&&(c=ee({},r),cd(c,f)),t=t.ownerDocument||t,f=t.createElement("script"),ft(f),St(f,"link",c),t.head.appendChild(f),n.instance=f);case"void":return null;default:throw Error(s(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,Zo(c,r.precedence,t));return n.instance}function Zo(t,n,r){for(var c=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,p=f,y=0;y<c.length;y++){var S=c[y];if(S.dataset.precedence===n)p=S;else if(p!==f)break}p?p.parentNode.insertBefore(t,p.nextSibling):(n=r.nodeType===9?r.head:r,n.insertBefore(t,n.firstChild))}function od(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.title==null&&(t.title=n.title)}function cd(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.integrity==null&&(t.integrity=n.integrity)}var Wo=null;function Ag(t,n,r){if(Wo===null){var c=new Map,f=Wo=new Map;f.set(r,c)}else f=Wo,c=f.get(r),c||(c=new Map,f.set(r,c));if(c.has(t))return c;for(c.set(t,null),r=r.getElementsByTagName(t),f=0;f<r.length;f++){var p=r[f];if(!(p[Os]||p[Ct]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var y=p.getAttribute(n)||"";y=t+y;var S=c.get(y);S?S.push(p):c.set(y,[p])}}return c}function Ng(t,n,r){t=t.ownerDocument||t,t.head.insertBefore(r,n==="title"?t.querySelector("head > title"):null)}function nk(t,n,r){if(r===1||n.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;switch(n.rel){case"stylesheet":return t=n.disabled,typeof n.precedence=="string"&&t==null;default:return!0}case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function Pg(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}var gr=null;function ik(){}function ak(t,n,r){if(gr===null)throw Error(s(475));var c=gr;if(n.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var f=is(r.href),p=t.querySelector(mr(f));if(p){t=p._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(c.count++,c=$o.bind(c),t.then(c,c)),n.state.loading|=4,n.instance=p,ft(p);return}p=t.ownerDocument||t,r=Og(r),(f=on.get(f))&&od(r,f),p=p.createElement("link"),ft(p);var y=p;y._p=new Promise(function(S,R){y.onload=S,y.onerror=R}),St(p,"link",r),n.instance=p}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(c.count++,n=$o.bind(c),t.addEventListener("load",n),t.addEventListener("error",n))}}function sk(){if(gr===null)throw Error(s(475));var t=gr;return t.stylesheets&&t.count===0&&ld(t,t.stylesheets),0<t.count?function(n){var r=setTimeout(function(){if(t.stylesheets&&ld(t,t.stylesheets),t.unsuspend){var c=t.unsuspend;t.unsuspend=null,c()}},6e4);return t.unsuspend=n,function(){t.unsuspend=null,clearTimeout(r)}}:null}function $o(){if(this.count--,this.count===0){if(this.stylesheets)ld(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ec=null;function ld(t,n){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ec=new Map,n.forEach(rk,t),ec=null,$o.call(t))}function rk(t,n){if(!(n.state.loading&4)){var r=ec.get(t);if(r)var c=r.get(null);else{r=new Map,ec.set(t,r);for(var f=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var y=f[p];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(r.set(y.dataset.precedence,y),c=y)}c&&r.set(null,c)}f=n.instance,y=f.getAttribute("data-precedence"),p=r.get(y)||c,p===c&&r.set(null,f),r.set(y,f),this.count++,c=$o.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),p?p.parentNode.insertBefore(f,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(f,t.firstChild)),n.state.loading|=4}}var vr={$$typeof:k,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function ok(t,n,r,c,f,p,y,S){this.tag=1,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dl(0),this.hiddenUpdates=dl(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=S,this.incompleteTransitions=new Map}function Mg(t,n,r,c,f,p,y,S,R,P,H,X){return t=new ok(t,n,r,y,S,R,P,X),n=1,p===!0&&(n|=24),p=sn(3,null,null,n),t.current=p,p.stateNode=t,n=ql(),n.refCount++,t.pooledCache=n,n.refCount++,p.memoizedState={element:c,isDehydrated:r,cache:n},Tu(p),t}function Ug(t){return t?(t=La,t):La}function Lg(t,n,r,c,f,p){f=Ug(f),c.context===null?c.context=f:c.pendingContext=f,c=bi(n),c.payload={element:r},p=p===void 0?null:p,p!==null&&(c.callback=p),r=Si(t,c,n),r!==null&&(Ot(r,t,n),er(r,t,n))}function jg(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<n?r:n}}function ud(t,n){jg(t,n),(t=t.alternate)&&jg(t,n)}function Ig(t){if(t.tag===13){var n=fi(t,67108864);n!==null&&Ot(n,t,67108864),ud(t,67108864)}}var tc=!0;function ck(t,n,r,c){var f=Q.T;Q.T=null;var p=se.p;try{se.p=2,dd(t,n,r,c)}finally{se.p=p,Q.T=f}}function lk(t,n,r,c){var f=Q.T;Q.T=null;var p=se.p;try{se.p=8,dd(t,n,r,c)}finally{se.p=p,Q.T=f}}function dd(t,n,r,c){if(tc){var f=fd(c);if(f===null)$u(t,n,c,nc,r),zg(t,c);else if(dk(f,t,n,r,c))c.stopPropagation();else if(zg(t,c),n&4&&-1<uk.indexOf(t)){for(;f!==null;){var p=Ra(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var y=Gi(p.pendingLanes);if(y!==0){var S=p;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var R=1<<31-Bt(y);S.entanglements[1]|=R,y&=~R}wn(p),(Ye&6)===0&&(Bo=kn()+500,dr(0))}}break;case 13:S=fi(p,2),S!==null&&Ot(S,p,2),Vo(),ud(p,2)}if(p=fd(c),p===null&&$u(t,n,c,nc,r),p===f)break;f=p}f!==null&&c.stopPropagation()}else $u(t,n,c,null,r)}}function fd(t){return t=yl(t),hd(t)}var nc=null;function hd(t){if(nc=null,t=Ki(t),t!==null){var n=me(t);if(n===null)t=null;else{var r=n.tag;if(r===13){if(t=ze(n),t!==null)return t;t=null}else if(r===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null)}}return nc=t,null}function Bg(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xb()){case lh:return 2;case uh:return 8;case Jr:case Jb:return 32;case dh:return 268435456;default:return 32}default:return 32}}var md=!1,wi=null,xi=null,Oi=null,yr=new Map,br=new Map,Di=[],uk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zg(t,n){switch(t){case"focusin":case"focusout":wi=null;break;case"dragenter":case"dragleave":xi=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":yr.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":br.delete(n.pointerId)}}function Sr(t,n,r,c,f,p){return t===null||t.nativeEvent!==p?(t={blockedOn:n,domEventName:r,eventSystemFlags:c,nativeEvent:p,targetContainers:[f]},n!==null&&(n=Ra(n),n!==null&&Ig(n)),t):(t.eventSystemFlags|=c,n=t.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),t)}function dk(t,n,r,c,f){switch(n){case"focusin":return wi=Sr(wi,t,n,r,c,f),!0;case"dragenter":return xi=Sr(xi,t,n,r,c,f),!0;case"mouseover":return Oi=Sr(Oi,t,n,r,c,f),!0;case"pointerover":var p=f.pointerId;return yr.set(p,Sr(yr.get(p)||null,t,n,r,c,f)),!0;case"gotpointercapture":return p=f.pointerId,br.set(p,Sr(br.get(p)||null,t,n,r,c,f)),!0}return!1}function qg(t){var n=Ki(t.target);if(n!==null){var r=me(n);if(r!==null){if(n=r.tag,n===13){if(n=ze(r),n!==null){t.blockedOn=n,sS(t.priority,function(){if(r.tag===13){var c=Ft(),f=fi(r,c);f!==null&&Ot(f,r,c),ud(r,c)}});return}}else if(n===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ic(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var r=fd(t.nativeEvent);if(r===null){r=t.nativeEvent;var c=new r.constructor(r.type,r);vl=c,r.target.dispatchEvent(c),vl=null}else return n=Ra(r),n!==null&&Ig(n),t.blockedOn=r,!1;n.shift()}return!0}function Vg(t,n,r){ic(t)&&r.delete(n)}function fk(){md=!1,wi!==null&&ic(wi)&&(wi=null),xi!==null&&ic(xi)&&(xi=null),Oi!==null&&ic(Oi)&&(Oi=null),yr.forEach(Vg),br.forEach(Vg)}function ac(t,n){t.blockedOn===n&&(t.blockedOn=null,md||(md=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,fk)))}var sc=null;function Hg(t){sc!==t&&(sc=t,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){sc===t&&(sc=null);for(var n=0;n<t.length;n+=3){var r=t[n],c=t[n+1],f=t[n+2];if(typeof c!="function"){if(hd(c||r)===null)continue;break}var p=Ra(r);p!==null&&(t.splice(n,3),n-=3,iu(p,{pending:!0,data:f,method:r.method,action:c},c,f))}}))}function Tr(t){function n(R){return ac(R,t)}wi!==null&&ac(wi,t),xi!==null&&ac(xi,t),Oi!==null&&ac(Oi,t),yr.forEach(n),br.forEach(n);for(var r=0;r<Di.length;r++){var c=Di[r];c.blockedOn===t&&(c.blockedOn=null)}for(;0<Di.length&&(r=Di[0],r.blockedOn===null);)qg(r),r.blockedOn===null&&Di.shift();if(r=(t.ownerDocument||t).$$reactFormReplay,r!=null)for(c=0;c<r.length;c+=3){var f=r[c],p=r[c+1],y=f[Dt]||null;if(typeof p=="function")y||Hg(r);else if(y){var S=null;if(p&&p.hasAttribute("formAction")){if(f=p,y=p[Dt]||null)S=y.formAction;else if(hd(f)!==null)continue}else S=y.action;typeof S=="function"?r[c+1]=S:(r.splice(c,3),c-=3),Hg(r)}}}function pd(t){this._internalRoot=t}rc.prototype.render=pd.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(s(409));var r=n.current,c=Ft();Lg(r,c,t,n,null,null)},rc.prototype.unmount=pd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;t.tag===0&&$a(),Lg(t.current,2,null,t,null,null),Vo(),n[Ea]=null}};function rc(t){this._internalRoot=t}rc.prototype.unstable_scheduleHydration=function(t){if(t){var n=vh();t={blockedOn:null,target:t,priority:n};for(var r=0;r<Di.length&&n!==0&&n<Di[r].priority;r++);Di.splice(r,0,t),r===0&&qg(t)}};var Fg=e.version;if(Fg!=="19.0.0")throw Error(s(527,Fg,"19.0.0"));se.findDOMNode=function(t){var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=Z(n),t=t!==null?he(t):null,t=t===null?null:t.stateNode,t};var hk={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,findFiberByHostInstance:Ki,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{_s=oc.inject(hk),It=oc}catch{}}return Cr.createRoot=function(t,n){if(!o(t))throw Error(s(299));var r=!1,c="",f=op,p=cp,y=lp,S=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(p=n.onCaughtError),n.onRecoverableError!==void 0&&(y=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(S=n.unstable_transitionCallbacks)),n=Mg(t,1,!1,null,null,r,c,f,p,y,S,null),t[Ea]=n.current,Wu(t.nodeType===8?t.parentNode:t),new pd(n)},Cr.hydrateRoot=function(t,n,r){if(!o(t))throw Error(s(299));var c=!1,f="",p=op,y=cp,S=lp,R=null,P=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(S=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(R=r.unstable_transitionCallbacks),r.formState!==void 0&&(P=r.formState)),n=Mg(t,1,!0,n,r??null,c,f,p,y,S,R,P),n.context=Ug(null),r=n.current,c=Ft(),f=bi(c),f.callback=null,Si(r,f,c),n.current.lanes=c,xs(n,c),wn(n),t[Ea]=n.current,Wu(t),new rc(n)},Cr.version="19.0.0",Cr}var ev;function Rk(){if(ev)return yd.exports;ev=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),yd.exports=Ek(),yd.exports}var _k=Rk(),Er={},tv;function wk(){if(tv)return Er;tv=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.parse=u,Er.serialize=h;const a=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,l=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function u(b,k){const T=new l,E=b.length;if(E<2)return T;const _=(k==null?void 0:k.decode)||g;let x=0;do{const I=b.indexOf("=",x);if(I===-1)break;const U=b.indexOf(";",x),N=U===-1?E:U;if(I>N){x=b.lastIndexOf(";",I-1)+1;continue}const w=d(b,x,I),F=m(b,I,w),J=b.slice(w,F);if(T[J]===void 0){let ne=d(b,I+1,N),Q=m(b,N,ne);const ee=_(b.slice(ne,Q));T[J]=ee}x=N+1}while(x<E);return T}function d(b,k,T){do{const E=b.charCodeAt(k);if(E!==32&&E!==9)return k}while(++k<T);return T}function m(b,k,T){for(;k>T;){const E=b.charCodeAt(--k);if(E!==32&&E!==9)return k+1}return T}function h(b,k,T){const E=(T==null?void 0:T.encode)||encodeURIComponent;if(!a.test(b))throw new TypeError(`argument name is invalid: ${b}`);const _=E(k);if(!e.test(_))throw new TypeError(`argument val is invalid: ${k}`);let x=b+"="+_;if(!T)return x;if(T.maxAge!==void 0){if(!Number.isInteger(T.maxAge))throw new TypeError(`option maxAge is invalid: ${T.maxAge}`);x+="; Max-Age="+T.maxAge}if(T.domain){if(!i.test(T.domain))throw new TypeError(`option domain is invalid: ${T.domain}`);x+="; Domain="+T.domain}if(T.path){if(!s.test(T.path))throw new TypeError(`option path is invalid: ${T.path}`);x+="; Path="+T.path}if(T.expires){if(!v(T.expires)||!Number.isFinite(T.expires.valueOf()))throw new TypeError(`option expires is invalid: ${T.expires}`);x+="; Expires="+T.expires.toUTCString()}if(T.httpOnly&&(x+="; HttpOnly"),T.secure&&(x+="; Secure"),T.partitioned&&(x+="; Partitioned"),T.priority)switch(typeof T.priority=="string"?T.priority.toLowerCase():void 0){case"low":x+="; Priority=Low";break;case"medium":x+="; Priority=Medium";break;case"high":x+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${T.priority}`)}if(T.sameSite)switch(typeof T.sameSite=="string"?T.sameSite.toLowerCase():T.sameSite){case!0:case"strict":x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"none":x+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${T.sameSite}`)}return x}function g(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function v(b){return o.call(b)==="[object Date]"}return Er}wk();/**
 * react-router v7.4.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var nv="popstate";function xk(a={}){function e(s,o){let{pathname:l,search:u,hash:d}=s.location;return Gd("",{pathname:l,search:u,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function i(s,o){return typeof o=="string"?o:jr(o)}return Dk(e,i,null,a)}function Qe(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function Pn(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ok(){return Math.random().toString(36).substring(2,10)}function iv(a,e){return{usr:a.state,key:a.key,idx:e}}function Gd(a,e,i=null,s){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?Ss(e):e,state:i,key:e&&e.key||s||Ok()}}function jr({pathname:a="/",search:e="",hash:i=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(a+=i.charAt(0)==="#"?i:"#"+i),a}function Ss(a){let e={};if(a){let i=a.indexOf("#");i>=0&&(e.hash=a.substring(i),a=a.substring(0,i));let s=a.indexOf("?");s>=0&&(e.search=a.substring(s),a=a.substring(0,s)),a&&(e.pathname=a)}return e}function Dk(a,e,i,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,u=o.history,d="POP",m=null,h=g();h==null&&(h=0,u.replaceState({...u.state,idx:h},""));function g(){return(u.state||{idx:null}).idx}function v(){d="POP";let _=g(),x=_==null?null:_-h;h=_,m&&m({action:d,location:E.location,delta:x})}function b(_,x){d="PUSH";let I=Gd(E.location,_,x);h=g()+1;let U=iv(I,h),N=E.createHref(I);try{u.pushState(U,"",N)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;o.location.assign(N)}l&&m&&m({action:d,location:E.location,delta:1})}function k(_,x){d="REPLACE";let I=Gd(E.location,_,x);h=g();let U=iv(I,h),N=E.createHref(I);u.replaceState(U,"",N),l&&m&&m({action:d,location:E.location,delta:0})}function T(_){let x=o.location.origin!=="null"?o.location.origin:o.location.href,I=typeof _=="string"?_:jr(_);return I=I.replace(/ $/,"%20"),Qe(x,`No window.location.(origin|href) available to create URL for href: ${I}`),new URL(I,x)}let E={get action(){return d},get location(){return a(o,u)},listen(_){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(nv,v),m=_,()=>{o.removeEventListener(nv,v),m=null}},createHref(_){return e(o,_)},createURL:T,encodeLocation(_){let x=T(_);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:b,replace:k,go(_){return u.go(_)}};return E}function Ty(a,e,i="/"){return Ak(a,e,i,!1)}function Ak(a,e,i,s){let o=typeof e=="string"?Ss(e):e,l=ai(o.pathname||"/",i);if(l==null)return null;let u=ky(a);Nk(u);let d=null;for(let m=0;d==null&&m<u.length;++m){let h=Hk(l);d=qk(u[m],h,s)}return d}function ky(a,e=[],i=[],s=""){let o=(l,u,d)=>{let m={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};m.relativePath.startsWith("/")&&(Qe(m.relativePath.startsWith(s),`Absolute route path "${m.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(s.length));let h=ii([s,m.relativePath]),g=i.concat(m);l.children&&l.children.length>0&&(Qe(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),ky(l.children,e,g,h)),!(l.path==null&&!l.index)&&e.push({path:h,score:Bk(h,l.index),routesMeta:g})};return a.forEach((l,u)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))o(l,u);else for(let m of Cy(l.path))o(l,u,m)}),e}function Cy(a){let e=a.split("/");if(e.length===0)return[];let[i,...s]=e,o=i.endsWith("?"),l=i.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let u=Cy(s.join("/")),d=[];return d.push(...u.map(m=>m===""?l:[l,m].join("/"))),o&&d.push(...u),d.map(m=>a.startsWith("/")&&m===""?"/":m)}function Nk(a){a.sort((e,i)=>e.score!==i.score?i.score-e.score:zk(e.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var Pk=/^:[\w-]+$/,Mk=3,Uk=2,Lk=1,jk=10,Ik=-2,av=a=>a==="*";function Bk(a,e){let i=a.split("/"),s=i.length;return i.some(av)&&(s+=Ik),e&&(s+=Uk),i.filter(o=>!av(o)).reduce((o,l)=>o+(Pk.test(l)?Mk:l===""?Lk:jk),s)}function zk(a,e){return a.length===e.length&&a.slice(0,-1).every((s,o)=>s===e[o])?a[a.length-1]-e[e.length-1]:0}function qk(a,e,i=!1){let{routesMeta:s}=a,o={},l="/",u=[];for(let d=0;d<s.length;++d){let m=s[d],h=d===s.length-1,g=l==="/"?e:e.slice(l.length)||"/",v=Uc({path:m.relativePath,caseSensitive:m.caseSensitive,end:h},g),b=m.route;if(!v&&h&&i&&!s[s.length-1].route.index&&(v=Uc({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},g)),!v)return null;Object.assign(o,v.params),u.push({params:o,pathname:ii([l,v.pathname]),pathnameBase:Yk(ii([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=ii([l,v.pathnameBase]))}return u}function Uc(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[i,s]=Vk(a.path,a.caseSensitive,a.end),o=e.match(i);if(!o)return null;let l=o[0],u=l.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:s.reduce((h,{paramName:g,isOptional:v},b)=>{if(g==="*"){let T=d[b]||"";u=l.slice(0,l.length-T.length).replace(/(.)\/+$/,"$1")}const k=d[b];return v&&!k?h[g]=void 0:h[g]=(k||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:u,pattern:a}}function Vk(a,e=!1,i=!0){Pn(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let s=[],o="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,m)=>(s.push({paramName:d,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return a.endsWith("*")?(s.push({paramName:"*"}),o+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?o+="\\/*$":a!==""&&a!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function Hk(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Pn(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function ai(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,s=a.charAt(i);return s&&s!=="/"?null:a.slice(i)||"/"}function Fk(a,e="/"){let{pathname:i,search:s="",hash:o=""}=typeof a=="string"?Ss(a):a;return{pathname:i?i.startsWith("/")?i:Gk(i,e):e,search:Qk(s),hash:Xk(o)}}function Gk(a,e){let i=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(o=>{o===".."?i.length>1&&i.pop():o!=="."&&i.push(o)}),i.length>1?i.join("/"):"/"}function kd(a,e,i,s){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Kk(a){return a.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function Ey(a){let e=Kk(a);return e.map((i,s)=>s===e.length-1?i.pathname:i.pathnameBase)}function Ry(a,e,i,s=!1){let o;typeof a=="string"?o=Ss(a):(o={...a},Qe(!o.pathname||!o.pathname.includes("?"),kd("?","pathname","search",o)),Qe(!o.pathname||!o.pathname.includes("#"),kd("#","pathname","hash",o)),Qe(!o.search||!o.search.includes("#"),kd("#","search","hash",o)));let l=a===""||o.pathname==="",u=l?"/":o.pathname,d;if(u==null)d=i;else{let v=e.length-1;if(!s&&u.startsWith("..")){let b=u.split("/");for(;b[0]==="..";)b.shift(),v-=1;o.pathname=b.join("/")}d=v>=0?e[v]:"/"}let m=Fk(o,d),h=u&&u!=="/"&&u.endsWith("/"),g=(l||u===".")&&i.endsWith("/");return!m.pathname.endsWith("/")&&(h||g)&&(m.pathname+="/"),m}var ii=a=>a.join("/").replace(/\/\/+/g,"/"),Yk=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),Qk=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,Xk=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function Jk(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}var _y=["POST","PUT","PATCH","DELETE"];new Set(_y);var Zk=["GET",..._y];new Set(Zk);var Ts=B.createContext(null);Ts.displayName="DataRouter";var Yc=B.createContext(null);Yc.displayName="DataRouterState";var wy=B.createContext({isTransitioning:!1});wy.displayName="ViewTransition";var Wk=B.createContext(new Map);Wk.displayName="Fetchers";var $k=B.createContext(null);$k.displayName="Await";var Ln=B.createContext(null);Ln.displayName="Navigation";var Vr=B.createContext(null);Vr.displayName="Location";var oi=B.createContext({outlet:null,matches:[],isDataRoute:!1});oi.displayName="Route";var Uf=B.createContext(null);Uf.displayName="RouteError";function eC(a,{relative:e}={}){Qe(Hr(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=B.useContext(Ln),{hash:o,pathname:l,search:u}=Fr(a,{relative:e}),d=l;return i!=="/"&&(d=l==="/"?i:ii([i,l])),s.createHref({pathname:d,search:u,hash:o})}function Hr(){return B.useContext(Vr)!=null}function Ta(){return Qe(Hr(),"useLocation() may be used only in the context of a <Router> component."),B.useContext(Vr).location}var xy="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Oy(a){B.useContext(Ln).static||B.useLayoutEffect(a)}function tC(){let{isDataRoute:a}=B.useContext(oi);return a?mC():nC()}function nC(){Qe(Hr(),"useNavigate() may be used only in the context of a <Router> component.");let a=B.useContext(Ts),{basename:e,navigator:i}=B.useContext(Ln),{matches:s}=B.useContext(oi),{pathname:o}=Ta(),l=JSON.stringify(Ey(s)),u=B.useRef(!1);return Oy(()=>{u.current=!0}),B.useCallback((m,h={})=>{if(Pn(u.current,xy),!u.current)return;if(typeof m=="number"){i.go(m);return}let g=Ry(m,JSON.parse(l),o,h.relative==="path");a==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:ii([e,g.pathname])),(h.replace?i.replace:i.push)(g,h.state,h)},[e,i,l,o,a])}B.createContext(null);function Fr(a,{relative:e}={}){let{matches:i}=B.useContext(oi),{pathname:s}=Ta(),o=JSON.stringify(Ey(i));return B.useMemo(()=>Ry(a,JSON.parse(o),s,e==="path"),[a,o,s,e])}function iC(a,e){return Dy(a,e)}function Dy(a,e,i,s){var I;Qe(Hr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o,static:l}=B.useContext(Ln),{matches:u}=B.useContext(oi),d=u[u.length-1],m=d?d.params:{},h=d?d.pathname:"/",g=d?d.pathnameBase:"/",v=d&&d.route;{let U=v&&v.path||"";Ay(h,!v||U.endsWith("*")||U.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${U}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${U}"> to <Route path="${U==="/"?"*":`${U}/*`}">.`)}let b=Ta(),k;if(e){let U=typeof e=="string"?Ss(e):e;Qe(g==="/"||((I=U.pathname)==null?void 0:I.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${U.pathname}" was given in the \`location\` prop.`),k=U}else k=b;let T=k.pathname||"/",E=T;if(g!=="/"){let U=g.replace(/^\//,"").split("/");E="/"+T.replace(/^\//,"").split("/").slice(U.length).join("/")}let _=!l&&i&&i.matches&&i.matches.length>0?i.matches:Ty(a,{pathname:E});Pn(v||_!=null,`No routes matched location "${k.pathname}${k.search}${k.hash}" `),Pn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${k.pathname}${k.search}${k.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=cC(_&&_.map(U=>Object.assign({},U,{params:Object.assign({},m,U.params),pathname:ii([g,o.encodeLocation?o.encodeLocation(U.pathname).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?g:ii([g,o.encodeLocation?o.encodeLocation(U.pathnameBase).pathname:U.pathnameBase])})),u,i,s);return e&&x?B.createElement(Vr.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...k},navigationType:"POP"}},x):x}function aC(){let a=hC(),e=Jk(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),i=a instanceof Error?a.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",a),u=B.createElement(B.Fragment,null,B.createElement("p",null,"💿 Hey developer 👋"),B.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",B.createElement("code",{style:l},"ErrorBoundary")," or"," ",B.createElement("code",{style:l},"errorElement")," prop on your route.")),B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),i?B.createElement("pre",{style:o},i):null,u)}var sC=B.createElement(aC,null),rC=class extends B.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){console.error("React Router caught the following error during render",a,e)}render(){return this.state.error!==void 0?B.createElement(oi.Provider,{value:this.props.routeContext},B.createElement(Uf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function oC({routeContext:a,match:e,children:i}){let s=B.useContext(Ts);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),B.createElement(oi.Provider,{value:a},i)}function cC(a,e=[],i=null,s=null){if(a==null){if(!i)return null;if(i.errors)a=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)a=i.matches;else return null}let o=a,l=i==null?void 0:i.errors;if(l!=null){let m=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);Qe(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let u=!1,d=-1;if(i)for(let m=0;m<o.length;m++){let h=o[m];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=m),h.route.id){let{loaderData:g,errors:v}=i,b=h.route.loader&&!g.hasOwnProperty(h.route.id)&&(!v||v[h.route.id]===void 0);if(h.route.lazy||b){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((m,h,g)=>{let v,b=!1,k=null,T=null;i&&(v=l&&h.route.id?l[h.route.id]:void 0,k=h.route.errorElement||sC,u&&(d<0&&g===0?(Ay("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,T=null):d===g&&(b=!0,T=h.route.hydrateFallbackElement||null)));let E=e.concat(o.slice(0,g+1)),_=()=>{let x;return v?x=k:b?x=T:h.route.Component?x=B.createElement(h.route.Component,null):h.route.element?x=h.route.element:x=m,B.createElement(oC,{match:h,routeContext:{outlet:m,matches:E,isDataRoute:i!=null},children:x})};return i&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?B.createElement(rC,{location:i.location,revalidation:i.revalidation,component:k,error:v,children:_(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):_()},null)}function Lf(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lC(a){let e=B.useContext(Ts);return Qe(e,Lf(a)),e}function uC(a){let e=B.useContext(Yc);return Qe(e,Lf(a)),e}function dC(a){let e=B.useContext(oi);return Qe(e,Lf(a)),e}function jf(a){let e=dC(a),i=e.matches[e.matches.length-1];return Qe(i.route.id,`${a} can only be used on routes that contain a unique "id"`),i.route.id}function fC(){return jf("useRouteId")}function hC(){var s;let a=B.useContext(Uf),e=uC("useRouteError"),i=jf("useRouteError");return a!==void 0?a:(s=e.errors)==null?void 0:s[i]}function mC(){let{router:a}=lC("useNavigate"),e=jf("useNavigate"),i=B.useRef(!1);return Oy(()=>{i.current=!0}),B.useCallback(async(o,l={})=>{Pn(i.current,xy),i.current&&(typeof o=="number"?a.navigate(o):await a.navigate(o,{fromRouteId:e,...l}))},[a,e])}var sv={};function Ay(a,e,i){!e&&!sv[a]&&(sv[a]=!0,Pn(!1,i))}B.memo(pC);function pC({routes:a,future:e,state:i}){return Dy(a,void 0,i,e)}function Kd(a){Qe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function gC({basename:a="/",children:e=null,location:i,navigationType:s="POP",navigator:o,static:l=!1}){Qe(!Hr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=a.replace(/^\/*/,"/"),d=B.useMemo(()=>({basename:u,navigator:o,static:l,future:{}}),[u,o,l]);typeof i=="string"&&(i=Ss(i));let{pathname:m="/",search:h="",hash:g="",state:v=null,key:b="default"}=i,k=B.useMemo(()=>{let T=ai(m,u);return T==null?null:{location:{pathname:T,search:h,hash:g,state:v,key:b},navigationType:s}},[u,m,h,g,v,b,s]);return Pn(k!=null,`<Router basename="${u}"> is not able to match the URL "${m}${h}${g}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:B.createElement(Ln.Provider,{value:d},B.createElement(Vr.Provider,{children:e,value:k}))}function vC({children:a,location:e}){return iC(Yd(a),e)}function Yd(a,e=[]){let i=[];return B.Children.forEach(a,(s,o)=>{if(!B.isValidElement(s))return;let l=[...e,o];if(s.type===B.Fragment){i.push.apply(i,Yd(s.props.children,l));return}Qe(s.type===Kd,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qe(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=Yd(s.props.children,l)),i.push(u)}),i}var hc="get",mc="application/x-www-form-urlencoded";function Qc(a){return a!=null&&typeof a.tagName=="string"}function yC(a){return Qc(a)&&a.tagName.toLowerCase()==="button"}function bC(a){return Qc(a)&&a.tagName.toLowerCase()==="form"}function SC(a){return Qc(a)&&a.tagName.toLowerCase()==="input"}function TC(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function kC(a,e){return a.button===0&&(!e||e==="_self")&&!TC(a)}var cc=null;function CC(){if(cc===null)try{new FormData(document.createElement("form"),0),cc=!1}catch{cc=!0}return cc}var EC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Cd(a){return a!=null&&!EC.has(a)?(Pn(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${mc}"`),null):a}function RC(a,e){let i,s,o,l,u;if(bC(a)){let d=a.getAttribute("action");s=d?ai(d,e):null,i=a.getAttribute("method")||hc,o=Cd(a.getAttribute("enctype"))||mc,l=new FormData(a)}else if(yC(a)||SC(a)&&(a.type==="submit"||a.type==="image")){let d=a.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=a.getAttribute("formaction")||d.getAttribute("action");if(s=m?ai(m,e):null,i=a.getAttribute("formmethod")||d.getAttribute("method")||hc,o=Cd(a.getAttribute("formenctype"))||Cd(d.getAttribute("enctype"))||mc,l=new FormData(d,a),!CC()){let{name:h,type:g,value:v}=a;if(g==="image"){let b=h?`${h}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else h&&l.append(h,v)}}else{if(Qc(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=hc,s=null,o=mc,u=a}return l&&o==="text/plain"&&(u=l,l=void 0),{action:s,method:i.toLowerCase(),encType:o,formData:l,body:u}}function If(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}async function _C(a,e){if(a.id in e)return e[a.id];try{let i=await import(a.module);return e[a.id]=i,i}catch(i){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function wC(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function xC(a,e,i){let s=await Promise.all(a.map(async o=>{let l=e.routes[o.route.id];if(l){let u=await _C(l,i);return u.links?u.links():[]}return[]}));return NC(s.flat(1).filter(wC).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function rv(a,e,i,s,o,l){let u=(m,h)=>i[h]?m.route.id!==i[h].route.id:!0,d=(m,h)=>{var g;return i[h].pathname!==m.pathname||((g=i[h].route.path)==null?void 0:g.endsWith("*"))&&i[h].params["*"]!==m.params["*"]};return l==="assets"?e.filter((m,h)=>u(m,h)||d(m,h)):l==="data"?e.filter((m,h)=>{var v;let g=s.routes[m.route.id];if(!g||!g.hasLoader)return!1;if(u(m,h)||d(m,h))return!0;if(m.route.shouldRevalidate){let b=m.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((v=i[0])==null?void 0:v.params)||{},nextUrl:new URL(a,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function OC(a,e,{includeHydrateFallback:i}={}){return DC(a.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),i&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function DC(a){return[...new Set(a)]}function AC(a){let e={},i=Object.keys(a).sort();for(let s of i)e[s]=a[s];return e}function NC(a,e){let i=new Set;return new Set(e),a.reduce((s,o)=>{let l=JSON.stringify(AC(o));return i.has(l)||(i.add(l),s.push({key:l,link:o})),s},[])}function PC(a,e){let i=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return i.pathname==="/"?i.pathname="_root.data":e&&ai(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.data`:i.pathname=`${i.pathname.replace(/\/$/,"")}.data`,i}function Ny(){let a=B.useContext(Ts);return If(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function MC(){let a=B.useContext(Yc);return If(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var Bf=B.createContext(void 0);Bf.displayName="FrameworkContext";function Py(){let a=B.useContext(Bf);return If(a,"You must render this element inside a <HydratedRouter> element"),a}function UC(a,e){let i=B.useContext(Bf),[s,o]=B.useState(!1),[l,u]=B.useState(!1),{onFocus:d,onBlur:m,onMouseEnter:h,onMouseLeave:g,onTouchStart:v}=e,b=B.useRef(null);B.useEffect(()=>{if(a==="render"&&u(!0),a==="viewport"){let E=x=>{x.forEach(I=>{u(I.isIntersecting)})},_=new IntersectionObserver(E,{threshold:.5});return b.current&&_.observe(b.current),()=>{_.disconnect()}}},[a]),B.useEffect(()=>{if(s){let E=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(E)}}},[s]);let k=()=>{o(!0)},T=()=>{o(!1),u(!1)};return i?a!=="intent"?[l,b,{}]:[l,b,{onFocus:Rr(d,k),onBlur:Rr(m,T),onMouseEnter:Rr(h,k),onMouseLeave:Rr(g,T),onTouchStart:Rr(v,k)}]:[!1,b,{}]}function Rr(a,e){return i=>{a&&a(i),i.defaultPrevented||e(i)}}function LC({page:a,...e}){let{router:i}=Ny(),s=B.useMemo(()=>Ty(i.routes,a,i.basename),[i.routes,a,i.basename]);return s?B.createElement(IC,{page:a,matches:s,...e}):null}function jC(a){let{manifest:e,routeModules:i}=Py(),[s,o]=B.useState([]);return B.useEffect(()=>{let l=!1;return xC(a,e,i).then(u=>{l||o(u)}),()=>{l=!0}},[a,e,i]),s}function IC({page:a,matches:e,...i}){let s=Ta(),{manifest:o,routeModules:l}=Py(),{basename:u}=Ny(),{loaderData:d,matches:m}=MC(),h=B.useMemo(()=>rv(a,e,m,o,s,"data"),[a,e,m,o,s]),g=B.useMemo(()=>rv(a,e,m,o,s,"assets"),[a,e,m,o,s]),v=B.useMemo(()=>{if(a===s.pathname+s.search+s.hash)return[];let T=new Set,E=!1;if(e.forEach(x=>{var U;let I=o.routes[x.route.id];!I||!I.hasLoader||(!h.some(N=>N.route.id===x.route.id)&&x.route.id in d&&((U=l[x.route.id])!=null&&U.shouldRevalidate)||I.hasClientLoader?E=!0:T.add(x.route.id))}),T.size===0)return[];let _=PC(a,u);return E&&T.size>0&&_.searchParams.set("_routes",e.filter(x=>T.has(x.route.id)).map(x=>x.route.id).join(",")),[_.pathname+_.search]},[u,d,s,o,h,e,a,l]),b=B.useMemo(()=>OC(g,o),[g,o]),k=jC(g);return B.createElement(B.Fragment,null,v.map(T=>B.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...i})),b.map(T=>B.createElement("link",{key:T,rel:"modulepreload",href:T,...i})),k.map(({key:T,link:E})=>B.createElement("link",{key:T,...E})))}function BC(...a){return e=>{a.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var My=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{My&&(window.__reactRouterVersion="7.4.0")}catch{}function zC({basename:a,children:e,window:i}){let s=B.useRef();s.current==null&&(s.current=xk({window:i,v5Compat:!0}));let o=s.current,[l,u]=B.useState({action:o.action,location:o.location}),d=B.useCallback(m=>{B.startTransition(()=>u(m))},[u]);return B.useLayoutEffect(()=>o.listen(d),[o,d]),B.createElement(gC,{basename:a,children:e,location:l.location,navigationType:l.action,navigator:o})}var Uy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gt=B.forwardRef(function({onClick:e,discover:i="render",prefetch:s="none",relative:o,reloadDocument:l,replace:u,state:d,target:m,to:h,preventScrollReset:g,viewTransition:v,...b},k){let{basename:T}=B.useContext(Ln),E=typeof h=="string"&&Uy.test(h),_,x=!1;if(typeof h=="string"&&E&&(_=h,My))try{let Q=new URL(window.location.href),ee=h.startsWith("//")?new URL(Q.protocol+h):new URL(h),le=ai(ee.pathname,T);ee.origin===Q.origin&&le!=null?h=le+ee.search+ee.hash:x=!0}catch{Pn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let I=eC(h,{relative:o}),[U,N,w]=UC(s,b),F=FC(h,{replace:u,state:d,target:m,preventScrollReset:g,relative:o,viewTransition:v});function J(Q){e&&e(Q),Q.defaultPrevented||F(Q)}let ne=B.createElement("a",{...b,...w,href:_||I,onClick:x||l?e:J,ref:BC(k,N),target:m,"data-discover":!E&&i==="render"?"true":void 0});return U&&!E?B.createElement(B.Fragment,null,ne,B.createElement(LC,{page:I})):ne});Gt.displayName="Link";var qC=B.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:u,viewTransition:d,children:m,...h},g){let v=Fr(u,{relative:h.relative}),b=Ta(),k=B.useContext(Yc),{navigator:T,basename:E}=B.useContext(Ln),_=k!=null&&XC(v)&&d===!0,x=T.encodeLocation?T.encodeLocation(v).pathname:v.pathname,I=b.pathname,U=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;i||(I=I.toLowerCase(),U=U?U.toLowerCase():null,x=x.toLowerCase()),U&&E&&(U=ai(U,E)||U);const N=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let w=I===x||!o&&I.startsWith(x)&&I.charAt(N)==="/",F=U!=null&&(U===x||!o&&U.startsWith(x)&&U.charAt(x.length)==="/"),J={isActive:w,isPending:F,isTransitioning:_},ne=w?e:void 0,Q;typeof s=="function"?Q=s(J):Q=[s,w?"active":null,F?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let ee=typeof l=="function"?l(J):l;return B.createElement(Gt,{...h,"aria-current":ne,className:Q,ref:g,style:ee,to:u,viewTransition:d},typeof m=="function"?m(J):m)});qC.displayName="NavLink";var VC=B.forwardRef(({discover:a="render",fetcherKey:e,navigate:i,reloadDocument:s,replace:o,state:l,method:u=hc,action:d,onSubmit:m,relative:h,preventScrollReset:g,viewTransition:v,...b},k)=>{let T=YC(),E=QC(d,{relative:h}),_=u.toLowerCase()==="get"?"get":"post",x=typeof d=="string"&&Uy.test(d),I=U=>{if(m&&m(U),U.defaultPrevented)return;U.preventDefault();let N=U.nativeEvent.submitter,w=(N==null?void 0:N.getAttribute("formmethod"))||u;T(N||U.currentTarget,{fetcherKey:e,method:w,navigate:i,replace:o,state:l,relative:h,preventScrollReset:g,viewTransition:v})};return B.createElement("form",{ref:k,method:_,action:E,onSubmit:s?m:I,...b,"data-discover":!x&&a==="render"?"true":void 0})});VC.displayName="Form";function HC(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ly(a){let e=B.useContext(Ts);return Qe(e,HC(a)),e}function FC(a,{target:e,replace:i,state:s,preventScrollReset:o,relative:l,viewTransition:u}={}){let d=tC(),m=Ta(),h=Fr(a,{relative:l});return B.useCallback(g=>{if(kC(g,e)){g.preventDefault();let v=i!==void 0?i:jr(m)===jr(h);d(a,{replace:v,state:s,preventScrollReset:o,relative:l,viewTransition:u})}},[m,d,h,i,s,e,a,o,l,u])}var GC=0,KC=()=>`__${String(++GC)}__`;function YC(){let{router:a}=Ly("useSubmit"),{basename:e}=B.useContext(Ln),i=fC();return B.useCallback(async(s,o={})=>{let{action:l,method:u,encType:d,formData:m,body:h}=RC(s,e);if(o.navigate===!1){let g=o.fetcherKey||KC();await a.fetch(g,i,o.action||l,{preventScrollReset:o.preventScrollReset,formData:m,body:h,formMethod:o.method||u,formEncType:o.encType||d,flushSync:o.flushSync})}else await a.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:m,body:h,formMethod:o.method||u,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:i,flushSync:o.flushSync,viewTransition:o.viewTransition})},[a,e,i])}function QC(a,{relative:e}={}){let{basename:i}=B.useContext(Ln),s=B.useContext(oi);Qe(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...Fr(a||".",{relative:e})},u=Ta();if(a==null){l.search=u.search;let d=new URLSearchParams(l.search),m=d.getAll("index");if(m.some(g=>g==="")){d.delete("index"),m.filter(v=>v).forEach(v=>d.append("index",v));let g=d.toString();l.search=g?`?${g}`:""}}return(!a||a===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(l.pathname=l.pathname==="/"?i:ii([i,l.pathname])),jr(l)}function XC(a,e={}){let i=B.useContext(wy);Qe(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Ly("useViewTransitionState"),o=Fr(a,{relative:e.relative});if(!i.isTransitioning)return!1;let l=ai(i.currentLocation.pathname,s)||i.currentLocation.pathname,u=ai(i.nextLocation.pathname,s)||i.nextLocation.pathname;return Uc(o.pathname,u)!=null||Uc(o.pathname,l)!=null}new TextEncoder;function pc({isHomePage:a=!1}){return C.jsx("header",{className:"header",children:C.jsxs("div",{className:"container",children:[C.jsx("div",{className:"logo",children:C.jsx(Gt,{to:"/",children:C.jsx("h1",{children:"FlashSale"})})}),C.jsx("nav",{className:"nav",children:C.jsxs("ul",{children:[a?C.jsxs(C.Fragment,{children:[C.jsx("li",{children:C.jsx("a",{href:"#features",children:"기능"})}),C.jsx("li",{children:C.jsx("a",{href:"#pricing",children:"요금제"})}),C.jsx("li",{children:C.jsx("a",{href:"#faq",children:"FAQ"})})]}):C.jsx("li",{children:C.jsx(Gt,{to:"/",children:"홈으로"})}),C.jsx("li",{children:C.jsx(Gt,{to:"/live",className:"btn btn-primary",children:"라이브 방송"})})]})})]})})}function gc({simplified:a=!1}){return C.jsx("footer",{className:"footer",children:C.jsxs("div",{className:"container",children:[C.jsxs("div",{className:"footer-content",children:[C.jsxs("div",{className:"footer-logo",children:[C.jsx("h3",{children:"FlashSale"}),C.jsx("p",{children:"한시적 특가 세일로 매출을 극대화하는 가장 쉬운 방법"})]}),!a&&C.jsxs("div",{className:"footer-links",children:[C.jsxs("div",{className:"footer-links-column",children:[C.jsx("h4",{children:"제품"}),C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Gt,{to:"/#features",children:"기능"})}),C.jsx("li",{children:C.jsx(Gt,{to:"/#pricing",children:"요금제"})}),C.jsx("li",{children:C.jsx(Gt,{to:"/#faq",children:"FAQ"})})]})]}),C.jsxs("div",{className:"footer-links-column",children:[C.jsx("h4",{children:"회사"}),C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"소개"})}),C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"블로그"})}),C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"채용"})})]})]}),C.jsxs("div",{className:"footer-links-column",children:[C.jsx("h4",{children:"법률"}),C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"이용약관"})}),C.jsx("li",{children:C.jsx(Gt,{to:"#",children:"개인정보처리방침"})})]})]})]})]}),C.jsxs("div",{className:"footer-bottom",children:[C.jsx("p",{children:"© 2025 FlashSale. All rights reserved."}),!a&&C.jsxs("div",{className:"social-links",children:[C.jsx("a",{href:"#","aria-label":"Facebook",children:C.jsx("span",{children:"Facebook"})}),C.jsx("a",{href:"#","aria-label":"Twitter",children:C.jsx("span",{children:"Twitter"})}),C.jsx("a",{href:"#","aria-label":"Instagram",children:C.jsx("span",{children:"Instagram"})}),C.jsx("a",{href:"#","aria-label":"LinkedIn",children:C.jsx("span",{children:"LinkedIn"})})]})]})]})})}function JC(){const[a,e]=B.useState(""),i=s=>{s.preventDefault(),alert(`${a}로 신청되었습니다.`),e("")};return C.jsxs("div",{className:"app",children:[C.jsx(pc,{isHomePage:!0}),C.jsx("section",{className:"hero",children:C.jsx("div",{className:"container",children:C.jsxs("div",{className:"hero-content",children:[C.jsxs("h2",{className:"hero-title",children:["단 하루만",C.jsx("br",{}),"특별한 할인 혜택을 제공합니다"]}),C.jsx("p",{className:"hero-description",children:"FlashSale을 통해 한정된 시간 동안 최고의 할인 혜택을 제공하고 매출을 극대화하세요."}),C.jsxs("form",{className:"signup-form",onSubmit:i,children:[C.jsx("input",{type:"email",placeholder:"이메일을 입력하세요",value:a,onChange:s=>e(s.target.value),required:!0}),C.jsx("button",{type:"submit",className:"btn btn-primary",children:"무료로 시작하기"})]}),C.jsx("p",{className:"form-note",children:"* 14일 무료 체험 후 구독이 필요합니다"})]})})}),C.jsx("section",{id:"features",className:"features",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"주요 기능"}),C.jsxs("div",{className:"features-grid",children:[C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"🚀"}),C.jsx("h3",{children:"빠른 할인 설정"}),C.jsx("p",{children:"몇 번의 클릭만으로 시간 제한 특가 세일을 설정할 수 있습니다."})]}),C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"📊"}),C.jsx("h3",{children:"실시간 매출 분석"}),C.jsx("p",{children:"할인 캠페인 효과를 실시간으로 분석하여 최적의 판매 전략을 수립할 수 있습니다."})]}),C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"🔒"}),C.jsx("h3",{children:"안전한 보안"}),C.jsx("p",{children:"모든 데이터는 암호화되어 안전하게 보호됩니다."})]}),C.jsxs("div",{className:"feature-card",children:[C.jsx("div",{className:"feature-icon",children:"⏱️"}),C.jsx("h3",{children:"카운트다운 타이머"}),C.jsx("p",{children:"긴급성을 높이는 카운트다운 타이머로 고객의 구매 결정을 앞당길 수 있습니다."})]})]})]})}),C.jsx("section",{id:"pricing",className:"pricing",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"플랜 선택"}),C.jsxs("div",{className:"pricing-cards",children:[C.jsxs("div",{className:"pricing-card",children:[C.jsx("h3",{children:"스타터"}),C.jsxs("div",{className:"price",children:["₩29,000",C.jsx("span",{children:"/월"})]}),C.jsxs("ul",{className:"pricing-features",children:[C.jsx("li",{children:"✓ 기본 기능 접근"}),C.jsx("li",{children:"✓ 월 500회 연결"}),C.jsx("li",{children:"✓ 이메일 지원"}),C.jsx("li",{children:"✓ 기본 분석"})]}),C.jsx("button",{className:"btn btn-outline",children:"시작하기"})]}),C.jsxs("div",{className:"pricing-card featured",children:[C.jsx("div",{className:"featured-tag",children:"인기"}),C.jsx("h3",{children:"프로"}),C.jsxs("div",{className:"price",children:["₩79,000",C.jsx("span",{children:"/월"})]}),C.jsxs("ul",{className:"pricing-features",children:[C.jsx("li",{children:"✓ 모든 기본 기능"}),C.jsx("li",{children:"✓ 무제한 연결"}),C.jsx("li",{children:"✓ 우선 지원"}),C.jsx("li",{children:"✓ 고급 분석"}),C.jsx("li",{children:"✓ API 접근"})]}),C.jsx("button",{className:"btn btn-primary",children:"시작하기"})]}),C.jsxs("div",{className:"pricing-card",children:[C.jsx("h3",{children:"엔터프라이즈"}),C.jsx("div",{className:"price",children:"문의"}),C.jsxs("ul",{className:"pricing-features",children:[C.jsx("li",{children:"✓ 모든 프로 기능"}),C.jsx("li",{children:"✓ 전용 매니저"}),C.jsx("li",{children:"✓ 맞춤형 기능"}),C.jsx("li",{children:"✓ 온보딩 지원"}),C.jsx("li",{children:"✓ SLA 보장"})]}),C.jsx("button",{className:"btn btn-outline",children:"문의하기"})]})]})]})}),C.jsx("section",{id:"faq",className:"faq",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"자주 묻는 질문"}),C.jsxs("div",{className:"faq-list",children:[C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"FlashSale은 어떤 서비스인가요?"}),C.jsx("p",{children:"FlashSale은 비즈니스가 한시적인 특별 할인을 쉽게 제공할 수 있는 플랫폼입니다. 몇 번의 클릭만으로 긴급 세일 이벤트를 시작할 수 있습니다."})]}),C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"무료 체험은 어떻게 이용하나요?"}),C.jsx("p",{children:"회원가입 후 14일 동안 모든 기능을 무료로 이용할 수 있습니다. 별도의 결제 정보 없이도 시작할 수 있습니다."})]}),C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"구독을 취소할 수 있나요?"}),C.jsx("p",{children:"네, 언제든지 구독을 취소할 수 있습니다. 취소 시 다음 결제일까지 서비스를 이용할 수 있습니다."})]}),C.jsxs("div",{className:"faq-item",children:[C.jsx("h3",{children:"기술적 지원은 어떻게 받을 수 있나요?"}),C.jsx("p",{children:"이메일 또는 실시간 채팅을 통해 언제든지 기술 지원팀에 문의할 수 있습니다. 프로 및 엔터프라이즈 요금제는 우선 지원을 받습니다."})]})]})]})}),C.jsx("section",{id:"contact",className:"contact",children:C.jsxs("div",{className:"container",children:[C.jsx("h2",{className:"section-title",children:"문의하기"}),C.jsx("p",{className:"contact-description",children:"더 자세한 정보가 필요하시거나 질문이 있으신가요? 언제든지 연락주세요."}),C.jsx("div",{className:"contact-form-container",children:C.jsxs("form",{className:"contact-form",children:[C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"이름",required:!0})}),C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"email",placeholder:"이메일",required:!0})}),C.jsx("div",{className:"form-group",children:C.jsx("textarea",{placeholder:"메시지",rows:5,required:!0})}),C.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:"보내기"})]})})]})}),C.jsx(gc,{})]})}function jy(a,e){return function(){return a.apply(e,arguments)}}const{toString:ZC}=Object.prototype,{getPrototypeOf:zf}=Object,Xc=(a=>e=>{const i=ZC.call(e);return a[i]||(a[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),Sn=a=>(a=a.toLowerCase(),e=>Xc(e)===a),Jc=a=>e=>typeof e===a,{isArray:ks}=Array,Ir=Jc("undefined");function WC(a){return a!==null&&!Ir(a)&&a.constructor!==null&&!Ir(a.constructor)&&Qt(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const Iy=Sn("ArrayBuffer");function $C(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&Iy(a.buffer),e}const eE=Jc("string"),Qt=Jc("function"),By=Jc("number"),Zc=a=>a!==null&&typeof a=="object",tE=a=>a===!0||a===!1,vc=a=>{if(Xc(a)!=="object")return!1;const e=zf(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},nE=Sn("Date"),iE=Sn("File"),aE=Sn("Blob"),sE=Sn("FileList"),rE=a=>Zc(a)&&Qt(a.pipe),oE=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||Qt(a.append)&&((e=Xc(a))==="formdata"||e==="object"&&Qt(a.toString)&&a.toString()==="[object FormData]"))},cE=Sn("URLSearchParams"),[lE,uE,dE,fE]=["ReadableStream","Request","Response","Headers"].map(Sn),hE=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gr(a,e,{allOwnKeys:i=!1}={}){if(a===null||typeof a>"u")return;let s,o;if(typeof a!="object"&&(a=[a]),ks(a))for(s=0,o=a.length;s<o;s++)e.call(null,a[s],s,a);else{const l=i?Object.getOwnPropertyNames(a):Object.keys(a),u=l.length;let d;for(s=0;s<u;s++)d=l[s],e.call(null,a[d],d,a)}}function zy(a,e){e=e.toLowerCase();const i=Object.keys(a);let s=i.length,o;for(;s-- >0;)if(o=i[s],e===o.toLowerCase())return o;return null}const pa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,qy=a=>!Ir(a)&&a!==pa;function Qd(){const{caseless:a}=qy(this)&&this||{},e={},i=(s,o)=>{const l=a&&zy(e,o)||o;vc(e[l])&&vc(s)?e[l]=Qd(e[l],s):vc(s)?e[l]=Qd({},s):ks(s)?e[l]=s.slice():e[l]=s};for(let s=0,o=arguments.length;s<o;s++)arguments[s]&&Gr(arguments[s],i);return e}const mE=(a,e,i,{allOwnKeys:s}={})=>(Gr(e,(o,l)=>{i&&Qt(o)?a[l]=jy(o,i):a[l]=o},{allOwnKeys:s}),a),pE=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),gE=(a,e,i,s)=>{a.prototype=Object.create(e.prototype,s),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),i&&Object.assign(a.prototype,i)},vE=(a,e,i,s)=>{let o,l,u;const d={};if(e=e||{},a==null)return e;do{for(o=Object.getOwnPropertyNames(a),l=o.length;l-- >0;)u=o[l],(!s||s(u,a,e))&&!d[u]&&(e[u]=a[u],d[u]=!0);a=i!==!1&&zf(a)}while(a&&(!i||i(a,e))&&a!==Object.prototype);return e},yE=(a,e,i)=>{a=String(a),(i===void 0||i>a.length)&&(i=a.length),i-=e.length;const s=a.indexOf(e,i);return s!==-1&&s===i},bE=a=>{if(!a)return null;if(ks(a))return a;let e=a.length;if(!By(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=a[e];return i},SE=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&zf(Uint8Array)),TE=(a,e)=>{const s=(a&&a[Symbol.iterator]).call(a);let o;for(;(o=s.next())&&!o.done;){const l=o.value;e.call(a,l[0],l[1])}},kE=(a,e)=>{let i;const s=[];for(;(i=a.exec(e))!==null;)s.push(i);return s},CE=Sn("HTMLFormElement"),EE=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,s,o){return s.toUpperCase()+o}),ov=(({hasOwnProperty:a})=>(e,i)=>a.call(e,i))(Object.prototype),RE=Sn("RegExp"),Vy=(a,e)=>{const i=Object.getOwnPropertyDescriptors(a),s={};Gr(i,(o,l)=>{let u;(u=e(o,l,a))!==!1&&(s[l]=u||o)}),Object.defineProperties(a,s)},_E=a=>{Vy(a,(e,i)=>{if(Qt(a)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const s=a[i];if(Qt(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},wE=(a,e)=>{const i={},s=o=>{o.forEach(l=>{i[l]=!0})};return ks(a)?s(a):s(String(a).split(e)),i},xE=()=>{},OE=(a,e)=>a!=null&&Number.isFinite(a=+a)?a:e;function DE(a){return!!(a&&Qt(a.append)&&a[Symbol.toStringTag]==="FormData"&&a[Symbol.iterator])}const AE=a=>{const e=new Array(10),i=(s,o)=>{if(Zc(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[o]=s;const l=ks(s)?[]:{};return Gr(s,(u,d)=>{const m=i(u,o+1);!Ir(m)&&(l[d]=m)}),e[o]=void 0,l}}return s};return i(a,0)},NE=Sn("AsyncFunction"),PE=a=>a&&(Zc(a)||Qt(a))&&Qt(a.then)&&Qt(a.catch),Hy=((a,e)=>a?setImmediate:e?((i,s)=>(pa.addEventListener("message",({source:o,data:l})=>{o===pa&&l===i&&s.length&&s.shift()()},!1),o=>{s.push(o),pa.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",Qt(pa.postMessage)),ME=typeof queueMicrotask<"u"?queueMicrotask.bind(pa):typeof process<"u"&&process.nextTick||Hy,q={isArray:ks,isArrayBuffer:Iy,isBuffer:WC,isFormData:oE,isArrayBufferView:$C,isString:eE,isNumber:By,isBoolean:tE,isObject:Zc,isPlainObject:vc,isReadableStream:lE,isRequest:uE,isResponse:dE,isHeaders:fE,isUndefined:Ir,isDate:nE,isFile:iE,isBlob:aE,isRegExp:RE,isFunction:Qt,isStream:rE,isURLSearchParams:cE,isTypedArray:SE,isFileList:sE,forEach:Gr,merge:Qd,extend:mE,trim:hE,stripBOM:pE,inherits:gE,toFlatObject:vE,kindOf:Xc,kindOfTest:Sn,endsWith:yE,toArray:bE,forEachEntry:TE,matchAll:kE,isHTMLForm:CE,hasOwnProperty:ov,hasOwnProp:ov,reduceDescriptors:Vy,freezeMethods:_E,toObjectSet:wE,toCamelCase:EE,noop:xE,toFiniteNumber:OE,findKey:zy,global:pa,isContextDefined:qy,isSpecCompliantForm:DE,toJSONObject:AE,isAsyncFn:NE,isThenable:PE,setImmediate:Hy,asap:ME};function ve(a,e,i,s,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),s&&(this.request=s),o&&(this.response=o,this.status=o.status?o.status:null)}q.inherits(ve,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:q.toJSONObject(this.config),code:this.code,status:this.status}}});const Fy=ve.prototype,Gy={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{Gy[a]={value:a}});Object.defineProperties(ve,Gy);Object.defineProperty(Fy,"isAxiosError",{value:!0});ve.from=(a,e,i,s,o,l)=>{const u=Object.create(Fy);return q.toFlatObject(a,u,function(m){return m!==Error.prototype},d=>d!=="isAxiosError"),ve.call(u,a.message,e,i,s,o),u.cause=a,u.name=a.name,l&&Object.assign(u,l),u};const UE=null;function Xd(a){return q.isPlainObject(a)||q.isArray(a)}function Ky(a){return q.endsWith(a,"[]")?a.slice(0,-2):a}function cv(a,e,i){return a?a.concat(e).map(function(o,l){return o=Ky(o),!i&&l?"["+o+"]":o}).join(i?".":""):e}function LE(a){return q.isArray(a)&&!a.some(Xd)}const jE=q.toFlatObject(q,{},null,function(e){return/^is[A-Z]/.test(e)});function Wc(a,e,i){if(!q.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,i=q.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,_){return!q.isUndefined(_[E])});const s=i.metaTokens,o=i.visitor||g,l=i.dots,u=i.indexes,m=(i.Blob||typeof Blob<"u"&&Blob)&&q.isSpecCompliantForm(e);if(!q.isFunction(o))throw new TypeError("visitor must be a function");function h(T){if(T===null)return"";if(q.isDate(T))return T.toISOString();if(!m&&q.isBlob(T))throw new ve("Blob is not supported. Use a Buffer instead.");return q.isArrayBuffer(T)||q.isTypedArray(T)?m&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function g(T,E,_){let x=T;if(T&&!_&&typeof T=="object"){if(q.endsWith(E,"{}"))E=s?E:E.slice(0,-2),T=JSON.stringify(T);else if(q.isArray(T)&&LE(T)||(q.isFileList(T)||q.endsWith(E,"[]"))&&(x=q.toArray(T)))return E=Ky(E),x.forEach(function(U,N){!(q.isUndefined(U)||U===null)&&e.append(u===!0?cv([E],N,l):u===null?E:E+"[]",h(U))}),!1}return Xd(T)?!0:(e.append(cv(_,E,l),h(T)),!1)}const v=[],b=Object.assign(jE,{defaultVisitor:g,convertValue:h,isVisitable:Xd});function k(T,E){if(!q.isUndefined(T)){if(v.indexOf(T)!==-1)throw Error("Circular reference detected in "+E.join("."));v.push(T),q.forEach(T,function(x,I){(!(q.isUndefined(x)||x===null)&&o.call(e,x,q.isString(I)?I.trim():I,E,b))===!0&&k(x,E?E.concat(I):[I])}),v.pop()}}if(!q.isObject(a))throw new TypeError("data must be an object");return k(a),e}function lv(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function qf(a,e){this._pairs=[],a&&Wc(a,this,e)}const Yy=qf.prototype;Yy.append=function(e,i){this._pairs.push([e,i])};Yy.toString=function(e){const i=e?function(s){return e.call(this,s,lv)}:lv;return this._pairs.map(function(o){return i(o[0])+"="+i(o[1])},"").join("&")};function IE(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Qy(a,e,i){if(!e)return a;const s=i&&i.encode||IE;q.isFunction(i)&&(i={serialize:i});const o=i&&i.serialize;let l;if(o?l=o(e,i):l=q.isURLSearchParams(e)?e.toString():new qf(e,i).toString(s),l){const u=a.indexOf("#");u!==-1&&(a=a.slice(0,u)),a+=(a.indexOf("?")===-1?"?":"&")+l}return a}class uv{constructor(){this.handlers=[]}use(e,i,s){return this.handlers.push({fulfilled:e,rejected:i,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){q.forEach(this.handlers,function(s){s!==null&&e(s)})}}const Xy={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},BE=typeof URLSearchParams<"u"?URLSearchParams:qf,zE=typeof FormData<"u"?FormData:null,qE=typeof Blob<"u"?Blob:null,VE={isBrowser:!0,classes:{URLSearchParams:BE,FormData:zE,Blob:qE},protocols:["http","https","file","blob","url","data"]},Vf=typeof window<"u"&&typeof document<"u",Jd=typeof navigator=="object"&&navigator||void 0,HE=Vf&&(!Jd||["ReactNative","NativeScript","NS"].indexOf(Jd.product)<0),FE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",GE=Vf&&window.location.href||"http://localhost",KE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Vf,hasStandardBrowserEnv:HE,hasStandardBrowserWebWorkerEnv:FE,navigator:Jd,origin:GE},Symbol.toStringTag,{value:"Module"})),_t={...KE,...VE};function YE(a,e){return Wc(a,new _t.classes.URLSearchParams,Object.assign({visitor:function(i,s,o,l){return _t.isNode&&q.isBuffer(i)?(this.append(s,i.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},e))}function QE(a){return q.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function XE(a){const e={},i=Object.keys(a);let s;const o=i.length;let l;for(s=0;s<o;s++)l=i[s],e[l]=a[l];return e}function Jy(a){function e(i,s,o,l){let u=i[l++];if(u==="__proto__")return!0;const d=Number.isFinite(+u),m=l>=i.length;return u=!u&&q.isArray(o)?o.length:u,m?(q.hasOwnProp(o,u)?o[u]=[o[u],s]:o[u]=s,!d):((!o[u]||!q.isObject(o[u]))&&(o[u]=[]),e(i,s,o[u],l)&&q.isArray(o[u])&&(o[u]=XE(o[u])),!d)}if(q.isFormData(a)&&q.isFunction(a.entries)){const i={};return q.forEachEntry(a,(s,o)=>{e(QE(s),o,i,0)}),i}return null}function JE(a,e,i){if(q.isString(a))try{return(e||JSON.parse)(a),q.trim(a)}catch(s){if(s.name!=="SyntaxError")throw s}return(i||JSON.stringify)(a)}const Kr={transitional:Xy,adapter:["xhr","http","fetch"],transformRequest:[function(e,i){const s=i.getContentType()||"",o=s.indexOf("application/json")>-1,l=q.isObject(e);if(l&&q.isHTMLForm(e)&&(e=new FormData(e)),q.isFormData(e))return o?JSON.stringify(Jy(e)):e;if(q.isArrayBuffer(e)||q.isBuffer(e)||q.isStream(e)||q.isFile(e)||q.isBlob(e)||q.isReadableStream(e))return e;if(q.isArrayBufferView(e))return e.buffer;if(q.isURLSearchParams(e))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return YE(e,this.formSerializer).toString();if((d=q.isFileList(e))||s.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Wc(d?{"files[]":e}:e,m&&new m,this.formSerializer)}}return l||o?(i.setContentType("application/json",!1),JE(e)):e}],transformResponse:[function(e){const i=this.transitional||Kr.transitional,s=i&&i.forcedJSONParsing,o=this.responseType==="json";if(q.isResponse(e)||q.isReadableStream(e))return e;if(e&&q.isString(e)&&(s&&!this.responseType||o)){const u=!(i&&i.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(d){if(u)throw d.name==="SyntaxError"?ve.from(d,ve.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_t.classes.FormData,Blob:_t.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};q.forEach(["delete","get","head","post","put","patch"],a=>{Kr.headers[a]={}});const ZE=q.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),WE=a=>{const e={};let i,s,o;return a&&a.split(`
`).forEach(function(u){o=u.indexOf(":"),i=u.substring(0,o).trim().toLowerCase(),s=u.substring(o+1).trim(),!(!i||e[i]&&ZE[i])&&(i==="set-cookie"?e[i]?e[i].push(s):e[i]=[s]:e[i]=e[i]?e[i]+", "+s:s)}),e},dv=Symbol("internals");function _r(a){return a&&String(a).trim().toLowerCase()}function yc(a){return a===!1||a==null?a:q.isArray(a)?a.map(yc):String(a)}function $E(a){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=i.exec(a);)e[s[1]]=s[2];return e}const eR=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function Ed(a,e,i,s,o){if(q.isFunction(s))return s.call(this,e,i);if(o&&(e=i),!!q.isString(e)){if(q.isString(s))return e.indexOf(s)!==-1;if(q.isRegExp(s))return s.test(e)}}function tR(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,i,s)=>i.toUpperCase()+s)}function nR(a,e){const i=q.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(a,s+i,{value:function(o,l,u){return this[s].call(this,e,o,l,u)},configurable:!0})})}let Lt=class{constructor(e){e&&this.set(e)}set(e,i,s){const o=this;function l(d,m,h){const g=_r(m);if(!g)throw new Error("header name must be a non-empty string");const v=q.findKey(o,g);(!v||o[v]===void 0||h===!0||h===void 0&&o[v]!==!1)&&(o[v||m]=yc(d))}const u=(d,m)=>q.forEach(d,(h,g)=>l(h,g,m));if(q.isPlainObject(e)||e instanceof this.constructor)u(e,i);else if(q.isString(e)&&(e=e.trim())&&!eR(e))u(WE(e),i);else if(q.isHeaders(e))for(const[d,m]of e.entries())l(m,d,s);else e!=null&&l(i,e,s);return this}get(e,i){if(e=_r(e),e){const s=q.findKey(this,e);if(s){const o=this[s];if(!i)return o;if(i===!0)return $E(o);if(q.isFunction(i))return i.call(this,o,s);if(q.isRegExp(i))return i.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,i){if(e=_r(e),e){const s=q.findKey(this,e);return!!(s&&this[s]!==void 0&&(!i||Ed(this,this[s],s,i)))}return!1}delete(e,i){const s=this;let o=!1;function l(u){if(u=_r(u),u){const d=q.findKey(s,u);d&&(!i||Ed(s,s[d],d,i))&&(delete s[d],o=!0)}}return q.isArray(e)?e.forEach(l):l(e),o}clear(e){const i=Object.keys(this);let s=i.length,o=!1;for(;s--;){const l=i[s];(!e||Ed(this,this[l],l,e,!0))&&(delete this[l],o=!0)}return o}normalize(e){const i=this,s={};return q.forEach(this,(o,l)=>{const u=q.findKey(s,l);if(u){i[u]=yc(o),delete i[l];return}const d=e?tR(l):String(l).trim();d!==l&&delete i[l],i[d]=yc(o),s[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const i=Object.create(null);return q.forEach(this,(s,o)=>{s!=null&&s!==!1&&(i[o]=e&&q.isArray(s)?s.join(", "):s)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,i])=>e+": "+i).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...i){const s=new this(e);return i.forEach(o=>s.set(o)),s}static accessor(e){const s=(this[dv]=this[dv]={accessors:{}}).accessors,o=this.prototype;function l(u){const d=_r(u);s[d]||(nR(o,u),s[d]=!0)}return q.isArray(e)?e.forEach(l):l(e),this}};Lt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);q.reduceDescriptors(Lt.prototype,({value:a},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(s){this[i]=s}}});q.freezeMethods(Lt);function Rd(a,e){const i=this||Kr,s=e||i,o=Lt.from(s.headers);let l=s.data;return q.forEach(a,function(d){l=d.call(i,l,o.normalize(),e?e.status:void 0)}),o.normalize(),l}function Zy(a){return!!(a&&a.__CANCEL__)}function Cs(a,e,i){ve.call(this,a??"canceled",ve.ERR_CANCELED,e,i),this.name="CanceledError"}q.inherits(Cs,ve,{__CANCEL__:!0});function Wy(a,e,i){const s=i.config.validateStatus;!i.status||!s||s(i.status)?a(i):e(new ve("Request failed with status code "+i.status,[ve.ERR_BAD_REQUEST,ve.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function iR(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function aR(a,e){a=a||10;const i=new Array(a),s=new Array(a);let o=0,l=0,u;return e=e!==void 0?e:1e3,function(m){const h=Date.now(),g=s[l];u||(u=h),i[o]=m,s[o]=h;let v=l,b=0;for(;v!==o;)b+=i[v++],v=v%a;if(o=(o+1)%a,o===l&&(l=(l+1)%a),h-u<e)return;const k=g&&h-g;return k?Math.round(b*1e3/k):void 0}}function sR(a,e){let i=0,s=1e3/e,o,l;const u=(h,g=Date.now())=>{i=g,o=null,l&&(clearTimeout(l),l=null),a.apply(null,h)};return[(...h)=>{const g=Date.now(),v=g-i;v>=s?u(h,g):(o=h,l||(l=setTimeout(()=>{l=null,u(o)},s-v)))},()=>o&&u(o)]}const Lc=(a,e,i=3)=>{let s=0;const o=aR(50,250);return sR(l=>{const u=l.loaded,d=l.lengthComputable?l.total:void 0,m=u-s,h=o(m),g=u<=d;s=u;const v={loaded:u,total:d,progress:d?u/d:void 0,bytes:m,rate:h||void 0,estimated:h&&d&&g?(d-u)/h:void 0,event:l,lengthComputable:d!=null,[e?"download":"upload"]:!0};a(v)},i)},fv=(a,e)=>{const i=a!=null;return[s=>e[0]({lengthComputable:i,total:a,loaded:s}),e[1]]},hv=a=>(...e)=>q.asap(()=>a(...e)),rR=_t.hasStandardBrowserEnv?((a,e)=>i=>(i=new URL(i,_t.origin),a.protocol===i.protocol&&a.host===i.host&&(e||a.port===i.port)))(new URL(_t.origin),_t.navigator&&/(msie|trident)/i.test(_t.navigator.userAgent)):()=>!0,oR=_t.hasStandardBrowserEnv?{write(a,e,i,s,o,l){const u=[a+"="+encodeURIComponent(e)];q.isNumber(i)&&u.push("expires="+new Date(i).toGMTString()),q.isString(s)&&u.push("path="+s),q.isString(o)&&u.push("domain="+o),l===!0&&u.push("secure"),document.cookie=u.join("; ")},read(a){const e=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function cR(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function lR(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function $y(a,e,i){let s=!cR(e);return a&&(s||i==!1)?lR(a,e):e}const mv=a=>a instanceof Lt?{...a}:a;function ba(a,e){e=e||{};const i={};function s(h,g,v,b){return q.isPlainObject(h)&&q.isPlainObject(g)?q.merge.call({caseless:b},h,g):q.isPlainObject(g)?q.merge({},g):q.isArray(g)?g.slice():g}function o(h,g,v,b){if(q.isUndefined(g)){if(!q.isUndefined(h))return s(void 0,h,v,b)}else return s(h,g,v,b)}function l(h,g){if(!q.isUndefined(g))return s(void 0,g)}function u(h,g){if(q.isUndefined(g)){if(!q.isUndefined(h))return s(void 0,h)}else return s(void 0,g)}function d(h,g,v){if(v in e)return s(h,g);if(v in a)return s(void 0,h)}const m={url:l,method:l,data:l,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:d,headers:(h,g,v)=>o(mv(h),mv(g),v,!0)};return q.forEach(Object.keys(Object.assign({},a,e)),function(g){const v=m[g]||o,b=v(a[g],e[g],g);q.isUndefined(b)&&v!==d||(i[g]=b)}),i}const e0=a=>{const e=ba({},a);let{data:i,withXSRFToken:s,xsrfHeaderName:o,xsrfCookieName:l,headers:u,auth:d}=e;e.headers=u=Lt.from(u),e.url=Qy($y(e.baseURL,e.url,e.allowAbsoluteUrls),a.params,a.paramsSerializer),d&&u.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let m;if(q.isFormData(i)){if(_t.hasStandardBrowserEnv||_t.hasStandardBrowserWebWorkerEnv)u.setContentType(void 0);else if((m=u.getContentType())!==!1){const[h,...g]=m?m.split(";").map(v=>v.trim()).filter(Boolean):[];u.setContentType([h||"multipart/form-data",...g].join("; "))}}if(_t.hasStandardBrowserEnv&&(s&&q.isFunction(s)&&(s=s(e)),s||s!==!1&&rR(e.url))){const h=o&&l&&oR.read(l);h&&u.set(o,h)}return e},uR=typeof XMLHttpRequest<"u",dR=uR&&function(a){return new Promise(function(i,s){const o=e0(a);let l=o.data;const u=Lt.from(o.headers).normalize();let{responseType:d,onUploadProgress:m,onDownloadProgress:h}=o,g,v,b,k,T;function E(){k&&k(),T&&T(),o.cancelToken&&o.cancelToken.unsubscribe(g),o.signal&&o.signal.removeEventListener("abort",g)}let _=new XMLHttpRequest;_.open(o.method.toUpperCase(),o.url,!0),_.timeout=o.timeout;function x(){if(!_)return;const U=Lt.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),w={data:!d||d==="text"||d==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:U,config:a,request:_};Wy(function(J){i(J),E()},function(J){s(J),E()},w),_=null}"onloadend"in _?_.onloadend=x:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(x)},_.onabort=function(){_&&(s(new ve("Request aborted",ve.ECONNABORTED,a,_)),_=null)},_.onerror=function(){s(new ve("Network Error",ve.ERR_NETWORK,a,_)),_=null},_.ontimeout=function(){let N=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const w=o.transitional||Xy;o.timeoutErrorMessage&&(N=o.timeoutErrorMessage),s(new ve(N,w.clarifyTimeoutError?ve.ETIMEDOUT:ve.ECONNABORTED,a,_)),_=null},l===void 0&&u.setContentType(null),"setRequestHeader"in _&&q.forEach(u.toJSON(),function(N,w){_.setRequestHeader(w,N)}),q.isUndefined(o.withCredentials)||(_.withCredentials=!!o.withCredentials),d&&d!=="json"&&(_.responseType=o.responseType),h&&([b,T]=Lc(h,!0),_.addEventListener("progress",b)),m&&_.upload&&([v,k]=Lc(m),_.upload.addEventListener("progress",v),_.upload.addEventListener("loadend",k)),(o.cancelToken||o.signal)&&(g=U=>{_&&(s(!U||U.type?new Cs(null,a,_):U),_.abort(),_=null)},o.cancelToken&&o.cancelToken.subscribe(g),o.signal&&(o.signal.aborted?g():o.signal.addEventListener("abort",g)));const I=iR(o.url);if(I&&_t.protocols.indexOf(I)===-1){s(new ve("Unsupported protocol "+I+":",ve.ERR_BAD_REQUEST,a));return}_.send(l||null)})},fR=(a,e)=>{const{length:i}=a=a?a.filter(Boolean):[];if(e||i){let s=new AbortController,o;const l=function(h){if(!o){o=!0,d();const g=h instanceof Error?h:this.reason;s.abort(g instanceof ve?g:new Cs(g instanceof Error?g.message:g))}};let u=e&&setTimeout(()=>{u=null,l(new ve(`timeout ${e} of ms exceeded`,ve.ETIMEDOUT))},e);const d=()=>{a&&(u&&clearTimeout(u),u=null,a.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),a=null)};a.forEach(h=>h.addEventListener("abort",l));const{signal:m}=s;return m.unsubscribe=()=>q.asap(d),m}},hR=function*(a,e){let i=a.byteLength;if(i<e){yield a;return}let s=0,o;for(;s<i;)o=s+e,yield a.slice(s,o),s=o},mR=async function*(a,e){for await(const i of pR(a))yield*hR(i,e)},pR=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const e=a.getReader();try{for(;;){const{done:i,value:s}=await e.read();if(i)break;yield s}}finally{await e.cancel()}},pv=(a,e,i,s)=>{const o=mR(a,e);let l=0,u,d=m=>{u||(u=!0,s&&s(m))};return new ReadableStream({async pull(m){try{const{done:h,value:g}=await o.next();if(h){d(),m.close();return}let v=g.byteLength;if(i){let b=l+=v;i(b)}m.enqueue(new Uint8Array(g))}catch(h){throw d(h),h}},cancel(m){return d(m),o.return()}},{highWaterMark:2})},$c=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",t0=$c&&typeof ReadableStream=="function",gR=$c&&(typeof TextEncoder=="function"?(a=>e=>a.encode(e))(new TextEncoder):async a=>new Uint8Array(await new Response(a).arrayBuffer())),n0=(a,...e)=>{try{return!!a(...e)}catch{return!1}},vR=t0&&n0(()=>{let a=!1;const e=new Request(_t.origin,{body:new ReadableStream,method:"POST",get duplex(){return a=!0,"half"}}).headers.has("Content-Type");return a&&!e}),gv=64*1024,Zd=t0&&n0(()=>q.isReadableStream(new Response("").body)),jc={stream:Zd&&(a=>a.body)};$c&&(a=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!jc[e]&&(jc[e]=q.isFunction(a[e])?i=>i[e]():(i,s)=>{throw new ve(`Response type '${e}' is not supported`,ve.ERR_NOT_SUPPORT,s)})})})(new Response);const yR=async a=>{if(a==null)return 0;if(q.isBlob(a))return a.size;if(q.isSpecCompliantForm(a))return(await new Request(_t.origin,{method:"POST",body:a}).arrayBuffer()).byteLength;if(q.isArrayBufferView(a)||q.isArrayBuffer(a))return a.byteLength;if(q.isURLSearchParams(a)&&(a=a+""),q.isString(a))return(await gR(a)).byteLength},bR=async(a,e)=>{const i=q.toFiniteNumber(a.getContentLength());return i??yR(e)},SR=$c&&(async a=>{let{url:e,method:i,data:s,signal:o,cancelToken:l,timeout:u,onDownloadProgress:d,onUploadProgress:m,responseType:h,headers:g,withCredentials:v="same-origin",fetchOptions:b}=e0(a);h=h?(h+"").toLowerCase():"text";let k=fR([o,l&&l.toAbortSignal()],u),T;const E=k&&k.unsubscribe&&(()=>{k.unsubscribe()});let _;try{if(m&&vR&&i!=="get"&&i!=="head"&&(_=await bR(g,s))!==0){let w=new Request(e,{method:"POST",body:s,duplex:"half"}),F;if(q.isFormData(s)&&(F=w.headers.get("content-type"))&&g.setContentType(F),w.body){const[J,ne]=fv(_,Lc(hv(m)));s=pv(w.body,gv,J,ne)}}q.isString(v)||(v=v?"include":"omit");const x="credentials"in Request.prototype;T=new Request(e,{...b,signal:k,method:i.toUpperCase(),headers:g.normalize().toJSON(),body:s,duplex:"half",credentials:x?v:void 0});let I=await fetch(T);const U=Zd&&(h==="stream"||h==="response");if(Zd&&(d||U&&E)){const w={};["status","statusText","headers"].forEach(Q=>{w[Q]=I[Q]});const F=q.toFiniteNumber(I.headers.get("content-length")),[J,ne]=d&&fv(F,Lc(hv(d),!0))||[];I=new Response(pv(I.body,gv,J,()=>{ne&&ne(),E&&E()}),w)}h=h||"text";let N=await jc[q.findKey(jc,h)||"text"](I,a);return!U&&E&&E(),await new Promise((w,F)=>{Wy(w,F,{data:N,headers:Lt.from(I.headers),status:I.status,statusText:I.statusText,config:a,request:T})})}catch(x){throw E&&E(),x&&x.name==="TypeError"&&/fetch/i.test(x.message)?Object.assign(new ve("Network Error",ve.ERR_NETWORK,a,T),{cause:x.cause||x}):ve.from(x,x&&x.code,a,T)}}),Wd={http:UE,xhr:dR,fetch:SR};q.forEach(Wd,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const vv=a=>`- ${a}`,TR=a=>q.isFunction(a)||a===null||a===!1,i0={getAdapter:a=>{a=q.isArray(a)?a:[a];const{length:e}=a;let i,s;const o={};for(let l=0;l<e;l++){i=a[l];let u;if(s=i,!TR(i)&&(s=Wd[(u=String(i)).toLowerCase()],s===void 0))throw new ve(`Unknown adapter '${u}'`);if(s)break;o[u||"#"+l]=s}if(!s){const l=Object.entries(o).map(([d,m])=>`adapter ${d} `+(m===!1?"is not supported by the environment":"is not available in the build"));let u=e?l.length>1?`since :
`+l.map(vv).join(`
`):" "+vv(l[0]):"as no adapter specified";throw new ve("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return s},adapters:Wd};function _d(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new Cs(null,a)}function yv(a){return _d(a),a.headers=Lt.from(a.headers),a.data=Rd.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),i0.getAdapter(a.adapter||Kr.adapter)(a).then(function(s){return _d(a),s.data=Rd.call(a,a.transformResponse,s),s.headers=Lt.from(s.headers),s},function(s){return Zy(s)||(_d(a),s&&s.response&&(s.response.data=Rd.call(a,a.transformResponse,s.response),s.response.headers=Lt.from(s.response.headers))),Promise.reject(s)})}const a0="1.8.4",el={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{el[a]=function(s){return typeof s===a||"a"+(e<1?"n ":" ")+a}});const bv={};el.transitional=function(e,i,s){function o(l,u){return"[Axios v"+a0+"] Transitional option '"+l+"'"+u+(s?". "+s:"")}return(l,u,d)=>{if(e===!1)throw new ve(o(u," has been removed"+(i?" in "+i:"")),ve.ERR_DEPRECATED);return i&&!bv[u]&&(bv[u]=!0,console.warn(o(u," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(l,u,d):!0}};el.spelling=function(e){return(i,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function kR(a,e,i){if(typeof a!="object")throw new ve("options must be an object",ve.ERR_BAD_OPTION_VALUE);const s=Object.keys(a);let o=s.length;for(;o-- >0;){const l=s[o],u=e[l];if(u){const d=a[l],m=d===void 0||u(d,l,a);if(m!==!0)throw new ve("option "+l+" must be "+m,ve.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new ve("Unknown option "+l,ve.ERR_BAD_OPTION)}}const bc={assertOptions:kR,validators:el},xn=bc.validators;let ga=class{constructor(e){this.defaults=e,this.interceptors={request:new uv,response:new uv}}async request(e,i){try{return await this._request(e,i)}catch(s){if(s instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const l=o.stack?o.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=ba(this.defaults,i);const{transitional:s,paramsSerializer:o,headers:l}=i;s!==void 0&&bc.assertOptions(s,{silentJSONParsing:xn.transitional(xn.boolean),forcedJSONParsing:xn.transitional(xn.boolean),clarifyTimeoutError:xn.transitional(xn.boolean)},!1),o!=null&&(q.isFunction(o)?i.paramsSerializer={serialize:o}:bc.assertOptions(o,{encode:xn.function,serialize:xn.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),bc.assertOptions(i,{baseUrl:xn.spelling("baseURL"),withXsrfToken:xn.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let u=l&&q.merge(l.common,l[i.method]);l&&q.forEach(["delete","get","head","post","put","patch","common"],T=>{delete l[T]}),i.headers=Lt.concat(u,l);const d=[];let m=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(i)===!1||(m=m&&E.synchronous,d.unshift(E.fulfilled,E.rejected))});const h=[];this.interceptors.response.forEach(function(E){h.push(E.fulfilled,E.rejected)});let g,v=0,b;if(!m){const T=[yv.bind(this),void 0];for(T.unshift.apply(T,d),T.push.apply(T,h),b=T.length,g=Promise.resolve(i);v<b;)g=g.then(T[v++],T[v++]);return g}b=d.length;let k=i;for(v=0;v<b;){const T=d[v++],E=d[v++];try{k=T(k)}catch(_){E.call(this,_);break}}try{g=yv.call(this,k)}catch(T){return Promise.reject(T)}for(v=0,b=h.length;v<b;)g=g.then(h[v++],h[v++]);return g}getUri(e){e=ba(this.defaults,e);const i=$y(e.baseURL,e.url,e.allowAbsoluteUrls);return Qy(i,e.params,e.paramsSerializer)}};q.forEach(["delete","get","head","options"],function(e){ga.prototype[e]=function(i,s){return this.request(ba(s||{},{method:e,url:i,data:(s||{}).data}))}});q.forEach(["post","put","patch"],function(e){function i(s){return function(l,u,d){return this.request(ba(d||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:u}))}}ga.prototype[e]=i(),ga.prototype[e+"Form"]=i(!0)});let CR=class s0{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(l){i=l});const s=this;this.promise.then(o=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](o);s._listeners=null}),this.promise.then=o=>{let l;const u=new Promise(d=>{s.subscribe(d),l=d}).then(o);return u.cancel=function(){s.unsubscribe(l)},u},e(function(l,u,d){s.reason||(s.reason=new Cs(l,u,d),i(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const i=this._listeners.indexOf(e);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const e=new AbortController,i=s=>{e.abort(s)};return this.subscribe(i),e.signal.unsubscribe=()=>this.unsubscribe(i),e.signal}static source(){let e;return{token:new s0(function(o){e=o}),cancel:e}}};function ER(a){return function(i){return a.apply(null,i)}}function RR(a){return q.isObject(a)&&a.isAxiosError===!0}const $d={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries($d).forEach(([a,e])=>{$d[e]=a});function r0(a){const e=new ga(a),i=jy(ga.prototype.request,e);return q.extend(i,ga.prototype,e,{allOwnKeys:!0}),q.extend(i,e,null,{allOwnKeys:!0}),i.create=function(o){return r0(ba(a,o))},i}const tt=r0(Kr);tt.Axios=ga;tt.CanceledError=Cs;tt.CancelToken=CR;tt.isCancel=Zy;tt.VERSION=a0;tt.toFormData=Wc;tt.AxiosError=ve;tt.Cancel=tt.CanceledError;tt.all=function(e){return Promise.all(e)};tt.spread=ER;tt.isAxiosError=RR;tt.mergeConfig=ba;tt.AxiosHeaders=Lt;tt.formToJSON=a=>Jy(q.isHTMLForm(a)?new FormData(a):a);tt.getAdapter=i0.getAdapter;tt.HttpStatusCode=$d;tt.default=tt;const{Axios:cx,AxiosError:lx,CanceledError:ux,isCancel:dx,CancelToken:fx,VERSION:hx,all:mx,Cancel:px,isAxiosError:gx,spread:vx,toFormData:yx,AxiosHeaders:bx,HttpStatusCode:Sx,formToJSON:Tx,getAdapter:kx,mergeConfig:Cx}=tt;var Sv={};function _R(a,e){return e.forEach(function(i){i&&typeof i!="string"&&!Array.isArray(i)&&Object.keys(i).forEach(function(s){if(s!=="default"&&!(s in a)){var o=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(a,s,o.get?o:{enumerable:!0,get:function(){return i[s]}})}})}),Object.freeze(a)}var wR=Object.defineProperty,xR=(a,e,i)=>e in a?wR(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,Tv=(a,e,i)=>xR(a,typeof e!="symbol"?e+"":e,i);class Yt{constructor(){Tv(this,"_locking"),Tv(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const i=new Promise(o=>e=()=>{this._locks-=1,o()}),s=this._locking.then(()=>e);return this._locking=this._locking.then(()=>i),s}}function $e(a,e){if(!a)throw new Error(e)}const OR=34028234663852886e22,DR=-34028234663852886e22,AR=4294967295,NR=2147483647,PR=-2147483648;function Sc(a){if(typeof a!="number")throw new Error("invalid int 32: "+typeof a);if(!Number.isInteger(a)||a>NR||a<PR)throw new Error("invalid int 32: "+a)}function ef(a){if(typeof a!="number")throw new Error("invalid uint 32: "+typeof a);if(!Number.isInteger(a)||a>AR||a<0)throw new Error("invalid uint 32: "+a)}function o0(a){if(typeof a!="number")throw new Error("invalid float 32: "+typeof a);if(Number.isFinite(a)&&(a>OR||a<DR))throw new Error("invalid float 32: "+a)}const c0=Symbol("@bufbuild/protobuf/enum-type");function MR(a){const e=a[c0];return $e(e,"missing enum type on enum object"),e}function l0(a,e,i,s){a[c0]=u0(e,i.map(o=>({no:o.no,name:o.name,localName:a[o.no]})))}function u0(a,e,i){const s=Object.create(null),o=Object.create(null),l=[];for(const u of e){const d=d0(u);l.push(d),s[u.name]=d,o[u.no]=d}return{typeName:a,values:l,findName(u){return s[u]},findNumber(u){return o[u]}}}function UR(a,e,i){const s={};for(const o of e){const l=d0(o);s[l.localName]=l.no,s[l.no]=l.localName}return l0(s,a,e),s}function d0(a){return"localName"in a?a:Object.assign(Object.assign({},a),{localName:a.name})}class Hf{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,i){const s=this.getType(),o=s.runtime.bin,l=o.makeReadOptions(i);return o.readMessage(this,l.readerFactory(e),e.byteLength,l),this}fromJson(e,i){const s=this.getType(),o=s.runtime.json,l=o.makeReadOptions(i);return o.readMessage(s,e,l,this),this}fromJsonString(e,i){let s;try{s=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(s,i)}toBinary(e){const i=this.getType(),s=i.runtime.bin,o=s.makeWriteOptions(e),l=o.writerFactory();return s.writeMessage(this,l,o),l.finish()}toJson(e){const i=this.getType(),s=i.runtime.json,o=s.makeWriteOptions(e);return s.writeMessage(this,o)}toJsonString(e){var i;const s=this.toJson(e);return JSON.stringify(s,null,(i=e==null?void 0:e.prettySpaces)!==null&&i!==void 0?i:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function LR(a,e,i,s){var o;const l=(o=s==null?void 0:s.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),u={[l]:function(d){a.util.initFields(this),a.util.initPartial(d,this)}}[l];return Object.setPrototypeOf(u.prototype,new Hf),Object.assign(u,{runtime:a,typeName:e,fields:a.util.newFieldList(i),fromBinary(d,m){return new u().fromBinary(d,m)},fromJson(d,m){return new u().fromJson(d,m)},fromJsonString(d,m){return new u().fromJsonString(d,m)},equals(d,m){return a.util.equals(u,d,m)}}),u}function jR(){let a=0,e=0;for(let s=0;s<28;s+=7){let o=this.buf[this.pos++];if(a|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}let i=this.buf[this.pos++];if(a|=(i&15)<<28,e=(i&112)>>4,(i&128)==0)return this.assertBounds(),[a,e];for(let s=3;s<=31;s+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<s,(o&128)==0)return this.assertBounds(),[a,e]}throw new Error("invalid varint")}function wd(a,e,i){for(let l=0;l<28;l=l+7){const u=a>>>l,d=!(!(u>>>7)&&e==0),m=(d?u|128:u)&255;if(i.push(m),!d)return}const s=a>>>28&15|(e&7)<<4,o=e>>3!=0;if(i.push((o?s|128:s)&255),!!o){for(let l=3;l<31;l=l+7){const u=e>>>l,d=!!(u>>>7),m=(d?u|128:u)&255;if(i.push(m),!d)return}i.push(e>>>31&1)}}const Tc=4294967296;function kv(a){const e=a[0]==="-";e&&(a=a.slice(1));const i=1e6;let s=0,o=0;function l(u,d){const m=Number(a.slice(u,d));o*=i,s=s*i+m,s>=Tc&&(o=o+(s/Tc|0),s=s%Tc)}return l(-24,-18),l(-18,-12),l(-12,-6),l(-6),e?h0(s,o):Ff(s,o)}function IR(a,e){let i=Ff(a,e);const s=i.hi&2147483648;s&&(i=h0(i.lo,i.hi));const o=f0(i.lo,i.hi);return s?"-"+o:o}function f0(a,e){if({lo:a,hi:e}=BR(a,e),e<=2097151)return String(Tc*e+a);const i=a&16777215,s=(a>>>24|e<<8)&16777215,o=e>>16&65535;let l=i+s*6777216+o*6710656,u=s+o*8147497,d=o*2;const m=1e7;return l>=m&&(u+=Math.floor(l/m),l%=m),u>=m&&(d+=Math.floor(u/m),u%=m),d.toString()+Cv(u)+Cv(l)}function BR(a,e){return{lo:a>>>0,hi:e>>>0}}function Ff(a,e){return{lo:a|0,hi:e|0}}function h0(a,e){return e=~e,a?a=~a+1:e+=1,Ff(a,e)}const Cv=a=>{const e=String(a);return"0000000".slice(e.length)+e};function Ev(a,e){if(a>=0){for(;a>127;)e.push(a&127|128),a=a>>>7;e.push(a)}else{for(let i=0;i<9;i++)e.push(a&127|128),a=a>>7;e.push(1)}}function zR(){let a=this.buf[this.pos++],e=a&127;if((a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<7,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<14,(a&128)==0)return this.assertBounds(),e;if(a=this.buf[this.pos++],e|=(a&127)<<21,(a&128)==0)return this.assertBounds(),e;a=this.buf[this.pos++],e|=(a&15)<<28;for(let i=5;(a&128)!==0&&i<10;i++)a=this.buf[this.pos++];if((a&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function qR(){const a=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof a.getBigInt64=="function"&&typeof a.getBigUint64=="function"&&typeof a.setBigInt64=="function"&&typeof a.setBigUint64=="function"&&(typeof process!="object"||typeof Sv!="object"||Sv.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),l=BigInt("9223372036854775807"),u=BigInt("0"),d=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(m){const h=typeof m=="bigint"?m:BigInt(m);if(h>l||h<o)throw new Error("int64 invalid: ".concat(m));return h},uParse(m){const h=typeof m=="bigint"?m:BigInt(m);if(h>d||h<u)throw new Error("uint64 invalid: ".concat(m));return h},enc(m){return a.setBigInt64(0,this.parse(m),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},uEnc(m){return a.setBigInt64(0,this.uParse(m),!0),{lo:a.getInt32(0,!0),hi:a.getInt32(4,!0)}},dec(m,h){return a.setInt32(0,m,!0),a.setInt32(4,h,!0),a.getBigInt64(0,!0)},uDec(m,h){return a.setInt32(0,m,!0),a.setInt32(4,h,!0),a.getBigUint64(0,!0)}}}const i=o=>$e(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),s=o=>$e(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),i(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),s(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),i(o),kv(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),s(o),kv(o)},dec(o,l){return IR(o,l)},uDec(o,l){return f0(o,l)}}}const Ge=qR();var K;(function(a){a[a.DOUBLE=1]="DOUBLE",a[a.FLOAT=2]="FLOAT",a[a.INT64=3]="INT64",a[a.UINT64=4]="UINT64",a[a.INT32=5]="INT32",a[a.FIXED64=6]="FIXED64",a[a.FIXED32=7]="FIXED32",a[a.BOOL=8]="BOOL",a[a.STRING=9]="STRING",a[a.BYTES=12]="BYTES",a[a.UINT32=13]="UINT32",a[a.SFIXED32=15]="SFIXED32",a[a.SFIXED64=16]="SFIXED64",a[a.SINT32=17]="SINT32",a[a.SINT64=18]="SINT64"})(K||(K={}));var qi;(function(a){a[a.BIGINT=0]="BIGINT",a[a.STRING=1]="STRING"})(qi||(qi={}));function Ni(a,e,i){if(e===i)return!0;if(a==K.BYTES){if(!(e instanceof Uint8Array)||!(i instanceof Uint8Array)||e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==i[s])return!1;return!0}switch(a){case K.UINT64:case K.FIXED64:case K.INT64:case K.SFIXED64:case K.SINT64:return e==i}return!1}function gs(a,e){switch(a){case K.BOOL:return!1;case K.UINT64:case K.FIXED64:case K.INT64:case K.SFIXED64:case K.SINT64:return e==0?Ge.zero:"0";case K.DOUBLE:case K.FLOAT:return 0;case K.BYTES:return new Uint8Array(0);case K.STRING:return"";default:return 0}}function m0(a,e){switch(a){case K.BOOL:return e===!1;case K.STRING:return e==="";case K.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var it;(function(a){a[a.Varint=0]="Varint",a[a.Bit64=1]="Bit64",a[a.LengthDelimited=2]="LengthDelimited",a[a.StartGroup=3]="StartGroup",a[a.EndGroup=4]="EndGroup",a[a.Bit32=5]="Bit32"})(it||(it={}));class VR{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let i=new Uint8Array(e),s=0;for(let o=0;o<this.chunks.length;o++)i.set(this.chunks[o],s),s+=this.chunks[o].length;return this.chunks=[],i}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),i=this.stack.pop();if(!i)throw new Error("invalid state, fork stack empty");return this.chunks=i.chunks,this.buf=i.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,i){return this.uint32((e<<3|i)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ef(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Sc(e),Ev(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let i=this.textEncoder.encode(e);return this.uint32(i.byteLength),this.raw(i)}float(e){o0(e);let i=new Uint8Array(4);return new DataView(i.buffer).setFloat32(0,e,!0),this.raw(i)}double(e){let i=new Uint8Array(8);return new DataView(i.buffer).setFloat64(0,e,!0),this.raw(i)}fixed32(e){ef(e);let i=new Uint8Array(4);return new DataView(i.buffer).setUint32(0,e,!0),this.raw(i)}sfixed32(e){Sc(e);let i=new Uint8Array(4);return new DataView(i.buffer).setInt32(0,e,!0),this.raw(i)}sint32(e){return Sc(e),e=(e<<1^e>>31)>>>0,Ev(e,this.buf),this}sfixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=Ge.enc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}fixed64(e){let i=new Uint8Array(8),s=new DataView(i.buffer),o=Ge.uEnc(e);return s.setInt32(0,o.lo,!0),s.setInt32(4,o.hi,!0),this.raw(i)}int64(e){let i=Ge.enc(e);return wd(i.lo,i.hi,this.buf),this}sint64(e){let i=Ge.enc(e),s=i.hi>>31,o=i.lo<<1^s,l=(i.hi<<1|i.lo>>>31)^s;return wd(o,l,this.buf),this}uint64(e){let i=Ge.uEnc(e);return wd(i.lo,i.hi,this.buf),this}}class HR{constructor(e,i){this.varint64=jR,this.uint32=zR,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=i??new TextDecoder}tag(){let e=this.uint32(),i=e>>>3,s=e&7;if(i<=0||s<0||s>5)throw new Error("illegal tag: field no "+i+" wire type "+s);return[i,s]}skip(e,i){let s=this.pos;switch(e){case it.Varint:for(;this.buf[this.pos++]&128;);break;case it.Bit64:this.pos+=4;case it.Bit32:this.pos+=4;break;case it.LengthDelimited:let o=this.uint32();this.pos+=o;break;case it.StartGroup:for(;;){const[l,u]=this.tag();if(u===it.EndGroup){if(i!==void 0&&l!==i)throw new Error("invalid end group tag");break}this.skip(u,l)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(s,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Ge.dec(...this.varint64())}uint64(){return Ge.uDec(...this.varint64())}sint64(){let[e,i]=this.varint64(),s=-(e&1);return e=(e>>>1|(i&1)<<31)^s,i=i>>>1^s,Ge.dec(e,i)}bool(){let[e,i]=this.varint64();return e!==0||i!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Ge.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Ge.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),i=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(i,i+e)}string(){return this.textDecoder.decode(this.bytes())}}function FR(a,e,i,s){let o;return{typeName:e,extendee:i,get field(){if(!o){const l=typeof s=="function"?s():s;l.name=e.split(".").pop(),l.jsonName="[".concat(e,"]"),o=a.util.newFieldList([l]).list()[0]}return o},runtime:a}}function p0(a){const e=a.field.localName,i=Object.create(null);return i[e]=GR(a),[i,()=>i[e]]}function GR(a){const e=a.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return gs(e.T,e.L);case"message":const i=e.T,s=new i;return i.fieldWrapper?i.fieldWrapper.unwrapField(s):s;case"map":throw"map fields are not allowed to be extensions"}}function KR(a,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let i=a.length-1;i>=0;--i)if(a[i].no==e.no)return[a[i]];return[]}return a.filter(i=>i.no===e.no)}let ti="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),tl=[];for(let a=0;a<ti.length;a++)tl[ti[a].charCodeAt(0)]=a;tl[45]=ti.indexOf("+");tl[95]=ti.indexOf("/");const g0={dec(a){let e=a.length*3/4;a[a.length-2]=="="?e-=2:a[a.length-1]=="="&&(e-=1);let i=new Uint8Array(e),s=0,o=0,l,u=0;for(let d=0;d<a.length;d++){if(l=tl[a.charCodeAt(d)],l===void 0)switch(a[d]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:u=l,o=1;break;case 1:i[s++]=u<<2|(l&48)>>4,u=l,o=2;break;case 2:i[s++]=(u&15)<<4|(l&60)>>2,u=l,o=3;break;case 3:i[s++]=(u&3)<<6|l,o=0;break}}if(o==1)throw Error("invalid base64 string.");return i.subarray(0,s)},enc(a){let e="",i=0,s,o=0;for(let l=0;l<a.length;l++)switch(s=a[l],i){case 0:e+=ti[s>>2],o=(s&3)<<4,i=1;break;case 1:e+=ti[o|s>>4],o=(s&15)<<2,i=2;break;case 2:e+=ti[o|s>>6],e+=ti[s&63],i=0;break}return i&&(e+=ti[o],e+="=",i==1&&(e+="=")),e}};function YR(a,e,i){y0(e,a);const s=e.runtime.bin.makeReadOptions(i),o=KR(a.getType().runtime.bin.listUnknownFields(a),e.field),[l,u]=p0(e);for(const d of o)e.runtime.bin.readField(l,s.readerFactory(d.data),e.field,d.wireType,s);return u()}function QR(a,e,i,s){y0(e,a);const o=e.runtime.bin.makeReadOptions(s),l=e.runtime.bin.makeWriteOptions(s);if(v0(a,e)){const h=a.getType().runtime.bin.listUnknownFields(a).filter(g=>g.no!=e.field.no);a.getType().runtime.bin.discardUnknownFields(a);for(const g of h)a.getType().runtime.bin.onUnknownField(a,g.no,g.wireType,g.data)}const u=l.writerFactory();let d=e.field;!d.opt&&!d.repeated&&(d.kind=="enum"||d.kind=="scalar")&&(d=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(d,i,u,l);const m=o.readerFactory(u.finish());for(;m.pos<m.len;){const[h,g]=m.tag(),v=m.skip(g,h);a.getType().runtime.bin.onUnknownField(a,h,g,v)}}function v0(a,e){const i=a.getType();return e.extendee.typeName===i.typeName&&!!i.runtime.bin.listUnknownFields(a).find(s=>s.no==e.field.no)}function y0(a,e){$e(a.extendee.typeName==e.getType().typeName,"extension ".concat(a.typeName," can only be applied to message ").concat(a.extendee.typeName))}function b0(a,e){const i=a.localName;if(a.repeated)return e[i].length>0;if(a.oneof)return e[a.oneof.localName].case===i;switch(a.kind){case"enum":case"scalar":return a.opt||a.req?e[i]!==void 0:a.kind=="enum"?e[i]!==a.T.values[0].no:!m0(a.T,e[i]);case"message":return e[i]!==void 0;case"map":return Object.keys(e[i]).length>0}}function Rv(a,e){const i=a.localName,s=!a.opt&&!a.req;if(a.repeated)e[i]=[];else if(a.oneof)e[a.oneof.localName]={case:void 0};else switch(a.kind){case"map":e[i]={};break;case"enum":e[i]=s?a.T.values[0].no:void 0;break;case"scalar":e[i]=s?gs(a.T,a.L):void 0;break;case"message":e[i]=void 0;break}}function va(a,e){if(a===null||typeof a!="object"||!Object.getOwnPropertyNames(Hf.prototype).every(s=>s in a&&typeof a[s]=="function"))return!1;const i=a.getType();return i===null||typeof i!="function"||!("typeName"in i)||typeof i.typeName!="string"?!1:e===void 0?!0:i.typeName==e.typeName}function S0(a,e){return va(e)||!a.fieldWrapper?e:a.fieldWrapper.wrapField(e)}K.DOUBLE,K.FLOAT,K.INT64,K.UINT64,K.INT32,K.UINT32,K.BOOL,K.STRING,K.BYTES;const _v={ignoreUnknownFields:!1},wv={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function XR(a){return a?Object.assign(Object.assign({},_v),a):_v}function JR(a){return a?Object.assign(Object.assign({},wv),a):wv}const Ic=Symbol(),kc=Symbol();function ZR(){return{makeReadOptions:XR,makeWriteOptions:JR,readMessage(a,e,i,s){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(a.typeName," from JSON: ").concat(Dn(e)));s=s??new a;const o=new Map,l=i.typeRegistry;for(const[u,d]of Object.entries(e)){const m=a.fields.findJsonName(u);if(m){if(m.oneof){if(d===null&&m.kind=="scalar")continue;const h=o.get(m.oneof);if(h!==void 0)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: multiple keys for oneof "').concat(m.oneof.name,'" present: "').concat(h,'", "').concat(u,'"'));o.set(m.oneof,u)}xv(s,d,m,i,a)}else{let h=!1;if(l!=null&&l.findExtension&&u.startsWith("[")&&u.endsWith("]")){const g=l.findExtension(u.substring(1,u.length-1));if(g&&g.extendee.typeName==a.typeName){h=!0;const[v,b]=p0(g);xv(v,d,g.field,i,g),QR(s,g,b(),i)}}if(!h&&!i.ignoreUnknownFields)throw new Error("cannot decode message ".concat(a.typeName,' from JSON: key "').concat(u,'" is unknown'))}}return s},writeMessage(a,e){const i=a.getType(),s={};let o;try{for(o of i.fields.byNumber()){if(!b0(o,a)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!$R(o))continue}const u=o.oneof?a[o.oneof.localName].value:a[o.localName],d=Ov(o,u,e);d!==void 0&&(s[e.useProtoFieldName?o.name:o.jsonName]=d)}const l=e.typeRegistry;if(l!=null&&l.findExtensionFor)for(const u of i.runtime.bin.listUnknownFields(a)){const d=l.findExtensionFor(i.typeName,u.no);if(d&&v0(a,d)){const m=YR(a,d,e),h=Ov(d.field,m,e);h!==void 0&&(s[d.field.jsonName]=h)}}}catch(l){const u=o?"cannot encode field ".concat(i.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(i.typeName," to JSON"),d=l instanceof Error?l.message:String(l);throw new Error(u+(d.length>0?": ".concat(d):""))}return s},readScalar(a,e,i){return Pr(a,e,i??qi.BIGINT,!0)},writeScalar(a,e,i){if(e!==void 0&&(i||m0(a,e)))return Cc(a,e)},debug:Dn}}function Dn(a){if(a===null)return"null";switch(typeof a){case"object":return Array.isArray(a)?"array":"object";case"string":return a.length>100?"string":'"'.concat(a.split('"').join('\\"'),'"');default:return String(a)}}function xv(a,e,i,s,o){let l=i.localName;if(i.repeated){if($e(i.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e)));const u=a[l];for(const d of e){if(d===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(d)));switch(i.kind){case"message":u.push(i.T.fromJson(d,s));break;case"enum":const m=xd(i.T,d,s.ignoreUnknownFields,!0);m!==kc&&u.push(m);break;case"scalar":try{u.push(Pr(i.T,d,i.L,!0))}catch(h){let g="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(d));throw h instanceof Error&&h.message.length>0&&(g+=": ".concat(h.message)),new Error(g)}break}}}else if(i.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e)));const u=a[l];for(const[d,m]of Object.entries(e)){if(m===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: map value null"));let h;try{h=WR(i.K,d)}catch(g){let v="cannot decode map key for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e));throw g instanceof Error&&g.message.length>0&&(v+=": ".concat(g.message)),new Error(v)}switch(i.V.kind){case"message":u[h]=i.V.T.fromJson(m,s);break;case"enum":const g=xd(i.V.T,m,s.ignoreUnknownFields,!0);g!==kc&&(u[h]=g);break;case"scalar":try{u[h]=Pr(i.V.T,m,qi.BIGINT,!0)}catch(v){let b="cannot decode map value for field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e));throw v instanceof Error&&v.message.length>0&&(b+=": ".concat(v.message)),new Error(b)}break}}}else switch(i.oneof&&(a=a[i.oneof.localName]={case:l},l="value"),i.kind){case"message":const u=i.T;if(e===null&&u.typeName!="google.protobuf.Value")return;let d=a[l];va(d)?d.fromJson(e,s):(a[l]=d=u.fromJson(e,s),u.fieldWrapper&&!i.oneof&&(a[l]=u.fieldWrapper.unwrapField(d)));break;case"enum":const m=xd(i.T,e,s.ignoreUnknownFields,!1);switch(m){case Ic:Rv(i,a);break;case kc:break;default:a[l]=m;break}break;case"scalar":try{const h=Pr(i.T,e,i.L,!1);switch(h){case Ic:Rv(i,a);break;default:a[l]=h;break}}catch(h){let g="cannot decode field ".concat(o.typeName,".").concat(i.name," from JSON: ").concat(Dn(e));throw h instanceof Error&&h.message.length>0&&(g+=": ".concat(h.message)),new Error(g)}break}}function WR(a,e){if(a===K.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Pr(a,e,qi.BIGINT,!0).toString()}function Pr(a,e,i,s){if(e===null)return s?gs(a,i):Ic;switch(a){case K.DOUBLE:case K.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return a==K.FLOAT&&o0(o),o;case K.INT32:case K.FIXED32:case K.SFIXED32:case K.SINT32:case K.UINT32:let l;if(typeof e=="number"?l=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(l=Number(e)),l===void 0)break;return a==K.UINT32||a==K.FIXED32?ef(l):Sc(l),l;case K.INT64:case K.SFIXED64:case K.SINT64:if(typeof e!="number"&&typeof e!="string")break;const u=Ge.parse(e);return i?u.toString():u;case K.FIXED64:case K.UINT64:if(typeof e!="number"&&typeof e!="string")break;const d=Ge.uParse(e);return i?d.toString():d;case K.BOOL:if(typeof e!="boolean")break;return e;case K.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case K.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return g0.dec(e)}throw new Error}function xd(a,e,i,s){if(e===null)return a.typeName=="google.protobuf.NullValue"?0:s?a.values[0].no:Ic;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=a.findName(e);if(o!==void 0)return o.no;if(i)return kc;break}throw new Error("cannot decode enum ".concat(a.typeName," from JSON: ").concat(Dn(e)))}function $R(a){return a.repeated||a.kind=="map"?!0:!(a.oneof||a.kind=="message"||a.opt||a.req)}function Ov(a,e,i){if(a.kind=="map"){$e(typeof e=="object"&&e!=null);const s={},o=Object.entries(e);switch(a.V.kind){case"scalar":for(const[u,d]of o)s[u.toString()]=Cc(a.V.T,d);break;case"message":for(const[u,d]of o)s[u.toString()]=d.toJson(i);break;case"enum":const l=a.V.T;for(const[u,d]of o)s[u.toString()]=Od(l,d,i.enumAsInteger);break}return i.emitDefaultValues||o.length>0?s:void 0}if(a.repeated){$e(Array.isArray(e));const s=[];switch(a.kind){case"scalar":for(let o=0;o<e.length;o++)s.push(Cc(a.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)s.push(Od(a.T,e[o],i.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)s.push(e[o].toJson(i));break}return i.emitDefaultValues||s.length>0?s:void 0}switch(a.kind){case"scalar":return Cc(a.T,e);case"enum":return Od(a.T,e,i.enumAsInteger);case"message":return S0(a.T,e).toJson(i)}}function Od(a,e,i){var s;if($e(typeof e=="number"),a.typeName=="google.protobuf.NullValue")return null;if(i)return e;const o=a.findNumber(e);return(s=o==null?void 0:o.name)!==null&&s!==void 0?s:e}function Cc(a,e){switch(a){case K.INT32:case K.SFIXED32:case K.SINT32:case K.FIXED32:case K.UINT32:return $e(typeof e=="number"),e;case K.FLOAT:case K.DOUBLE:return $e(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case K.STRING:return $e(typeof e=="string"),e;case K.BOOL:return $e(typeof e=="boolean"),e;case K.UINT64:case K.FIXED64:case K.INT64:case K.SFIXED64:case K.SINT64:return $e(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case K.BYTES:return $e(e instanceof Uint8Array),g0.enc(e)}}const rs=Symbol("@bufbuild/protobuf/unknown-fields"),Dv={readUnknownFields:!0,readerFactory:a=>new HR(a)},Av={writeUnknownFields:!0,writerFactory:()=>new VR};function e1(a){return a?Object.assign(Object.assign({},Dv),a):Dv}function t1(a){return a?Object.assign(Object.assign({},Av),a):Av}function n1(){return{makeReadOptions:e1,makeWriteOptions:t1,listUnknownFields(a){var e;return(e=a[rs])!==null&&e!==void 0?e:[]},discardUnknownFields(a){delete a[rs]},writeUnknownFields(a,e){const s=a[rs];if(s)for(const o of s)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(a,e,i,s){const o=a;Array.isArray(o[rs])||(o[rs]=[]),o[rs].push({no:e,wireType:i,data:s})},readMessage(a,e,i,s,o){const l=a.getType(),u=o?e.len:e.pos+i;let d,m;for(;e.pos<u&&([d,m]=e.tag(),!(o===!0&&m==it.EndGroup));){const h=l.fields.find(d);if(!h){const g=e.skip(m,d);s.readUnknownFields&&this.onUnknownField(a,d,m,g);continue}Nv(a,e,h,m,s)}if(o&&(m!=it.EndGroup||d!==i))throw new Error("invalid end group tag")},readField:Nv,writeMessage(a,e,i){const s=a.getType();for(const o of s.fields.byNumber()){if(!b0(o,a)){if(o.req)throw new Error("cannot encode field ".concat(s.typeName,".").concat(o.name," to binary: required field not set"));continue}const l=o.oneof?a[o.oneof.localName].value:a[o.localName];Pv(o,l,e,i)}return i.writeUnknownFields&&this.writeUnknownFields(a,e),e},writeField(a,e,i,s){e!==void 0&&Pv(a,e,i,s)}}}function Nv(a,e,i,s,o){let{repeated:l,localName:u}=i;switch(i.oneof&&(a=a[i.oneof.localName],a.case!=u&&delete a.value,a.case=u,u="value"),i.kind){case"scalar":case"enum":const d=i.kind=="enum"?K.INT32:i.T;let m=Bc;if(i.kind=="scalar"&&i.L>0&&(m=a1),l){let b=a[u];if(s==it.LengthDelimited&&d!=K.STRING&&d!=K.BYTES){let T=e.uint32()+e.pos;for(;e.pos<T;)b.push(m(e,d))}else b.push(m(e,d))}else a[u]=m(e,d);break;case"message":const h=i.T;l?a[u].push(Ec(e,new h,o,i)):va(a[u])?Ec(e,a[u],o,i):(a[u]=Ec(e,new h,o,i),h.fieldWrapper&&!i.oneof&&!i.repeated&&(a[u]=h.fieldWrapper.unwrapField(a[u])));break;case"map":let[g,v]=i1(i,e,o);a[u][g]=v;break}}function Ec(a,e,i,s){const o=e.getType().runtime.bin,l=s==null?void 0:s.delimited;return o.readMessage(e,a,l?s.no:a.uint32(),i,l),e}function i1(a,e,i){const s=e.uint32(),o=e.pos+s;let l,u;for(;e.pos<o;){const[d]=e.tag();switch(d){case 1:l=Bc(e,a.K);break;case 2:switch(a.V.kind){case"scalar":u=Bc(e,a.V.T);break;case"enum":u=e.int32();break;case"message":u=Ec(e,new a.V.T,i,void 0);break}break}}if(l===void 0&&(l=gs(a.K,qi.BIGINT)),typeof l!="string"&&typeof l!="number"&&(l=l.toString()),u===void 0)switch(a.V.kind){case"scalar":u=gs(a.V.T,qi.BIGINT);break;case"enum":u=a.V.T.values[0].no;break;case"message":u=new a.V.T;break}return[l,u]}function a1(a,e){const i=Bc(a,e);return typeof i=="bigint"?i.toString():i}function Bc(a,e){switch(e){case K.STRING:return a.string();case K.BOOL:return a.bool();case K.DOUBLE:return a.double();case K.FLOAT:return a.float();case K.INT32:return a.int32();case K.INT64:return a.int64();case K.UINT64:return a.uint64();case K.FIXED64:return a.fixed64();case K.BYTES:return a.bytes();case K.FIXED32:return a.fixed32();case K.SFIXED32:return a.sfixed32();case K.SFIXED64:return a.sfixed64();case K.SINT64:return a.sint64();case K.UINT32:return a.uint32();case K.SINT32:return a.sint32()}}function Pv(a,e,i,s){$e(e!==void 0);const o=a.repeated;switch(a.kind){case"scalar":case"enum":let l=a.kind=="enum"?K.INT32:a.T;if(o)if($e(Array.isArray(e)),a.packed)r1(i,l,a.no,e);else for(const u of e)Mr(i,l,a.no,u);else Mr(i,l,a.no,e);break;case"message":if(o){$e(Array.isArray(e));for(const u of e)Mv(i,s,a,u)}else Mv(i,s,a,e);break;case"map":$e(typeof e=="object"&&e!=null);for(const[u,d]of Object.entries(e))s1(i,s,a,u,d);break}}function s1(a,e,i,s,o){a.tag(i.no,it.LengthDelimited),a.fork();let l=s;switch(i.K){case K.INT32:case K.FIXED32:case K.UINT32:case K.SFIXED32:case K.SINT32:l=Number.parseInt(s);break;case K.BOOL:$e(s=="true"||s=="false"),l=s=="true";break}switch(Mr(a,i.K,1,l),i.V.kind){case"scalar":Mr(a,i.V.T,2,o);break;case"enum":Mr(a,K.INT32,2,o);break;case"message":$e(o!==void 0),a.tag(2,it.LengthDelimited).bytes(o.toBinary(e));break}a.join()}function Mv(a,e,i,s){const o=S0(i.T,s);i.delimited?a.tag(i.no,it.StartGroup).raw(o.toBinary(e)).tag(i.no,it.EndGroup):a.tag(i.no,it.LengthDelimited).bytes(o.toBinary(e))}function Mr(a,e,i,s){$e(s!==void 0);let[o,l]=T0(e);a.tag(i,o)[l](s)}function r1(a,e,i,s){if(!s.length)return;a.tag(i,it.LengthDelimited).fork();let[,o]=T0(e);for(let l=0;l<s.length;l++)a[o](s[l]);a.join()}function T0(a){let e=it.Varint;switch(a){case K.BYTES:case K.STRING:e=it.LengthDelimited;break;case K.DOUBLE:case K.FIXED64:case K.SFIXED64:e=it.Bit64;break;case K.FIXED32:case K.SFIXED32:case K.FLOAT:e=it.Bit32;break}const i=K[a].toLowerCase();return[e,i]}function o1(){return{setEnumType:l0,initPartial(a,e){if(a===void 0)return;const i=e.getType();for(const s of i.fields.byMember()){const o=s.localName,l=e,u=a;if(u[o]!=null)switch(s.kind){case"oneof":const d=u[o].case;if(d===void 0)continue;const m=s.findField(d);let h=u[o].value;m&&m.kind=="message"&&!va(h,m.T)?h=new m.T(h):m&&m.kind==="scalar"&&m.T===K.BYTES&&(h=wr(h)),l[o]={case:d,value:h};break;case"scalar":case"enum":let g=u[o];s.T===K.BYTES&&(g=s.repeated?g.map(wr):wr(g)),l[o]=g;break;case"map":switch(s.V.kind){case"scalar":case"enum":if(s.V.T===K.BYTES)for(const[k,T]of Object.entries(u[o]))l[o][k]=wr(T);else Object.assign(l[o],u[o]);break;case"message":const b=s.V.T;for(const k of Object.keys(u[o])){let T=u[o][k];b.fieldWrapper||(T=new b(T)),l[o][k]=T}break}break;case"message":const v=s.T;if(s.repeated)l[o]=u[o].map(b=>va(b,v)?b:new v(b));else{const b=u[o];v.fieldWrapper?v.typeName==="google.protobuf.BytesValue"?l[o]=wr(b):l[o]=b:l[o]=va(b,v)?b:new v(b)}break}}},equals(a,e,i){return e===i?!0:!e||!i?!1:a.fields.byMember().every(s=>{const o=e[s.localName],l=i[s.localName];if(s.repeated){if(o.length!==l.length)return!1;switch(s.kind){case"message":return o.every((u,d)=>s.T.equals(u,l[d]));case"scalar":return o.every((u,d)=>Ni(s.T,u,l[d]));case"enum":return o.every((u,d)=>Ni(K.INT32,u,l[d]))}throw new Error("repeated cannot contain ".concat(s.kind))}switch(s.kind){case"message":return s.T.equals(o,l);case"enum":return Ni(K.INT32,o,l);case"scalar":return Ni(s.T,o,l);case"oneof":if(o.case!==l.case)return!1;const u=s.findField(o.case);if(u===void 0)return!0;switch(u.kind){case"message":return u.T.equals(o.value,l.value);case"enum":return Ni(K.INT32,o.value,l.value);case"scalar":return Ni(u.T,o.value,l.value)}throw new Error("oneof cannot contain ".concat(u.kind));case"map":const d=Object.keys(o).concat(Object.keys(l));switch(s.V.kind){case"message":const m=s.V.T;return d.every(g=>m.equals(o[g],l[g]));case"enum":return d.every(g=>Ni(K.INT32,o[g],l[g]));case"scalar":const h=s.V.T;return d.every(g=>Ni(h,o[g],l[g]))}break}})},clone(a){const e=a.getType(),i=new e,s=i;for(const o of e.fields.byMember()){const l=a[o.localName];let u;if(o.repeated)u=l.map(lc);else if(o.kind=="map"){u=s[o.localName];for(const[d,m]of Object.entries(l))u[d]=lc(m)}else o.kind=="oneof"?u=o.findField(l.case)?{case:l.case,value:lc(l.value)}:{case:void 0}:u=lc(l);s[o.localName]=u}for(const o of e.runtime.bin.listUnknownFields(a))e.runtime.bin.onUnknownField(s,o.no,o.wireType,o.data);return i}}}function lc(a){if(a===void 0)return a;if(va(a))return a.clone();if(a instanceof Uint8Array){const e=new Uint8Array(a.byteLength);return e.set(a),e}return a}function wr(a){return a instanceof Uint8Array?a:new Uint8Array(a)}function c1(a,e,i){return{syntax:a,json:ZR(),bin:n1(),util:Object.assign(Object.assign({},o1()),{newFieldList:e,initFields:i}),makeMessageType(s,o,l){return LR(this,s,o,l)},makeEnum:UR,makeEnumType:u0,getEnumType:MR,makeExtension(s,o,l){return FR(this,s,o,l)}}}class l1{constructor(e,i){this._fields=e,this._normalizer=i}findJsonName(e){if(!this.jsonNames){const i={};for(const s of this.list())i[s.jsonName]=i[s.name]=s;this.jsonNames=i}return this.jsonNames[e]}find(e){if(!this.numbers){const i={};for(const s of this.list())i[s.no]=s;this.numbers=i}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,i)=>e.no-i.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let i;for(const s of this.list())s.oneof?s.oneof!==i&&(i=s.oneof,e.push(i)):e.push(s)}return this.members}}function k0(a,e){const i=C0(a);return e?i:p1(m1(i))}function u1(a){return k0(a,!1)}const d1=C0;function C0(a){let e=!1;const i=[];for(let s=0;s<a.length;s++){let o=a.charAt(s);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),i.push(o);break}}return i.join("")}const f1=new Set(["constructor","toString","toJSON","valueOf"]),h1=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),E0=a=>"".concat(a,"$"),m1=a=>h1.has(a)?E0(a):a,p1=a=>f1.has(a)?E0(a):a;class g1{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=u1(e)}addField(e){$e(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let i=0;i<this.fields.length;i++)this._lookup[this.fields[i].localName]=this.fields[i]}return this._lookup[e]}}function v1(a,e){var i,s,o,l,u,d;const m=[];let h;for(const g of typeof a=="function"?a():a){const v=g;if(v.localName=k0(g.name,g.oneof!==void 0),v.jsonName=(i=g.jsonName)!==null&&i!==void 0?i:d1(g.name),v.repeated=(s=g.repeated)!==null&&s!==void 0?s:!1,g.kind=="scalar"&&(v.L=(o=g.L)!==null&&o!==void 0?o:qi.BIGINT),v.delimited=(l=g.delimited)!==null&&l!==void 0?l:!1,v.req=(u=g.req)!==null&&u!==void 0?u:!1,v.opt=(d=g.opt)!==null&&d!==void 0?d:!1,g.packed===void 0&&(v.packed=g.kind=="enum"||g.kind=="scalar"&&g.T!=K.BYTES&&g.T!=K.STRING),g.oneof!==void 0){const b=typeof g.oneof=="string"?g.oneof:g.oneof.name;(!h||h.name!=b)&&(h=new g1(b)),v.oneof=h,h.addField(v)}m.push(v)}return m}const z=c1("proto3",a=>new l1(a,e=>v1(e)),a=>{for(const e of a.getType().fields.byMember()){if(e.opt)continue;const i=e.localName,s=a;if(e.repeated){s[i]=[];continue}switch(e.kind){case"oneof":s[i]={case:void 0};break;case"enum":s[i]=0;break;case"map":s[i]={};break;case"scalar":s[i]=gs(e.T,e.L);break}}});class Mt extends Hf{constructor(e){super(),this.seconds=Ge.zero,this.nanos=0,z.util.initPartial(e,this)}fromJson(e,i){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(z.json.debug(e)));const s=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!s)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(s[1]+"-"+s[2]+"-"+s[3]+"T"+s[4]+":"+s[5]+":"+s[6]+(s[8]?s[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Ge.parse(o/1e3),this.nanos=0,s[7]&&(this.nanos=parseInt("1"+s[7]+"0".repeat(9-s[7].length))-1e9),this}toJson(e){const i=Number(this.seconds)*1e3;if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let s="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?s="."+o.substring(0,3)+"Z":o.substring(6)==="000"?s="."+o.substring(0,6)+"Z":s="."+o+"Z"}return new Date(i).toISOString().replace(".000Z",s)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Mt.fromDate(new Date)}static fromDate(e){const i=e.getTime();return new Mt({seconds:Ge.parse(Math.floor(i/1e3)),nanos:i%1e3*1e6})}static fromBinary(e,i){return new Mt().fromBinary(e,i)}static fromJson(e,i){return new Mt().fromJson(e,i)}static fromJsonString(e,i){return new Mt().fromJsonString(e,i)}static equals(e,i){return z.util.equals(Mt,e,i)}}Mt.runtime=z;Mt.typeName="google.protobuf.Timestamp";Mt.fields=z.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const y1=z.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Mt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:b1,repeated:!0},{no:5,name:"events",kind:"message",T:T1,repeated:!0}]),b1=z.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:S1,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),S1=z.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Mt},{no:3,name:"value",kind:"scalar",T:2}]),T1=z.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Mt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Mt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),R0=z.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"REGRESSION"},{no:1,name:"SIMULCAST"}]),gn=z.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),ct=z.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),Gf=z.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Nr=z.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Br=z.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),yn=z.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"}]),os=z.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),k1=z.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Nn=z.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"}]),Kf=z.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:zc,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:j0}]),zc=z.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),C1=z.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:z.getEnumType(ct),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),zr=z.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:z.getEnumType(tf)},{no:4,name:"tracks",kind:"message",T:ls,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:C1},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:z.getEnumType(qc)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:z.getEnumType(yn)}]),tf=z.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),qc=z.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),Kt=z.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),E1=z.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:ya,repeated:!0}]),ls=z.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:z.getEnumType(gn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:z.getEnumType(ct)},{no:10,name:"layers",kind:"message",T:ya,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:E1,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:z.getEnumType(Kt)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:j0},{no:19,name:"audio_features",kind:"enum",T:z.getEnumType(Nn),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:z.getEnumType(R0)}]),ya=z.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:z.getEnumType(Gf)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]),Pt=z.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:z.getEnumType(Oe)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:w0,oneof:"value"},{no:3,name:"speaker",kind:"message",T:R1,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:x0,oneof:"value"},{no:7,name:"transcription",kind:"message",T:_1,oneof:"value"},{no:8,name:"metrics",kind:"message",T:y1,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:nf,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:O0,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:D0,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:A0,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:sf,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:rf,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:of,oneof:"value"}]),Oe=z.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),R1=z.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:_0,repeated:!0}]),_0=z.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),w0=z.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),x0=z.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),_1=z.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:w1,repeated:!0}]),w1=z.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),nf=z.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),O0=z.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),D0=z.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),A0=z.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:N0,oneof:"value"}]),N0=z.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),P0=z.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),x1=z.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:z.getEnumType(M0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),M0=z.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),O1=z.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:z.getEnumType(U0)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),U0=z.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"}]),L0=z.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Uv},{no:2,name:"screen",kind:"message",T:Uv},{no:3,name:"resume_connection",kind:"enum",T:z.getEnumType(Br)},{no:4,name:"disabled_codecs",kind:"message",T:D1},{no:5,name:"force_relay",kind:"enum",T:z.getEnumType(Br)}]),Uv=z.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:z.getEnumType(Br)}]),D1=z.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:zc,repeated:!0},{no:2,name:"publish",kind:"message",T:zc,repeated:!0}]),j0=z.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),af=z.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),I0=z.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:z.getEnumType(af)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),B0=z.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),sf=z.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:z.getEnumType(Kt)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:I0,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:B0,oneof:"content_header"}],{localName:"DataStream_Header"}),rf=z.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),of=z.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),vn=z.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),cf=z.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),A1=z.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),N1=z.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:Sa,oneof:"message"},{no:2,name:"answer",kind:"message",T:Sa,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Yf,oneof:"message"},{no:4,name:"add_track",kind:"message",T:uf,oneof:"message"},{no:5,name:"mute",kind:"message",T:Qf,oneof:"message"},{no:6,name:"subscription",kind:"message",T:nl,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:z0,oneof:"message"},{no:8,name:"leave",kind:"message",T:il,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:V0,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:K0,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Y0,oneof:"message"},{no:13,name:"simulate",kind:"message",T:On,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:H0,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:X0,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:q0,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:j1,oneof:"message"}]),Lv=z.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:P1,oneof:"message"},{no:2,name:"answer",kind:"message",T:Sa,oneof:"message"},{no:3,name:"offer",kind:"message",T:Sa,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Yf,oneof:"message"},{no:5,name:"update",kind:"message",T:L1,oneof:"message"},{no:6,name:"track_published",kind:"message",T:Xf,oneof:"message"},{no:8,name:"leave",kind:"message",T:il,oneof:"message"},{no:9,name:"mute",kind:"message",T:Qf,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:I1,oneof:"message"},{no:11,name:"room_update",kind:"message",T:B1,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:q1,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:H1,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:G1,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:K1,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:U1,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:M1,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Y1,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:J1,oneof:"message"},{no:22,name:"request_response",kind:"message",T:Z1,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:W1,oneof:"message"}]),lf=z.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),uf=z.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:z.getEnumType(gn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:z.getEnumType(ct)},{no:9,name:"layers",kind:"message",T:ya,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:lf,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:z.getEnumType(Kt)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:z.getEnumType(R0)}]),Yf=z.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:z.getEnumType(vn)},{no:3,name:"final",kind:"scalar",T:8}]),Qf=z.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),P1=z.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Kf},{no:2,name:"participant",kind:"message",T:zr},{no:3,name:"other_participants",kind:"message",T:zr,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:F0,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:L0},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:x1},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:zc,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),M1=z.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:F0,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:L0}]),Xf=z.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:ls}]),U1=z.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Sa=z.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]),L1=z.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:zr,repeated:!0}]),nl=z.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:P0,repeated:!0}]),z0=z.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:z.getEnumType(Gf)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),q0=z.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:z.getEnumType(Nn),repeated:!0}]),j1=z.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),il=z.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:z.getEnumType(yn)},{no:3,name:"action",kind:"enum",T:z.getEnumType(ds)},{no:4,name:"regions",kind:"message",T:Q1}]),ds=z.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),V0=z.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:ya,repeated:!0}]),H0=z.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),F0=z.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),I1=z.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:_0,repeated:!0}]),B1=z.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Kf}]),z1=z.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:z.getEnumType(Nr)},{no:3,name:"score",kind:"scalar",T:2}]),q1=z.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:z1,repeated:!0}]),V1=z.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:z.getEnumType(cf)}]),H1=z.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:V1,repeated:!0}]),Jf=z.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:z.getEnumType(Gf)},{no:2,name:"enabled",kind:"scalar",T:8}]),F1=z.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Jf,repeated:!0}]),G1=z.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Jf,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:F1,repeated:!0}]),G0=z.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),K0=z.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:G0,repeated:!0}]),K1=z.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),Y0=z.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:Sa},{no:2,name:"subscription",kind:"message",T:nl},{no:3,name:"publish_tracks",kind:"message",T:Xf,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Q0,repeated:!0},{no:5,name:"offer",kind:"message",T:Sa},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0}]),Q0=z.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:z.getEnumType(vn)}]),On=z.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:z.getEnumType(A1),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),X0=z.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Y1=z.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),Q1=z.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:X1,repeated:!0}]),X1=z.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),J1=z.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:z.getEnumType(k1)}]),Z1=z.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:z.getEnumType(Zf)},{no:3,name:"message",kind:"scalar",T:9}]),Zf=z.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),W1=z.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function $1(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Rc={exports:{}},e_=Rc.exports,jv;function t_(){return jv||(jv=1,function(a){(function(e,i){a.exports?a.exports=i():e.log=i()})(e_,function(){var e=function(){},i="undefined",s=typeof window!==i&&typeof window.navigator!==i&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],l={},u=null;function d(E,_){var x=E[_];if(typeof x.bind=="function")return x.bind(E);try{return Function.prototype.bind.call(x,E)}catch{return function(){return Function.prototype.apply.apply(x,[E,arguments])}}}function m(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(E){return E==="debug"&&(E="log"),typeof console===i?!1:E==="trace"&&s?m:console[E]!==void 0?d(console,E):console.log!==void 0?d(console,"log"):e}function g(){for(var E=this.getLevel(),_=0;_<o.length;_++){var x=o[_];this[x]=_<E?e:this.methodFactory(x,E,this.name)}if(this.log=this.debug,typeof console===i&&E<this.levels.SILENT)return"No console available for logging"}function v(E){return function(){typeof console!==i&&(g.call(this),this[E].apply(this,arguments))}}function b(E,_,x){return h(E)||v.apply(this,arguments)}function k(E,_){var x=this,I,U,N,w="loglevel";typeof E=="string"?w+=":"+E:typeof E=="symbol"&&(w=void 0);function F(le){var Re=(o[le]||"silent").toUpperCase();if(!(typeof window===i||!w)){try{window.localStorage[w]=Re;return}catch{}try{window.document.cookie=encodeURIComponent(w)+"="+Re+";"}catch{}}}function J(){var le;if(!(typeof window===i||!w)){try{le=window.localStorage[w]}catch{}if(typeof le===i)try{var Re=window.document.cookie,ue=encodeURIComponent(w),vt=Re.indexOf(ue+"=");vt!==-1&&(le=/^([^;]+)/.exec(Re.slice(vt+ue.length+1))[1])}catch{}return x.levels[le]===void 0&&(le=void 0),le}}function ne(){if(!(typeof window===i||!w)){try{window.localStorage.removeItem(w)}catch{}try{window.document.cookie=encodeURIComponent(w)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function Q(le){var Re=le;if(typeof Re=="string"&&x.levels[Re.toUpperCase()]!==void 0&&(Re=x.levels[Re.toUpperCase()]),typeof Re=="number"&&Re>=0&&Re<=x.levels.SILENT)return Re;throw new TypeError("log.setLevel() called with invalid level: "+le)}x.name=E,x.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},x.methodFactory=_||b,x.getLevel=function(){return N??U??I},x.setLevel=function(le,Re){return N=Q(le),Re!==!1&&F(N),g.call(x)},x.setDefaultLevel=function(le){U=Q(le),J()||x.setLevel(le,!1)},x.resetLevel=function(){N=null,ne(),g.call(x)},x.enableAll=function(le){x.setLevel(x.levels.TRACE,le)},x.disableAll=function(le){x.setLevel(x.levels.SILENT,le)},x.rebuild=function(){if(u!==x&&(I=Q(u.getLevel())),g.call(x),u===x)for(var le in l)l[le].rebuild()},I=Q(u?u.getLevel():"WARN");var ee=J();ee!=null&&(N=Q(ee)),g.call(x)}u=new k,u.getLogger=function(_){if(typeof _!="symbol"&&typeof _!="string"||_==="")throw new TypeError("You must supply a name when creating a logger.");var x=l[_];return x||(x=l[_]=new k(_,u.methodFactory)),x};var T=typeof window!==i?window.log:void 0;return u.noConflict=function(){return typeof window!==i&&window.log===u&&(window.log=T),u},u.getLoggers=function(){return l},u.default=u,u})}(Rc)),Rc.exports}var al=t_(),df;(function(a){a[a.trace=0]="trace",a[a.debug=1]="debug",a[a.info=2]="info",a[a.warn=3]="warn",a[a.error=4]="error",a[a.silent=5]="silent"})(df||(df={}));var bn;(function(a){a.Default="livekit",a.Room="livekit-room",a.Participant="livekit-participant",a.Track="livekit-track",a.Publication="livekit-track-publication",a.Engine="livekit-engine",a.Signal="livekit-signal",a.PCManager="livekit-pc-manager",a.PCTransport="livekit-pc-transport",a.E2EE="lk-e2ee"})(bn||(bn={}));let Ee=al.getLogger("livekit");Object.values(bn).map(a=>al.getLogger(a));Ee.setDefaultLevel(df.info);function si(a){const e=al.getLogger(a);return e.setDefaultLevel(Ee.getLevel()),e}const n_=al.getLogger("lk-e2ee"),xr=7e3,i_=[0,300,2*2*300,3*3*300,4*4*300,xr,xr,xr,xr,xr];class a_{constructor(e){this._retryDelays=e!==void 0?[...e]:i_}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const i=this._retryDelays[e.retryCount];return e.retryCount<=1?i:i+Math.random()*1e3}}function s_(a,e){var i={};for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&e.indexOf(s)<0&&(i[s]=a[s]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(a);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(a,s[o])&&(i[s[o]]=a[s[o]]);return i}function O(a,e,i,s){function o(l){return l instanceof i?l:new i(function(u){u(l)})}return new(i||(i=Promise))(function(l,u){function d(g){try{h(s.next(g))}catch(v){u(v)}}function m(g){try{h(s.throw(g))}catch(v){u(v)}}function h(g){g.done?l(g.value):o(g.value).then(d,m)}h((s=s.apply(a,e||[])).next())})}function Iv(a){var e=typeof Symbol=="function"&&Symbol.iterator,i=e&&a[e],s=0;if(i)return i.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&s>=a.length&&(a=void 0),{value:a&&a[s++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Li(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],i;return e?e.call(a):(a=typeof Iv=="function"?Iv(a):a[Symbol.iterator](),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(l){i[l]=a[l]&&function(u){return new Promise(function(d,m){u=a[l](u),o(d,m,u.done,u.value)})}}function o(l,u,d,m){Promise.resolve(m).then(function(h){l({value:h,done:d})},u)}}var uc={exports:{}},Bv;function r_(){if(Bv)return uc.exports;Bv=1;var a=typeof Reflect=="object"?Reflect:null,e=a&&typeof a.apply=="function"?a.apply:function(w,F,J){return Function.prototype.apply.call(w,F,J)},i;a&&typeof a.ownKeys=="function"?i=a.ownKeys:Object.getOwnPropertySymbols?i=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:i=function(w){return Object.getOwnPropertyNames(w)};function s(N){console&&console.warn&&console.warn(N)}var o=Number.isNaN||function(w){return w!==w};function l(){l.init.call(this)}uc.exports=l,uc.exports.once=x,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var u=10;function d(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(N){if(typeof N!="number"||N<0||o(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");u=N}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||o(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function m(N){return N._maxListeners===void 0?l.defaultMaxListeners:N._maxListeners}l.prototype.getMaxListeners=function(){return m(this)},l.prototype.emit=function(w){for(var F=[],J=1;J<arguments.length;J++)F.push(arguments[J]);var ne=w==="error",Q=this._events;if(Q!==void 0)ne=ne&&Q.error===void 0;else if(!ne)return!1;if(ne){var ee;if(F.length>0&&(ee=F[0]),ee instanceof Error)throw ee;var le=new Error("Unhandled error."+(ee?" ("+ee.message+")":""));throw le.context=ee,le}var Re=Q[w];if(Re===void 0)return!1;if(typeof Re=="function")e(Re,this,F);else for(var ue=Re.length,vt=T(Re,ue),J=0;J<ue;++J)e(vt[J],this,F);return!0};function h(N,w,F,J){var ne,Q,ee;if(d(F),Q=N._events,Q===void 0?(Q=N._events=Object.create(null),N._eventsCount=0):(Q.newListener!==void 0&&(N.emit("newListener",w,F.listener?F.listener:F),Q=N._events),ee=Q[w]),ee===void 0)ee=Q[w]=F,++N._eventsCount;else if(typeof ee=="function"?ee=Q[w]=J?[F,ee]:[ee,F]:J?ee.unshift(F):ee.push(F),ne=m(N),ne>0&&ee.length>ne&&!ee.warned){ee.warned=!0;var le=new Error("Possible EventEmitter memory leak detected. "+ee.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");le.name="MaxListenersExceededWarning",le.emitter=N,le.type=w,le.count=ee.length,s(le)}return N}l.prototype.addListener=function(w,F){return h(this,w,F,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(w,F){return h(this,w,F,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(N,w,F){var J={fired:!1,wrapFn:void 0,target:N,type:w,listener:F},ne=g.bind(J);return ne.listener=F,J.wrapFn=ne,ne}l.prototype.once=function(w,F){return d(F),this.on(w,v(this,w,F)),this},l.prototype.prependOnceListener=function(w,F){return d(F),this.prependListener(w,v(this,w,F)),this},l.prototype.removeListener=function(w,F){var J,ne,Q,ee,le;if(d(F),ne=this._events,ne===void 0)return this;if(J=ne[w],J===void 0)return this;if(J===F||J.listener===F)--this._eventsCount===0?this._events=Object.create(null):(delete ne[w],ne.removeListener&&this.emit("removeListener",w,J.listener||F));else if(typeof J!="function"){for(Q=-1,ee=J.length-1;ee>=0;ee--)if(J[ee]===F||J[ee].listener===F){le=J[ee].listener,Q=ee;break}if(Q<0)return this;Q===0?J.shift():E(J,Q),J.length===1&&(ne[w]=J[0]),ne.removeListener!==void 0&&this.emit("removeListener",w,le||F)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(w){var F,J,ne;if(J=this._events,J===void 0)return this;if(J.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):J[w]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete J[w]),this;if(arguments.length===0){var Q=Object.keys(J),ee;for(ne=0;ne<Q.length;++ne)ee=Q[ne],ee!=="removeListener"&&this.removeAllListeners(ee);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(F=J[w],typeof F=="function")this.removeListener(w,F);else if(F!==void 0)for(ne=F.length-1;ne>=0;ne--)this.removeListener(w,F[ne]);return this};function b(N,w,F){var J=N._events;if(J===void 0)return[];var ne=J[w];return ne===void 0?[]:typeof ne=="function"?F?[ne.listener||ne]:[ne]:F?_(ne):T(ne,ne.length)}l.prototype.listeners=function(w){return b(this,w,!0)},l.prototype.rawListeners=function(w){return b(this,w,!1)},l.listenerCount=function(N,w){return typeof N.listenerCount=="function"?N.listenerCount(w):k.call(N,w)},l.prototype.listenerCount=k;function k(N){var w=this._events;if(w!==void 0){var F=w[N];if(typeof F=="function")return 1;if(F!==void 0)return F.length}return 0}l.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function T(N,w){for(var F=new Array(w),J=0;J<w;++J)F[J]=N[J];return F}function E(N,w){for(;w+1<N.length;w++)N[w]=N[w+1];N.pop()}function _(N){for(var w=new Array(N.length),F=0;F<w.length;++F)w[F]=N[F].listener||N[F];return w}function x(N,w){return new Promise(function(F,J){function ne(ee){N.removeListener(w,Q),J(ee)}function Q(){typeof N.removeListener=="function"&&N.removeListener("error",ne),F([].slice.call(arguments))}U(N,w,Q,{once:!0}),w!=="error"&&I(N,ne,{once:!0})})}function I(N,w,F){typeof N.on=="function"&&U(N,"error",w,F)}function U(N,w,F,J){if(typeof N.on=="function")J.once?N.once(w,F):N.on(w,F);else if(typeof N.addEventListener=="function")N.addEventListener(w,function ne(Q){J.once&&N.removeEventListener(w,ne),F(Q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}return uc.exports}var jn=r_();let J0=!0,Z0=!0;function _c(a,e,i){const s=a.match(e);return s&&s.length>=i&&parseInt(s[i],10)}function ka(a,e,i){if(!a.RTCPeerConnection)return;const s=a.RTCPeerConnection.prototype,o=s.addEventListener;s.addEventListener=function(u,d){if(u!==e)return o.apply(this,arguments);const m=h=>{const g=i(h);g&&(d.handleEvent?d.handleEvent(g):d(g))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,m),o.apply(this,[u,m])};const l=s.removeEventListener;s.removeEventListener=function(u,d){if(u!==e||!this._eventMap||!this._eventMap[e])return l.apply(this,arguments);if(!this._eventMap[e].has(d))return l.apply(this,arguments);const m=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,l.apply(this,[u,m])},Object.defineProperty(s,"on"+e,{get(){return this["_on"+e]},set(u){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),u&&this.addEventListener(e,this["_on"+e]=u)},enumerable:!0,configurable:!0})}function o_(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(J0=a,a?"adapter.js logging disabled":"adapter.js logging enabled")}function c_(a){return typeof a!="boolean"?new Error("Argument type: "+typeof a+". Please use a boolean."):(Z0=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))}function W0(){if(typeof window=="object"){if(J0)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Wf(a,e){Z0&&console.warn(a+" is deprecated, please use "+e+" instead.")}function l_(a){const e={browser:null,version:null};if(typeof a>"u"||!a.navigator||!a.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:i}=a;if(i.userAgentData&&i.userAgentData.brands){const s=i.userAgentData.brands.find(o=>o.brand==="Chromium");if(s)return{browser:"chrome",version:parseInt(s.version,10)}}if(i.mozGetUserMedia)e.browser="firefox",e.version=_c(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||a.isSecureContext===!1&&a.webkitRTCPeerConnection)e.browser="chrome",e.version=_c(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(a.RTCPeerConnection&&i.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=_c(i.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=a.RTCRtpTransceiver&&"currentDirection"in a.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function zv(a){return Object.prototype.toString.call(a)==="[object Object]"}function $0(a){return zv(a)?Object.keys(a).reduce(function(e,i){const s=zv(a[i]),o=s?$0(a[i]):a[i],l=s&&!Object.keys(o).length;return o===void 0||l?e:Object.assign(e,{[i]:o})},{}):a}function ff(a,e,i){!e||i.has(e.id)||(i.set(e.id,e),Object.keys(e).forEach(s=>{s.endsWith("Id")?ff(a,a.get(e[s]),i):s.endsWith("Ids")&&e[s].forEach(o=>{ff(a,a.get(o),i)})}))}function qv(a,e,i){const s=i?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const l=[];return a.forEach(u=>{u.type==="track"&&u.trackIdentifier===e.id&&l.push(u)}),l.forEach(u=>{a.forEach(d=>{d.type===s&&d.trackId===u.id&&ff(a,d,o)})}),o}const Vv=W0;function eb(a,e){const i=a&&a.navigator;if(!i.mediaDevices)return;const s=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const m={};return Object.keys(d).forEach(h=>{if(h==="require"||h==="advanced"||h==="mediaSource")return;const g=typeof d[h]=="object"?d[h]:{ideal:d[h]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const v=function(b,k){return b?b+k.charAt(0).toUpperCase()+k.slice(1):k==="deviceId"?"sourceId":k};if(g.ideal!==void 0){m.optional=m.optional||[];let b={};typeof g.ideal=="number"?(b[v("min",h)]=g.ideal,m.optional.push(b),b={},b[v("max",h)]=g.ideal,m.optional.push(b)):(b[v("",h)]=g.ideal,m.optional.push(b))}g.exact!==void 0&&typeof g.exact!="number"?(m.mandatory=m.mandatory||{},m.mandatory[v("",h)]=g.exact):["min","max"].forEach(b=>{g[b]!==void 0&&(m.mandatory=m.mandatory||{},m.mandatory[v(b,h)]=g[b])})}),d.advanced&&(m.optional=(m.optional||[]).concat(d.advanced)),m},o=function(d,m){if(e.version>=61)return m(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const h=function(g,v,b){v in g&&!(b in g)&&(g[b]=g[v],delete g[v])};d=JSON.parse(JSON.stringify(d)),h(d.audio,"autoGainControl","googAutoGainControl"),h(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=s(d.audio)}if(d&&typeof d.video=="object"){let h=d.video.facingMode;h=h&&(typeof h=="object"?h:{ideal:h});const g=e.version<66;if(h&&(h.exact==="user"||h.exact==="environment"||h.ideal==="user"||h.ideal==="environment")&&!(i.mediaDevices.getSupportedConstraints&&i.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete d.video.facingMode;let v;if(h.exact==="environment"||h.ideal==="environment"?v=["back","rear"]:(h.exact==="user"||h.ideal==="user")&&(v=["front"]),v)return i.mediaDevices.enumerateDevices().then(b=>{b=b.filter(T=>T.kind==="videoinput");let k=b.find(T=>v.some(E=>T.label.toLowerCase().includes(E)));return!k&&b.length&&v.includes("back")&&(k=b[b.length-1]),k&&(d.video.deviceId=h.exact?{exact:k.deviceId}:{ideal:k.deviceId}),d.video=s(d.video),Vv("chrome: "+JSON.stringify(d)),m(d)})}d.video=s(d.video)}return Vv("chrome: "+JSON.stringify(d)),m(d)},l=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},u=function(d,m,h){o(d,g=>{i.webkitGetUserMedia(g,m,v=>{h&&h(l(v))})})};if(i.getUserMedia=u.bind(i),i.mediaDevices.getUserMedia){const d=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(m){return o(m,h=>d(h).then(g=>{if(h.audio&&!g.getAudioTracks().length||h.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(l(g))))}}}function tb(a){a.MediaStream=a.MediaStream||a.webkitMediaStream}function nb(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("ontrack"in a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(i){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=i)},enumerable:!0,configurable:!0});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===o.track.id):l={track:o.track};const u=new Event("track");u.track=o.track,u.receiver=l,u.transceiver={receiver:l},u.streams=[s.stream],this.dispatchEvent(u)}),s.stream.getTracks().forEach(o=>{let l;a.RTCPeerConnection.prototype.getReceivers?l=this.getReceivers().find(d=>d.track&&d.track.id===o.id):l={track:o};const u=new Event("track");u.track=o,u.receiver=l,u.transceiver={receiver:l},u.streams=[s.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else ka(a,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function ib(a){if(typeof a=="object"&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){const e=function(o,l){return{track:l,get dtmf(){return this._dtmf===void 0&&(l.kind==="audio"?this._dtmf=o.createDTMFSender(l):this._dtmf=null),this._dtmf},_pc:o}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(d,m){let h=o.apply(this,arguments);return h||(h=e(this,d),this._senders.push(h)),h};const l=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(d){l.apply(this,arguments);const m=this._senders.indexOf(d);m!==-1&&this._senders.splice(m,1)}}const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(l){this._senders=this._senders||[],i.apply(this,[l]),l.getTracks().forEach(u=>{this._senders.push(e(this,u))})};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(l){this._senders=this._senders||[],s.apply(this,[l]),l.getTracks().forEach(u=>{const d=this._senders.find(m=>m.track===u);d&&this._senders.splice(this._senders.indexOf(d),1)})}}else if(typeof a=="object"&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){const e=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ab(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender&&a.RTCRtpReceiver))return;if(!("getStats"in a.RTCRtpSender.prototype)){const i=a.RTCPeerConnection.prototype.getSenders;i&&(a.RTCPeerConnection.prototype.getSenders=function(){const l=i.apply(this,[]);return l.forEach(u=>u._pc=this),l});const s=a.RTCPeerConnection.prototype.addTrack;s&&(a.RTCPeerConnection.prototype.addTrack=function(){const l=s.apply(this,arguments);return l._pc=this,l}),a.RTCRtpSender.prototype.getStats=function(){const l=this;return this._pc.getStats().then(u=>qv(u,l.track,!0))}}if(!("getStats"in a.RTCRtpReceiver.prototype)){const i=a.RTCPeerConnection.prototype.getReceivers;i&&(a.RTCPeerConnection.prototype.getReceivers=function(){const o=i.apply(this,[]);return o.forEach(l=>l._pc=this),o}),ka(a,"track",s=>(s.receiver._pc=s.srcElement,s)),a.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(l=>qv(l,o.track,!1))}}if(!("getStats"in a.RTCRtpSender.prototype&&"getStats"in a.RTCRtpReceiver.prototype))return;const e=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof a.MediaStreamTrack){const s=arguments[0];let o,l,u;return this.getSenders().forEach(d=>{d.track===s&&(o?u=!0:o=d)}),this.getReceivers().forEach(d=>(d.track===s&&(l?u=!0:l=d),d.track===s)),u||o&&l?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():l?l.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function sb(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(u,d){if(!d)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const m=e.apply(this,arguments);return this._shimmedLocalStreams[d.id]?this._shimmedLocalStreams[d.id].indexOf(m)===-1&&this._shimmedLocalStreams[d.id].push(m):this._shimmedLocalStreams[d.id]=[d,m],m};const i=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(v=>v.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const d=this.getSenders();i.apply(this,arguments);const m=this.getSenders().filter(h=>d.indexOf(h)===-1);this._shimmedLocalStreams[u.id]=[u].concat(m)};const s=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],s.apply(this,arguments)};const o=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(d=>{const m=this._shimmedLocalStreams[d].indexOf(u);m!==-1&&this._shimmedLocalStreams[d].splice(m,1),this._shimmedLocalStreams[d].length===1&&delete this._shimmedLocalStreams[d]}),o.apply(this,arguments)}}function rb(a,e){if(!a.RTCPeerConnection)return;if(a.RTCPeerConnection.prototype.addTrack&&e.version>=65)return sb(a);const i=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){const g=i.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(v=>this._reverseStreams[v.id])};const s=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(v=>{if(this.getSenders().find(k=>k.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const v=new a.MediaStream(g.getTracks());this._streams[g.id]=v,this._reverseStreams[v.id]=g,g=v}s.apply(this,[g])};const o=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},a.RTCPeerConnection.prototype.addTrack=function(g,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find(E=>E===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(E=>E.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const T=this._streams[v.id];if(T)T.addTrack(g),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const E=new a.MediaStream([g]);this._streams[v.id]=E,this._reverseStreams[E.id]=v,this.addStream(E)}return this.getSenders().find(E=>E.track===g)};function l(h,g){let v=g.sdp;return Object.keys(h._reverseStreams||[]).forEach(b=>{const k=h._reverseStreams[b],T=h._streams[k.id];v=v.replace(new RegExp(T.id,"g"),k.id)}),new RTCSessionDescription({type:g.type,sdp:v})}function u(h,g){let v=g.sdp;return Object.keys(h._reverseStreams||[]).forEach(b=>{const k=h._reverseStreams[b],T=h._streams[k.id];v=v.replace(new RegExp(k.id,"g"),T.id)}),new RTCSessionDescription({type:g.type,sdp:v})}["createOffer","createAnswer"].forEach(function(h){const g=a.RTCPeerConnection.prototype[h],v={[h](){const b=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[T=>{const E=l(this,T);b[0].apply(null,[E])},T=>{b[1]&&b[1].apply(null,T)},arguments[2]]):g.apply(this,arguments).then(T=>l(this,T))}};a.RTCPeerConnection.prototype[h]=v[h]});const d=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=u(this,arguments[0]),d.apply(this,arguments))};const m=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get(){const h=m.get.apply(this);return h.type===""?h:l(this,h)}}),a.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(g._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let b;Object.keys(this._streams).forEach(k=>{this._streams[k].getTracks().find(E=>g.track===E)&&(b=this._streams[k])}),b&&(b.getTracks().length===1?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function hf(a,e){!a.RTCPeerConnection&&a.webkitRTCPeerConnection&&(a.RTCPeerConnection=a.webkitRTCPeerConnection),a.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=a.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};a.RTCPeerConnection.prototype[i]=o[i]})}function ob(a,e){ka(a,"negotiationneeded",i=>{const s=i.target;if(!((e.version<72||s.getConfiguration&&s.getConfiguration().sdpSemantics==="plan-b")&&s.signalingState!=="stable"))return i})}var Hv=Object.freeze({__proto__:null,fixNegotiationNeeded:ob,shimAddTrackRemoveTrack:rb,shimAddTrackRemoveTrackWithNative:sb,shimGetSendersWithDtmf:ib,shimGetUserMedia:eb,shimMediaStream:tb,shimOnTrack:nb,shimPeerConnection:hf,shimSenderReceiverGetStats:ab});function cb(a,e){const i=a&&a.navigator,s=a&&a.MediaStreamTrack;if(i.getUserMedia=function(o,l,u){Wf("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(o).then(l,u)},!(e.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const o=function(u,d,m){d in u&&!(m in u)&&(u[m]=u[d],delete u[d])},l=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u.audio,"autoGainControl","mozAutoGainControl"),o(u.audio,"noiseSuppression","mozNoiseSuppression")),l(u)},s&&s.prototype.getSettings){const u=s.prototype.getSettings;s.prototype.getSettings=function(){const d=u.apply(this,arguments);return o(d,"mozAutoGainControl","autoGainControl"),o(d,"mozNoiseSuppression","noiseSuppression"),d}}if(s&&s.prototype.applyConstraints){const u=s.prototype.applyConstraints;s.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d,"autoGainControl","mozAutoGainControl"),o(d,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[d])}}}}function u_(a,e){a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices||a.navigator.mediaDevices&&(a.navigator.mediaDevices.getDisplayMedia=function(s){if(!(s&&s.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return s.video===!0?s.video={mediaSource:e}:s.video.mediaSource=e,a.navigator.mediaDevices.getUserMedia(s)})}function lb(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function mf(a,e){if(typeof a!="object"||!(a.RTCPeerConnection||a.mozRTCPeerConnection))return;!a.RTCPeerConnection&&a.mozRTCPeerConnection&&(a.RTCPeerConnection=a.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const l=a.RTCPeerConnection.prototype[o],u={[o](){return arguments[0]=new(o==="addIceCandidate"?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),l.apply(this,arguments)}};a.RTCPeerConnection.prototype[o]=u[o]});const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(){const[l,u,d]=arguments;return s.apply(this,[l||null]).then(m=>{if(e.version<53&&!u)try{m.forEach(h=>{h.type=i[h.type]||h.type})}catch(h){if(h.name!=="TypeError")throw h;m.forEach((g,v)=>{m.set(v,Object.assign({},g,{type:i[g.type]||g.type}))})}return m}).then(u,d)}}function ub(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpSender.prototype)return;const e=a.RTCPeerConnection.prototype.getSenders;e&&(a.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(l=>l._pc=this),o});const i=a.RTCPeerConnection.prototype.addTrack;i&&(a.RTCPeerConnection.prototype.addTrack=function(){const o=i.apply(this,arguments);return o._pc=this,o}),a.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function db(a){if(!(typeof a=="object"&&a.RTCPeerConnection&&a.RTCRtpSender)||a.RTCRtpSender&&"getStats"in a.RTCRtpReceiver.prototype)return;const e=a.RTCPeerConnection.prototype.getReceivers;e&&(a.RTCPeerConnection.prototype.getReceivers=function(){const s=e.apply(this,[]);return s.forEach(o=>o._pc=this),s}),ka(a,"track",i=>(i.receiver._pc=i.srcElement,i)),a.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function fb(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){Wf("removeStream","removeTrack"),this.getSenders().forEach(s=>{s.track&&i.getTracks().includes(s.track)&&this.removeTrack(s)})})}function hb(a){a.DataChannel&&!a.RTCDataChannel&&(a.RTCDataChannel=a.DataChannel)}function mb(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.addTransceiver;e&&(a.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const o=s.length>0;o&&s.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const l=e.apply(this,arguments);if(o){const{sender:u}=l,d=u.getParameters();(!("encodings"in d)||d.encodings.length===1&&Object.keys(d.encodings[0]).length===0)&&(d.encodings=s,u.sendEncodings=s,this.setParametersPromises.push(u.setParameters(d).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return l})}function pb(a){if(!(typeof a=="object"&&a.RTCRtpSender))return;const e=a.RTCRtpSender.prototype.getParameters;e&&(a.RTCRtpSender.prototype.getParameters=function(){const s=e.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function gb(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function vb(a){if(!(typeof a=="object"&&a.RTCPeerConnection))return;const e=a.RTCPeerConnection.prototype.createAnswer;a.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Fv=Object.freeze({__proto__:null,shimAddTransceiver:mb,shimCreateAnswer:vb,shimCreateOffer:gb,shimGetDisplayMedia:u_,shimGetParameters:pb,shimGetUserMedia:cb,shimOnTrack:lb,shimPeerConnection:mf,shimRTCDataChannel:hb,shimReceiverGetStats:db,shimRemoveStream:fb,shimSenderGetStats:ub});function yb(a){if(!(typeof a!="object"||!a.RTCPeerConnection)){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in a.RTCPeerConnection.prototype)){const e=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(s){this._localStreams||(this._localStreams=[]),this._localStreams.includes(s)||this._localStreams.push(s),s.getAudioTracks().forEach(o=>e.call(this,o,s)),s.getVideoTracks().forEach(o=>e.call(this,o,s))},a.RTCPeerConnection.prototype.addTrack=function(s){for(var o=arguments.length,l=new Array(o>1?o-1:0),u=1;u<o;u++)l[u-1]=arguments[u];return l&&l.forEach(d=>{this._localStreams?this._localStreams.includes(d)||this._localStreams.push(d):this._localStreams=[d]}),e.apply(this,arguments)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(i){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(i);if(s===-1)return;this._localStreams.splice(s,1);const o=i.getTracks();this.getSenders().forEach(l=>{o.includes(l.track)&&this.removeTrack(l)})})}}function bb(a){if(!(typeof a!="object"||!a.RTCPeerConnection)&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in a.RTCPeerConnection.prototype))){Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(i){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=i),this.addEventListener("track",this._onaddstreampoly=s=>{s.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const l=new Event("addstream");l.stream=o,this.dispatchEvent(l)})})}});const e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(l=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(l)>=0)return;s._remoteStreams.push(l);const u=new Event("addstream");u.stream=l,s.dispatchEvent(u)})}),e.apply(s,arguments)}}}function Sb(a){if(typeof a!="object"||!a.RTCPeerConnection)return;const e=a.RTCPeerConnection.prototype,i=e.createOffer,s=e.createAnswer,o=e.setLocalDescription,l=e.setRemoteDescription,u=e.addIceCandidate;e.createOffer=function(h,g){const v=arguments.length>=2?arguments[2]:arguments[0],b=i.apply(this,[v]);return g?(b.then(h,g),Promise.resolve()):b},e.createAnswer=function(h,g){const v=arguments.length>=2?arguments[2]:arguments[0],b=s.apply(this,[v]);return g?(b.then(h,g),Promise.resolve()):b};let d=function(m,h,g){const v=o.apply(this,[m]);return g?(v.then(h,g),Promise.resolve()):v};e.setLocalDescription=d,d=function(m,h,g){const v=l.apply(this,[m]);return g?(v.then(h,g),Promise.resolve()):v},e.setRemoteDescription=d,d=function(m,h,g){const v=u.apply(this,[m]);return g?(v.then(h,g),Promise.resolve()):v},e.addIceCandidate=d}function Tb(a){const e=a&&a.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const i=e.mediaDevices,s=i.getUserMedia.bind(i);e.mediaDevices.getUserMedia=o=>s(kb(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(s,o,l){e.mediaDevices.getUserMedia(s).then(o,l)}).bind(e))}function kb(a){return a&&a.video!==void 0?Object.assign({},a,{video:$0(a.video)}):a}function Cb(a){if(!a.RTCPeerConnection)return;const e=a.RTCPeerConnection;a.RTCPeerConnection=function(s,o){if(s&&s.iceServers){const l=[];for(let u=0;u<s.iceServers.length;u++){let d=s.iceServers[u];d.urls===void 0&&d.url?(Wf("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,l.push(d)):l.push(s.iceServers[u])}s.iceServers=l}return new e(s,o)},a.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Eb(a){typeof a=="object"&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Rb(a){const e=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(s){if(s){typeof s.offerToReceiveAudio<"u"&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const o=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):s.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof s.offerToReceiveVideo<"u"&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const l=this.getTransceivers().find(u=>u.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&l?l.direction==="sendrecv"?l.setDirection?l.setDirection("sendonly"):l.direction="sendonly":l.direction==="recvonly"&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive"):s.offerToReceiveVideo===!0&&!l&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function _b(a){typeof a!="object"||a.AudioContext||(a.AudioContext=a.webkitAudioContext)}var Gv=Object.freeze({__proto__:null,shimAudioContext:_b,shimCallbacksAPI:Sb,shimConstraints:kb,shimCreateOfferLegacy:Rb,shimGetUserMedia:Tb,shimLocalStreamsAPI:yb,shimRTCIceServerUrls:Cb,shimRemoteStreamsAPI:bb,shimTrackEventTransceiver:Eb}),Dd={exports:{}},Kv;function d_(){return Kv||(Kv=1,function(a){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(i){return i.trim().split(`
`).map(s=>s.trim())},e.splitSections=function(i){return i.split(`
m=`).map((o,l)=>(l>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(i){const s=e.splitSections(i);return s&&s[0]},e.getMediaSections=function(i){const s=e.splitSections(i);return s.shift(),s},e.matchPrefix=function(i,s){return e.splitLines(i).filter(o=>o.indexOf(s)===0)},e.parseCandidate=function(i){let s;i.indexOf("a=candidate:")===0?s=i.substring(12).split(" "):s=i.substring(10).split(" ");const o={foundation:s[0],component:{1:"rtp",2:"rtcp"}[s[1]]||s[1],protocol:s[2].toLowerCase(),priority:parseInt(s[3],10),ip:s[4],address:s[4],port:parseInt(s[5],10),type:s[7]};for(let l=8;l<s.length;l+=2)switch(s[l]){case"raddr":o.relatedAddress=s[l+1];break;case"rport":o.relatedPort=parseInt(s[l+1],10);break;case"tcptype":o.tcpType=s[l+1];break;case"ufrag":o.ufrag=s[l+1],o.usernameFragment=s[l+1];break;default:o[s[l]]===void 0&&(o[s[l]]=s[l+1]);break}return o},e.writeCandidate=function(i){const s=[];s.push(i.foundation);const o=i.component;o==="rtp"?s.push(1):o==="rtcp"?s.push(2):s.push(o),s.push(i.protocol.toUpperCase()),s.push(i.priority),s.push(i.address||i.ip),s.push(i.port);const l=i.type;return s.push("typ"),s.push(l),l!=="host"&&i.relatedAddress&&i.relatedPort&&(s.push("raddr"),s.push(i.relatedAddress),s.push("rport"),s.push(i.relatedPort)),i.tcpType&&i.protocol.toLowerCase()==="tcp"&&(s.push("tcptype"),s.push(i.tcpType)),(i.usernameFragment||i.ufrag)&&(s.push("ufrag"),s.push(i.usernameFragment||i.ufrag)),"candidate:"+s.join(" ")},e.parseIceOptions=function(i){return i.substring(14).split(" ")},e.parseRtpMap=function(i){let s=i.substring(9).split(" ");const o={payloadType:parseInt(s.shift(),10)};return s=s[0].split("/"),o.name=s[0],o.clockRate=parseInt(s[1],10),o.channels=s.length===3?parseInt(s[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(i){let s=i.payloadType;i.preferredPayloadType!==void 0&&(s=i.preferredPayloadType);const o=i.channels||i.numChannels||1;return"a=rtpmap:"+s+" "+i.name+"/"+i.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(i){const s=i.substring(9).split(" ");return{id:parseInt(s[0],10),direction:s[0].indexOf("/")>0?s[0].split("/")[1]:"sendrecv",uri:s[1],attributes:s.slice(2).join(" ")}},e.writeExtmap=function(i){return"a=extmap:"+(i.id||i.preferredId)+(i.direction&&i.direction!=="sendrecv"?"/"+i.direction:"")+" "+i.uri+(i.attributes?" "+i.attributes:"")+`\r
`},e.parseFmtp=function(i){const s={};let o;const l=i.substring(i.indexOf(" ")+1).split(";");for(let u=0;u<l.length;u++)o=l[u].trim().split("="),s[o[0].trim()]=o[1];return s},e.writeFmtp=function(i){let s="",o=i.payloadType;if(i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.parameters&&Object.keys(i.parameters).length){const l=[];Object.keys(i.parameters).forEach(u=>{i.parameters[u]!==void 0?l.push(u+"="+i.parameters[u]):l.push(u)}),s+="a=fmtp:"+o+" "+l.join(";")+`\r
`}return s},e.parseRtcpFb=function(i){const s=i.substring(i.indexOf(" ")+1).split(" ");return{type:s.shift(),parameter:s.join(" ")}},e.writeRtcpFb=function(i){let s="",o=i.payloadType;return i.preferredPayloadType!==void 0&&(o=i.preferredPayloadType),i.rtcpFeedback&&i.rtcpFeedback.length&&i.rtcpFeedback.forEach(l=>{s+="a=rtcp-fb:"+o+" "+l.type+(l.parameter&&l.parameter.length?" "+l.parameter:"")+`\r
`}),s},e.parseSsrcMedia=function(i){const s=i.indexOf(" "),o={ssrc:parseInt(i.substring(7,s),10)},l=i.indexOf(":",s);return l>-1?(o.attribute=i.substring(s+1,l),o.value=i.substring(l+1)):o.attribute=i.substring(s+1),o},e.parseSsrcGroup=function(i){const s=i.substring(13).split(" ");return{semantics:s.shift(),ssrcs:s.map(o=>parseInt(o,10))}},e.getMid=function(i){const s=e.matchPrefix(i,"a=mid:")[0];if(s)return s.substring(6)},e.parseFingerprint=function(i){const s=i.substring(14).split(" ");return{algorithm:s[0].toLowerCase(),value:s[1].toUpperCase()}},e.getDtlsParameters=function(i,s){return{role:"auto",fingerprints:e.matchPrefix(i+s,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(i,s){let o="a=setup:"+s+`\r
`;return i.fingerprints.forEach(l=>{o+="a=fingerprint:"+l.algorithm+" "+l.value+`\r
`}),o},e.parseCryptoLine=function(i){const s=i.substring(9).split(" ");return{tag:parseInt(s[0],10),cryptoSuite:s[1],keyParams:s[2],sessionParams:s.slice(3)}},e.writeCryptoLine=function(i){return"a=crypto:"+i.tag+" "+i.cryptoSuite+" "+(typeof i.keyParams=="object"?e.writeCryptoKeyParams(i.keyParams):i.keyParams)+(i.sessionParams?" "+i.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(i){if(i.indexOf("inline:")!==0)return null;const s=i.substring(7).split("|");return{keyMethod:"inline",keySalt:s[0],lifeTime:s[1],mkiValue:s[2]?s[2].split(":")[0]:void 0,mkiLength:s[2]?s[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(i){return i.keyMethod+":"+i.keySalt+(i.lifeTime?"|"+i.lifeTime:"")+(i.mkiValue&&i.mkiLength?"|"+i.mkiValue+":"+i.mkiLength:"")},e.getCryptoParameters=function(i,s){return e.matchPrefix(i+s,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(i,s){const o=e.matchPrefix(i+s,"a=ice-ufrag:")[0],l=e.matchPrefix(i+s,"a=ice-pwd:")[0];return o&&l?{usernameFragment:o.substring(12),password:l.substring(10)}:null},e.writeIceParameters=function(i){let s="a=ice-ufrag:"+i.usernameFragment+`\r
a=ice-pwd:`+i.password+`\r
`;return i.iceLite&&(s+=`a=ice-lite\r
`),s},e.parseRtpParameters=function(i){const s={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},l=e.splitLines(i)[0].split(" ");s.profile=l[2];for(let d=3;d<l.length;d++){const m=l[d],h=e.matchPrefix(i,"a=rtpmap:"+m+" ")[0];if(h){const g=e.parseRtpMap(h),v=e.matchPrefix(i,"a=fmtp:"+m+" ");switch(g.parameters=v.length?e.parseFmtp(v[0]):{},g.rtcpFeedback=e.matchPrefix(i,"a=rtcp-fb:"+m+" ").map(e.parseRtcpFb),s.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":s.fecMechanisms.push(g.name.toUpperCase());break}}}e.matchPrefix(i,"a=extmap:").forEach(d=>{s.headerExtensions.push(e.parseExtmap(d))});const u=e.matchPrefix(i,"a=rtcp-fb:* ").map(e.parseRtcpFb);return s.codecs.forEach(d=>{u.forEach(m=>{d.rtcpFeedback.find(g=>g.type===m.type&&g.parameter===m.parameter)||d.rtcpFeedback.push(m)})}),s},e.writeRtpDescription=function(i,s){let o="";o+="m="+i+" ",o+=s.codecs.length>0?"9":"0",o+=" "+(s.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=s.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,s.codecs.forEach(u=>{o+=e.writeRtpMap(u),o+=e.writeFmtp(u),o+=e.writeRtcpFb(u)});let l=0;return s.codecs.forEach(u=>{u.maxptime>l&&(l=u.maxptime)}),l>0&&(o+="a=maxptime:"+l+`\r
`),s.headerExtensions&&s.headerExtensions.forEach(u=>{o+=e.writeExtmap(u)}),o},e.parseRtpEncodingParameters=function(i){const s=[],o=e.parseRtpParameters(i),l=o.fecMechanisms.indexOf("RED")!==-1,u=o.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(i,"a=ssrc:").map(b=>e.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),m=d.length>0&&d[0].ssrc;let h;const g=e.matchPrefix(i,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(T=>parseInt(T,10)));g.length>0&&g[0].length>1&&g[0][0]===m&&(h=g[0][1]),o.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let k={ssrc:m,codecPayloadType:parseInt(b.parameters.apt,10)};m&&h&&(k.rtx={ssrc:h}),s.push(k),l&&(k=JSON.parse(JSON.stringify(k)),k.fec={ssrc:m,mechanism:u?"red+ulpfec":"red"},s.push(k))}}),s.length===0&&m&&s.push({ssrc:m});let v=e.matchPrefix(i,"b=");return v.length&&(v[0].indexOf("b=TIAS:")===0?v=parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?v=parseInt(v[0].substring(5),10)*1e3*.95-50*40*8:v=void 0,s.forEach(b=>{b.maxBitrate=v})),s},e.parseRtcpParameters=function(i){const s={},o=e.matchPrefix(i,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];o&&(s.cname=o.value,s.ssrc=o.ssrc);const l=e.matchPrefix(i,"a=rtcp-rsize");s.reducedSize=l.length>0,s.compound=l.length===0;const u=e.matchPrefix(i,"a=rtcp-mux");return s.mux=u.length>0,s},e.writeRtcpParameters=function(i){let s="";return i.reducedSize&&(s+=`a=rtcp-rsize\r
`),i.mux&&(s+=`a=rtcp-mux\r
`),i.ssrc!==void 0&&i.cname&&(s+="a=ssrc:"+i.ssrc+" cname:"+i.cname+`\r
`),s},e.parseMsid=function(i){let s;const o=e.matchPrefix(i,"a=msid:");if(o.length===1)return s=o[0].substring(7).split(" "),{stream:s[0],track:s[1]};const l=e.matchPrefix(i,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");if(l.length>0)return s=l[0].value.split(" "),{stream:s[0],track:s[1]}},e.parseSctpDescription=function(i){const s=e.parseMLine(i),o=e.matchPrefix(i,"a=max-message-size:");let l;o.length>0&&(l=parseInt(o[0].substring(19),10)),isNaN(l)&&(l=65536);const u=e.matchPrefix(i,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:s.fmt,maxMessageSize:l};const d=e.matchPrefix(i,"a=sctpmap:");if(d.length>0){const m=d[0].substring(10).split(" ");return{port:parseInt(m[0],10),protocol:m[1],maxMessageSize:l}}},e.writeSctpDescription=function(i,s){let o=[];return i.protocol!=="DTLS/SCTP"?o=["m="+i.kind+" 9 "+i.protocol+" "+s.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+s.port+`\r
`]:o=["m="+i.kind+" 9 "+i.protocol+" "+s.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+s.port+" "+s.protocol+` 65535\r
`],s.maxMessageSize!==void 0&&o.push("a=max-message-size:"+s.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(i,s,o){let l;const u=s!==void 0?s:2;return i?l=i:l=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+l+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(i,s){const o=e.splitLines(i);for(let l=0;l<o.length;l++)switch(o[l]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[l].substring(2)}return s?e.getDirection(s):"sendrecv"},e.getKind=function(i){return e.splitLines(i)[0].split(" ")[0].substring(2)},e.isRejected=function(i){return i.split(" ",2)[1]==="0"},e.parseMLine=function(i){const o=e.splitLines(i)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(i){const o=e.matchPrefix(i,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(i){if(typeof i!="string"||i.length===0)return!1;const s=e.splitLines(i);for(let o=0;o<s.length;o++)if(s[o].length<2||s[o].charAt(1)!=="=")return!1;return!0},a.exports=e}(Dd)),Dd.exports}var wb=d_(),fs=$1(wb),f_=_R({__proto__:null,default:fs},[wb]);function wc(a){if(!a.RTCIceCandidate||a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)return;const e=a.RTCIceCandidate;a.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&(s=JSON.parse(JSON.stringify(s)),s.candidate=s.candidate.substring(2)),s.candidate&&s.candidate.length){const o=new e(s),l=fs.parseCandidate(s.candidate);for(const u in l)u in o||Object.defineProperty(o,u,{value:l[u]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(s)},a.RTCIceCandidate.prototype=e.prototype,ka(a,"icecandidate",i=>(i.candidate&&Object.defineProperty(i,"candidate",{value:new a.RTCIceCandidate(i.candidate),writable:"false"}),i))}function pf(a){!a.RTCIceCandidate||a.RTCIceCandidate&&"relayProtocol"in a.RTCIceCandidate.prototype||ka(a,"icecandidate",e=>{if(e.candidate){const i=fs.parseCandidate(e.candidate.candidate);i.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[i.priority>>24])}return e})}function xc(a,e){if(!a.RTCPeerConnection)return;"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const i=function(d){if(!d||!d.sdp)return!1;const m=fs.splitSections(d.sdp);return m.shift(),m.some(h=>{const g=fs.parseMLine(h);return g&&g.kind==="application"&&g.protocol.indexOf("SCTP")!==-1})},s=function(d){const m=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(m===null||m.length<2)return-1;const h=parseInt(m[1],10);return h!==h?-1:h},o=function(d){let m=65536;return e.browser==="firefox"&&(e.version<57?d===-1?m=16384:m=2147483637:e.version<60?m=e.version===57?65535:65536:m=2147483637),m},l=function(d,m){let h=65536;e.browser==="firefox"&&e.version===57&&(h=65535);const g=fs.matchPrefix(d.sdp,"a=max-message-size:");return g.length>0?h=parseInt(g[0].substring(19),10):e.browser==="firefox"&&m!==-1&&(h=2147483637),h},u=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:m}=this.getConfiguration();m==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const m=s(arguments[0]),h=o(m),g=l(arguments[0],m);let v;h===0&&g===0?v=Number.POSITIVE_INFINITY:h===0||g===0?v=Math.max(h,g):v=Math.min(h,g);const b={};Object.defineProperty(b,"maxMessageSize",{get(){return v}}),this._sctp=b}return u.apply(this,arguments)}}function Oc(a){if(!(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype))return;function e(s,o){const l=s.send;s.send=function(){const d=arguments[0],m=d.length||d.size||d.byteLength;if(s.readyState==="open"&&o.sctp&&m>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return l.apply(s,arguments)}}const i=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){const o=i.apply(this,arguments);return e(o,this),o},ka(a,"datachannel",s=>(e(s.channel,s.target),s))}function gf(a){if(!a.RTCPeerConnection||"connectionState"in a.RTCPeerConnection.prototype)return;const e=a.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(i){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),i&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=i)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(i=>{const s=e[i];e[i]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const l=o.target;if(l._lastConnectionState!==l.connectionState){l._lastConnectionState=l.connectionState;const u=new Event("connectionstatechange",o);l.dispatchEvent(u)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),s.apply(this,arguments)}})}function vf(a,e){if(!a.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const i=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const l=o.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);a.RTCSessionDescription&&o instanceof a.RTCSessionDescription?arguments[0]=new a.RTCSessionDescription({type:o.type,sdp:l}):o.sdp=l}return i.apply(this,arguments)}}function Dc(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.addIceCandidate;!i||i.length===0||(a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ac(a,e){if(!(a.RTCPeerConnection&&a.RTCPeerConnection.prototype))return;const i=a.RTCPeerConnection.prototype.setLocalDescription;!i||i.length===0||(a.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return i.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?i.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>i.apply(this,[u]))})}var h_=Object.freeze({__proto__:null,removeExtmapAllowMixed:vf,shimAddIceCandidateNullOrEmpty:Dc,shimConnectionState:gf,shimMaxMessageSize:xc,shimParameterlessSetLocalDescription:Ac,shimRTCIceCandidate:wc,shimRTCIceCandidateRelayProtocol:pf,shimSendThrowTypeError:Oc});function m_(){let{window:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=W0,s=l_(a),o={browserDetails:s,commonShim:h_,extractVersion:_c,disableLog:o_,disableWarnings:c_,sdp:f_};switch(s.browser){case"chrome":if(!Hv||!hf||!e.shimChrome)return i("Chrome shim is not included in this adapter release."),o;if(s.version===null)return i("Chrome shim can not determine version, not shimming."),o;i("adapter.js shimming chrome."),o.browserShim=Hv,Dc(a,s),Ac(a),eb(a,s),tb(a),hf(a,s),nb(a),rb(a,s),ib(a),ab(a),ob(a,s),wc(a),pf(a),gf(a),xc(a,s),Oc(a),vf(a,s);break;case"firefox":if(!Fv||!mf||!e.shimFirefox)return i("Firefox shim is not included in this adapter release."),o;i("adapter.js shimming firefox."),o.browserShim=Fv,Dc(a,s),Ac(a),cb(a,s),mf(a,s),lb(a),fb(a),ub(a),db(a),hb(a),mb(a),pb(a),gb(a),vb(a),wc(a),gf(a),xc(a,s),Oc(a);break;case"safari":if(!Gv||!e.shimSafari)return i("Safari shim is not included in this adapter release."),o;i("adapter.js shimming safari."),o.browserShim=Gv,Dc(a,s),Ac(a),Cb(a),Rb(a),Sb(a),yb(a),bb(a),Eb(a),Tb(a),_b(a),wc(a),pf(a),xc(a,s),Oc(a),vf(a,s);break;default:i("Unsupported browser!");break}return o}m_({window:typeof window>"u"?void 0:window});const p_=10,dc="lk_e2ee",g_="LKFrameEncryptionKey",v_={sharedKey:!1,ratchetSalt:g_,ratchetWindowSize:8,failureTolerance:p_,keyringSize:16};var Bi;(function(a){a.SetKey="setKey",a.RatchetRequest="ratchetRequest",a.KeyRatcheted="keyRatcheted"})(Bi||(Bi={}));var Yv;(function(a){a.KeyRatcheted="keyRatcheted"})(Yv||(Yv={}));var Ii;(function(a){a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError"})(Ii||(Ii={}));var Qv;(function(a){a.Error="cryptorError"})(Qv||(Qv={}));function y_(){return b_()||yf()}function yf(){return typeof window.RTCRtpScriptTransform<"u"}function b_(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class Ex extends jn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(i,s)=>{Ee.debug("key ratcheted event received",{material:i,keyIndex:s})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},v_),e),this.on(Bi.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,i,s){const o={key:e,participantIdentity:i,keyIndex:s};if(!this.options.sharedKey&&!i)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(i??"shared","-").concat(s??0),o),this.emit(Bi.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,i){this.emit(Bi.RatchetRequest,e,i)}}class Hi extends Error{constructor(e,i){super(i||"an error has occured"),this.name="LiveKitError",this.code=e}}var xe;(function(a){a[a.NotAllowed=0]="NotAllowed",a[a.ServerUnreachable=1]="ServerUnreachable",a[a.InternalError=2]="InternalError",a[a.Cancelled=3]="Cancelled",a[a.LeaveRequest=4]="LeaveRequest"})(xe||(xe={}));class Be extends Hi{constructor(e,i,s,o){super(1,e),this.name="ConnectionError",this.status=s,this.reason=i,this.context=o,this.reasonName=xe[i]}}class $f extends Hi{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class ni extends Hi{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class S_ extends Hi{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class dt extends Hi{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class bf extends Hi{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class T_ extends Hi{constructor(e,i){super(15,e),this.name="PublishTrackError",this.status=i}}class Xv extends Hi{constructor(e,i){super(15,e),this.reason=i,this.reasonName=typeof i=="string"?i:Zf[i]}}var Vc;(function(a){a.PermissionDenied="PermissionDenied",a.NotFound="NotFound",a.DeviceInUse="DeviceInUse",a.Other="Other"})(Vc||(Vc={}));(function(a){function e(i){if(i&&"name"in i)return i.name==="NotFoundError"||i.name==="DevicesNotFoundError"?a.NotFound:i.name==="NotAllowedError"||i.name==="PermissionDeniedError"?a.PermissionDenied:i.name==="NotReadableError"||i.name==="TrackStartError"?a.DeviceInUse:a.Other}a.getFailure=e})(Vc||(Vc={}));var Jv;(function(a){a[a.InvalidKey=0]="InvalidKey",a[a.MissingKey=1]="MissingKey",a[a.InternalError=2]="InternalError"})(Jv||(Jv={}));var W;(function(a){a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting",a.Reconnected="reconnected",a.Disconnected="disconnected",a.ConnectionStateChanged="connectionStateChanged",a.MediaDevicesChanged="mediaDevicesChanged",a.ParticipantConnected="participantConnected",a.ParticipantDisconnected="participantDisconnected",a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalAudioSilenceDetected="localAudioSilenceDetected",a.ActiveSpeakersChanged="activeSpeakersChanged",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.ParticipantAttributesChanged="participantAttributesChanged",a.RoomMetadataChanged="roomMetadataChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.AudioPlaybackStatusChanged="audioPlaybackChanged",a.VideoPlaybackStatusChanged="videoPlaybackChanged",a.MediaDevicesError="mediaDevicesError",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.SignalConnected="signalConnected",a.RecordingStatusChanged="recordingStatusChanged",a.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",a.EncryptionError="encryptionError",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ActiveDeviceChanged="activeDeviceChanged",a.ChatMessage="chatMessage",a.LocalTrackSubscribed="localTrackSubscribed",a.MetricsReceived="metricsReceived"})(W||(W={}));var ae;(function(a){a.TrackPublished="trackPublished",a.TrackSubscribed="trackSubscribed",a.TrackSubscriptionFailed="trackSubscriptionFailed",a.TrackUnpublished="trackUnpublished",a.TrackUnsubscribed="trackUnsubscribed",a.TrackMuted="trackMuted",a.TrackUnmuted="trackUnmuted",a.LocalTrackPublished="localTrackPublished",a.LocalTrackUnpublished="localTrackUnpublished",a.ParticipantMetadataChanged="participantMetadataChanged",a.ParticipantNameChanged="participantNameChanged",a.DataReceived="dataReceived",a.SipDTMFReceived="sipDTMFReceived",a.TranscriptionReceived="transcriptionReceived",a.IsSpeakingChanged="isSpeakingChanged",a.ConnectionQualityChanged="connectionQualityChanged",a.TrackStreamStateChanged="trackStreamStateChanged",a.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",a.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",a.MediaDevicesError="mediaDevicesError",a.AudioStreamAcquired="audioStreamAcquired",a.ParticipantPermissionsChanged="participantPermissionsChanged",a.PCTrackAdded="pcTrackAdded",a.AttributesChanged="attributesChanged",a.LocalTrackSubscribed="localTrackSubscribed",a.ChatMessage="chatMessage"})(ae||(ae={}));var te;(function(a){a.TransportsCreated="transportsCreated",a.Connected="connected",a.Disconnected="disconnected",a.Resuming="resuming",a.Resumed="resumed",a.Restarting="restarting",a.Restarted="restarted",a.SignalResumed="signalResumed",a.SignalRestarted="signalRestarted",a.Closing="closing",a.MediaTrackAdded="mediaTrackAdded",a.ActiveSpeakersUpdate="activeSpeakersUpdate",a.DataPacketReceived="dataPacketReceived",a.RTPVideoMapUpdate="rtpVideoMapUpdate",a.DCBufferStatusChanged="dcBufferStatusChanged",a.ParticipantUpdate="participantUpdate",a.RoomUpdate="roomUpdate",a.SpeakersChanged="speakersChanged",a.StreamStateChanged="streamStateChanged",a.ConnectionQualityUpdate="connectionQualityUpdate",a.SubscriptionError="subscriptionError",a.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",a.RemoteMute="remoteMute",a.SubscribedQualityUpdate="subscribedQualityUpdate",a.LocalTrackUnpublished="localTrackUnpublished",a.LocalTrackSubscribed="localTrackSubscribed",a.Offline="offline",a.SignalRequestResponse="signalRequestResponse"})(te||(te={}));var $;(function(a){a.Message="message",a.Muted="muted",a.Unmuted="unmuted",a.Restarted="restarted",a.Ended="ended",a.Subscribed="subscribed",a.Unsubscribed="unsubscribed",a.UpdateSettings="updateSettings",a.UpdateSubscription="updateSubscription",a.AudioPlaybackStarted="audioPlaybackStarted",a.AudioPlaybackFailed="audioPlaybackFailed",a.AudioSilenceDetected="audioSilenceDetected",a.VisibilityChanged="visibilityChanged",a.VideoDimensionsChanged="videoDimensionsChanged",a.VideoPlaybackStarted="videoPlaybackStarted",a.VideoPlaybackFailed="videoPlaybackFailed",a.ElementAttached="elementAttached",a.ElementDetached="elementDetached",a.UpstreamPaused="upstreamPaused",a.UpstreamResumed="upstreamResumed",a.SubscriptionPermissionChanged="subscriptionPermissionChanged",a.SubscriptionStatusChanged="subscriptionStatusChanged",a.SubscriptionFailed="subscriptionFailed",a.TrackProcessorUpdate="trackProcessorUpdate",a.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",a.TranscriptionReceived="transcriptionReceived",a.TimeSyncUpdate="timeSyncUpdate"})($||($={}));function k_(a){if(!(typeof a>"u"))return typeof structuredClone=="function"?structuredClone(a):JSON.parse(JSON.stringify(a))}const C_=/version\/(\d+(\.?_?\d+)+)/i;let Ad;function Mn(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const i=navigator.userAgent.toLowerCase();if(Ad===void 0||e){const s=E_.find(o=>{let{test:l}=o;return l.test(i)});Ad=s==null?void 0:s.describe(i)}return Ad}const E_=[{test:/firefox|iceweasel|fxios/i,describe(a){return{name:"Firefox",version:Nc(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:Nd(a)}}},{test:/chrom|crios|crmo/i,describe(a){return{name:"Chrome",version:Nc(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,a),os:a.toLowerCase().includes("crios")?"iOS":void 0,osVersion:Nd(a)}}},{test:/safari|applewebkit/i,describe(a){return{name:"Safari",version:Nc(C_,a),os:a.includes("mobile/")?"iOS":"macOS",osVersion:Nd(a)}}}];function Nc(a,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=e.match(a);return s&&s.length>=i&&s[i]||""}function Nd(a){return a.includes("mac os")?Nc(/\(.+?(\d+_\d+(:?_\d+)?)/,a,1).replace(/_/g,"."):void 0}var R_="2.9.9";const __=R_,w_=15;class Tt{}Tt.setTimeout=function(){return setTimeout(...arguments)};Tt.setInterval=function(){return setInterval(...arguments)};Tt.clearTimeout=function(){return clearTimeout(...arguments)};Tt.clearInterval=function(){return clearInterval(...arguments)};const x_=5e3,Or=[];var cn;(function(a){a[a.LOW=0]="LOW",a[a.MEDIUM=1]="MEDIUM",a[a.HIGH=2]="HIGH"})(cn||(cn={}));class Y extends jn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Y.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Ee,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),x_):this.handleAppVisibilityChanged()},this.log=si((o=s.loggerName)!==null&&o!==void 0?o:bn.Track),this.loggerContextCb=s.loggerContextCb,this.setMaxListeners(100),this.kind=i,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Y.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Me(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let i="audio";this.kind===Y.Kind.Video&&(i="video"),this.attachedElements.length===0&&this.kind===Y.Kind.Video&&this.addAppVisibilityListener(),e||(i==="audio"&&(Or.forEach(l=>{l.parentElement===null&&!e&&(e=l)}),e&&Or.splice(Or.indexOf(e),1)),e||(e=document.createElement(i))),this.attachedElements.includes(e)||this.attachedElements.push(e),us(this.mediaStreamTrack,e);const s=e.srcObject.getTracks(),o=s.some(l=>l.kind==="audio");return e.play().then(()=>{this.emit(o?$.AudioPlaybackStarted:$.VideoPlaybackStarted)}).catch(l=>{l.name==="NotAllowedError"?this.emit(o?$.AudioPlaybackFailed:$.VideoPlaybackFailed,l):l.name==="AbortError"?Ee.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):Ee.warn("could not playback ".concat(o?"audio":"video"),l),o&&e&&s.some(u=>u.kind==="video")&&l.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit($.ElementAttached,e),e}detach(e){try{if(e){hs(this.mediaStreamTrack,e);const s=this.attachedElements.indexOf(e);return s>=0&&(this.attachedElements.splice(s,1),this.recycleElement(e),this.emit($.ElementDetached,e)),e}const i=[];return this.attachedElements.forEach(s=>{hs(this.mediaStreamTrack,s),i.push(s),this.recycleElement(s),this.emit($.ElementDetached,s)}),this.attachedElements=[],i}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=si(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let i=!0;e.pause(),Or.forEach(s=>{s.parentElement||(i=!1)}),i&&Or.push(e)}}handleAppVisibilityChanged(){return O(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===Y.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Ut()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Ut()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function us(a,e){let i;e.srcObject instanceof MediaStream?i=e.srcObject:i=new MediaStream;let s;a.kind==="audio"?s=i.getAudioTracks():s=i.getVideoTracks(),s.includes(a)||(s.forEach(o=>{i.removeTrack(o)}),i.addTrack(a)),(!Vi()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=i.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==i&&(e.srcObject=i,(Vi()||vs())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=i,e.play().catch(()=>{})},0))}function hs(a,e){if(e.srcObject instanceof MediaStream){const i=e.srcObject;i.removeTrack(a),i.getTracks().length>0?e.srcObject=i:e.srcObject=null}}(function(a){let e;(function(h){h.Audio="audio",h.Video="video",h.Unknown="unknown"})(e=a.Kind||(a.Kind={}));let i;(function(h){h.Camera="camera",h.Microphone="microphone",h.ScreenShare="screen_share",h.ScreenShareAudio="screen_share_audio",h.Unknown="unknown"})(i=a.Source||(a.Source={}));let s;(function(h){h.Active="active",h.Paused="paused",h.Unknown="unknown"})(s=a.StreamState||(a.StreamState={}));function o(h){switch(h){case e.Audio:return gn.AUDIO;case e.Video:return gn.VIDEO;default:return gn.DATA}}a.kindToProto=o;function l(h){switch(h){case gn.AUDIO:return e.Audio;case gn.VIDEO:return e.Video;default:return e.Unknown}}a.kindFromProto=l;function u(h){switch(h){case i.Camera:return ct.CAMERA;case i.Microphone:return ct.MICROPHONE;case i.ScreenShare:return ct.SCREEN_SHARE;case i.ScreenShareAudio:return ct.SCREEN_SHARE_AUDIO;default:return ct.UNKNOWN}}a.sourceToProto=u;function d(h){switch(h){case ct.CAMERA:return i.Camera;case ct.MICROPHONE:return i.Microphone;case ct.SCREEN_SHARE:return i.ScreenShare;case ct.SCREEN_SHARE_AUDIO:return i.ScreenShareAudio;default:return i.Unknown}}a.sourceFromProto=d;function m(h){switch(h){case cf.ACTIVE:return s.Active;case cf.PAUSED:return s.Paused;default:return s.Unknown}}a.streamStateFromProto=m})(Y);class je{constructor(e,i,s,o,l){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(i!==void 0&&s!==void 0)this.width=e,this.height=i,this.aspectRatio=e/i,this.encoding={maxBitrate:s,maxFramerate:o,priority:l};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const O_=["vp8","h264"],D_=["vp8","h264","vp9","av1"];function A_(a){return!!O_.find(e=>e===a)}var Zv;(function(a){a[a.REGRESSION=0]="REGRESSION",a[a.SIMULCAST=1]="SIMULCAST"})(Zv||(Zv={}));var Sf;(function(a){a.telephone={maxBitrate:12e3},a.speech={maxBitrate:24e3},a.music={maxBitrate:48e3},a.musicStereo={maxBitrate:64e3},a.musicHighQuality={maxBitrate:96e3},a.musicHighQualityStereo={maxBitrate:128e3}})(Sf||(Sf={}));const qr={h90:new je(160,90,9e4,20),h180:new je(320,180,16e4,20),h216:new je(384,216,18e4,20),h360:new je(640,360,45e4,20),h540:new je(960,540,8e5,25),h720:new je(1280,720,17e5,30),h1080:new je(1920,1080,3e6,30),h1440:new je(2560,1440,5e6,30),h2160:new je(3840,2160,8e6,30)},Tf={h120:new je(160,120,7e4,20),h180:new je(240,180,125e3,20),h240:new je(320,240,14e4,20),h360:new je(480,360,33e4,20),h480:new je(640,480,5e5,20),h540:new je(720,540,6e5,25),h720:new je(960,720,13e5,30),h1080:new je(1440,1080,23e5,30),h1440:new je(1920,1440,38e5,30)},eh={h360fps3:new je(640,360,2e5,3,"medium"),h360fps15:new je(640,360,4e5,15,"medium"),h720fps5:new je(1280,720,8e5,5,"medium"),h720fps15:new je(1280,720,15e5,15,"medium"),h720fps30:new je(1280,720,2e6,30,"medium"),h1080fps15:new je(1920,1080,25e5,15,"medium"),h1080fps30:new je(1920,1080,5e6,30,"medium"),original:new je(0,0,7e6,30,"medium")},N_="|",Wv="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function P_(a){const e=a.split(N_);return e.length>1?[e[0],a.substr(e[0].length+1)]:[a,""]}function jt(a){return O(this,void 0,void 0,function*(){return new Promise(e=>Tt.setTimeout(e,a))})}function kf(){return"addTransceiver"in RTCPeerConnection.prototype}function Cf(){return"addTrack"in RTCPeerConnection.prototype}function M_(){if(!("getCapabilities"in RTCRtpSender)||Vi())return!1;const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType==="video/AV1"){e=!0;break}}return e}function U_(){if(!("getCapabilities"in RTCRtpSender)||vs())return!1;if(Vi()){const i=Mn();if(i!=null&&i.version&&ys(i.version,"16")<0)return!1}const a=RTCRtpSender.getCapabilities("video");let e=!1;if(a){for(const i of a.codecs)if(i.mimeType==="video/VP9"){e=!0;break}}return e}function Ur(a){return a==="av1"||a==="vp9"}function Ef(a){return document?(a||(a=document.createElement("audio")),"setSinkId"in a):!1}function L_(){return typeof RTCPeerConnection>"u"?!1:kf()||Cf()}function vs(){var a;return((a=Mn())===null||a===void 0?void 0:a.name)==="Firefox"}function Vi(){var a;return((a=Mn())===null||a===void 0?void 0:a.name)==="Safari"}function j_(){const a=Mn();return(a==null?void 0:a.name)==="Safari"&&a.version.startsWith("17.")}function xb(){var a,e;return Ut()?(e=(a=navigator.userAgentData)===null||a===void 0?void 0:a.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function I_(){const a=Mn(),e="17.2";if(a)return a.name!=="Safari"&&a.os!=="iOS"||a.os==="iOS"&&a.osVersion&&ys(e,a.osVersion)>=0?!0:a.name==="Safari"&&ys(e,a.version)>=0}function Ut(){return typeof document<"u"}function Un(){return navigator.product=="ReactNative"}function Rf(a){return a.hostname.endsWith(".livekit.cloud")||a.hostname.endsWith(".livekit.run")}function Ob(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Db(){if(!Un())return;let a=Ob();if(a)return a.platform}function $v(){if(Ut())return window.devicePixelRatio;if(Un()){let a=Ob();if(a)return a.devicePixelRatio}return 1}function ys(a,e){const i=a.split("."),s=e.split("."),o=Math.min(i.length,s.length);for(let l=0;l<o;++l){const u=parseInt(i[l],10),d=parseInt(s[l],10);if(u>d)return 1;if(u<d)return-1;if(l===o-1&&u===d)return 0}return a===""&&e!==""?-1:e===""?1:i.length==s.length?0:i.length<s.length?-1:1}function B_(a){for(const e of a)e.target.handleResize(e)}function z_(a){for(const e of a)e.target.handleVisibilityChanged(e)}let Pd=null;const ey=()=>(Pd||(Pd=new ResizeObserver(B_)),Pd);let Md=null;const ty=()=>(Md||(Md=new IntersectionObserver(z_,{root:null,rootMargin:"0px"})),Md);function q_(){var a;const e=new O1({sdk:U0.JS,protocol:w_,version:__});return Un()&&(e.os=(a=Db())!==null&&a!==void 0?a:""),e}function ny(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=a,o.height=e;const l=o.getContext("2d");l==null||l.fillRect(0,0,o.width,o.height),s&&l&&(l.beginPath(),l.arc(a/2,e/2,50,0,Math.PI*2,!0),l.closePath(),l.fillStyle="grey",l.fill());const u=o.captureStream(),[d]=u.getTracks();if(!d)throw Error("Could not get empty media stream video track");return d.enabled=i,d}let Dr;function Ud(){if(!Dr){const a=new AudioContext,e=a.createOscillator(),i=a.createGain();i.gain.setValueAtTime(0,0);const s=a.createMediaStreamDestination();if(e.connect(i),i.connect(s),e.start(),[Dr]=s.stream.getAudioTracks(),!Dr)throw Error("Could not get empty media stream audio track");Dr.enabled=!1}return Dr.clone()}class Ab{constructor(e,i){this.onFinally=i,this.promise=new Promise((s,o)=>O(this,void 0,void 0,function*(){this.resolve=s,this.reject=o,e&&(yield e(s,o))})).finally(()=>{var s;return(s=this.onFinally)===null||s===void 0?void 0:s.call(this)})}}function V_(a){return D_.includes(a)}function zi(a){if(typeof a=="string"||typeof a=="number")return a;if(Array.isArray(a))return a[0];if(a.exact)return Array.isArray(a.exact)?a.exact[0]:a.exact;if(a.ideal)return Array.isArray(a.ideal)?a.ideal[0]:a.ideal;throw Error("could not unwrap constraint")}function H_(a){return a.startsWith("http")?a.replace(/^(http)/,"ws"):a}function iy(a){return a.startsWith("ws")?a.replace(/^(ws)/,"http"):a}function F_(a,e){return a.segments.map(i=>{let{id:s,text:o,language:l,startTime:u,endTime:d,final:m}=i;var h;const g=(h=e.get(s))!==null&&h!==void 0?h:Date.now(),v=Date.now();return m?e.delete(s):e.set(s,g),{id:s,text:o,startTime:Number.parseInt(u.toString()),endTime:Number.parseInt(d.toString()),final:m,language:l,firstReceivedTime:g,lastReceivedTime:v}})}function G_(a){const{id:e,timestamp:i,message:s,editTimestamp:o}=a;return{id:e,timestamp:Number.parseInt(i.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:s}}function ay(a){switch(a.reason){case xe.LeaveRequest:return a.context;case xe.Cancelled:return yn.CLIENT_INITIATED;case xe.NotAllowed:return yn.USER_REJECTED;case xe.ServerUnreachable:return yn.JOIN_FAILURE;default:return yn.UNKNOWN_REASON}}function Pc(a){return a!==void 0?Number(a):void 0}function ha(a){return a!==void 0?BigInt(a):void 0}function ms(a){return!!a&&!(a instanceof MediaStreamTrack)&&a.isLocal}function ri(a){return!!a&&a.kind==Y.Kind.Audio}function Es(a){return!!a&&a.kind==Y.Kind.Video}function Pi(a){return ms(a)&&Es(a)}function ma(a){return ms(a)&&ri(a)}function _f(a){return!!a&&!a.isLocal}function K_(a){return!!a&&!a.isLocal}function Ld(a){return _f(a)&&Es(a)}function Y_(a){return a.isLocal}function Q_(a,e){const i=[];let s=new TextEncoder().encode(a);for(;s.length>e;){let o=e;for(;o>0;){const l=s[o];if(l!==void 0&&(l&192)!==128)break;o--}i.push(s.slice(0,o)),s=s.slice(o)}return s.length>0&&i.push(s),i}function Nb(a,e,i){var s,o,l,u,d;const{optionsWithoutProcessor:m,audioProcessor:h,videoProcessor:g}=th(a??{}),v=e==null?void 0:e.processor,b=i==null?void 0:i.processor,k=(s=k_(m))!==null&&s!==void 0?s:{};return k.audio===!0&&(k.audio={}),k.video===!0&&(k.video={}),k.audio&&(wf(k.audio,e),(o=(u=k.audio).deviceId)!==null&&o!==void 0||(u.deviceId="default"),(h||v)&&(k.audio.processor=h??v)),k.video&&(wf(k.video,i),(l=(d=k.video).deviceId)!==null&&l!==void 0||(d.deviceId="default"),(g||b)&&(k.video.processor=g??b)),k}function wf(a,e){return Object.keys(e).forEach(i=>{a[i]===void 0&&(a[i]=e[i])}),a}function sl(a){var e,i,s,o;const l={};if(a.video)if(typeof a.video=="object"){const u={},d=u,m=a.video;Object.keys(m).forEach(h=>{switch(h){case"resolution":wf(d,m.resolution);break;default:d[h]=m[h]}}),l.video=u,(e=(s=l.video).deviceId)!==null&&e!==void 0||(s.deviceId="default")}else l.video=a.video?{deviceId:"default"}:!1;else l.video=!1;return a.audio?typeof a.audio=="object"?(l.audio=a.audio,(i=(o=l.audio).deviceId)!==null&&i!==void 0||(o.deviceId="default")):l.audio={deviceId:"default"}:l.audio=!1,l}function Pb(a){return O(this,arguments,void 0,function(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const s=Mb();if(s){const o=s.createAnalyser();o.fftSize=2048;const l=o.frequencyBinCount,u=new Uint8Array(l);s.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield jt(i),o.getByteTimeDomainData(u);const m=u.some(h=>h!==128&&h!==0);return s.close(),!m}return!1}()})}function Mb(){var a;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const i=new e({latencyHint:"interactive"});if(i.state==="suspended"&&typeof window<"u"&&(!((a=window.document)===null||a===void 0)&&a.body)){const s=()=>O(this,void 0,void 0,function*(){var o;try{i.state==="suspended"&&(yield i.resume())}catch(l){console.warn("Error trying to auto-resume audio context",l)}(o=window.document.body)===null||o===void 0||o.removeEventListener("click",s)});window.document.body.addEventListener("click",s)}return i}}function sy(a){return a===Y.Source.Microphone?"audioinput":a===Y.Source.Camera?"videoinput":void 0}function X_(a){var e,i;let s=(e=a.video)!==null&&e!==void 0?e:!0;return a.resolution&&a.resolution.width>0&&a.resolution.height>0&&(s=typeof s=="boolean"?{}:s,Vi()?s=Object.assign(Object.assign({},s),{width:{max:a.resolution.width},height:{max:a.resolution.height},frameRate:a.resolution.frameRate}):s=Object.assign(Object.assign({},s),{width:{ideal:a.resolution.width},height:{ideal:a.resolution.height},frameRate:a.resolution.frameRate})),{audio:(i=a.audio)!==null&&i!==void 0?i:!1,video:s,controller:a.controller,selfBrowserSurface:a.selfBrowserSurface,surfaceSwitching:a.surfaceSwitching,systemAudio:a.systemAudio,preferCurrentTab:a.preferCurrentTab}}function Mc(a){return a.split("/")[1].toLowerCase()}function J_(a){const e=[];return a.forEach(i=>{i.track!==void 0&&e.push(new Xf({cid:i.track.mediaStreamID,track:i.trackInfo}))}),e}function Me(a){return"mediaStreamTrack"in a?{trackID:a.sid,source:a.source,muted:a.isMuted,enabled:a.mediaStreamTrack.enabled,kind:a.kind,streamID:a.mediaStreamID,streamTrackID:a.mediaStreamTrack.id}:{trackID:a.trackSid,enabled:a.isEnabled,muted:a.isMuted,trackInfo:Object.assign({mimeType:a.mimeType,name:a.trackName,encrypted:a.isEncrypted,kind:a.kind,source:a.source},a.track?Me(a.track):{})}}function Z_(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function W_(a,e){var i;a===void 0&&(a={}),e===void 0&&(e={});const s=[...Object.keys(e),...Object.keys(a)],o={};for(const l of s)a[l]!==e[l]&&(o[l]=(i=e[l])!==null&&i!==void 0?i:"");return o}function th(a){const e=Object.assign({},a);let i,s;return typeof e.audio=="object"&&e.audio.processor&&(i=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(s=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:i,videoProcessor:s,optionsWithoutProcessor:e}}function $_(a){switch(a){case ct.CAMERA:return Y.Source.Camera;case ct.MICROPHONE:return Y.Source.Microphone;case ct.SCREEN_SHARE:return Y.Source.ScreenShare;case ct.SCREEN_SHARE_AUDIO:return Y.Source.ScreenShareAudio;default:return Y.Source.Unknown}}class ew extends jn.EventEmitter{constructor(e){super(),this.onWorkerMessage=i=>{var s,o;const{kind:l,data:u}=i.data;switch(l){case"error":Ee.error(u.error.message),this.emit(Ii.EncryptionError,u.error);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(d=>{this.postKey(d)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(d=>{this.postKey(d)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity))this.emit(Ii.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const d=(o=this.room)===null||o===void 0?void 0:o.getParticipantByIdentity(u.participantIdentity);if(!d)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(Ii.ParticipantEncryptionStatusChanged,u.enabled,d)}break;case"ratchetKey":this.keyProvider.emit(Bi.KeyRatcheted,u.material,u.keyIndex);break}},this.onWorkerError=i=>{Ee.error("e2ee worker encountered an error:",{error:i.error}),this.emit(Ii.EncryptionError,i.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!y_())throw new $f("tried to setup end-to-end encryption on an unsupported browser");if(Ee.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const i={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:n_.getLevel()}};this.worker&&(Ee.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(i))}}setParticipantCryptorEnabled(e,i){Ee.debug("set e2ee to ".concat(e," for participant ").concat(i)),this.postEnable(e,i)}setSifTrailer(e){!e||e.length===0?Ee.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(te.RTPVideoMapUpdate,i=>{this.postRTPMap(i)})}setupEventListeners(e,i){e.on(W.TrackPublished,(s,o)=>this.setParticipantCryptorEnabled(s.trackInfo.encryption!==Kt.NONE,o.identity)),e.on(W.ConnectionStateChanged,s=>{s===Ne.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{this.setParticipantCryptorEnabled(l.trackInfo.encryption!==Kt.NONE,o.identity)})})}).on(W.TrackUnsubscribed,(s,o,l)=>{var u;const d={kind:"removeTransform",data:{participantIdentity:l.identity,trackId:s.mediaStreamID}};(u=this.worker)===null||u===void 0||u.postMessage(d)}).on(W.TrackSubscribed,(s,o,l)=>{this.setupE2EEReceiver(s,l.identity,o.trackInfo)}).on(W.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");i.getKeys().forEach(s=>{this.postKey(s)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(ae.LocalTrackPublished,s=>O(this,void 0,void 0,function*(){this.setupE2EESender(s.track,s.track.sender)})),i.on(Bi.SetKey,s=>this.postKey(s)).on(Bi.RatchetRequest,(s,o)=>this.postRatchetRequest(s,o))}postRatchetRequest(e,i){if(!this.worker)throw Error("could not ratchet key, worker is missing");const s={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:i}};this.worker.postMessage(s)}postKey(e){let{key:i,participantIdentity:s,keyIndex:o}=e;var l;if(!this.worker)throw Error("could not set key, worker is missing");const u={kind:"setKey",data:{participantIdentity:s,isPublisher:s===((l=this.room)===null||l===void 0?void 0:l.localParticipant.identity),key:i,keyIndex:o}};this.worker.postMessage(u)}postEnable(e,i){if(this.worker){const s={kind:"enable",data:{enabled:e,participantIdentity:i}};this.worker.postMessage(s)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var i;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((i=this.room)===null||i===void 0)&&i.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const s={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(s)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const i={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(i)}setupE2EEReceiver(e,i,s){if(e.receiver){if(!(s!=null&&s.mimeType)||s.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,i,e.kind==="video"?Mc(s.mimeType):void 0)}}setupE2EESender(e,i){if(!ms(e)||!i){i||Ee.warn("early return because sender is not ready");return}this.handleSender(i,e.mediaStreamID,void 0)}handleReceiver(e,i,s,o){return O(this,void 0,void 0,function*(){if(this.worker){if(yf()){const l={kind:"decode",participantIdentity:s,trackId:i,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{if(dc in e&&o){const m={kind:"updateCodec",data:{trackId:i,codec:o,participantIdentity:s}};this.worker.postMessage(m);return}let l=e.writableStream,u=e.readableStream;if(!l||!u){const m=e.createEncodedStreams();e.writableStream=m.writable,l=m.writable,e.readableStream=m.readable,u=m.readable}const d={kind:"decode",data:{readableStream:u,writableStream:l,trackId:i,codec:o,participantIdentity:s}};this.worker.postMessage(d,[u,l])}e[dc]=!0}})}handleSender(e,i,s){var o;if(!(dc in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(yf()){Ee.info("initialize script transform");const l={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:i,codec:s};e.transform=new RTCRtpScriptTransform(this.worker,l)}else{Ee.info("initialize encoded streams");const l=e.createEncodedStreams(),u={kind:"encode",data:{readableStream:l.readable,writableStream:l.writable,codec:s,trackId:i,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(u,[l.readable,l.writable])}e[dc]=!0}}}const jd="default";class gt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new gt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return O(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l;if(((l=gt.userMediaPromiseMap)===null||l===void 0?void 0:l.size)>0){Ee.debug("awaiting getUserMedia promise");try{i?yield gt.userMediaPromiseMap.get(i):yield Promise.all(gt.userMediaPromiseMap.values())}catch{Ee.warn("error waiting for media permissons")}}let u=yield navigator.mediaDevices.enumerateDevices();if(o&&!(Vi()&&s.hasDeviceInUse(i))&&(u.filter(m=>m.kind===i).length===0||u.some(m=>{const h=m.label==="",g=i?m.kind===i:!0;return h&&g}))){const m={video:i!=="audioinput"&&i!=="audiooutput",audio:i!=="videoinput"&&{deviceId:"default"}},h=yield navigator.mediaDevices.getUserMedia(m);u=yield navigator.mediaDevices.enumerateDevices(),h.getTracks().forEach(g=>{g.stop()})}return s._previousDevices=u,i&&(u=u.filter(d=>d.kind===i)),u}()})}normalizeDeviceId(e,i,s){return O(this,void 0,void 0,function*(){if(i!==jd)return i;const o=yield this.getDevices(e),l=o.find(d=>d.deviceId===jd);if(!l){Ee.warn("could not reliably determine default device");return}const u=o.find(d=>d.deviceId!==jd&&d.groupId===(s??l.groupId));if(!u){Ee.warn("could not reliably determine default device");return}return u==null?void 0:u.deviceId})}hasDeviceInUse(e){return e?gt.userMediaPromiseMap.has(e):gt.userMediaPromiseMap.size>0}}gt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];gt.userMediaPromiseMap=new Map;var Lr;(function(a){a[a.WAITING=0]="WAITING",a[a.RUNNING=1]="RUNNING",a[a.COMPLETED=2]="COMPLETED"})(Lr||(Lr={}));class tw{constructor(){this.pendingTasks=new Map,this.taskMutex=new Yt,this.nextTaskIndex=0}run(e){return O(this,void 0,void 0,function*(){const i={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Lr.WAITING};this.pendingTasks.set(i.id,i);const s=yield this.taskMutex.lock();try{return i.executedAt=Date.now(),i.status=Lr.RUNNING,yield e()}finally{i.status=Lr.COMPLETED,this.pendingTasks.delete(i.id),s()}})}flush(){return O(this,void 0,void 0,function*(){return this.run(()=>O(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const nw=["syncState","trickle","offer","answer","simulate","leave"];function iw(a){const e=nw.indexOf(a.case)>=0;return Ee.trace("request allowed to bypass queue:",{canPass:e,req:a}),e}var Fe;(function(a){a[a.CONNECTING=0]="CONNECTING",a[a.CONNECTED=1]="CONNECTED",a[a.RECONNECTING=2]="RECONNECTING",a[a.DISCONNECTING=3]="DISCONNECTING",a[a.DISCONNECTED=4]="DISCONNECTED"})(Fe||(Fe={}));class nh{get currentState(){return this.state}get isDisconnected(){return this.state===Fe.DISCONNECTING||this.state===Fe.DISCONNECTED}get isEstablishingConnection(){return this.state===Fe.CONNECTING||this.state===Fe.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;this.rtt=0,this.state=Fe.DISCONNECTED,this.log=Ee,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=si((s=i.loggerName)!==null&&s!==void 0?s:bn.Signal),this.loggerContextCb=i.loggerContextCb,this.useJSON=e,this.requestQueue=new tw,this.queuedRequests=[],this.closingLock=new Yt,this.connectionLock=new Yt,this.state=Fe.DISCONNECTED}get logContext(){var e,i;return(i=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&i!==void 0?i:{}}join(e,i,s,o){return O(this,void 0,void 0,function*(){return this.state=Fe.CONNECTING,this.options=s,yield this.connect(e,i,s,o)})}reconnect(e,i,s,o){return O(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Fe.RECONNECTING,this.clearPingInterval(),yield this.connect(e,i,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:s,reconnectReason:o}))})}connect(e,i,s,o){this.connectOptions=s;const l=new URL(H_(e)),u=l.pathname.endsWith("/");l.pathname+=u?"rtc":"/rtc";const d=q_(),m=aw(i,d,s);for(const[h,g]of m)l.searchParams.set(h,g);return new Promise((h,g)=>O(this,void 0,void 0,function*(){const v=yield this.connectionLock.lock();try{const b=()=>O(this,void 0,void 0,function*(){this.close(),clearTimeout(k),g(new Be("room connection has been cancelled (signal)",xe.Cancelled))}),k=setTimeout(()=>{this.close(),g(new Be("room connection has timed out (signal)",xe.ServerUnreachable))},s.websocketTimeout);o!=null&&o.aborted&&b(),o==null||o.addEventListener("abort",b);const T=new URL(l.toString());T.searchParams.has("access_token")&&T.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(T),Object.assign({reconnect:s.reconnect,reconnectReason:s.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(l.toString()),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(k)},this.ws.onerror=E=>O(this,void 0,void 0,function*(){if(this.state!==Fe.CONNECTED){this.state=Fe.DISCONNECTED,clearTimeout(k);try{const _=new URL(l.toString());_.protocol="http".concat(_.protocol.substring(2)),_.pathname+="/validate";const x=yield fetch(_);if(x.status.toFixed(0).startsWith("4")){const I=yield x.text();g(new Be(I,xe.NotAllowed,x.status))}else g(new Be("Internal error",xe.InternalError,x.status))}catch(_){g(new Be(_ instanceof Error?_.message:"server was not reachable",xe.ServerUnreachable))}return}this.handleWSError(E)}),this.ws.onmessage=E=>O(this,void 0,void 0,function*(){var _,x,I;let U;if(typeof E.data=="string"){const N=JSON.parse(E.data);U=Lv.fromJson(N,{ignoreUnknownFields:!0})}else if(E.data instanceof ArrayBuffer)U=Lv.fromBinary(new Uint8Array(E.data));else{this.log.error("could not decode websocket message: ".concat(typeof E.data),this.logContext);return}if(this.state!==Fe.CONNECTED){let N=!1;if(((_=U.message)===null||_===void 0?void 0:_.case)==="join"?(this.state=Fe.CONNECTED,o==null||o.removeEventListener("abort",b),this.pingTimeoutDuration=U.message.value.pingTimeout,this.pingIntervalDuration=U.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),h(U.message.value)):this.state===Fe.RECONNECTING&&U.message.case!=="leave"?(this.state=Fe.CONNECTED,o==null||o.removeEventListener("abort",b),this.startPingInterval(),((x=U.message)===null||x===void 0?void 0:x.case)==="reconnect"?h(U.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),h(void 0),N=!0)):this.isEstablishingConnection&&U.message.case==="leave"?g(new Be("Received leave request while trying to (re)connect",xe.LeaveRequest,void 0,U.message.value.reason)):s.reconnect||g(new Be("did not receive join response, got ".concat((I=U.message)===null||I===void 0?void 0:I.case," instead"),xe.InternalError)),!N)return}this.signalLatency&&(yield jt(this.signalLatency)),this.handleSignalResponse(U)}),this.ws.onclose=E=>{this.isEstablishingConnection&&g(new Be("Websocket got closed during a (re)connection attempt",xe.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:E.reason,code:E.code,wasClean:E.wasClean,state:this.state})),this.handleOnClose(E.reason)}}finally{v()}}))}close(){return O(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const s=yield e.closingLock.lock();try{if(e.clearPingInterval(),i&&(e.state=Fe.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const o=new Promise(l=>{e.ws?e.ws.onclose=()=>{l()}:l()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([o,jt(250)])),e.ws=void 0}}finally{i&&(e.state=Fe.DISCONNECTED),s()}}()})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Hc(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Hc(e)})}sendIceCandidate(e,i){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Yf({candidateInit:JSON.stringify(e),target:i})})}sendMuteTrack(e,i){return this.sendRequest({case:"mute",value:new Qf({sid:e,muted:i})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,i){return O(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const d=l.getNextRequestId();return yield l.sendRequest({case:"updateMetadata",value:new H0({requestId:d,metadata:s,name:o,attributes:u})}),d}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,i){return this.sendRequest({case:"updateLayers",value:new V0({trackSid:e,layers:i})})}sendUpdateSubscriptionPermissions(e,i){return this.sendRequest({case:"subscriptionPermission",value:new K0({allParticipants:e,trackPermissions:i})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Ge.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new X0({timestamp:Ge.parse(Date.now()),rtt:Ge.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,i){return this.sendRequest({case:"updateAudioTrack",value:new q0({trackSid:e,features:i})})}sendLeave(){return this.sendRequest({case:"leave",value:new il({reason:yn.CLIENT_INITIATED,action:ds.DISCONNECT})})}sendRequest(e){return O(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!o&&!iw(i)&&s.state===Fe.RECONNECTING){s.queuedRequests.push(()=>O(s,void 0,void 0,function*(){yield this.sendRequest(i,!0)}));return}if(o||(yield s.requestQueue.flush()),s.signalLatency&&(yield jt(s.signalLatency)),!s.ws||s.ws.readyState!==s.ws.OPEN){s.log.error("cannot send signal request before connected, type: ".concat(i==null?void 0:i.case),s.logContext);return}const u=new N1({message:i});try{s.useJSON?s.ws.send(u.toJsonString()):s.ws.send(u.toBinary())}catch(d){s.log.error("error sending signal message",Object.assign(Object.assign({},s.logContext),{error:d}))}}()})}handleSignalResponse(e){var i,s;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let l=!1;if(o.case==="answer"){const u=ry(o.value);this.onAnswer&&this.onAnswer(u)}else if(o.case==="offer"){const u=ry(o.value);this.onOffer&&this.onOffer(u)}else if(o.case==="trickle"){const u=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(u,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((i=o.value.participants)!==null&&i!==void 0?i:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((s=o.value.speakers)!==null&&s!==void 0?s:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),l=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));l||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return O(this,void 0,void 0,function*(){if(this.state===Fe.DISCONNECTED)return;const i=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),i&&i(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Tt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Tt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Tt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Tt.clearInterval(this.pingInterval)}}function ry(a){const e={type:"offer",sdp:a.sdp};switch(a.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=a.type;break}return e}function Hc(a){return new Sa({sdp:a.sdp,type:a.type})}function aw(a,e,i){var s;const o=new URLSearchParams;return o.set("access_token",a),i.reconnect&&(o.set("reconnect","1"),i.sid&&o.set("sid",i.sid)),o.set("auto_subscribe",i.autoSubscribe?"1":"0"),o.set("sdk",Un()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),i.adaptiveStream&&o.set("adaptive_stream","1"),i.reconnectReason&&o.set("reconnect_reason",i.reconnectReason.toString()),!((s=navigator.connection)===null||s===void 0)&&s.type&&o.set("network",navigator.connection.type),o}var hn={},Id={},Bd={exports:{}},oy;function ih(){if(oy)return Bd.exports;oy=1;var a=Bd.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var i="candidate:%s %d %s %d %s %d typ %s";return i+=e.raddr!=null?" raddr %s rport %d":"%v%v",i+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(i+=" generation %d"),i+=e["network-id"]!=null?" network-id %d":"%v",i+=e["network-cost"]!=null?" network-cost %d":"%v",i}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var i="ssrc:%d";return e.attribute!=null&&(i+=" %s",e.value!=null&&(i+=":%s")),i}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var i="mediaclk:";return i+=e.id!=null?"id=%s %s":"%v%s",i+=e.mediaClockValue!=null?"=%s":"",i+=e.rateNumerator!=null?" rate=%s":"",i+=e.rateDenominator!=null?"/%s":"",i}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(a).forEach(function(e){var i=a[e];i.forEach(function(s){s.reg||(s.reg=/(.*)/),s.format||(s.format="%s")})}),Bd.exports}var cy;function sw(){return cy||(cy=1,function(a){var e=function(d){return String(Number(d))===d?Number(d):d},i=function(d,m,h,g){if(g&&!h)m[g]=e(d[1]);else for(var v=0;v<h.length;v+=1)d[v+1]!=null&&(m[h[v]]=e(d[v+1]))},s=function(d,m,h){var g=d.name&&d.names;d.push&&!m[d.push]?m[d.push]=[]:g&&!m[d.name]&&(m[d.name]={});var v=d.push?{}:g?m[d.name]:m;i(h.match(d.reg),v,d.names,d.name),d.push&&m[d.push].push(v)},o=ih(),l=RegExp.prototype.test.bind(/^([a-z])=(.*)/);a.parse=function(d){var m={},h=[],g=m;return d.split(/(\r\n|\r|\n)/).filter(l).forEach(function(v){var b=v[0],k=v.slice(2);b==="m"&&(h.push({rtp:[],fmtp:[]}),g=h[h.length-1]);for(var T=0;T<(o[b]||[]).length;T+=1){var E=o[b][T];if(E.reg.test(k))return s(E,g,k)}}),m.media=h,m};var u=function(d,m){var h=m.split(/=(.+)/,2);return h.length===2?d[h[0]]=e(h[1]):h.length===1&&m.length>1&&(d[h[0]]=void 0),d};a.parseParams=function(d){return d.split(/;\s?/).reduce(u,{})},a.parseFmtpConfig=a.parseParams,a.parsePayloads=function(d){return d.toString().split(" ").map(Number)},a.parseRemoteCandidates=function(d){for(var m=[],h=d.split(" ").map(e),g=0;g<h.length;g+=3)m.push({component:h[g],ip:h[g+1],port:h[g+2]});return m},a.parseImageAttributes=function(d){return d.split(" ").map(function(m){return m.substring(1,m.length-1).split(",").reduce(u,{})})},a.parseSimulcastStreamList=function(d){return d.split(";").map(function(m){return m.split(",").map(function(h){var g,v=!1;return h[0]!=="~"?g=e(h):(g=e(h.substring(1,h.length)),v=!0),{scid:g,paused:v}})})}}(Id)),Id}var zd,ly;function rw(){if(ly)return zd;ly=1;var a=ih(),e=/%[sdv%]/g,i=function(u){var d=1,m=arguments,h=m.length;return u.replace(e,function(g){if(d>=h)return g;var v=m[d];switch(d+=1,g){case"%%":return"%";case"%s":return String(v);case"%d":return Number(v);case"%v":return""}})},s=function(u,d,m){var h=d.format instanceof Function?d.format(d.push?m:m[d.name]):d.format,g=[u+"="+h];if(d.names)for(var v=0;v<d.names.length;v+=1){var b=d.names[v];d.name?g.push(m[d.name][b]):g.push(m[d.names[v]])}else g.push(m[d.name]);return i.apply(null,g)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],l=["i","c","b","a"];return zd=function(u,d){d=d||{},u.version==null&&(u.version=0),u.name==null&&(u.name=" "),u.media.forEach(function(v){v.payloads==null&&(v.payloads="")});var m=d.outerOrder||o,h=d.innerOrder||l,g=[];return m.forEach(function(v){a[v].forEach(function(b){b.name in u&&u[b.name]!=null?g.push(s(v,b,u)):b.push in u&&u[b.push]!=null&&u[b.push].forEach(function(k){g.push(s(v,b,k))})})}),u.media.forEach(function(v){g.push(s("m",a.m[0],v)),h.forEach(function(b){a[b].forEach(function(k){k.name in v&&v[k.name]!=null?g.push(s(b,k,v)):k.push in v&&v[k.push]!=null&&v[k.push].forEach(function(T){g.push(s(b,k,T))})})})}),g.join(`\r
`)+`\r
`},zd}var uy;function ow(){if(uy)return hn;uy=1;var a=sw(),e=rw(),i=ih();return hn.grammar=i,hn.write=e,hn.parse=a.parse,hn.parseParams=a.parseParams,hn.parseFmtpConfig=a.parseFmtpConfig,hn.parsePayloads=a.parsePayloads,hn.parseRemoteCandidates=a.parseRemoteCandidates,hn.parseImageAttributes=a.parseImageAttributes,hn.parseSimulcastStreamList=a.parseSimulcastStreamList,hn}var Mi=ow();function ah(a,e,i){var s,o,l;e===void 0&&(e=50),i===void 0&&(i={});var u=(s=i.isImmediate)!=null&&s,d=(o=i.callback)!=null&&o,m=i.maxWait,h=Date.now(),g=[];function v(){if(m!==void 0){var k=Date.now()-h;if(k+e>=m)return m-k}return e}var b=function(){var k=[].slice.call(arguments),T=this;return new Promise(function(E,_){var x=u&&l===void 0;if(l!==void 0&&clearTimeout(l),l=setTimeout(function(){if(l=void 0,h=Date.now(),!u){var U=a.apply(T,k);d&&d(U),g.forEach(function(N){return(0,N.resolve)(U)}),g=[]}},v()),x){var I=a.apply(T,k);return d&&d(I),E(I)}g.push({resolve:E,reject:_})})};return b.cancel=function(k){l!==void 0&&clearTimeout(l),g.forEach(function(T){return(0,T.reject)(k)}),g=[]},b}const cw=.7,lw=20,ps={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class dy extends jn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;super(),this.log=Ee,this.ddExtID=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=ah(o=>O(this,void 0,void 0,function*(){this.emit(ps.NegotiationStarted);try{yield this.createAndSendOffer()}catch(l){if(o)o(l);else throw l}}),lw),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=si((s=i.loggerName)!==null&&s!==void 0?s:bn.PCTransport),this.loggerOptions=i,this.config=e,this._pc=this.createPC()}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=i=>{var s;i.candidate&&((s=this.onIceCandidate)===null||s===void 0||s.call(this,i.candidate))},e.onicecandidateerror=i=>{var s;(s=this.onIceCandidateError)===null||s===void 0||s.call(this,i)},e.oniceconnectionstatechange=()=>{var i;(i=this.onIceConnectionStateChange)===null||i===void 0||i.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var i;(i=this.onSignalingStatechange)===null||i===void 0||i.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var i;(i=this.onConnectionStateChange)===null||i===void 0||i.call(this,e.connectionState)},e.ondatachannel=i=>{var s;(s=this.onDataChannel)===null||s===void 0||s.call(this,i)},e.ontrack=i=>{var s;(s=this.onTrack)===null||s===void 0||s.call(this,i)},e}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return O(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return O(this,void 0,void 0,function*(){var i;let s;if(e.type==="offer"){let{stereoMids:o,nackMids:l}=uw(e);this.remoteStereoMids=o,this.remoteNackMids=l}else if(e.type==="answer"){const o=Mi.parse((i=e.sdp)!==null&&i!==void 0?i:"");o.media.forEach(l=>{l.type==="audio"&&this.trackBitrates.some(u=>{if(!u.transceiver||l.mid!=u.transceiver.mid)return!1;let d=0;if(l.rtp.some(h=>h.codec.toUpperCase()===u.codec.toUpperCase()?(d=h.payload,!0):!1),d===0)return!0;let m=!1;for(const h of l.fmtp)if(h.payload===d){h.config=h.config.split(";").filter(g=>!g.includes("maxaveragebitrate")).join(";"),u.maxbr>0&&(h.config+=";maxaveragebitrate=".concat(u.maxbr*1e3)),m=!0;break}return m||u.maxbr>0&&l.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(u.maxbr*1e3)}),!0})}),s=Mi.write(o)}yield this.setMungedSDP(e,s,!0),this.pendingCandidates.forEach(o=>{this.pc.addIceCandidate(o)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(ps.NegotiationComplete),e.sdp&&Mi.parse(e.sdp).media.forEach(l=>{l.type==="video"&&this.emit(ps.RTPVideoPayloadTypes,l.rtp)}))})}createAndSendOffer(e){return O(this,void 0,void 0,function*(){var i;if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const l=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&l)yield this._pc.setRemoteDescription(l);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const s=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:s.sdp},this.logContext));const o=Mi.parse((i=s.sdp)!==null&&i!==void 0?i:"");o.media.forEach(l=>{hy(l),l.type==="audio"?fy(l,[],[]):l.type==="video"&&this.trackBitrates.some(u=>{if(!l.msid||!u.cid||!l.msid.includes(u.cid))return!1;let d=0;if(l.rtp.some(h=>h.codec.toUpperCase()===u.codec.toUpperCase()?(d=h.payload,!0):!1),d===0||(Ur(u.codec)&&this.ensureVideoDDExtensionForSVC(l,o),u.codec!=="av1"))return!0;const m=Math.round(u.maxbr*cw);for(const h of l.fmtp)if(h.payload===d){h.config.includes("x-google-start-bitrate")||(h.config+=";x-google-start-bitrate=".concat(m));break}return!0})}),yield this.setMungedSDP(s,Mi.write(o)),this.onOffer(s)})}createAndSetAnswer(){return O(this,void 0,void 0,function*(){var e;const i=yield this.pc.createAnswer(),s=Mi.parse((e=i.sdp)!==null&&e!==void 0?e:"");return s.media.forEach(o=>{hy(o),o.type==="audio"&&fy(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(i,Mi.write(s)),i})}createDataChannel(e,i){return this.pc.createDataChannel(e,i)}addTransceiver(e,i){return this.pc.addTransceiver(e,i)}addTrack(e){if(!this._pc)throw new dt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var i;if(!this._pc)throw new dt("PC closed, cannot configure");return(i=this._pc)===null||i===void 0?void 0:i.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var i;return(i=this._pc)===null||i===void 0?void 0:i.removeTrack(e)}getConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&i!==void 0?i:"closed"}getICEConnectionState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&i!==void 0?i:"closed"}getSignallingState(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&i!==void 0?i:"closed"}getTransceivers(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&i!==void 0?i:[]}getSenders(){var e,i;return(i=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&i!==void 0?i:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return O(this,void 0,void 0,function*(){var e;if(!this._pc)return;let i="";const s=new Map,o=new Map;if((yield this._pc.getStats()).forEach(d=>{switch(d.type){case"transport":i=d.selectedCandidatePairId;break;case"candidate-pair":i===""&&d.selected&&(i=d.id),s.set(d.id,d);break;case"remote-candidate":o.set(d.id,"".concat(d.address,":").concat(d.port));break}}),i==="")return;const u=(e=s.get(i))===null||e===void 0?void 0:e.remoteCandidateId;if(u!==void 0)return o.get(u)})}setMungedSDP(e,i,s){return O(this,void 0,void 0,function*(){if(i){const o=e.sdp;e.sdp=i;try{this.log.debug("setting munged ".concat(s?"remote":"local"," description"),this.logContext),s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(l){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:l,sdp:i})),e.sdp=o}}try{s?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let l="unknown error";o instanceof Error?l=o.message:typeof o=="string"&&(l=o);const u={error:l,sdp:e.sdp};throw!s&&this.pc.remoteDescription&&(u.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:u})),new bf(l)}})}ensureVideoDDExtensionForSVC(e,i){var s,o;if(!((s=e.ext)===null||s===void 0?void 0:s.some(u=>u.uri===Wv))){if(this.ddExtID===0){let u=0;i.media.forEach(d=>{var m;d.type==="video"&&((m=d.ext)===null||m===void 0||m.forEach(h=>{h.value>u&&(u=h.value)}))}),this.ddExtID=u+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:Wv})}}}function fy(a,e,i){let s=0;a.rtp.some(o=>o.codec==="opus"?(s=o.payload,!0):!1),s>0&&(a.rtcpFb||(a.rtcpFb=[]),i.includes(a.mid)&&!a.rtcpFb.some(o=>o.payload===s&&o.type==="nack")&&a.rtcpFb.push({payload:s,type:"nack"}),e.includes(a.mid)&&a.fmtp.some(o=>o.payload===s?(o.config.includes("stereo=1")||(o.config+=";stereo=1"),!0):!1))}function uw(a){var e;const i=[],s=[],o=Mi.parse((e=a.sdp)!==null&&e!==void 0?e:"");let l=0;return o.media.forEach(u=>{var d;u.type==="audio"&&(u.rtp.some(m=>m.codec==="opus"?(l=m.payload,!0):!1),!((d=u.rtcpFb)===null||d===void 0)&&d.some(m=>m.payload===l&&m.type==="nack")&&s.push(u.mid),u.fmtp.some(m=>m.payload===l?(m.config.includes("sprop-stereo=1")&&i.push(u.mid),!0):!1))}),{stereoMids:i,nackMids:s}}function hy(a){if(a.connection){const e=a.connection.ip.indexOf(":")>=0;(a.connection.version===4&&e||a.connection.version===6&&!e)&&(a.connection.ip="0.0.0.0",a.connection.version=4)}}const xf="vp8",dw={audioPreset:Sf.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:eh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:xf,backupCodec:!0},Ub={deviceId:"default",autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},Lb={deviceId:"default",resolution:qr.h720.resolution},fw={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new a_,disconnectOnPageLeave:!0,webAudioMix:!1},sh={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var We;(function(a){a[a.NEW=0]="NEW",a[a.CONNECTING=1]="CONNECTING",a[a.CONNECTED=2]="CONNECTED",a[a.FAILED=3]="FAILED",a[a.CLOSING=4]="CLOSING",a[a.CLOSED=5]="CLOSED"})(We||(We={}));class hw{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,i,s){var o;this.peerConnectionTimeout=sh.peerConnectionTimeout,this.log=Ee,this.updateState=()=>{var l;const u=this.state,d=this.requiredTransports.map(m=>m.getConnectionState());d.every(m=>m==="connected")?this.state=We.CONNECTED:d.some(m=>m==="failed")?this.state=We.FAILED:d.some(m=>m==="connecting")?this.state=We.CONNECTING:d.every(m=>m==="closed")?this.state=We.CLOSED:d.some(m=>m==="closed")?this.state=We.CLOSING:d.every(m=>m==="new")&&(this.state=We.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat(We[u]," to ").concat(We[this.state]),this.logContext),(l=this.onStateChange)===null||l===void 0||l.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=si((o=s.loggerName)!==null&&o!==void 0?o:bn.PCManager),this.loggerOptions=s,this.isPublisherConnectionRequired=!i,this.isSubscriberConnectionRequired=i,this.publisher=new dy(e,s),this.subscriber=new dy(e,s),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=l=>{var u;(u=this.onIceCandidate)===null||u===void 0||u.call(this,l,vn.PUBLISHER)},this.subscriber.onIceCandidate=l=>{var u;(u=this.onIceCandidate)===null||u===void 0||u.call(this,l,vn.SUBSCRIBER)},this.subscriber.onDataChannel=l=>{var u;(u=this.onDataChannel)===null||u===void 0||u.call(this,l)},this.subscriber.onTrack=l=>{var u;(u=this.onTrack)===null||u===void 0||u.call(this,l)},this.publisher.onOffer=l=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,l)},this.state=We.NEW,this.connectionLock=new Yt,this.remoteOfferLock=new Yt}get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions).loggerContextCb)===null||i===void 0?void 0:i.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return O(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const i of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(i)}catch(s){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:s}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return O(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,i){return O(this,void 0,void 0,function*(){i===vn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return O(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const i=yield this.remoteOfferLock.lock();try{return yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()}finally{i()}})}updateConfiguration(e,i){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),i&&this.triggerIceRestart()}ensurePCTransportConnection(e,i){return O(this,void 0,void 0,function*(){var s;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((s=this.requiredTransports)===null||s===void 0?void 0:s.map(l=>this.ensureTransportConnected(l,e,i)))}finally{o()}})}negotiate(e){return O(this,void 0,void 0,function*(){return new Promise((i,s)=>O(this,void 0,void 0,function*(){const o=setTimeout(()=>{s("negotiation timed out")},this.peerConnectionTimeout),l=()=>{clearTimeout(o),s("negotiation aborted")};e.signal.addEventListener("abort",l),this.publisher.once(ps.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(ps.NegotiationComplete,()=>{clearTimeout(o),i()})}),yield this.publisher.negotiate(u=>{clearTimeout(o),s(u)})}))})}addPublisherTransceiver(e,i){return this.publisher.addTransceiver(e,i)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,i){return this.publisher.createDataChannel(e,i)}getConnectedAddress(e){return e===vn.PUBLISHER?this.publisher.getConnectedAddress():e===vn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,i){return O(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(s.getConnectionState()!=="connected")return new Promise((m,h)=>O(l,void 0,void 0,function*(){const g=()=>{this.log.warn("abort transport connection",this.logContext),Tt.clearTimeout(v),h(new Be("room connection has been cancelled",xe.Cancelled))};o!=null&&o.signal.aborted&&g(),o==null||o.signal.addEventListener("abort",g);const v=Tt.setTimeout(()=>{o==null||o.signal.removeEventListener("abort",g),h(new Be("could not establish pc connection",xe.InternalError))},u);for(;this.state!==We.CONNECTED;)if(yield jt(50),o!=null&&o.signal.aborted){h(new Be("room connection has been cancelled",xe.Cancelled));return}Tt.clearTimeout(v),o==null||o.signal.removeEventListener("abort",g),m()}))}()})}}class et extends Error{constructor(e,i,s){super(i),this.code=e,this.message=my(i,et.MAX_MESSAGE_BYTES),this.data=s?my(s,et.MAX_DATA_BYTES):void 0}static fromProto(e){return new et(e.code,e.message,e.data)}toProto(){return new N0({code:this.code,message:this.message,data:this.data})}static builtIn(e,i){return new et(et.ErrorCode[e],et.ErrorMessage[e],i)}}et.MAX_MESSAGE_BYTES=256;et.MAX_DATA_BYTES=15360;et.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};et.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const jb=15360;function rh(a){return new TextEncoder().encode(a).length}function my(a,e){if(rh(a)<=e)return a;let i=0,s=a.length;const o=new TextEncoder;for(;i<s;){const l=Math.floor((i+s+1)/2);o.encode(a.slice(0,l)).length<=e?i=l:s=l-1}return a.slice(0,i)}const oh=2e3;function rl(a,e){if(!e)return 0;let i,s;return"bytesReceived"in a?(i=a.bytesReceived,s=e.bytesReceived):"bytesSent"in a&&(i=a.bytesSent,s=e.bytesSent),i===void 0||s===void 0||a.timestamp===void 0||e.timestamp===void 0?0:(i-s)*8*1e3/(a.timestamp-e.timestamp)}const mw=1e3;class Ib extends Y{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}constructor(e,i,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=arguments.length>4?arguments[4]:void 0;super(e,i,l),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=ah(()=>O(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>O(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit($.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new Yt,this.pauseUpstreamLock=new Yt,this.processorLock=new Yt,this.restartLock=new Yt,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),s&&(this._constraints=s)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Y.Kind.Video)return;const{width:e,height:i}=this._mediaStreamTrack.getSettings();if(e&&i)return{width:e,height:i}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,i;return(i=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&i!==void 0?i:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,i){return O(this,void 0,void 0,function*(){var s;if(e===this._mediaStreamTrack&&!i)return;this._mediaStreamTrack&&(this.attachedElements.forEach(l=>{hs(this._mediaStreamTrack,l)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){const l=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(us(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}finally{l()}}this.sender&&((s=this.sender.transport)===null||s===void 0?void 0:s.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(l=>{us(o??e,l)}))})}waitForDimensions(){return O(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mw;return function*(){var s;if(e.kind===Y.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((s=Mn())===null||s===void 0?void 0:s.os)==="iOS"&&(yield jt(10));const o=Date.now();for(;Date.now()-o<i;){const l=e.dimensions;if(l)return l;yield jt(50)}throw new ni("unable to get track dimensions after timeout")}()})}setDeviceId(e){return O(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===zi(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),zi(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return O(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===Y.Source.ScreenShare)return;const{deviceId:s,groupId:o}=e._mediaStreamTrack.getSettings(),l=e.kind===Y.Kind.Audio?"audioinput":"videoinput";return i?gt.getInstance().normalizeDeviceId(l,s,o):s}()})}mute(){return O(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return O(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,i){return O(this,void 0,void 0,function*(){if(!this.sender)throw new ni("unable to replace an unpublished track");let s,o;return typeof i=="boolean"?s=i:i!==void 0&&(s=i.userProvidedTrack,o=i.stopProcessor),this.providedByUser=s??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return O(this,void 0,void 0,function*(){this.manuallyStopped=!1;const i=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:s}=e,o=s_(e,["deviceId"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const l={audio:!1,video:!1};this.kind===Y.Kind.Video?l.video=s?{deviceId:s}:!0:l.audio=s?{deviceId:s}:!0,this.attachedElements.forEach(m=>{hs(this.mediaStreamTrack,m)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const d=(yield navigator.mediaDevices.getUserMedia(l)).getTracks()[0];return yield d.applyConstraints(o),d.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(d),this._constraints=e,this.emit($.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{i()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return O(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),xb()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return O(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit($.UpstreamPaused,this);const s=Mn();if((s==null?void 0:s.name)==="Safari"&&ys(s.version,"12.0")<0)throw new $f("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{i()}})}resumeUpstream(){return O(this,void 0,void 0,function*(){var e;const i=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit($.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{i()}})}getRTCStatsReport(){return O(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return O(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l;const u=yield s.processorLock.lock();try{s.log.debug("setting up processor",s.logContext);const d=document.createElement(s.kind),m={kind:s.kind,track:s._mediaStreamTrack,element:d,audioContext:s.audioContext};if(yield i.init(m),s.log.debug("processor initialized",s.logContext),s.processor&&(yield s.stopProcessor()),s.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(us(s._mediaStreamTrack,d),d.muted=!0,d.play().catch(h=>s.log.error("failed to play processor element",Object.assign(Object.assign({},s.logContext),{error:h}))),s.processor=i,s.processorElement=d,s.processor.processedTrack){for(const h of s.attachedElements)h!==s.processorElement&&o&&(hs(s._mediaStreamTrack,h),us(s.processor.processedTrack,h));yield(l=s.sender)===null||l===void 0?void 0:l.replaceTrack(s.processor.processedTrack)}s.emit($.TrackProcessorUpdate,s.processor)}finally{u()}}()})}getProcessor(){return this.processor}stopProcessor(){return O(this,arguments,void 0,function(){var e=this;let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var s,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(s=e.processor.processedTrack)===null||s===void 0||s.stop(),yield e.processor.destroy(),e.processor=void 0,i||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit($.TrackProcessorUpdate))}()})}}class Fc extends Ib{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;super(e,Y.Kind.Audio,i,s,l),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>O(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let u;try{u=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}u&&this.prevStats&&(this._currentBitrate=rl(u,this.prevStats)),this.prevStats=u}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,Nn.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit($.AudioTrackFeatureUpdate,this,Nn.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return O(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Y.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return O(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const s=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==zi(this._constraints.deviceId);return this.source===Y.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||s)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{i()}})}restartTrack(e){return O(this,void 0,void 0,function*(){let i;if(e){const s=sl({audio:e});typeof s.audio!="boolean"&&(i=s.audio)}yield this.restart(i)})}restart(e){const i=Object.create(null,{restart:{get:()=>super.restart}});return O(this,void 0,void 0,function*(){const s=yield i.restart.call(this,e);return this.checkForSilence(),s})}startMonitor(){Ut()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},oh)))}setProcessor(e){return O(this,void 0,void 0,function*(){var i;const s=yield this.processorLock.lock();try{if(!Un()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(i=this.sender)===null||i===void 0?void 0:i.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit($.TrackProcessorUpdate,this.processor)}finally{s()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return O(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const i=yield this.sender.getStats();let s;return i.forEach(o=>{o.type==="outbound-rtp"&&(s={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),s})}checkForSilence(){return O(this,void 0,void 0,function*(){const e=yield Pb(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit($.AudioSilenceDetected)),e})}}function Bb(a,e,i){switch(a.kind){case"audio":return new Fc(a,e,!1,void 0,i);case"video":return new Gc(a,e,!1,i);default:throw new ni("unsupported track type: ".concat(a.kind))}}const pw=Object.values(qr),gw=Object.values(Tf),vw=Object.values(eh),yw=[qr.h180,qr.h360],bw=[Tf.h180,Tf.h360],Sw=a=>[{scaleResolutionDownBy:2,fps:a.encoding.maxFramerate}].map(i=>{var s,o;return new je(Math.floor(a.width/i.scaleResolutionDownBy),Math.floor(a.height/i.scaleResolutionDownBy),Math.max(15e4,Math.floor(a.encoding.maxBitrate/(Math.pow(i.scaleResolutionDownBy,2)*(((s=a.encoding.maxFramerate)!==null&&s!==void 0?s:30)/((o=i.fps)!==null&&o!==void 0?o:30))))),i.fps,a.encoding.priority)}),Of=["q","h","f"];function Df(a,e,i,s){var o,l;let u=s==null?void 0:s.videoEncoding;a&&(u=s==null?void 0:s.screenShareEncoding);const d=s==null?void 0:s.simulcast,m=s==null?void 0:s.scalabilityMode,h=s==null?void 0:s.videoCodec;if(!u&&!d&&!m||!e||!i)return[{}];u||(u=kw(a,e,i,h),Ee.debug("using video encoding",u));const g=u.maxFramerate,v=new je(e,i,u.maxBitrate,u.maxFramerate,u.priority);if(m&&Ur(h)){const T=new zb(m),E=[];if(T.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(m));const _=Mn();if(Vi()||Un()||(_==null?void 0:_.name)==="Chrome"&&ys(_==null?void 0:_.version,"113")<0){const x=T.suffix=="h"?2:3;for(let I=0;I<T.spatial;I+=1)E.push({rid:Of[2-I],maxBitrate:u.maxBitrate/Math.pow(x,I),maxFramerate:v.encoding.maxFramerate});E[0].scalabilityMode=m}else E.push({maxBitrate:u.maxBitrate,maxFramerate:v.encoding.maxFramerate,scalabilityMode:m});return v.encoding.priority&&(E[0].priority=v.encoding.priority,E[0].networkPriority=v.encoding.priority),Ee.debug("using svc encoding",{encodings:E}),E}if(!d)return[u];let b=[];a?b=(o=gy(s==null?void 0:s.screenShareSimulcastLayers))!==null&&o!==void 0?o:py(a,v):b=(l=gy(s==null?void 0:s.videoSimulcastLayers))!==null&&l!==void 0?l:py(a,v);let k;if(b.length>0){const T=b[0];b.length>1&&([,k]=b);const E=Math.max(e,i);if(E>=960&&k)return qd(e,i,[T,k,v],g);if(E>=480)return qd(e,i,[T,v],g)}return qd(e,i,[v])}function Tw(a,e,i){var s,o,l,u;if(!i.backupCodec||i.backupCodec===!0||i.backupCodec.codec===i.videoCodec)return;e!==i.backupCodec.codec&&Ee.warn("requested a different codec than specified as backup",{serverRequested:e,backup:i.backupCodec.codec}),i.videoCodec=e,i.videoEncoding=i.backupCodec.encoding;const d=a.mediaStreamTrack.getSettings(),m=(s=d.width)!==null&&s!==void 0?s:(o=a.dimensions)===null||o===void 0?void 0:o.width,h=(l=d.height)!==null&&l!==void 0?l:(u=a.dimensions)===null||u===void 0?void 0:u.height;return a.source===Y.Source.ScreenShare&&i.simulcast&&(i.simulcast=!1),Df(a.source===Y.Source.ScreenShare,m,h,i)}function kw(a,e,i,s){const o=Cw(a,e,i);let{encoding:l}=o[0];const u=Math.max(e,i);for(let d=0;d<o.length;d+=1){const m=o[d];if(l=m.encoding,m.width>=u)break}if(s)switch(s){case"av1":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.7;break;case"vp9":l=Object.assign({},l),l.maxBitrate=l.maxBitrate*.85;break}return l}function Cw(a,e,i){if(a)return vw;const s=e>i?e/i:i/e;return Math.abs(s-16/9)<Math.abs(s-4/3)?pw:gw}function py(a,e){if(a)return Sw(e);const{width:i,height:s}=e,o=i>s?i/s:s/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?yw:bw}function qd(a,e,i,s){const o=[];if(i.forEach((l,u)=>{if(u>=Of.length)return;const d=Math.min(a,e),h={rid:Of[u],scaleResolutionDownBy:Math.max(1,d/Math.min(l.width,l.height)),maxBitrate:l.encoding.maxBitrate},g=s&&l.encoding.maxFramerate?Math.min(s,l.encoding.maxFramerate):l.encoding.maxFramerate;g&&(h.maxFramerate=g);const v=vs()||u===0;l.encoding.priority&&v&&(h.priority=l.encoding.priority,h.networkPriority=l.encoding.priority),o.push(h)}),Un()&&Db()==="ios"){let l;o.forEach(d=>{l?d.maxFramerate&&d.maxFramerate>l&&(l=d.maxFramerate):l=d.maxFramerate});let u=!0;o.forEach(d=>{var m;d.maxFramerate!=l&&(u&&(u=!1,Ee.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Ee.info('Setting framerate of encoding "'.concat((m=d.rid)!==null&&m!==void 0?m:"",'" to ').concat(l)),d.maxFramerate=l)})}return o}function gy(a){if(a)return a.sort((e,i)=>{const{encoding:s}=e,{encoding:o}=i;return s.maxBitrate>o.maxBitrate?1:s.maxBitrate<o.maxBitrate?-1:s.maxBitrate===o.maxBitrate&&s.maxFramerate&&o.maxFramerate?s.maxFramerate>o.maxFramerate?1:-1:0})}class zb{constructor(e){const i=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!i)throw new Error("invalid scalability mode");if(this.spatial=parseInt(i[1]),this.temporal=parseInt(i[2]),i.length>3)switch(i[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=i[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function Ew(a){return a.source===Y.Source.ScreenShare||a.constraints.height&&zi(a.constraints.height)>=1080?"maintain-resolution":"balanced"}const Rw=5e3;class Gc extends Ib{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,Y.Kind.Video,i,s,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.monitorSender=()=>O(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(d){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}const u=new Map(l.map(d=>[d.rid,d]));if(this.prevStats){let d=0;u.forEach((m,h)=>{var g;const v=(g=this.prevStats)===null||g===void 0?void 0:g.get(h);d+=rl(m,v)}),this._currentBitrate=d}this.prevStats=u}),this.senderLock=new Yt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var i;if(this.signalClient=e,!Ut())return;const s=(i=this.sender)===null||i===void 0?void 0:i.getParameters();s&&(this.encodings=s.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},oh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return O(this,void 0,void 0,function*(){var i,s,o,l,u;yield e.pauseUpstream.call(this);try{for(var d=!0,m=Li(this.simulcastCodecs.values()),h;h=yield m.next(),i=h.done,!i;d=!0)l=h.value,d=!1,yield(u=l.sender)===null||u===void 0?void 0:u.replaceTrack(null)}catch(g){s={error:g}}finally{try{!d&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(s)throw s.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return O(this,void 0,void 0,function*(){var i,s,o,l,u;yield e.resumeUpstream.call(this);try{for(var d=!0,m=Li(this.simulcastCodecs.values()),h;h=yield m.next(),i=h.done,!i;d=!0){l=h.value,d=!1;const g=l;yield(u=g.sender)===null||u===void 0?void 0:u.replaceTrack(g.mediaStreamTrack)}}catch(g){s={error:g}}finally{try{!d&&!i&&(o=m.return)&&(yield o.call(m))}finally{if(s)throw s.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return O(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===Y.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{i()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return O(this,void 0,void 0,function*(){const i=yield this.muteLock.lock();try{return this.isMuted?(this.source===Y.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{i()}})}setTrackMuted(e){super.setTrackMuted(e);for(const i of this.simulcastCodecs.values())i.mediaStreamTrack.enabled=!e}getSenderStats(){return O(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const i=[],s=yield this.sender.getStats();return s.forEach(o=>{var l;if(o.type==="outbound-rtp"){const u={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(l=o.rid)!==null&&l!==void 0?l:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},d=s.get(o.remoteId);d&&(u.jitter=d.jitter,u.packetsLost=d.packetsLost,u.roundTripTime=d.roundTripTime),i.push(u)}}),i.sort((o,l)=>{var u,d;return((u=l.frameWidth)!==null&&u!==void 0?u:0)-((d=o.frameWidth)!==null&&d!==void 0?d:0)}),i})}setPublishingQuality(e){const i=[];for(let s=cn.LOW;s<=cn.HIGH;s+=1)i.push(new Jf({quality:s,enabled:s<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(i)}restartTrack(e){return O(this,void 0,void 0,function*(){var i,s,o,l,u;let d;if(e){const v=sl({video:e});typeof v.video!="boolean"&&(d=v.video)}yield this.restart(d);try{for(var m=!0,h=Li(this.simulcastCodecs.values()),g;g=yield h.next(),i=g.done,!i;m=!0){l=g.value,m=!1;const v=l;v.sender&&((u=v.sender.transport)===null||u===void 0?void 0:u.state)!=="closed"&&(v.mediaStreamTrack=this.mediaStreamTrack.clone(),yield v.sender.replaceTrack(v.mediaStreamTrack))}}catch(v){s={error:v}}finally{try{!m&&!i&&(o=h.return)&&(yield o.call(h))}finally{if(s)throw s.error}}})}setProcessor(e){const i=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return O(this,arguments,void 0,function(s){var o=this;let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var u,d,m,h,g,v;if(yield i.setProcessor.call(o,s,l),!((g=o.processor)===null||g===void 0)&&g.processedTrack)try{for(var b=!0,k=Li(o.simulcastCodecs.values()),T;T=yield k.next(),u=T.done,!u;b=!0)h=T.value,b=!1,yield(v=h.sender)===null||v===void 0?void 0:v.replaceTrack(o.processor.processedTrack)}catch(E){d={error:E}}finally{try{!b&&!u&&(m=k.return)&&(yield m.call(k))}finally{if(d)throw d.error}}}()})}setDegradationPreference(e){return O(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const i=this.sender.getParameters();i.degradationPreference=e,this.sender.setParameters(i)}catch(i){this.log.warn("failed to set degradationPreference",Object.assign({error:i},this.logContext))}})}addSimulcastTrack(e,i){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const s={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:i};return this.simulcastCodecs.set(e,s),s}setSimulcastTrackSender(e,i){const s=this.simulcastCodecs.get(e);s&&(s.sender=i,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Rw))}setPublishingCodecs(e){return O(this,void 0,void 0,function*(){var i,s,o,l,u,d,m;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const h=[];try{for(i=!0,s=Li(e);o=yield s.next(),l=o.done,!l;i=!0){m=o.value,i=!1;const g=m;if(!this.codec||this.codec===g.codec)yield this.setPublishingLayers(g.qualities);else{const v=this.simulcastCodecs.get(g.codec);if(this.log.debug("try setPublishingCodec for ".concat(g.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:v})),!v||!v.sender){for(const b of g.qualities)if(b.enabled){h.push(g.codec);break}}else v.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(g.codec),this.logContext),yield vy(v.sender,v.encodings,g.qualities,this.senderLock,this.log,this.logContext))}}}catch(g){u={error:g}}finally{try{!i&&!l&&(d=s.return)&&(yield d.call(s))}finally{if(u)throw u.error}}return h})}setPublishingLayers(e){return O(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield vy(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return O(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),xb()&&this.isInBackground&&this.source===Y.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function vy(a,e,i,s,o,l){return O(this,void 0,void 0,function*(){const u=yield s.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},l),{sender:a,qualities:i,senderEncodings:e}));try{const d=a.getParameters(),{encodings:m}=d;if(!m)return;if(m.length!==e.length){o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},l),{encodings:m,senderEncodings:e}));return}let h=!1;!1&&m[0].scalabilityMode||m.forEach((v,b)=>{var k;let T=(k=v.rid)!==null&&k!==void 0?k:"";T===""&&(T="q");const E=qb(T),_=i.find(x=>x.quality===E);_&&v.active!==_.enabled&&(h=!0,v.active=_.enabled,o.debug("setting layer ".concat(_.quality," to ").concat(v.active?"enabled":"disabled"),l),vs()&&(_.enabled?(v.scaleResolutionDownBy=e[b].scaleResolutionDownBy,v.maxBitrate=e[b].maxBitrate,v.maxFrameRate=e[b].maxFrameRate):(v.scaleResolutionDownBy=4,v.maxBitrate=10,v.maxFrameRate=2)))}),h&&(d.encodings=m,o.debug("setting encodings",Object.assign(Object.assign({},l),{encodings:d.encodings})),yield a.setParameters(d))}finally{u()}})}function qb(a){switch(a){case"f":return cn.HIGH;case"h":return cn.MEDIUM;case"q":return cn.LOW;default:return cn.HIGH}}function yy(a,e,i,s){if(!i)return[new ya({quality:cn.HIGH,width:a,height:e,bitrate:0,ssrc:0})];if(s){const o=i[0].scalabilityMode,l=new zb(o),u=[],d=l.suffix=="h"?1.5:2,m=l.suffix=="h"?2:3;for(let h=0;h<l.spatial;h+=1)u.push(new ya({quality:Math.min(cn.HIGH,l.spatial-1)-h,width:Math.ceil(a/Math.pow(d,h)),height:Math.ceil(e/Math.pow(d,h)),bitrate:i[0].maxBitrate?Math.ceil(i[0].maxBitrate/Math.pow(m,h)):0,ssrc:0}));return u}return i.map(o=>{var l,u,d;const m=(l=o.scaleResolutionDownBy)!==null&&l!==void 0?l:1;let h=qb((u=o.rid)!==null&&u!==void 0?u:"");return new ya({quality:h,width:Math.ceil(a/m),height:Math.ceil(e/m),bitrate:(d=o.maxBitrate)!==null&&d!==void 0?d:0,ssrc:0})})}const by="_lossy",Sy="_reliable",_w=2*1e3,Vd="leave-reconnect";var mn;(function(a){a[a.New=0]="New",a[a.Connected=1]="Connected",a[a.Disconnected=2]="Disconnected",a[a.Reconnecting=3]="Reconnecting",a[a.Closed=4]="Closed"})(mn||(mn={}));class ww extends jn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var i;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=sh.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=mn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Ee,this.handleDataChannel=s=>O(this,[s],void 0,function(o){var l=this;let{channel:u}=o;return function*(){if(u){if(u.label===Sy)l.reliableDCSub=u;else if(u.label===by)l.lossyDCSub=u;else return;l.log.debug("on data channel ".concat(u.id,", ").concat(u.label),l.logContext),u.onmessage=l.handleDataMessage}}()}),this.handleDataMessage=s=>O(this,void 0,void 0,function*(){var o,l;const u=yield this.dataProcessLock.lock();try{let d;if(s.data instanceof ArrayBuffer)d=s.data;else if(s.data instanceof Blob)d=yield s.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:s.data}));return}const m=Pt.fromBinary(new Uint8Array(d));((o=m.value)===null||o===void 0?void 0:o.case)==="speaker"?this.emit(te.ActiveSpeakersUpdate,m.value.value.speakers):(((l=m.value)===null||l===void 0?void 0:l.case)==="user"&&Ow(m,m.value.value),this.emit(te.DataPacketReceived,m))}finally{u()}}),this.handleDataError=s=>{const l=s.currentTarget.maxRetransmits===0?"lossy":"reliable";if(s instanceof ErrorEvent&&s.error){const{error:u}=s.error;this.log.error("DataChannel error on ".concat(l,": ").concat(s.message),Object.assign(Object.assign({},this.logContext),{error:u}))}else this.log.error("Unknown DataChannel error on ".concat(l),Object.assign(Object.assign({},this.logContext),{event:s}))},this.handleBufferedAmountLow=s=>{const l=s.currentTarget.maxRetransmits===0?Oe.LOSSY:Oe.RELIABLE;this.updateAndEmitDCBufferStatus(l)},this.handleDisconnect=(s,o)=>{if(this._isClosed)return;this.log.warn("".concat(s," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const l=m=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(m,"ms. giving up"),this.logContext),this.emit(te.Disconnected),this.close()},u=Date.now()-this.reconnectStart;let d=this.getNextRetryDelay({elapsedMs:u,retryCount:this.reconnectAttempts});if(d===null){l(u);return}s===Vd&&(d=0),this.log.debug("reconnecting in ".concat(d,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Tt.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),d)},this.waitForRestarted=()=>new Promise((s,o)=>{this.pcState===mn.Connected&&s();const l=()=>{this.off(te.Disconnected,u),s()},u=()=>{this.off(te.Restarted,l),o()};this.once(te.Restarted,l),this.once(te.Disconnected,u)}),this.updateAndEmitDCBufferStatus=s=>{const o=this.isBufferStatusLow(s);typeof o<"u"&&o!==this.dcBufferStatus.get(s)&&(this.dcBufferStatus.set(s,o),this.emit(te.DCBufferStatusChanged,o,s))},this.isBufferStatusLow=s=>{const o=this.dataChannelForKind(s);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Fe.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(os.RR_SIGNAL_DISCONNECTED))},this.log=si((i=e.loggerName)!==null&&i!==void 0?i:bn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new nh(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Yt,this.dataProcessLock=new Yt,this.dcBufferStatus=new Map([[Oe.LOSSY,!0],[Oe.RELIABLE,!0]]),this.client.onParticipantUpdate=s=>this.emit(te.ParticipantUpdate,s),this.client.onConnectionQuality=s=>this.emit(te.ConnectionQualityUpdate,s),this.client.onRoomUpdate=s=>this.emit(te.RoomUpdate,s),this.client.onSubscriptionError=s=>this.emit(te.SubscriptionError,s),this.client.onSubscriptionPermissionUpdate=s=>this.emit(te.SubscriptionPermissionUpdate,s),this.client.onSpeakersChanged=s=>this.emit(te.SpeakersChanged,s),this.client.onStreamStateUpdate=s=>this.emit(te.StreamStateChanged,s),this.client.onRequestResponse=s=>this.emit(te.SignalRequestResponse,s)}get logContext(){var e,i,s,o,l,u,d,m;return{room:(i=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||i===void 0?void 0:i.name,roomID:(o=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.room)===null||o===void 0?void 0:o.sid,participant:(u=(l=this.latestJoinResponse)===null||l===void 0?void 0:l.participant)===null||u===void 0?void 0:u.identity,pID:(m=(d=this.latestJoinResponse)===null||d===void 0?void 0:d.participant)===null||m===void 0?void 0:m.sid}}join(e,i,s,o){return O(this,void 0,void 0,function*(){this.url=e,this.token=i,this.signalOpts=s,this.maxJoinAttempts=s.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const l=yield this.client.join(e,i,s,o);return this._isClosed=!1,this.latestJoinResponse=l,this.subscriberPrimary=l.subscriberPrimary,this.pcManager||(yield this.configure(l)),(!this.subscriberPrimary||l.fastPublish)&&this.negotiate(),this.clientConfiguration=l.clientConfiguration,l}catch(l){if(l instanceof Be&&l.reason===xe.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,i,s,o);throw l}})}close(){return O(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(te.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return O(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const i=s=>{s&&(s.close(),s.onbufferedamountlow=null,s.onclose=null,s.onclosing=null,s.onerror=null,s.onmessage=null,s.onopen=null)};i(this.lossyDC),i(this.lossyDCSub),i(this.reliableDC),i(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return O(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ni("a track with the same ID has already been published");return new Promise((i,s)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],s(new Be("publication of local track timed out, no response from server",xe.InternalError))},1e4);this.pendingTrackResolvers[e.cid]={resolve:l=>{clearTimeout(o),i(l)},reject:()=>{clearTimeout(o),s(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:i}=this.pendingTrackResolvers[e.track.id];i&&i(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(i){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:i}))}return!1}updateMuteStatus(e,i){this.client.sendMuteTrack(e,i)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return O(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return O(this,void 0,void 0,function*(){var i,s;if(this.pcManager&&this.pcManager.currentState!==We.NEW)return;this.participantSid=(i=e.participant)===null||i===void 0?void 0:i.sid;const o=this.makeRTCConfiguration(e);this.pcManager=new hw(o,e.subscriberPrimary,this.loggerOptions),this.emit(te.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(l,u)=>{this.client.sendIceCandidate(l,u)},this.pcManager.onPublisherOffer=l=>{this.client.sendOffer(l)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(l,u,d)=>O(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(l),this.logContext),["closed","disconnected","failed"].includes(u)&&(this.publisherConnectionPromise=void 0),l===We.CONNECTED){const g=this.pcState===mn.New;this.pcState=mn.Connected,g&&this.emit(te.Connected,e)}else l===We.FAILED&&this.pcState===mn.Connected&&(this.pcState=mn.Disconnected,this.handleDisconnect("peerconnection failed",d==="failed"?os.RR_SUBSCRIBER_FAILED:os.RR_PUBLISHER_FAILED));const m=this.client.isDisconnected||this.client.currentState===Fe.RECONNECTING,h=[We.FAILED,We.CLOSING,We.CLOSED].includes(l);m&&h&&!this._isClosed&&this.emit(te.Offline)}),this.pcManager.onTrack=l=>{this.emit(te.MediaTrackAdded,l.track,l.streams[0],l.receiver)},xw((s=e.serverInfo)===null||s===void 0?void 0:s.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>O(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,i)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:i})),this.pcManager.addIceCandidate(e,i))},this.client.onOffer=e=>O(this,void 0,void 0,function*(){if(!this.pcManager)return;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(i)}),this.client.onLocalTrackPublished=e=>{var i;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(i=e.track)===null||i===void 0?void 0:i.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:s}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],s(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(te.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(te.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,i)=>{this.emit(te.RemoteMute,e,i)},this.client.onSubscribedQualityUpdate=e=>{this.emit(te.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",os.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case ds.DISCONNECT:this.emit(te.Disconnected,e==null?void 0:e.reason),this.close();break;case ds.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Vd);break;case ds.RESUME:this.handleDisconnect(Vd)}}}makeRTCConfiguration(e){var i;const s=Object.assign({},this.rtcConfig);if(!((i=this.signalOpts)===null||i===void 0)&&i.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),s.encodedInsertableStreams=!0),e.iceServers&&!s.iceServers){const o=[];e.iceServers.forEach(l=>{const u={urls:l.urls};l.username&&(u.username=l.username),l.credential&&(u.credential=l.credential),o.push(u)}),s.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Br.ENABLED&&(s.iceTransportPolicy="relay"),s.sdpSemantics="unified-plan",s.continualGatheringPolicy="gather_continually",s}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(by,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Sy,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,i,s){return O(this,void 0,void 0,function*(){if(kf())return yield this.createTransceiverRTCRtpSender(e,i,s);if(Cf())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new dt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,i,s,o){return O(this,void 0,void 0,function*(){if(kf())return this.createSimulcastTransceiverSender(e,i,s,o);if(Cf())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new dt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,i,s){return O(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),Es(e)&&(e.codec=i.videoCodec);const l={direction:"sendonly",streams:o};return s&&(l.sendEncodings=s),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,l)).sender})}createSimulcastTransceiverSender(e,i,s,o){return O(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");const l={direction:"sendonly"};o&&(l.sendEncodings=o);const u=yield this.pcManager.addPublisherTransceiver(i.mediaStreamTrack,l);if(s.videoCodec)return e.setSimulcastTrackSender(s.videoCodec,u.sender),u.sender})}createRTCRtpSender(e){return O(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return O(this,void 0,void 0,function*(){var i,s,o;if(!this._isClosed){if(this.attemptingReconnect){Ee.warn("already attempting reconnect, returning early",this.logContext);return}(((i=this.clientConfiguration)===null||i===void 0?void 0:i.resumeConnection)===Br.DISABLED||((o=(s=this.pcManager)===null||s===void 0?void 0:s.currentState)!==null&&o!==void 0?o:We.NEW)===We.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(l){this.reconnectAttempts+=1;let u=!0;l instanceof dt?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:l})),u=!1):l instanceof cs||(this.fullReconnectOnNext=!0),u?this.handleDisconnect("reconnect",os.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(te.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(i){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:i}))}return null}restartConnection(e){return O(this,void 0,void 0,function*(){var i,s,o;try{if(!this.url||!this.token)throw new dt("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(te.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let l;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new cs;l=yield this.join(e??this.url,this.token,this.signalOpts)}catch(u){throw u instanceof Be&&u.reason===xe.NotAllowed?new dt("could not reconnect, token might be expired"):new cs}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(te.SignalRestarted,l),yield this.waitForPCReconnected(),this.client.currentState!==Fe.CONNECTED)throw new cs("Signal connection got severed during reconnect");(i=this.regionUrlProvider)===null||i===void 0||i.resetAttempts(),this.emit(te.Restarted)}catch(l){const u=yield(s=this.regionUrlProvider)===null||s===void 0?void 0:s.getNextBestRegionUrl();if(u){yield this.restartConnection(u);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),l}})}resumeConnection(e){return O(this,void 0,void 0,function*(){var i;if(!this.url||!this.token)throw new dt("could not reconnect, url or token not saved");if(!this.pcManager)throw new dt("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(te.Resuming);let s;try{this.setupSignalClientCallbacks(),s=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let l="";throw o instanceof Error&&(l=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof Be&&o.reason===xe.NotAllowed?new dt("could not reconnect, token might be expired"):o instanceof Be&&o.reason===xe.LeaveRequest?o:new cs(l)}if(this.emit(te.SignalResumed),s){const o=this.makeRTCConfiguration(s);this.pcManager.updateConfiguration(o)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Fe.CONNECTED)throw new cs("Signal connection got severed during reconnect");this.client.setReconnected(),((i=this.reliableDC)===null||i===void 0?void 0:i.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(te.Resumed)})}waitForPCInitialConnection(e,i){return O(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(i,e)})}waitForPCReconnected(){return O(this,void 0,void 0,function*(){this.pcState=mn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield jt(_w),!this.pcManager)throw new dt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=mn.Connected}catch(e){throw this.pcState=mn.Disconnected,new Be("could not establish PC connection, ".concat(e.message),xe.InternalError)}})}publishRpcResponse(e,i,s,o){return O(this,void 0,void 0,function*(){const l=new Pt({destinationIdentities:[e],kind:Oe.RELIABLE,value:{case:"rpcResponse",value:new A0({requestId:i,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:s??""}})}});yield this.sendDataPacket(l,Oe.RELIABLE)})}publishRpcAck(e,i){return O(this,void 0,void 0,function*(){const s=new Pt({destinationIdentities:[e],kind:Oe.RELIABLE,value:{case:"rpcAck",value:new D0({requestId:i})}});yield this.sendDataPacket(s,Oe.RELIABLE)})}sendDataPacket(e,i){return O(this,void 0,void 0,function*(){const s=e.toBinary();yield this.ensurePublisherConnected(i);const o=this.dataChannelForKind(i);o&&o.send(s),this.updateAndEmitDCBufferStatus(i)})}waitForBufferStatusLow(e){return new Promise((i,s)=>O(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))i();else{const o=()=>s("Engine closed");for(this.once(te.Closing,o);!this.dcBufferStatus.get(e);)yield jt(10);this.off(te.Closing,o),i()}}))}ensureDataTransportConnected(e){return O(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var l;if(!s.pcManager)throw new dt("PC manager is closed");const u=o?s.pcManager.subscriber:s.pcManager.publisher,d=o?"Subscriber":"Publisher";if(!u)throw new Be("".concat(d," connection not set"),xe.InternalError);let m=!1;!o&&!s.dataChannelForKind(i,o)&&(s.createDataChannels(),m=!0),!m&&!o&&!s.pcManager.publisher.isICEConnected&&s.pcManager.publisher.getICEConnectionState()!=="checking"&&(m=!0),m&&s.negotiate();const h=s.dataChannelForKind(i,o);if((h==null?void 0:h.readyState)==="open")return;const g=new Date().getTime()+s.peerConnectionTimeout;for(;new Date().getTime()<g;){if(u.isICEConnected&&((l=s.dataChannelForKind(i,o))===null||l===void 0?void 0:l.readyState)==="open")return;yield jt(50)}throw new Be("could not establish ".concat(d," connection, state: ").concat(u.getICEConnectionState()),xe.InternalError)}()})}ensurePublisherConnected(e){return O(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==We.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return O(this,void 0,void 0,function*(){return new Promise((e,i)=>O(this,void 0,void 0,function*(){if(!this.pcManager){i(new bf("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const s=new AbortController,o=()=>{s.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&i("cannot negotiate on closed engine"),this.on(te.Closing,o),this.pcManager.publisher.once(ps.RTPVideoPayloadTypes,l=>{const u=new Map;l.forEach(d=>{const m=d.codec.toLowerCase();V_(m)&&u.set(d.payload,m)}),this.emit(te.RTPVideoMapUpdate,u)});try{yield this.pcManager.negotiate(s),e()}catch(l){l instanceof bf&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",os.RR_UNKNOWN),i(l)}finally{this.off(te.Closing,o)}}))})}dataChannelForKind(e,i){if(i){if(e===Oe.LOSSY)return this.lossyDCSub;if(e===Oe.RELIABLE)return this.reliableDCSub}else{if(e===Oe.LOSSY)return this.lossyDC;if(e===Oe.RELIABLE)return this.reliableDC}}sendSyncState(e,i){var s,o;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const l=this.pcManager.subscriber.getLocalDescription(),u=this.pcManager.subscriber.getRemoteDescription(),d=(o=(s=this.signalOpts)===null||s===void 0?void 0:s.autoSubscribe)!==null&&o!==void 0?o:!0,m=new Array,h=new Array;e.forEach(g=>{g.isDesired!==d&&m.push(g.trackSid),g.isEnabled||h.push(g.trackSid)}),this.client.sendSyncState(new Y0({answer:l?Hc({sdp:l.sdp,type:l.type}):void 0,offer:u?Hc({sdp:u.sdp,type:u.type}):void 0,subscription:new nl({trackSids:m,subscribe:!d,participantTracks:[]}),publishTracks:J_(i),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:h}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],i=(s,o)=>{(s==null?void 0:s.id)!==void 0&&s.id!==null&&e.push(new Q0({label:s.label,id:s.id,target:o}))};return i(this.dataChannelForKind(Oe.LOSSY),vn.PUBLISHER),i(this.dataChannelForKind(Oe.RELIABLE),vn.PUBLISHER),i(this.dataChannelForKind(Oe.LOSSY,!0),vn.SUBSCRIBER),i(this.dataChannelForKind(Oe.RELIABLE,!0),vn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Tt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Ut()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Ut()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class cs extends Error{}function xw(a){return a!==void 0&&a>13}function Ow(a,e){const i=a.participantIdentity?a.participantIdentity:e.participantIdentity;a.participantIdentity=i,e.participantIdentity=i;const s=a.destinationIdentities.length!==0?a.destinationIdentities:e.destinationIdentities;a.destinationIdentities=s,e.destinationIdentities=s}class Af{constructor(e,i){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=i}updateToken(e){this.token=e}isCloud(){return Rf(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return O(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const i=this.regionSettings.regions.filter(s=>!this.attemptedRegions.find(o=>o.url===s.url));if(i.length>0){const s=i[0];return this.attemptedRegions.push(s),Ee.debug("next region: ".concat(s.region)),s.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return O(this,void 0,void 0,function*(){const i=yield fetch("".concat(Dw(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(i.ok){const s=yield i.json();return this.lastUpdateAt=Date.now(),s}else throw new Be("Could not fetch region settings: ".concat(i.statusText),i.status===401?xe.NotAllowed:xe.InternalError,i.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function Dw(a){return"".concat(a.protocol.replace("ws","http"),"//").concat(a.host,"/settings")}class Vb{get info(){return this._info}constructor(e,i,s){this.reader=i,this.totalByteSize=s,this._info=e,this.bytesReceived=0}}class Aw extends Vb{handleChunkReceived(e){var i;this.bytesReceived+=e.content.byteLength;const s=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,s)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>O(this,void 0,void 0,function*(){try{const{done:i,value:s}=yield e.read();return i?{done:!0,value:void 0}:(this.handleChunkReceived(s),{done:!1,value:s.content})}catch{return{done:!0,value:void 0}}}),return(){return O(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return O(this,void 0,void 0,function*(){var e,i,s,o;let l=new Set;try{for(var u=!0,d=Li(this),m;m=yield d.next(),e=m.done,!e;u=!0){o=m.value,u=!1;const h=o;l.add(h)}}catch(h){i={error:h}}finally{try{!u&&!e&&(s=d.return)&&(yield s.call(d))}finally{if(i)throw i.error}}return Array.from(l)})}}class Nw extends Vb{constructor(e,i,s){super(e,i,s),this.receivedChunks=new Map}handleChunkReceived(e){var i;const s=Pc(e.chunkIndex),o=this.receivedChunks.get(s);if(o&&o.version>e.version)return;this.receivedChunks.set(s,e),this.bytesReceived+=e.content.byteLength;const l=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(i=this.onProgress)===null||i===void 0||i.call(this,l)}[Symbol.asyncIterator](){const e=this.reader.getReader(),i=new TextDecoder;return{next:()=>O(this,void 0,void 0,function*(){try{const{done:s,value:o}=yield e.read();return s?{done:!0,value:void 0}:(this.handleChunkReceived(o),{done:!1,value:i.decode(o.content)})}catch{return{done:!0,value:void 0}}}),return(){return O(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return O(this,void 0,void 0,function*(){var e,i,s,o;let l="";try{for(var u=!0,d=Li(this),m;m=yield d.next(),e=m.done,!e;u=!0)o=m.value,u=!1,l+=o}catch(h){i={error:h}}finally{try{!u&&!e&&(s=d.return)&&(yield s.call(d))}finally{if(i)throw i.error}}return l})}}class Pw{constructor(e,i,s){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=s,this.info=i}write(e){return this.defaultWriter.write(e)}close(){return O(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class Mw extends Pw{}class Hb extends Y{constructor(e,i,s,o,l){super(e,s,l),this.sid=i,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?$.Muted:$.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const i=s=>{s.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",i),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit($.Ended,this))};e.addEventListener("removetrack",i)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return O(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),oh)),Z_()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var i;this.timeSyncHandle=requestAnimationFrame(()=>e());const s=(i=this.receiver)===null||i===void 0?void 0:i.getSynchronizationSources()[0];if(s){const{timestamp:o,rtpTimestamp:l}=s;l&&this.rtpTimestamp!==l&&(this.emit($.TimeSyncUpdate,{timestamp:o,rtpTimestamp:l}),this.rtpTimestamp=l)}};e()}}class Uw extends Hb{constructor(e,i,s,o,l,u){super(e,i,Y.Kind.Audio,s,u),this.monitorReceiver=()=>O(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=rl(d,this.prevStats)),this.prevStats=d}),this.audioContext=o,this.webAudioPluginNodes=[],l&&(this.sinkId=l.deviceId)}setVolume(e){var i;for(const s of this.attachedElements)this.audioContext?(i=this.gainNode)===null||i===void 0||i.gain.setTargetAtTime(e,0,.1):s.volume=e;Un()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Un())return 1;let e=0;return this.attachedElements.forEach(i=>{i.volume>e&&(e=i.volume)}),e}setSinkId(e){return O(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(i=>{if(Ef(i))return i.setSinkId(e)}))})}attach(e){const i=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ef(e)&&e.setSinkId(this.sinkId),this.audioContext&&i&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let i;return e?(i=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(i=super.detach(),this.disconnectWebAudio()),i}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,i){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(i.srcObject);let s=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{s.connect(o),s=o}),this.gainNode=e.createGain(),s.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit($.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit($.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,i;(e=this.gainNode)===null||e===void 0||e.disconnect(),(i=this.sourceNode)===null||i===void 0||i.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return O(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i;return e.forEach(s=>{s.type==="inbound-rtp"&&(i={type:"audio",streamId:s.id,timestamp:s.timestamp,jitter:s.jitter,bytesReceived:s.bytesReceived,concealedSamples:s.concealedSamples,concealmentEvents:s.concealmentEvents,silentConcealedSamples:s.silentConcealedSamples,silentConcealmentEvents:s.silentConcealmentEvents,totalAudioEnergy:s.totalAudioEnergy,totalSamplesDuration:s.totalSamplesDuration})}),i})}}const Hd=100;class Lw extends Hb{constructor(e,i,s,o,l){super(e,i,Y.Kind.Video,s,l),this.elementInfos=[],this.monitorReceiver=()=>O(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=rl(u,this.prevStats)),this.prevStats=u}),this.debouncedHandleResize=ah(()=>{this.updateDimensions()},Hd),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(i=>{e?hs(this._mediaStreamTrack,i):us(this._mediaStreamTrack,i)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(i=>i.element===e)===void 0){const i=new jw(e);this.observeElementInfo(i)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(i=>i===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const i=this.elementInfos.filter(s=>s===e);for(const s of i)s.stopObserving();this.elementInfos=this.elementInfos.filter(s=>s!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let i=[];if(e)return this.stopObservingElement(e),super.detach(e);i=super.detach();for(const s of i)this.stopObservingElement(s);return i}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return O(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let i,s="",o=new Map;return e.forEach(l=>{l.type==="inbound-rtp"?(s=l.codecId,i={type:"video",streamId:l.id,framesDecoded:l.framesDecoded,framesDropped:l.framesDropped,framesReceived:l.framesReceived,packetsReceived:l.packetsReceived,packetsLost:l.packetsLost,frameWidth:l.frameWidth,frameHeight:l.frameHeight,pliCount:l.pliCount,firCount:l.firCount,nackCount:l.nackCount,jitter:l.jitter,timestamp:l.timestamp,bytesReceived:l.bytesReceived,decoderImplementation:l.decoderImplementation}):l.type==="codec"&&o.set(l.id,l)}),i&&s!==""&&o.get(s)&&(i.mimeType=o.get(s).mimeType),i})}stopObservingElement(e){const i=this.elementInfos.filter(s=>s.element===e);for(const s of i)this.stopObservingElementInfo(s)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return O(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,i;const s=this.elementInfos.reduce((d,m)=>Math.max(d,m.visibilityChangedAt||0),0),o=!((i=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&i!==void 0)||i?this.isInBackground:!1,l=this.elementInfos.some(d=>d.pictureInPicture),u=this.elementInfos.some(d=>d.visible)&&!o||l;if(this.lastVisible!==u){if(!u&&Date.now()-s<Hd){Tt.setTimeout(()=>{this.updateVisibility()},Hd);return}this.lastVisible=u,this.emit($.VisibilityChanged,u,this)}}updateDimensions(){var e,i;let s=0,o=0;const l=this.getPixelDensity();for(const u of this.elementInfos){const d=u.width()*l,m=u.height()*l;d+m>s+o&&(s=d,o=m)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===s&&((i=this.lastDimensions)===null||i===void 0?void 0:i.height)===o||(this.lastDimensions={width:s,height:o},this.emit($.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const i=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return i==="screen"?$v():i||($v()>2?2:1)}}class jw{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,i){this.onVisibilityChanged=s=>{var o;const{target:l,isIntersecting:u}=s;l===this.element&&(this.isIntersecting=u,this.isPiP=Ar(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var s,o,l;(o=(s=window.documentPictureInPicture)===null||s===void 0?void 0:s.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Ar(this.element),(l=this.handleVisibilityChanged)===null||l===void 0||l.call(this)},this.onLeavePiP=()=>{var s;this.isPiP=Ar(this.element),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this)},this.element=e,this.isIntersecting=i??Nf(e),this.isPiP=Ut()&&Ar(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,i,s;this.isIntersecting=Nf(this.element),this.isPiP=Ar(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,ty().observe(this.element),ey().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(s=(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window)===null||s===void 0||s.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,i,s,o,l;(e=ty())===null||e===void 0||e.unobserve(this.element),(i=ey())===null||i===void 0||i.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(s=window.documentPictureInPicture)===null||s===void 0||s.removeEventListener("enter",this.onEnterPiP),(l=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||l===void 0||l.removeEventListener("pagehide",this.onLeavePiP)}}function Ar(a){var e,i;return document.pictureInPictureElement===a?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Nf(a,(i=window.documentPictureInPicture)===null||i===void 0?void 0:i.window):!1}function Nf(a,e){const i=e||window;let s=a.offsetTop,o=a.offsetLeft;const l=a.offsetWidth,u=a.offsetHeight,{hidden:d}=a,{display:m}=getComputedStyle(a);for(;a.offsetParent;)a=a.offsetParent,s+=a.offsetTop,o+=a.offsetLeft;return s<i.pageYOffset+i.innerHeight&&o<i.pageXOffset+i.innerWidth&&s+u>i.pageYOffset&&o+l>i.pageXOffset&&!d&&m!=="none"}class Ui extends jn.EventEmitter{constructor(e,i,s,o){var l;super(),this.metadataMuted=!1,this.encryption=Kt.NONE,this.log=Ee,this.handleMuted=()=>{this.emit($.Muted)},this.handleUnmuted=()=>{this.emit($.Unmuted)},this.log=si((l=o==null?void 0:o.loggerName)!==null&&l!==void 0?l:bn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=i,this.trackName=s,this.source=Y.Source.Unknown}setTrack(e){this.track&&(this.track.off($.Muted,this.handleMuted),this.track.off($.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on($.Muted,this.handleMuted),e.on($.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Me(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Kt.NONE}get audioTrack(){if(ri(this.track))return this.track}get videoTrack(){if(Es(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Y.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Y.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(a){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(a.SubscriptionStatus||(a.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(a.PermissionStatus||(a.PermissionStatus={}))})(Ui);class Pf extends Ui{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit($.Ended)},this.updateInfo(i),this.setTrack(s)}setTrack(e){this.track&&this.track.off($.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on($.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return O(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return O(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return O(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return O(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(ri(this.track)){const i=this.track.getSourceTrackSettings(),s=new Set;return i.autoGainControl&&s.add(Nn.TF_AUTO_GAIN_CONTROL),i.echoCancellation&&s.add(Nn.TF_ECHO_CANCELLATION),i.noiseSuppression&&s.add(Nn.TF_NOISE_SUPPRESSION),i.channelCount&&i.channelCount>1&&s.add(Nn.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||s.add(Nn.TF_NO_DTX),this.track.enhancedNoiseCancellation&&s.add(Nn.TF_ENHANCED_NOISE_CANCELLATION),Array.from(s.values())}else return[]}}var ji;(function(a){a.Excellent="excellent",a.Good="good",a.Poor="poor",a.Lost="lost",a.Unknown="unknown"})(ji||(ji={}));function Iw(a){switch(a){case Nr.EXCELLENT:return ji.Excellent;case Nr.GOOD:return ji.Good;case Nr.POOR:return ji.Poor;case Nr.LOST:return ji.Lost;default:return ji.Unknown}}class Fb extends jn.EventEmitter{get logContext(){var e,i;return Object.assign({},(i=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||i===void 0?void 0:i.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===qc.AGENT}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,i,s,o,l,u){let d=arguments.length>6&&arguments[6]!==void 0?arguments[6]:qc.STANDARD;var m;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ji.Unknown,this.log=Ee,this.log=si((m=u==null?void 0:u.loggerName)!==null&&m!==void 0?m:bn.Participant),this.loggerOptions=u,this.setMaxListeners(100),this.sid=e,this.identity=i,this.name=s,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=d,this._attributes=l??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,i]of this.trackPublications)if(i.source===e)return i}getTrackPublicationByName(e){for(const[,i]of this.trackPublications)if(i.trackName===e)return i}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const i=this.getTrackPublication(Y.Source.Camera);return!(!((e=i==null?void 0:i.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const i=this.getTrackPublication(Y.Source.Microphone);return!(!((e=i==null?void 0:i.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(Y.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const i=this.metadata!==e,s=this.metadata;this.metadata=e,i&&this.emit(ae.ParticipantMetadataChanged,s)}_setName(e){const i=this.name!==e;this.name=e,i&&this.emit(ae.ParticipantNameChanged,e)}_setAttributes(e){const i=W_(this.attributes,e);this._attributes=e,Object.keys(i).length>0&&this.emit(ae.AttributesChanged,i)}setPermissions(e){var i,s,o,l,u,d;const m=this.permissions,h=e.canPublish!==((i=this.permissions)===null||i===void 0?void 0:i.canPublish)||e.canSubscribe!==((s=this.permissions)===null||s===void 0?void 0:s.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((l=this.permissions)===null||l===void 0?void 0:l.hidden)||e.recorder!==((u=this.permissions)===null||u===void 0?void 0:u.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((g,v)=>{var b;return g!==((b=this.permissions)===null||b===void 0?void 0:b.canPublishSources[v])})||e.canSubscribeMetrics!==((d=this.permissions)===null||d===void 0?void 0:d.canSubscribeMetrics);return this.permissions=e,h&&this.emit(ae.ParticipantPermissionsChanged,m),h}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ae.IsSpeakingChanged,e))}setConnectionQuality(e){const i=this._connectionQuality;this._connectionQuality=Iw(e),i!==this._connectionQuality&&this.emit(ae.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(i=>ri(i.track)&&i.track.setAudioContext(e))}addTrackPublication(e){e.on($.Muted,()=>{this.emit(ae.TrackMuted,e)}),e.on($.Unmuted,()=>{this.emit(ae.TrackUnmuted,e)});const i=e;switch(i.track&&(i.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case Y.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case Y.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function Bw(a){var e,i,s;if(!a.participantSid&&!a.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new G0({participantIdentity:(e=a.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(i=a.participantSid)!==null&&i!==void 0?i:"",allTracks:(s=a.allowAll)!==null&&s!==void 0?s:!1,trackSids:a.allowedTrackSids||[]})}const fc=15e3;class zw extends Fb{constructor(e,i,s,o,l){super(e,i,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Kt.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Ab)},this.handleReconnected=()=>{var u,d;(d=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||d===void 0||d.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var u,d;this.reconnectFuture&&(this.reconnectFuture.promise.catch(m=>this.log.warn(m.message,this.logContext)),(d=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||d===void 0||d.call(u,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.handleSignalRequestResponse=u=>{const{requestId:d,reason:m,message:h}=u,g=this.pendingSignalRequests.get(d);g&&(m!==Zf.OK&&g.reject(new Xv(h,m)),this.pendingSignalRequests.delete(d))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let d=u.value.value,m=null,h=null;d.value.case==="payload"?m=d.value.value:d.value.case==="error"&&(h=et.fromProto(d.value.value)),this.handleIncomingRpcResponse(d.requestId,m,h);break;case"rpcAck":let g=u.value.value;this.handleIncomingRpcAck(g.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>Bw(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,d)=>{if(d===void 0&&(d=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Me(u)));return}this.engine.updateMuteStatus(u.sid,d)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Me(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Me(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const d=this.audioTrackPublications.get(u.sid);if(!d){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(d.trackSid,d.getTrackFeatures())},this.handleSubscribedQualityUpdate=u=>O(this,void 0,void 0,function*(){var d,m,h,g,v,b;if(!(!((v=this.roomOptions)===null||v===void 0)&&v.dynacast))return;const k=this.videoTrackPublications.get(u.trackSid);if(!k){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(u.subscribedCodecs.length>0){if(!k.videoTrack)return;const x=yield k.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var T=!0,E=Li(x),_;_=yield E.next(),d=_.done,!d;T=!0){g=_.value,T=!1;const I=g;A_(I)&&(this.log.debug("publish ".concat(I," for ").concat(k.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Me(k))),yield this.publishAdditionalCodecForTrack(k.videoTrack,I,k.options))}}catch(I){m={error:I}}finally{try{!T&&!d&&(h=E.return)&&(yield h.call(E))}finally{if(m)throw m.error}}}else u.subscribedQualities.length>0&&(yield(b=k.videoTrack)===null||b===void 0?void 0:b.setPublishingLayers(u.subscribedQualities))}),this.handleLocalTrackUnpublished=u=>{const d=this.trackPublications.get(u.trackSid);if(!d){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(d.track)},this.handleTrackEnded=u=>O(this,void 0,void 0,function*(){if(u.source===Y.Source.ScreenShare||u.source===Y.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Me(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(ma(u)||Pi(u))try{if(Ut())try{const d=yield navigator==null?void 0:navigator.permissions.query({name:u.source===Y.Source.Camera?"camera":"microphone"});if(d&&d.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),Me(u))),d.onchange=()=>{d.state!=="denied"&&(u.isMuted||u.restartTrack(),d.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Me(u))),ma(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Me(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=s,this.roomOptions=o,this.setupEngine(s),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=l}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Kt.NONE}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setupEngine(e){this.engine=e,this.engine.on(te.RemoteMute,(i,s)=>{const o=this.trackPublications.get(i);!o||!o.track||(s?o.mute():o.unmute())}),this.engine.on(te.Connected,this.handleReconnected).on(te.SignalRestarted,this.handleReconnected).on(te.SignalResumed,this.handleReconnected).on(te.Restarting,this.handleReconnecting).on(te.Resuming,this.handleReconnecting).on(te.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(te.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(te.Disconnected,this.handleDisconnected).on(te.SignalRequestResponse,this.handleSignalRequestResponse).on(te.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return O(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return O(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return O(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return O(this,arguments,void 0,function(i){var s=this;let{metadata:o,name:l,attributes:u}=i;return function*(){return new Promise((d,m)=>O(s,void 0,void 0,function*(){var h,g;try{let v=!1;const b=yield this.engine.client.sendUpdateLocalMetadata((h=o??this.metadata)!==null&&h!==void 0?h:"",(g=l??this.name)!==null&&g!==void 0?g:"",u),k=performance.now();for(this.pendingSignalRequests.set(b,{resolve:d,reject:T=>{m(T),v=!0},values:{name:l,metadata:o,attributes:u}});performance.now()-k<5e3&&!v;){if((!l||this.name===l)&&(!o||this.metadata===o)&&(!u||Object.entries(u).every(T=>{let[E,_]=T;return this.attributes[E]===_||_===""&&!this.attributes[E]}))){this.pendingSignalRequests.delete(b),d();return}yield jt(50)}m(new Xv("Request to update local metadata timed out","TimeoutError"))}catch(v){v instanceof Error&&m(v)}}))}()})}setCameraEnabled(e,i,s){return this.setTrackEnabled(Y.Source.Camera,e,i,s)}setMicrophoneEnabled(e,i,s){return this.setTrackEnabled(Y.Source.Microphone,e,i,s)}setScreenShareEnabled(e,i,s){return this.setTrackEnabled(Y.Source.ScreenShare,e,i,s)}setPermissions(e){const i=this.permissions,s=super.setPermissions(e);return s&&i&&this.emit(ae.ParticipantPermissionsChanged,i),s}setE2EEEnabled(e){return O(this,void 0,void 0,function*(){this.encryptionType=e?Kt.GCM:Kt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,i,s,o){return O(this,void 0,void 0,function*(){var l,u;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:i})),this.republishPromise&&(yield this.republishPromise);let d=this.getTrackPublication(e);if(i)if(d)yield d.unmute();else{let m;if(this.pendingPublishing.has(e)){const h=yield this.waitForPendingPublicationOfSource(e);return h||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield h==null?void 0:h.unmute(),h}this.pendingPublishing.add(e);try{switch(e){case Y.Source.Camera:m=yield this.createTracks({video:(l=s)!==null&&l!==void 0?l:!0});break;case Y.Source.Microphone:m=yield this.createTracks({audio:(u=s)!==null&&u!==void 0?u:!0});break;case Y.Source.ScreenShare:m=yield this.createScreenTracks(Object.assign({},s));break;default:throw new ni(e)}}catch(h){throw m==null||m.forEach(g=>{g.stop()}),h instanceof Error&&this.emit(ae.MediaDevicesError,h),this.pendingPublishing.delete(e),h}try{const h=[];for(const v of m)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Me(v))),h.push(this.publishTrack(v,o));[d]=yield Promise.all(h)}catch(h){throw m==null||m.forEach(g=>{g.stop()}),h}finally{this.pendingPublishing.delete(e)}}else if(!(d!=null&&d.track)&&this.pendingPublishing.has(e)&&(d=yield this.waitForPendingPublicationOfSource(e),d||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),d&&d.track)if(e===Y.Source.ScreenShare){d=yield this.unpublishTrack(d.track);const m=this.getTrackPublication(Y.Source.ScreenShareAudio);m&&m.track&&this.unpublishTrack(m.track)}else yield d.mute();return d})}enableCameraAndMicrophone(){return O(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Y.Source.Camera)||this.pendingPublishing.has(Y.Source.Microphone))){this.pendingPublishing.add(Y.Source.Camera),this.pendingPublishing.add(Y.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(i=>this.publishTrack(i)))}finally{this.pendingPublishing.delete(Y.Source.Camera),this.pendingPublishing.delete(Y.Source.Microphone)}}})}createTracks(e){return O(this,void 0,void 0,function*(){var i,s;e??(e={});const o=Nb(e,(i=this.roomOptions)===null||i===void 0?void 0:i.audioCaptureDefaults,(s=this.roomOptions)===null||s===void 0?void 0:s.videoCaptureDefaults),{audioProcessor:l,videoProcessor:u,optionsWithoutProcessor:d}=th(o),m=sl(d);let h;try{h=yield navigator.mediaDevices.getUserMedia(m)}catch(g){throw g instanceof Error&&(m.audio&&(this.microphoneError=g),m.video&&(this.cameraError=g)),g}return m.audio&&(this.microphoneError=void 0,this.emit(ae.AudioStreamAcquired)),m.video&&(this.cameraError=void 0),Promise.all(h.getTracks().map(g=>O(this,void 0,void 0,function*(){const v=g.kind==="audio";let b;const k=v?m.audio:m.video;typeof k!="boolean"&&(b=k);const T=Bb(g,b,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return T.kind===Y.Kind.Video?T.source=Y.Source.Camera:T.kind===Y.Kind.Audio&&(T.source=Y.Source.Microphone,T.setAudioContext(this.audioContext)),T.mediaStream=h,ri(T)&&l?yield T.setProcessor(l):Es(T)&&u&&(yield T.setProcessor(u)),T})))})}createScreenTracks(e){return O(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new $f("getDisplayMedia not supported");e.resolution===void 0&&!j_()&&(e.resolution=eh.h1080fps30.resolution);const i=X_(e),s=yield navigator.mediaDevices.getDisplayMedia(i),o=s.getVideoTracks();if(o.length===0)throw new ni("no video track found");const l=new Gc(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});l.source=Y.Source.ScreenShare,e.contentHint&&(l.mediaStreamTrack.contentHint=e.contentHint);const u=[l];if(s.getAudioTracks().length>0){this.emit(ae.AudioStreamAcquired);const d=new Fc(s.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});d.source=Y.Source.ScreenShareAudio,u.push(d)}return u})}publishTrack(e,i){return O(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,i)})}publishOrRepublishTrack(e,i){return O(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var d,m,h,g;ma(s)&&s.setAudioContext(l.audioContext),yield(d=l.reconnectFuture)===null||d===void 0?void 0:d.promise,l.republishPromise&&!u&&(yield l.republishPromise),ms(s)&&l.pendingPublishPromises.has(s)&&(yield l.pendingPublishPromises.get(s));let v;if(s instanceof MediaStreamTrack)v=s.getConstraints();else{v=s.constraints;let x;switch(s.source){case Y.Source.Microphone:x="audioinput";break;case Y.Source.Camera:x="videoinput"}x&&l.activeDeviceMap.has(x)&&(v=Object.assign(Object.assign({},v),{deviceId:l.activeDeviceMap.get(x)}))}if(s instanceof MediaStreamTrack)switch(s.kind){case"audio":s=new Fc(s,v,!0,l.audioContext,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;case"video":s=new Gc(s,v,!0,{loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});break;default:throw new ni("unsupported MediaStreamTrack kind ".concat(s.kind))}else s.updateLoggerOptions({loggerName:l.roomOptions.loggerName,loggerContextCb:()=>l.logContext});let b;if(l.trackPublications.forEach(x=>{x.track&&x.track===s&&(b=x)}),b)return l.log.warn("track has already been published, skipping",Object.assign(Object.assign({},l.logContext),Me(b))),b;const k="channelCount"in s.mediaStreamTrack.getSettings()&&s.mediaStreamTrack.getSettings().channelCount===2||s.mediaStreamTrack.getConstraints().channelCount===2,T=(m=o==null?void 0:o.forceStereo)!==null&&m!==void 0?m:k;T&&(o||(o={}),o.dtx===void 0&&l.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},l.logContext),Me(s))),o.red===void 0&&l.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(h=o.dtx)!==null&&h!==void 0||(o.dtx=!1),(g=o.red)!==null&&g!==void 0||(o.red=!1));const E=Object.assign(Object.assign({},l.roomOptions.publishDefaults),o);!I_()&&l.roomOptions.e2ee&&(l.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},l.logContext)),E.simulcast=!1),E.source&&(s.source=E.source);const _=l.publish(s,E,T);l.pendingPublishPromises.set(s,_);try{return yield _}catch(x){throw x}finally{l.pendingPublishPromises.delete(s)}}()})}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Me(e))),!1;const{canPublish:i,canPublishSources:s}=this.permissions;return i&&(s.length===0||s.map(o=>$_(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Me(e))),!1)}publish(e,i,s){return O(this,void 0,void 0,function*(){var o,l,u,d,m,h,g,v,b,k;if(!this.hasPermissionsToPublish(e))throw new T_("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(w=>ms(e)&&w.source===e.source)&&e.source!==Y.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Me(e))),i.stopMicTrackOnMute&&ri(e)&&(e.stopOnMute=!0),e.source===Y.Source.ScreenShare&&vs()&&(i.simulcast=!1),i.videoCodec==="av1"&&!M_()&&(i.videoCodec=void 0),i.videoCodec==="vp9"&&!U_()&&(i.videoCodec=void 0),i.videoCodec===void 0&&(i.videoCodec=xf),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(w=>i.videoCodec===Mc(w.mime))||(i.videoCodec=Mc(this.enabledPublishVideoCodecs[0].mime)));const E=i.videoCodec;e.on($.Muted,this.onTrackMuted),e.on($.Unmuted,this.onTrackUnmuted),e.on($.Ended,this.handleTrackEnded),e.on($.UpstreamPaused,this.onTrackUpstreamPaused),e.on($.UpstreamResumed,this.onTrackUpstreamResumed),e.on($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const _=new uf({cid:e.mediaStreamTrack.id,name:i.name,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),disableDtx:!(!((o=i.dtx)!==null&&o!==void 0)||o),encryption:this.encryptionType,stereo:s,disableRed:this.isE2EEEnabled||!(!((l=i.red)!==null&&l!==void 0)||l),stream:i==null?void 0:i.stream,backupCodecPolicy:i==null?void 0:i.backupCodecPolicy});let x;if(e.kind===Y.Kind.Video){let w={width:0,height:0};try{w=yield e.waitForDimensions()}catch{const J=(d=(u=this.roomOptions.videoCaptureDefaults)===null||u===void 0?void 0:u.resolution)!==null&&d!==void 0?d:qr.h720.resolution;w={width:J.width,height:J.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Me(e)),{dims:w}))}_.width=w.width,_.height=w.height,Pi(e)&&(Ur(E)&&(e.source===Y.Source.ScreenShare&&(i.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Me(e))))),i.scalabilityMode=(m=i.scalabilityMode)!==null&&m!==void 0?m:"L3T3_KEY"),_.simulcastCodecs=[new lf({codec:E,cid:e.mediaStreamTrack.id})],i.backupCodec===!0&&(i.backupCodec={codec:xf}),i.backupCodec&&E!==i.backupCodec.codec&&_.encryption===Kt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),_.simulcastCodecs.push(new lf({codec:i.backupCodec.codec,cid:""})))),x=Df(e.source===Y.Source.ScreenShare,_.width,_.height,i),_.layers=yy(_.width,_.height,x,Ur(i.videoCodec))}else e.kind===Y.Kind.Audio&&(x=[{maxBitrate:(h=i.audioPreset)===null||h===void 0?void 0:h.maxBitrate,priority:(v=(g=i.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&v!==void 0?v:"high",networkPriority:(k=(b=i.audioPreset)===null||b===void 0?void 0:b.priority)!==null&&k!==void 0?k:"high"}]);if(!this.engine||this.engine.isClosed)throw new dt("cannot publish track when not connected");const I=()=>O(this,void 0,void 0,function*(){var w,F,J;if(!this.engine.pcManager)throw new dt("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,i,x),Pi(e)&&((w=i.degradationPreference)!==null&&w!==void 0||(i.degradationPreference=Ew(e)),e.setDegradationPreference(i.degradationPreference)),x)if(vs()&&e.kind===Y.Kind.Audio){let ne;for(const Q of this.engine.pcManager.publisher.getTransceivers())if(Q.sender===e.sender){ne=Q;break}ne&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ne,codec:"opus",maxbr:!((F=x[0])===null||F===void 0)&&F.maxBitrate?x[0].maxBitrate/1e3:0})}else e.codec&&Ur(e.codec)&&(!((J=x[0])===null||J===void 0)&&J.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:_.cid,codec:e.codec,maxbr:x[0].maxBitrate/1e3});yield this.engine.negotiate()});let U;if(this.enabledPublishVideoCodecs.length>0)U=(yield Promise.all([this.engine.addTrack(_),I()]))[0];else{U=yield this.engine.addTrack(_);let w;if(U.codecs.forEach(F=>{w===void 0&&(w=F.mimeType)}),w&&e.kind===Y.Kind.Video){const F=Mc(w);F!==E&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Me(e)),{codec:F})),i.videoCodec=F,x=Df(e.source===Y.Source.ScreenShare,_.width,_.height,i))}yield I()}const N=new Pf(e.kind,U,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return N.options=i,e.sid=U.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:x,trackInfo:U})),Pi(e)?e.startMonitor(this.engine.client):ma(e)&&e.startMonitor(),this.addTrackPublication(N),this.emit(ae.LocalTrackPublished,N),N})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,i,s){return O(this,void 0,void 0,function*(){var o;if(this.encryptionType!==Kt.NONE)return;let l;if(this.trackPublications.forEach(k=>{k.track&&k.track===e&&(l=k)}),!l)throw new ni("track is not published");if(!Pi(e))throw new ni("track is not a video track");const u=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),s),d=Tw(e,i,u);if(!d){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Me(e)));return}const m=e.addSimulcastTrack(i,d);if(!m)return;const h=new uf({cid:m.mediaStreamTrack.id,type:Y.kindToProto(e.kind),muted:e.isMuted,source:Y.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:u.videoCodec,cid:m.mediaStreamTrack.id}]});if(h.layers=yy(h.width,h.height,d),!this.engine||this.engine.isClosed)throw new dt("cannot publish track when not connected");const g=()=>O(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,m,u,d),yield this.engine.negotiate()}),b=(yield Promise.all([this.engine.addTrack(h),g()]))[0];this.log.debug("published ".concat(i," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:d,trackInfo:b}))})}unpublishTrack(e,i){return O(this,void 0,void 0,function*(){var s,o;if(ms(e)){const h=this.pendingPublishPromises.get(e);h&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Me(e))),yield h)}const l=this.getPublicationForTrack(e),u=l?Me(l):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),u)),!l||!l.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),u));return}e=l.track,e.off($.Muted,this.onTrackMuted),e.off($.Unmuted,this.onTrackUnmuted),e.off($.Ended,this.handleTrackEnded),e.off($.UpstreamPaused,this.onTrackUpstreamPaused),e.off($.UpstreamResumed,this.onTrackUpstreamResumed),e.off($.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),i===void 0&&(i=(o=(s=this.roomOptions)===null||s===void 0?void 0:s.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),i?e.stop():e.stopMonitor();let d=!1;const m=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<We.FAILED&&m)try{for(const h of this.engine.pcManager.publisher.getTransceivers())h.sender===m&&(h.direction="inactive",d=!0);if(this.engine.removeTrack(m)&&(d=!0),Pi(e)){for(const[,h]of e.simulcastCodecs)h.sender&&(this.engine.removeTrack(h.sender)&&(d=!0),h.sender=void 0);e.simulcastCodecs.clear()}}catch(h){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),u),{error:h}))}switch(this.trackPublications.delete(l.trackSid),l.kind){case Y.Kind.Audio:this.audioTrackPublications.delete(l.trackSid);break;case Y.Kind.Video:this.videoTrackPublications.delete(l.trackSid);break}return this.emit(ae.LocalTrackUnpublished,l),l.setTrack(void 0),d&&(yield this.engine.negotiate()),l})}unpublishTracks(e){return O(this,void 0,void 0,function*(){return(yield Promise.all(e.map(s=>this.unpublishTrack(s)))).filter(s=>!!s)})}republishAllTracks(e){return O(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){s.republishPromise&&(yield s.republishPromise),s.republishPromise=new Promise((l,u)=>O(s,void 0,void 0,function*(){try{const d=[];this.trackPublications.forEach(m=>{m.track&&(i&&(m.options=Object.assign(Object.assign({},m.options),i)),d.push(m))}),yield Promise.all(d.map(m=>O(this,void 0,void 0,function*(){const h=m.track;yield this.unpublishTrack(h,!1),o&&!h.isMuted&&h.source!==Y.Source.ScreenShare&&h.source!==Y.Source.ScreenShareAudio&&(ma(h)||Pi(h))&&!h.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:m.trackSid})),yield h.restartTrack()),yield this.publishOrRepublishTrack(h,m.options,!0)}))),l()}catch(d){u(d)}finally{this.republishPromise=void 0}})),yield s.republishPromise}()})}publishData(e){return O(this,arguments,void 0,function(i){var s=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const l=o.reliable?Oe.RELIABLE:Oe.LOSSY,u=o.destinationIdentities,d=o.topic,m=new Pt({kind:l,value:{case:"user",value:new w0({participantIdentity:s.identity,payload:i,destinationIdentities:u,topic:d})}});yield s.engine.sendDataPacket(m,l)}()})}publishDtmf(e,i){return O(this,void 0,void 0,function*(){const s=new Pt({kind:Oe.RELIABLE,value:{case:"sipDtmf",value:new x0({code:e,digit:i})}});yield this.engine.sendDataPacket(s,Oe.RELIABLE)})}sendChatMessage(e,i){return O(this,void 0,void 0,function*(){const s={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:i==null?void 0:i.attachments},o=new Pt({value:{case:"chatMessage",value:new nf(Object.assign(Object.assign({},s),{timestamp:Ge.parse(s.timestamp)}))}});return yield this.engine.sendDataPacket(o,Oe.RELIABLE),this.emit(ae.ChatMessage,s),s})}editChatMessage(e,i){return O(this,void 0,void 0,function*(){const s=Object.assign(Object.assign({},i),{message:e,editTimestamp:Date.now()}),o=new Pt({value:{case:"chatMessage",value:new nf(Object.assign(Object.assign({},s),{timestamp:Ge.parse(s.timestamp),editTimestamp:Ge.parse(s.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,Oe.RELIABLE),this.emit(ae.ChatMessage,s),s})}sendText(e,i){return O(this,void 0,void 0,function*(){var s;const o=crypto.randomUUID(),u=new TextEncoder().encode(e).byteLength,d=(s=i==null?void 0:i.attachments)===null||s===void 0?void 0:s.map(()=>crypto.randomUUID()),m=new Array(d?d.length+1:1).fill(0),h=(v,b)=>{var k;m[b]=v;const T=m.reduce((E,_)=>E+_,0);(k=i==null?void 0:i.onProgress)===null||k===void 0||k.call(i,T)},g=yield this.streamText({streamId:o,totalSize:u,destinationIdentities:i==null?void 0:i.destinationIdentities,topic:i==null?void 0:i.topic,attachedStreamIds:d,attributes:i==null?void 0:i.attributes});return yield g.write(e),h(1,0),yield g.close(),i!=null&&i.attachments&&d&&(yield Promise.all(i.attachments.map((v,b)=>O(this,void 0,void 0,function*(){return this._sendFile(d[b],v,{topic:i.topic,mimeType:v.type,onProgress:k=>{h(k,b+1)}})})))),g.info})}streamText(e){return O(this,void 0,void 0,function*(){var i,s;const o=(i=e==null?void 0:e.streamId)!==null&&i!==void 0?i:crypto.randomUUID(),l={id:o,mimeType:"text/plain",timestamp:Date.now(),topic:(s=e==null?void 0:e.topic)!==null&&s!==void 0?s:"",size:e==null?void 0:e.totalSize,attributes:e==null?void 0:e.attributes},u=new sf({streamId:o,mimeType:l.mimeType,topic:l.topic,timestamp:ha(l.timestamp),totalLength:ha(e==null?void 0:e.totalSize),attributes:l.attributes,contentHeader:{case:"textHeader",value:new I0({version:e==null?void 0:e.version,attachedStreamIds:e==null?void 0:e.attachedStreamIds,replyToStreamId:e==null?void 0:e.replyToStreamId,operationType:(e==null?void 0:e.type)==="update"?af.UPDATE:af.CREATE})}}),d=e==null?void 0:e.destinationIdentities,m=new Pt({destinationIdentities:d,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(m,Oe.RELIABLE);let h=0;const g=this,v=new WritableStream({write(T){return O(this,void 0,void 0,function*(){for(const E of Q_(T,fc)){yield g.engine.waitForBufferStatusLow(Oe.RELIABLE);const _=new rf({content:E,streamId:o,chunkIndex:ha(h)}),x=new Pt({destinationIdentities:d,value:{case:"streamChunk",value:_}});yield g.engine.sendDataPacket(x,Oe.RELIABLE),h+=1}})},close(){return O(this,void 0,void 0,function*(){const T=new of({streamId:o}),E=new Pt({destinationIdentities:d,value:{case:"streamTrailer",value:T}});yield g.engine.sendDataPacket(E,Oe.RELIABLE)})},abort(T){console.log("Sink error:",T)}});let b=()=>O(this,void 0,void 0,function*(){yield k.close()});g.engine.once(te.Closing,b);const k=new Mw(v,l,()=>this.engine.off(te.Closing,b));return k})}sendFile(e,i){return O(this,void 0,void 0,function*(){const s=crypto.randomUUID();return yield this._sendFile(s,e,i),{id:s}})}_sendFile(e,i,s){return O(this,void 0,void 0,function*(){var o,l;const u=i.size,d=new sf({totalLength:ha(u),mimeType:(o=s==null?void 0:s.mimeType)!==null&&o!==void 0?o:i.type,streamId:e,topic:s==null?void 0:s.topic,encryptionType:s==null?void 0:s.encryptionType,timestamp:ha(Date.now()),contentHeader:{case:"byteHeader",value:new B0({name:i.name})}}),m=s==null?void 0:s.destinationIdentities,h=new Pt({destinationIdentities:m,value:{case:"streamHeader",value:d}});yield this.engine.sendDataPacket(h,Oe.RELIABLE);function g(T){return new Promise(E=>{const _=new FileReader;_.onload=()=>{E(new Uint8Array(_.result))},_.readAsArrayBuffer(T)})}const v=Math.ceil(u/fc);for(let T=0;T<v;T++){const E=yield g(i.slice(T*fc,Math.min((T+1)*fc,u)));yield this.engine.waitForBufferStatusLow(Oe.RELIABLE);const _=new rf({content:E,streamId:e,chunkIndex:ha(T)}),x=new Pt({destinationIdentities:m,value:{case:"streamChunk",value:_}});yield this.engine.sendDataPacket(x,Oe.RELIABLE),(l=s==null?void 0:s.onProgress)===null||l===void 0||l.call(s,(T+1)/v)}const b=new of({streamId:e}),k=new Pt({destinationIdentities:m,value:{case:"streamTrailer",value:b}});yield this.engine.sendDataPacket(k,Oe.RELIABLE)})}performRpc(e){return O(this,arguments,void 0,function(i){var s=this;let{destinationIdentity:o,method:l,payload:u,responseTimeout:d=1e4}=i;return function*(){return new Promise((h,g)=>O(s,void 0,void 0,function*(){var v,b,k,T;if(rh(u)>jb){g(et.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((b=(v=this.engine.latestJoinResponse)===null||v===void 0?void 0:v.serverInfo)===null||b===void 0)&&b.version&&ys((T=(k=this.engine.latestJoinResponse)===null||k===void 0?void 0:k.serverInfo)===null||T===void 0?void 0:T.version,"1.8.0")<0){g(et.builtIn("UNSUPPORTED_SERVER"));return}const E=crypto.randomUUID();yield this.publishRpcRequest(o,E,l,u,d-2e3);const _=setTimeout(()=>{this.pendingAcks.delete(E),g(et.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(E),clearTimeout(x)},2e3);this.pendingAcks.set(E,{resolve:()=>{clearTimeout(_)},participantIdentity:o});const x=setTimeout(()=>{this.pendingResponses.delete(E),g(et.builtIn("RESPONSE_TIMEOUT"))},d);this.pendingResponses.set(E,{resolve:(I,U)=>{clearTimeout(x),this.pendingAcks.has(E)&&(console.warn("RPC response received before ack",E),this.pendingAcks.delete(E),clearTimeout(_)),U?g(U):h(I??"")},participantIdentity:o})}))}()})}registerRpcMethod(e,i){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=i,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const i=this.pendingAcks.get(e);i?(i.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,i,s){const o=this.pendingResponses.get(e);o?(o.resolve(i,s),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,i,s,o,l){return O(this,void 0,void 0,function*(){const u=new Pt({destinationIdentities:[e],kind:Oe.RELIABLE,value:{case:"rpcRequest",value:new O0({id:i,method:s,payload:o,responseTimeoutMs:l,version:1})}});yield this.engine.sendDataPacket(u,Oe.RELIABLE)})}handleParticipantDisconnected(e){for(const[i,{participantIdentity:s}]of this.pendingAcks)s===e&&this.pendingAcks.delete(i);for(const[i,{participantIdentity:s,resolve:o}]of this.pendingResponses)s===e&&(o(null,et.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(i))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(i=>i.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(i=>{var s,o;const l=this.trackPublications.get(i.sid);if(l){const u=l.isMuted||((o=(s=l.track)===null||s===void 0?void 0:s.isUpstreamPaused)!==null&&o!==void 0?o:!1);u!==i.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Me(l)),{mutedOnServer:u})),this.engine.client.sendMuteTrack(i.sid,u))}}),!0)}getPublicationForTrack(e){let i;return this.trackPublications.forEach(s=>{const o=s.track;o&&(e instanceof MediaStreamTrack?(ma(o)||Pi(o))&&o.mediaStreamTrack===e&&(i=s):e===o&&(i=s))}),i}waitForPendingPublicationOfSource(e){return O(this,void 0,void 0,function*(){const s=Date.now();for(;Date.now()<s+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(l=>{let[u]=l;return u.source===e});if(o)return o[1];yield jt(20)}})}}class qw extends Ui{constructor(e,i,s,o){super(e,i.sid,i.name,o),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=cn.HIGH,this.handleEnded=l=>{this.setTrack(void 0),this.emit($.Ended,l)},this.handleVisibilityChange=l=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(l),this.logContext),this.disabled=!l,this.emitTrackUpdate()},this.handleVideoDimensionsChange=l=>{this.log.debug("adaptivestream video dimensions ".concat(l.width,"x").concat(l.height),this.logContext),this.videoDimensions=l,this.emitTrackUpdate()},this.subscribed=s,this.updateInfo(i)}setSubscribed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new nl({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new P0({participantSid:"",trackSids:[this.trackSid]})]});this.emit($.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(i),this.emitPermissionUpdateIfChanged(s)}get subscriptionStatus(){return this.subscribed===!1?Ui.SubscriptionStatus.Unsubscribed:super.isSubscribed?Ui.SubscriptionStatus.Subscribed:Ui.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Ui.PermissionStatus.Allowed:Ui.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var i,s;this.isManualOperationAllowed()&&(((i=this.videoDimensions)===null||i===void 0?void 0:i.width)===e.width&&((s=this.videoDimensions)===null||s===void 0?void 0:s.height)===e.height||(Ld(this.track)&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Ld(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const i=this.subscriptionStatus,s=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off($.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off($.VisibilityChanged,this.handleVisibilityChange),o.off($.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit($.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on($.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on($.VisibilityChanged,this.handleVisibilityChange),e.on($.Ended,this.handleEnded),this.emit($.Subscribed,e)),this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i))}setAllowed(e){const i=this.subscriptionStatus,s=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(s),this.emitSubscriptionUpdateIfChanged(i)}setSubscriptionError(e){this.emit($.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const i=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):i!==e.muted&&this.emit(e.muted?$.Muted:$.Unmuted)}emitSubscriptionUpdateIfChanged(e){const i=this.subscriptionStatus;e!==i&&this.emit($.SubscriptionStatusChanged,i,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit($.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Y.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Ld(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new z0({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=cn.HIGH,this.emit($.UpdateSettings,e)}}class Kc extends Fb{static fromParticipantInfo(e,i,s){return new Kc(e,i.sid,i.identity,i.name,i.metadata,i.attributes,s,i.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,i,s,o,l,u,d){let m=arguments.length>7&&arguments[7]!==void 0?arguments[7]:qc.STANDARD;super(i,s||"",o,l,u,d,m),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on($.UpdateSettings,i=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Me(e))),this.signalClient.sendUpdateTrackSettings(i)}),e.on($.UpdateSubscription,i=>{i.participantTracks.forEach(s=>{s.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(i)}),e.on($.SubscriptionPermissionChanged,i=>{this.emit(ae.TrackSubscriptionPermissionChanged,e,i)}),e.on($.SubscriptionStatusChanged,i=>{this.emit(ae.TrackSubscriptionStatusChanged,e,i)}),e.on($.Subscribed,i=>{this.emit(ae.TrackSubscribed,i,e)}),e.on($.Unsubscribed,i=>{this.emit(ae.TrackUnsubscribed,i,e)}),e.on($.SubscriptionFailed,i=>{this.emit(ae.TrackSubscriptionFailed,e.trackSid,i)})}getTrackPublication(e){const i=super.getTrackPublication(e);if(i)return i}getTrackPublicationByName(e){const i=super.getTrackPublicationByName(e);if(i)return i}setVolume(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y.Source.Microphone;this.volumeMap.set(i,e);const s=this.getTrackPublication(i);s&&s.track&&s.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y.Source.Microphone;const i=this.getTrackPublication(e);return i&&i.track?i.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,i,s,o,l,u){let d=this.getTrackPublicationBySid(i);if(d||i.startsWith("TR")||this.trackPublications.forEach(g=>{!d&&e.kind===g.kind.toString()&&(d=g)}),!d){if(u===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:i})),this.emit(ae.TrackSubscriptionFailed,i);return}u===void 0&&(u=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,i,s,o,l,u-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Me(d))),this.emit(ae.TrackSubscriptionFailed,i);return}const m=e.kind==="video";let h;return m?h=new Lw(e,i,o,l):h=new Uw(e,i,o,this.audioContext,this.audioOutput),h.source=d.source,h.isMuted=d.isMuted,h.setMediaStream(s),h.start(),d.setTrack(h),this.volumeMap.has(d.source)&&_f(h)&&ri(h)&&h.setVolume(this.volumeMap.get(d.source)),d}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const i=new Map,s=new Map;return e.tracks.forEach(o=>{var l,u;let d=this.getTrackPublicationBySid(o.sid);if(d)d.updateInfo(o);else{const m=Y.kindFromProto(o.type);if(!m)return;d=new qw(m,o,(l=this.signalClient.connectOptions)===null||l===void 0?void 0:l.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(u=this.loggerOptions)===null||u===void 0?void 0:u.loggerName}),d.updateInfo(o),s.set(o.sid,d);const h=Array.from(this.trackPublications.values()).find(g=>g.source===(d==null?void 0:d.source));h&&d.source!==Y.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(d.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Me(h),newTrack:Me(d)})),this.addTrackPublication(d)}i.set(o.sid,d)}),this.trackPublications.forEach(o=>{i.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Me(o))),this.unpublishTrack(o.trackSid,!0))}),s.forEach(o=>{this.emit(ae.TrackPublished,o)}),!0}unpublishTrack(e,i){const s=this.trackPublications.get(e);if(!s)return;const{track:o}=s;switch(o&&(o.stop(),s.setTrack(void 0)),this.trackPublications.delete(e),s.kind){case Y.Kind.Audio:this.audioTrackPublications.delete(e);break;case Y.Kind.Video:this.videoTrackPublications.delete(e);break}i&&this.emit(ae.TrackUnpublished,s)}setAudioOutput(e){return O(this,void 0,void 0,function*(){this.audioOutput=e;const i=[];this.audioTrackPublications.forEach(s=>{var o;ri(s.track)&&_f(s.track)&&i.push(s.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(i)})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:s})),super.emit(e,...s)}}var Ne;(function(a){a.Disconnected="disconnected",a.Connecting="connecting",a.Connected="connected",a.Reconnecting="reconnecting",a.SignalReconnecting="signalReconnecting"})(Ne||(Ne={}));const Vw=4*1e3;class bs extends jn.EventEmitter{constructor(e){var i,s,o,l;if(super(),i=this,this.state=Ne.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Ee,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(u,d,m)=>O(this,void 0,void 0,function*(){var h;if(!L_())throw Un()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const g=yield this.disconnectLock.lock();if(this.state===Ne.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),g(),Promise.resolve();if(this.connectFuture)return g(),this.connectFuture.promise;this.setAndEmitConnectionState(Ne.Connecting),((h=this.regionUrlProvider)===null||h===void 0?void 0:h.getServerUrl().toString())!==u&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Rf(new URL(u))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Af(u,d):this.regionUrlProvider.updateToken(d),this.regionUrlProvider.fetchRegionSettings().then(k=>{var T;(T=this.regionUrlProvider)===null||T===void 0||T.setServerReportedRegions(k)}).catch(k=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:k}))}));const v=(k,T,E)=>O(this,void 0,void 0,function*(){var _,x;this.abortController&&this.abortController.abort();const I=new AbortController;this.abortController=I,g==null||g();try{yield this.attemptConnection(E??u,d,m,I),this.abortController=void 0,k()}catch(U){if(this.regionUrlProvider&&U instanceof Be&&U.reason!==xe.Cancelled&&U.reason!==xe.NotAllowed){let N=null;try{N=yield this.regionUrlProvider.getNextBestRegionUrl((_=this.abortController)===null||_===void 0?void 0:_.signal)}catch(w){if(w instanceof Be&&(w.status===401||w.reason===xe.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),T(w);return}}N&&!(!((x=this.abortController)===null||x===void 0)&&x.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(U.message,". Retrying with another region: ").concat(N),this.logContext),this.recreateEngine(),yield v(k,T,N)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ay(U)),T(U))}else{let N=yn.UNKNOWN_REASON;U instanceof Be&&(N=ay(U)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,N),T(U)}}}),b=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Ab((k,T)=>{v(k,T,b)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(u,d,m,h,g,v)=>O(this,void 0,void 0,function*(){var b,k,T;const E=yield m.join(u,d,{autoSubscribe:h.autoSubscribe,adaptiveStream:typeof g.adaptiveStream=="object"?!0:g.adaptiveStream,maxRetries:h.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:h.websocketTimeout},v.signal);let _=E.serverInfo;if(_||(_={version:E.serverVersion,region:E.serverRegion}),this.serverInfo=_,this.log.debug("connected to Livekit Server ".concat(Object.entries(_).map(x=>{let[I,U]=x;return"".concat(I,": ").concat(U)}).join(", ")),{room:(b=E.room)===null||b===void 0?void 0:b.name,roomSid:(k=E.room)===null||k===void 0?void 0:k.sid,identity:(T=E.participant)===null||T===void 0?void 0:T.identity}),!_.version)throw new S_("unknown server version");return _.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),g.dynacast=!1),E}),this.applyJoinResponse=u=>{const d=u.participant;if(this.localParticipant.sid=d.sid,this.localParticipant.identity=d.identity,this.localParticipant.setEnabledPublishCodecs(u.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(u.sifTrailer)}catch(m){this.log.error(m instanceof Error?m.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:m}))}this.handleParticipantUpdates([d,...u.otherParticipants]),u.room&&this.handleRoomUpdate(u.room)},this.attemptConnection=(u,d,m,h)=>O(this,void 0,void 0,function*(){var g,v;this.state===Ne.Reconnecting||this.isResuming||!((g=this.engine)===null||g===void 0)&&g.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((v=this.regionUrlProvider)===null||v===void 0)&&v.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},sh),m),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const b=yield this.connectSignal(u,d,this.engine,this.connOptions,this.options,h);this.applyJoinResponse(b),this.setupLocalParticipantEvents(),this.emit(W.SignalConnected)}catch(b){yield this.engine.close(),this.recreateEngine();const k=new Be("could not establish signal connection",xe.ServerUnreachable);throw b instanceof Error&&(k.message="".concat(k.message,": ").concat(b.message)),b instanceof Be&&(k.reason=b.reason,k.status=b.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:b})),k}if(h.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Be("Connection attempt aborted",xe.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,h)}catch(b){throw yield this.engine.close(),this.recreateEngine(),b}Ut()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Ut()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ne.Connected),this.emit(W.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var u=arguments.length,d=new Array(u),m=0;m<u;m++)d[m]=arguments[m];return O(i,[...d],void 0,function(){var h=this;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var v,b,k,T;const E=yield h.disconnectLock.lock();try{if(h.state===Ne.Disconnected){h.log.debug("already disconnected",h.logContext);return}h.log.info("disconnect from room",Object.assign({},h.logContext)),(h.state===Ne.Connecting||h.state===Ne.Reconnecting||h.isResuming)&&(h.log.warn("abort connection attempt",h.logContext),(v=h.abortController)===null||v===void 0||v.abort(),(k=(b=h.connectFuture)===null||b===void 0?void 0:b.reject)===null||k===void 0||k.call(b,new Be("Client initiated disconnect",xe.Cancelled)),h.connectFuture=void 0),!((T=h.engine)===null||T===void 0)&&T.client.isDisconnected||(yield h.engine.client.sendLeave()),h.engine&&(yield h.engine.close()),h.handleDisconnect(g,yn.CLIENT_INITIATED),h.engine=void 0}finally{E()}}()})},this.onPageLeave=()=>O(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>O(this,void 0,void 0,function*(){const u=[],d=Mn();if(d&&d.os==="iOS"){const m="livekit-dummy-audio-el";let h=document.getElementById(m);if(!h){h=document.createElement("audio"),h.id=m,h.autoplay=!0,h.hidden=!0;const g=Ud();g.enabled=!0;const v=new MediaStream([g]);h.srcObject=v,document.addEventListener("visibilitychange",()=>{h&&(h.srcObject=document.hidden?null:v,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(h),this.once(W.Disconnected,()=>{h==null||h.remove(),h=null})}u.push(h)}this.remoteParticipants.forEach(m=>{m.audioTrackPublications.forEach(h=>{h.track&&h.track.attachedElements.forEach(g=>{u.push(g)})})});try{yield Promise.all([this.acquireAudioContext(),...u.map(m=>(m.muted=!1,m.play()))]),this.handleAudioPlaybackStarted()}catch(m){throw this.handleAudioPlaybackFailed(m),m}}),this.startVideo=()=>O(this,void 0,void 0,function*(){const u=[];for(const d of this.remoteParticipants.values())d.videoTrackPublications.forEach(m=>{var h;(h=m.track)===null||h===void 0||h.attachedElements.forEach(g=>{u.includes(g)||u.push(g)})});yield Promise.all(u.map(d=>d.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(d=>{d.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const u of this.remoteParticipants.values())this.handleParticipantDisconnected(u.identity,u);this.setAndEmitConnectionState(Ne.Reconnecting)&&this.emit(W.Reconnecting)},this.handleSignalRestarted=u=>O(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(u.serverRegion),Object.assign(Object.assign({},this.logContext),{region:u.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(u);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(d){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:d}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:u.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ne.Connected),this.emit(W.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=u=>{u.forEach(d=>{var m;if(d.identity===this.localParticipant.identity){this.localParticipant.updateInfo(d);return}d.identity===""&&(d.identity=(m=this.sidToIdentity.get(d.sid))!==null&&m!==void 0?m:"");let h=this.remoteParticipants.get(d.identity);d.state===tf.DISCONNECTED?this.handleParticipantDisconnected(d.identity,h):h=this.getOrCreateParticipant(d.identity,d)})},this.handleActiveSpeakersUpdate=u=>{const d=[],m={};u.forEach(h=>{if(m[h.sid]=!0,h.sid===this.localParticipant.sid)this.localParticipant.audioLevel=h.level,this.localParticipant.setIsSpeaking(!0),d.push(this.localParticipant);else{const g=this.getRemoteParticipantBySid(h.sid);g&&(g.audioLevel=h.level,g.setIsSpeaking(!0),d.push(g))}}),m[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(h=>{m[h.sid]||(h.audioLevel=0,h.setIsSpeaking(!1))}),this.activeSpeakers=d,this.emitWhenConnected(W.ActiveSpeakersChanged,d)},this.handleSpeakersChanged=u=>{const d=new Map;this.activeSpeakers.forEach(h=>{const g=this.remoteParticipants.get(h.identity);g&&g.sid!==h.sid||d.set(h.sid,h)}),u.forEach(h=>{let g=this.getRemoteParticipantBySid(h.sid);h.sid===this.localParticipant.sid&&(g=this.localParticipant),g&&(g.audioLevel=h.level,g.setIsSpeaking(h.active),h.active?d.set(h.sid,g):d.delete(h.sid))});const m=Array.from(d.values());m.sort((h,g)=>g.audioLevel-h.audioLevel),this.activeSpeakers=m,this.emitWhenConnected(W.ActiveSpeakersChanged,m)},this.handleStreamStateUpdate=u=>{u.streamStates.forEach(d=>{const m=this.getRemoteParticipantBySid(d.participantSid);if(!m)return;const h=m.getTrackPublicationBySid(d.trackSid);if(!h||!h.track)return;const g=Y.streamStateFromProto(d.state);g!==h.track.streamState&&(h.track.streamState=g,m.emit(ae.TrackStreamStateChanged,h,h.track.streamState),this.emitWhenConnected(W.TrackStreamStateChanged,h,h.track.streamState,m))})},this.handleSubscriptionPermissionUpdate=u=>{const d=this.getRemoteParticipantBySid(u.participantSid);if(!d)return;const m=d.getTrackPublicationBySid(u.trackSid);m&&m.setAllowed(u.allowed)},this.handleSubscriptionError=u=>{const d=Array.from(this.remoteParticipants.values()).find(h=>h.trackPublications.has(u.trackSid));if(!d)return;const m=d.getTrackPublicationBySid(u.trackSid);m&&m.setSubscriptionError(u.err)},this.handleDataPacket=u=>{const d=this.remoteParticipants.get(u.participantIdentity);if(u.value.case==="user")this.handleUserPacket(d,u.value.value,u.kind);else if(u.value.case==="transcription")this.handleTranscription(d,u.value.value);else if(u.value.case==="sipDtmf")this.handleSipDtmf(d,u.value.value);else if(u.value.case==="chatMessage")this.handleChatMessage(d,u.value.value);else if(u.value.case==="metrics")this.handleMetrics(u.value.value,d);else if(u.value.case==="streamHeader")this.handleStreamHeader(u.value.value,u.participantIdentity);else if(u.value.case==="streamChunk")this.handleStreamChunk(u.value.value);else if(u.value.case==="streamTrailer")this.handleStreamTrailer(u.value.value);else if(u.value.case==="rpcRequest"){const m=u.value.value;this.handleIncomingRpcRequest(u.participantIdentity,m.id,m.method,m.payload,m.responseTimeoutMs,m.version)}},this.handleUserPacket=(u,d,m)=>{this.emit(W.DataReceived,d.payload,u,m,d.topic),u==null||u.emit(ae.DataReceived,d.payload,m)},this.handleSipDtmf=(u,d)=>{this.emit(W.SipDTMFReceived,d,u),u==null||u.emit(ae.SipDTMFReceived,d)},this.bufferedSegments=new Map,this.handleTranscription=(u,d)=>{const m=d.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(d.transcribedParticipantIdentity),h=m==null?void 0:m.trackPublications.get(d.trackId),g=F_(d,this.transcriptionReceivedTimes);h==null||h.emit($.TranscriptionReceived,g),m==null||m.emit(ae.TranscriptionReceived,g,h),this.emit(W.TranscriptionReceived,g,m,h)},this.handleChatMessage=(u,d)=>{const m=G_(d);this.emit(W.ChatMessage,m,u)},this.handleMetrics=(u,d)=>{this.emit(W.MetricsReceived,u,d)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(W.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=u=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:u})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(W.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(W.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(W.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>O(this,void 0,void 0,function*(){var u,d;const m=gt.getInstance().previousDevices,h=yield gt.getInstance().getDevices(void 0,!1),g=Mn();if((g==null?void 0:g.name)==="Chrome"&&g.os!=="iOS")for(let b of h){const k=m.find(T=>T.deviceId===b.deviceId);k&&k.label!==""&&k.kind===b.kind&&k.label!==b.label&&this.getActiveDevice(b.kind)==="default"&&this.emit(W.ActiveDeviceChanged,b.kind,b.deviceId)}const v=["audiooutput","audioinput","videoinput"];for(let b of v){const k=h.filter(E=>E.kind===b),T=this.getActiveDevice(b);if(T===((u=m.filter(E=>E.kind===b)[0])===null||u===void 0?void 0:u.deviceId)&&k.length>0&&((d=k[0])===null||d===void 0?void 0:d.deviceId)!==T){yield this.switchActiveDevice(b,k[0].deviceId);continue}b==="audioinput"&&!Vi()||b==="videoinput"||k.length>0&&!k.find(E=>E.deviceId===this.getActiveDevice(b))&&(yield this.switchActiveDevice(b,k[0].deviceId))}this.emit(W.MediaDevicesChanged)}),this.handleRoomUpdate=u=>{const d=this.roomInfo;this.roomInfo=u,d&&d.metadata!==u.metadata&&this.emitWhenConnected(W.RoomMetadataChanged,u.metadata),(d==null?void 0:d.activeRecording)!==u.activeRecording&&this.emitWhenConnected(W.RecordingStatusChanged,u.activeRecording)},this.handleConnectionQualityUpdate=u=>{u.updates.forEach(d=>{if(d.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(d.quality);return}const m=this.getRemoteParticipantBySid(d.participantSid);m&&m.setConnectionQuality(d.quality)})},this.onLocalParticipantMetadataChanged=u=>{this.emit(W.ParticipantMetadataChanged,u,this.localParticipant)},this.onLocalParticipantNameChanged=u=>{this.emit(W.ParticipantNameChanged,u,this.localParticipant)},this.onLocalAttributesChanged=u=>{this.emit(W.ParticipantAttributesChanged,u,this.localParticipant)},this.onLocalTrackMuted=u=>{this.emit(W.TrackMuted,u,this.localParticipant)},this.onLocalTrackUnmuted=u=>{this.emit(W.TrackUnmuted,u,this.localParticipant)},this.onTrackProcessorUpdate=u=>{var d;(d=u==null?void 0:u.onPublish)===null||d===void 0||d.call(u,this)},this.onLocalTrackPublished=u=>O(this,void 0,void 0,function*(){var d,m,h,g,v,b;(d=u.track)===null||d===void 0||d.on($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(m=u.track)===null||m===void 0||m.on($.Restarted,this.onLocalTrackRestarted),(v=(g=(h=u.track)===null||h===void 0?void 0:h.getProcessor())===null||g===void 0?void 0:g.onPublish)===null||v===void 0||v.call(g,this),this.emit(W.LocalTrackPublished,u,this.localParticipant),ma(u.track)&&(yield u.track.checkForSilence())&&this.emit(W.LocalAudioSilenceDetected,u);const k=yield(b=u.track)===null||b===void 0?void 0:b.getDeviceId(!1),T=sy(u.source);T&&k&&k!==this.localParticipant.activeDeviceMap.get(T)&&(this.localParticipant.activeDeviceMap.set(T,k),this.emit(W.ActiveDeviceChanged,T,k))}),this.onLocalTrackUnpublished=u=>{var d,m;(d=u.track)===null||d===void 0||d.off($.TrackProcessorUpdate,this.onTrackProcessorUpdate),(m=u.track)===null||m===void 0||m.off($.Restarted,this.onLocalTrackRestarted),this.emit(W.LocalTrackUnpublished,u,this.localParticipant)},this.onLocalTrackRestarted=u=>O(this,void 0,void 0,function*(){const d=yield u.getDeviceId(!1),m=sy(u.source);m&&d&&d!==this.localParticipant.activeDeviceMap.get(m)&&(this.log.debug("local track restarted, setting ".concat(m," ").concat(d," active"),this.logContext),this.localParticipant.activeDeviceMap.set(m,d),this.emit(W.ActiveDeviceChanged,m,d))}),this.onLocalConnectionQualityChanged=u=>{this.emit(W.ConnectionQualityChanged,u,this.localParticipant)},this.onMediaDevicesError=u=>{this.emit(W.MediaDevicesError,u)},this.onLocalParticipantPermissionsChanged=u=>{this.emit(W.ParticipantPermissionsChanged,u,this.localParticipant)},this.onLocalChatMessageSent=u=>{this.emit(W.ChatMessage,u,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},fw),e),this.log=si((s=this.options.loggerName)!==null&&s!==void 0?s:bn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Ub),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Lb),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},dw),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Yt,this.localParticipant=new zw("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",zi(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",zi(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",zi(this.options.audioOutput.deviceId)).catch(u=>this.log.warn("Could not set audio output: ".concat(u.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),Ut()){const u=new AbortController;(l=navigator.mediaDevices)===null||l===void 0||l.addEventListener("devicechange",this.handleDeviceChange,{signal:u.signal}),bs.cleanupRegistry&&bs.cleanupRegistry.register(this,()=>{u.abort()})}}registerTextStreamHandler(e,i){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,i)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,i){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,i)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,i){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,i)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,i,s,o,l,u){return O(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,i),u!==1){yield this.engine.publishRpcResponse(e,i,null,et.builtIn("UNSUPPORTED_VERSION"));return}const d=this.rpcHandlers.get(s);if(!d){yield this.engine.publishRpcResponse(e,i,null,et.builtIn("UNSUPPORTED_METHOD"));return}let m=null,h=null;try{const g=yield d({requestId:i,callerIdentity:e,payload:o,responseTimeout:l});rh(g)>jb?(m=et.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(s))):h=g}catch(g){g instanceof et?m=g:(console.warn("Uncaught error returned by RPC handler for ".concat(s,". Returning APPLICATION_ERROR instead."),g),m=et.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,i,h,m)})}setE2EEEnabled(e){return O(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new ew(this.options.e2ee),this.e2eeManager.on(Ii.ParticipantEncryptionStatusChanged,(i,s)=>{Y_(s)&&(this.isE2EEEnabled=i),this.emit(W.ParticipantEncryptionStatusChanged,i,s)}),this.e2eeManager.on(Ii.EncryptionError,i=>this.emit(W.EncryptionError,i)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&i!==void 0?i:!1}getSid(){return O(this,void 0,void 0,function*(){return this.state===Ne.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,i)=>{const s=o=>{o.sid!==""&&(this.engine.off(te.RoomUpdate,s),e(o.sid))};this.engine.on(te.RoomUpdate,s),this.once(W.Disconnected,()=>{this.engine.off(te.RoomUpdate,s),i("Room disconnected before room server id was available")})})})}get name(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&i!==void 0?i:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&i!==void 0?i:0}get numPublishers(){var e,i;return(i=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&i!==void 0?i:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new ww(this.options),this.engine.on(te.ParticipantUpdate,this.handleParticipantUpdates).on(te.RoomUpdate,this.handleRoomUpdate).on(te.SpeakersChanged,this.handleSpeakersChanged).on(te.StreamStateChanged,this.handleStreamStateUpdate).on(te.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(te.SubscriptionError,this.handleSubscriptionError).on(te.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(te.MediaTrackAdded,(e,i,s)=>{this.onTrackAdded(e,i,s)}).on(te.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(te.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(te.DataPacketReceived,this.handleDataPacket).on(te.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ne.SignalReconnecting)&&this.emit(W.SignalReconnecting)}).on(te.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ne.Connected)&&this.emit(W.Reconnected)}).on(te.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ne.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(te.Restarting,this.handleRestarting).on(te.SignalRestarted,this.handleSignalRestarted).on(te.Offline,()=>{this.setAndEmitConnectionState(Ne.Reconnecting)&&this.emit(W.Reconnecting)}).on(te.DCBufferStatusChanged,(e,i)=>{this.emit(W.DCBufferStatusChanged,e,i)}).on(te.LocalTrackSubscribed,e=>{const i=this.localParticipant.getTrackPublications().find(s=>{let{trackSid:o}=s;return o===e});if(!i){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ae.LocalTrackSubscribed,i),this.emitWhenConnected(W.LocalTrackSubscribed,i,this.localParticipant)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return gt.getInstance().getDevices(e,i)}prepareConnection(e,i){return O(this,void 0,void 0,function*(){if(this.state===Ne.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Rf(new URL(e))&&i){this.regionUrlProvider=new Af(e,i);const s=yield this.regionUrlProvider.getNextBestRegionUrl();s&&this.state===Ne.Disconnected&&(this.regionUrl=s,yield fetch(iy(s),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(s),this.logContext))}else yield fetch(iy(e),{method:"HEAD"})}catch(s){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:s}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,i){return O(this,void 0,void 0,function*(){let s=()=>{},o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new On({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new On({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new On({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new On({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":s=()=>O(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new On({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":s=()=>O(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new On({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new On({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),s=()=>O(this,void 0,void 0,function*(){const l=this.engine.client.onLeave;l&&l(new il({reason:yn.CLIENT_INITIATED,action:ds.RECONNECT}))});break;case"subscriber-bandwidth":if(i===void 0||typeof i!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new On({scenario:{case:"subscriberBandwidth",value:ha(i)}});break;case"leave-full-reconnect":o=new On({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield s())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,i){return O(this,arguments,void 0,function(s,o){var l=this;let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var d,m,h,g,v,b,k,T;let E=!0,_=!1;const x=u?{exact:o}:o;if(s==="audioinput"){_=l.localParticipant.audioTrackPublications.size===0;const I=(d=l.getActiveDevice(s))!==null&&d!==void 0?d:l.options.audioCaptureDefaults.deviceId;l.options.audioCaptureDefaults.deviceId=x;const U=Array.from(l.localParticipant.audioTrackPublications.values()).filter(N=>N.source===Y.Source.Microphone);try{E=(yield Promise.all(U.map(N=>{var w;return(w=N.audioTrack)===null||w===void 0?void 0:w.setDeviceId(x)}))).every(N=>N===!0)}catch(N){throw l.options.audioCaptureDefaults.deviceId=I,N}}else if(s==="videoinput"){_=l.localParticipant.videoTrackPublications.size===0;const I=(m=l.getActiveDevice(s))!==null&&m!==void 0?m:l.options.videoCaptureDefaults.deviceId;l.options.videoCaptureDefaults.deviceId=x;const U=Array.from(l.localParticipant.videoTrackPublications.values()).filter(N=>N.source===Y.Source.Camera);try{E=(yield Promise.all(U.map(N=>{var w;return(w=N.videoTrack)===null||w===void 0?void 0:w.setDeviceId(x)}))).every(N=>N===!0)}catch(N){throw l.options.videoCaptureDefaults.deviceId=I,N}}else if(s==="audiooutput"){if(!Ef()&&!l.options.webAudioMix||l.options.webAudioMix&&l.audioContext&&!("setSinkId"in l.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");l.options.webAudioMix&&(o=(h=yield gt.getInstance().normalizeDeviceId("audiooutput",o))!==null&&h!==void 0?h:""),(g=(T=l.options).audioOutput)!==null&&g!==void 0||(T.audioOutput={});const I=(v=l.getActiveDevice(s))!==null&&v!==void 0?v:l.options.audioOutput.deviceId;l.options.audioOutput.deviceId=o;try{l.options.webAudioMix&&((b=l.audioContext)===null||b===void 0||b.setSinkId(o)),yield Promise.all(Array.from(l.remoteParticipants.values()).map(U=>U.setAudioOutput({deviceId:o})))}catch(U){throw l.options.audioOutput.deviceId=I,U}}return(_||s==="audiooutput")&&(l.localParticipant.activeDeviceMap.set(s,s==="audiooutput"&&((k=l.options.audioOutput)===null||k===void 0?void 0:k.deviceId)||o),l.emit(W.ActiveDeviceChanged,s,o)),E}()})}setupLocalParticipantEvents(){this.localParticipant.on(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ae.AttributesChanged,this.onLocalAttributesChanged).on(ae.TrackMuted,this.onLocalTrackMuted).on(ae.TrackUnmuted,this.onLocalTrackUnmuted).on(ae.LocalTrackPublished,this.onLocalTrackPublished).on(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ae.MediaDevicesError,this.onMediaDevicesError).on(ae.AudioStreamAcquired,this.startAudio).on(ae.ChatMessage,this.onLocalChatMessageSent).on(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,i,s){if(this.state===Ne.Connecting||this.state===Ne.Reconnecting){const g=()=>{this.onTrackAdded(e,i,s),v()},v=()=>{this.off(W.Reconnected,g),this.off(W.Connected,g),this.off(W.Disconnected,v)};this.once(W.Reconnected,g),this.once(W.Connected,g),this.once(W.Disconnected,v);return}if(this.state===Ne.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=P_(i.id),l=o[0];let u=o[1],d=e.id;if(u&&u.startsWith("TR")&&(d=u),l===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const m=Array.from(this.remoteParticipants.values()).find(g=>g.sid===l);if(!m){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(l),this.logContext);return}let h;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?h=this.options.adaptiveStream:h={}),m.addSubscribedMediaTrack(e,d,i,s,h)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,i=arguments.length>1?arguments[1]:void 0;var s;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==Ne.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(o=>{o.trackPublications.forEach(l=>{o.unpublishTrack(l.trackSid)})}),this.localParticipant.trackPublications.forEach(o=>{var l,u,d;o.track&&this.localParticipant.unpublishTrack(o.track,e),e?((l=o.track)===null||l===void 0||l.detach(),(u=o.track)===null||u===void 0||u.stop()):(d=o.track)===null||d===void 0||d.stopMonitor()}),this.localParticipant.off(ae.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ae.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ae.AttributesChanged,this.onLocalAttributesChanged).off(ae.TrackMuted,this.onLocalTrackMuted).off(ae.TrackUnmuted,this.onLocalTrackUnmuted).off(ae.LocalTrackPublished,this.onLocalTrackPublished).off(ae.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ae.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ae.MediaDevicesError,this.onMediaDevicesError).off(ae.AudioStreamAcquired,this.startAudio).off(ae.ChatMessage,this.onLocalChatMessageSent).off(ae.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Ut()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(s=navigator.mediaDevices)===null||s===void 0||s.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ne.Disconnected),this.emit(W.Disconnected,i)}}}handleParticipantDisconnected(e,i){var s;this.remoteParticipants.delete(e),i&&(i.trackPublications.forEach(o=>{i.unpublishTrack(o.trackSid,!0)}),this.emit(W.ParticipantDisconnected,i),(s=this.localParticipant)===null||s===void 0||s.handleParticipantDisconnected(i.identity))}handleStreamHeader(e,i){return O(this,void 0,void 0,function*(){var s;if(e.contentHeader.case==="byteHeader"){const o=this.byteStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let l;const u={id:e.streamId,name:(s=e.contentHeader.value.name)!==null&&s!==void 0?s:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Pc(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:m=>{l=m,this.byteStreamControllers.set(e.streamId,{info:u,controller:l,startTime:Date.now()})}});o(new Aw(u,d,Pc(e.totalLength)),{identity:i})}else if(e.contentHeader.case==="textHeader"){const o=this.textStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let l;const u={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},d=new ReadableStream({start:m=>{l=m,this.textStreamControllers.set(e.streamId,{info:u,controller:l,startTime:Date.now()})}});o(new Nw(u,d,Pc(e.totalLength)),{identity:i})}})}handleStreamChunk(e){const i=this.byteStreamControllers.get(e.streamId);i&&e.content.length>0&&i.controller.enqueue(e);const s=this.textStreamControllers.get(e.streamId);s&&e.content.length>0&&s.controller.enqueue(e)}handleStreamTrailer(e){const i=this.textStreamControllers.get(e.streamId);i&&(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close(),this.textStreamControllers.delete(e.streamId));const s=this.byteStreamControllers.get(e.streamId);s&&(s.info.attributes=Object.assign(Object.assign({},s.info.attributes),e.attributes),s.controller.close(),this.byteStreamControllers.delete(e.streamId))}acquireAudioContext(){return O(this,void 0,void 0,function*(){var e,i;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Mb())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),jt(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const s=((i=this.audioContext)===null||i===void 0?void 0:i.state)==="running";s!==this.canPlaybackAudio&&(this.audioEnabled=s,this.emit(W.AudioPlaybackStatusChanged,s))})}createParticipant(e,i){var s;let o;return i?o=Kc.fromParticipantInfo(this.engine.client,i,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new Kc(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((s=this.options.audioOutput)===null||s===void 0)&&s.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),o}getOrCreateParticipant(e,i){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return i&&o.updateInfo(i)&&this.sidToIdentity.set(i.sid,i.identity),o}const s=this.createParticipant(e,i);return this.remoteParticipants.set(e,s),this.sidToIdentity.set(i.sid,i.identity),this.emitWhenConnected(W.ParticipantConnected,s),s.on(ae.TrackPublished,o=>{this.emitWhenConnected(W.TrackPublished,o,s)}).on(ae.TrackSubscribed,(o,l)=>{o.kind===Y.Kind.Audio?(o.on($.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on($.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===Y.Kind.Video&&(o.on($.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on($.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(W.TrackSubscribed,o,l,s)}).on(ae.TrackUnpublished,o=>{this.emit(W.TrackUnpublished,o,s)}).on(ae.TrackUnsubscribed,(o,l)=>{this.emit(W.TrackUnsubscribed,o,l,s)}).on(ae.TrackMuted,o=>{this.emitWhenConnected(W.TrackMuted,o,s)}).on(ae.TrackUnmuted,o=>{this.emitWhenConnected(W.TrackUnmuted,o,s)}).on(ae.ParticipantMetadataChanged,o=>{this.emitWhenConnected(W.ParticipantMetadataChanged,o,s)}).on(ae.ParticipantNameChanged,o=>{this.emitWhenConnected(W.ParticipantNameChanged,o,s)}).on(ae.AttributesChanged,o=>{this.emitWhenConnected(W.ParticipantAttributesChanged,o,s)}).on(ae.ConnectionQualityChanged,o=>{this.emitWhenConnected(W.ConnectionQualityChanged,o,s)}).on(ae.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(W.ParticipantPermissionsChanged,o,s)}).on(ae.TrackSubscriptionStatusChanged,(o,l)=>{this.emitWhenConnected(W.TrackSubscriptionStatusChanged,o,l,s)}).on(ae.TrackSubscriptionFailed,(o,l)=>{this.emit(W.TrackSubscriptionFailed,o,s,l)}).on(ae.TrackSubscriptionPermissionChanged,(o,l)=>{this.emitWhenConnected(W.TrackSubscriptionPermissionChanged,o,l,s)}),i&&s.updateInfo(i),s}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((s,o)=>(s.push(...o.getTrackPublications()),s),[]),i=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,i)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const i of e.videoTrackPublications.values())i.isSubscribed&&K_(i)&&i.emitTrackUpdate()}getRemoteParticipantBySid(e){const i=this.sidToIdentity.get(e);if(i)return this.remoteParticipants.get(i)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Tt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,yn.STATE_MISMATCH))):e=0},Vw)}clearConnectionReconcile(){this.connectionReconcileInterval&&Tt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(W.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[i,s]=e;this.emit(i,...s)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(this.state===Ne.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,s]);else if(this.state===Ne.Connected)return this.emit(e,...s);return!1}simulateParticipants(e){return O(this,void 0,void 0,function*(){var i,s;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),l=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Kf({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Ge.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new zr({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(W.SignalConnected),this.emit(W.Connected),this.setAndEmitConnectionState(Ne.Connected),o.video){const u=new Pf(Y.Kind.Video,new ls({source:ct.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO,name:"video-dummy"}),new Gc(o.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:ny(160*((i=l.aspectRatios[0])!==null&&i!==void 0?i:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(u),this.localParticipant.emit(ae.LocalTrackPublished,u)}if(o.audio){const u=new Pf(Y.Kind.Audio,new ls({source:ct.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO}),new Fc(o.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Ud(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(u),this.localParticipant.emit(ae.LocalTrackPublished,u)}for(let u=0;u<l.count-1;u+=1){let d=new zr({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(u),state:tf.ACTIVE,tracks:[],joinedAt:Ge.parse(Date.now())});const m=this.getOrCreateParticipant(d.identity,d);if(l.video){const h=ny(160*((s=l.aspectRatios[u%l.aspectRatios.length])!==null&&s!==void 0?s:1),160,!1,!0),g=new ls({source:ct.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO});m.addSubscribedMediaTrack(h,g.sid,new MediaStream([h]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}if(l.audio){const h=Ud(),g=new ls({source:ct.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:gn.AUDIO});m.addSubscribedMediaTrack(h,g.sid,new MediaStream([h]),new RTCRtpReceiver),d.tracks=[...d.tracks,g]}m.updateInfo(d)}})}emit(e){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];if(e!==W.ActiveSpeakersChanged&&e!==W.TranscriptionReceived){const l=Gb(s).filter(u=>u!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:l}))}return super.emit(e,...s)}}bs.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(a=>{a()});function Gb(a){return a.map(e=>{if(e)return Array.isArray(e)?Gb(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var pn;(function(a){a[a.IDLE=0]="IDLE",a[a.RUNNING=1]="RUNNING",a[a.SKIPPED=2]="SKIPPED",a[a.SUCCESS=3]="SUCCESS",a[a.FAILED=4]="FAILED"})(pn||(pn={}));class Fi extends jn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=pn.IDLE,this.logs=[],this.options={},this.url=e,this.token=i,this.name=this.constructor.name,this.room=new bs(s.roomOptions),this.connectOptions=s.connectOptions,this.options=s}run(e){return O(this,void 0,void 0,function*(){if(this.status!==pn.IDLE)throw Error("check is running already");this.setStatus(pn.RUNNING);try{yield this.perform()}catch(i){i instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(i.message):this.appendError(i.message))}return yield this.disconnect(),yield new Promise(i=>setTimeout(i,500)),this.status!==pn.SKIPPED&&this.setStatus(this.isSuccess()?pn.SUCCESS:pn.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return O(this,void 0,void 0,function*(){return this.room.state===Ne.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return O(this,void 0,void 0,function*(){this.room&&this.room.state!==Ne.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(pn.SKIPPED)}switchProtocol(e){return O(this,void 0,void 0,function*(){let i=!1,s=!1;if(this.room.on(W.Reconnecting,()=>{i=!0}),this.room.once(W.Reconnected,()=>{s=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(l=>setTimeout(l,1e3)),!i)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(s)return;yield jt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class Hw extends Fi{get description(){return"Cloud regions"}perform(){return O(this,void 0,void 0,function*(){const e=new Af(this.url,this.token);if(!e.isCloud()){this.skip();return}const i=[],s=new Set;for(let l=0;l<3;l++){const u=yield e.getNextBestRegionUrl();if(!u)break;if(s.has(u))continue;s.add(u);const d=yield this.checkCloudRegion(u);this.appendMessage("".concat(d.region," RTT: ").concat(d.rtt,"ms, duration: ").concat(d.duration,"ms")),i.push(d)}i.sort((l,u)=>(l.duration-u.duration)*.5+(l.rtt-u.rtt)*.5);const o=i[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return O(this,void 0,void 0,function*(){var i,s;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(i=this.room.serverInfo)===null||i===void 0?void 0:i.region;if(!o)throw new Error("Region not found");const l=yield this.room.localParticipant.streamText({topic:"test"}),u=1e3,m=1e6/u,h="A".repeat(u),g=Date.now();for(let T=0;T<m;T++)yield l.write(h);yield l.close();const v=Date.now(),b=yield(s=this.room.engine.pcManager)===null||s===void 0?void 0:s.publisher.getStats(),k={region:o,rtt:1e4,duration:v-g};return b==null||b.forEach(T=>{T.type==="candidate-pair"&&T.nominated&&(k.rtt=T.currentRoundTripTime*1e3)}),yield this.disconnect(),k})}}const Fd=1e4;class Fw extends Fi{get description(){return"Connection via UDP vs TCP"}perform(){return O(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),i=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-i.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-i.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=i):this.appendMessage("best connection quality via udp");const s=this.bestStats;this.appendMessage("upstream bitrate: ".concat((s.bitrateTotal/s.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((s.rttTotal/s.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((s.jitterTotal/s.count*1e3).toFixed(2)," ms")),s.packetsLost>0&&this.appendWarning("packets lost: ".concat((s.packetsLost/s.packetsSent*100).toFixed(2),"%")),s.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((s.qualityLimitationDurations.bandwidth/(Fd/1e3)*100).toFixed(2),"%")),s.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((s.qualityLimitationDurations.cpu/(Fd/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return O(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const i=document.createElement("canvas");i.width=1280,i.height=720;const s=i.getContext("2d");if(!s)throw new Error("Could not get canvas context");let o=0;const l=()=>{o=(o+1)%360,s.fillStyle="hsl(".concat(o,", 100%, 50%)"),s.fillRect(0,0,i.width,i.height),requestAnimationFrame(l)};l();const d=i.captureStream(30).getVideoTracks()[0],h=(yield this.room.localParticipant.publishTrack(d,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,g={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},v=setInterval(()=>O(this,void 0,void 0,function*(){const b=yield h.getRTCStatsReport();b==null||b.forEach(k=>{k.type==="outbound-rtp"?(g.packetsSent=k.packetsSent,g.qualityLimitationDurations=k.qualityLimitationDurations,g.bitrateTotal+=k.targetBitrate,g.count++):k.type==="remote-inbound-rtp"&&(g.packetsLost=k.packetsLost,g.rttTotal+=k.roundTripTime,g.jitterTotal+=k.jitter)})}),1e3);return yield new Promise(b=>setTimeout(b,Fd)),clearInterval(v),d.stop(),i.remove(),yield this.disconnect(),g})}}function ch(a){return O(this,void 0,void 0,function*(){var e,i;a??(a={}),(e=a.audio)!==null&&e!==void 0||(a.audio={deviceId:"default"}),(i=a.video)!==null&&i!==void 0||(a.video={deviceId:"default"});const{audioProcessor:s,videoProcessor:o}=th(a),l=Nb(a,Ub,Lb),u=sl(l),d=navigator.mediaDevices.getUserMedia(u);a.audio&&(gt.userMediaPromiseMap.set("audioinput",d),d.catch(()=>gt.userMediaPromiseMap.delete("audioinput"))),a.video&&(gt.userMediaPromiseMap.set("videoinput",d),d.catch(()=>gt.userMediaPromiseMap.delete("videoinput")));const m=yield d;return Promise.all(m.getTracks().map(h=>O(this,void 0,void 0,function*(){const g=h.kind==="audio";g?l.audio:l.video;let v;const b=g?u.audio:u.video;typeof b!="boolean"&&(v=b);const k=h.getSettings().deviceId;v!=null&&v.deviceId&&zi(v.deviceId)!==k?v.deviceId=k:v||(v={deviceId:k});const T=Bb(h,v);return T.kind===Y.Kind.Video?T.source=Y.Source.Camera:T.kind===Y.Kind.Audio&&(T.source=Y.Source.Microphone),T.mediaStream=m,ri(T)&&s?yield T.setProcessor(s):Es(T)&&o&&(yield T.setProcessor(o)),T})))})}function Gw(a){return O(this,void 0,void 0,function*(){return(yield ch({audio:!1,video:a}))[0]})}function Kw(a){return O(this,void 0,void 0,function*(){return(yield ch({audio:a,video:!1}))[0]})}class Yw extends Fi{get description(){return"Can publish audio"}perform(){return O(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield Kw();if(yield Pb(s,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),i.localParticipant.publishTrack(s),yield new Promise(d=>setTimeout(d,3e3));const l=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!l)throw new Error("Could not get RTCStats");let u=0;if(l.forEach(d=>{d.type==="outbound-rtp"&&(d.kind==="audio"||!d.kind&&d.mediaType==="audio")&&(u=d.packetsSent)}),u===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(u," audio packets"))})}}class Qw extends Fi{get description(){return"Can publish video"}perform(){return O(this,void 0,void 0,function*(){var e;const i=yield this.connect(),s=yield Gw();yield this.checkForVideo(s.mediaStreamTrack),i.localParticipant.publishTrack(s),yield new Promise(u=>setTimeout(u,5e3));const o=yield(e=s.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let l=0;if(o.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="video"||!u.kind&&u.mediaType==="video")&&(l+=u.packetsSent)}),l===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(l," video packets"))})}checkForVideo(e){return O(this,void 0,void 0,function*(){const i=new MediaStream;i.addTrack(e.clone());const s=document.createElement("video");s.srcObject=i,s.muted=!0,yield new Promise(o=>{s.onplay=()=>{setTimeout(()=>{var l,u,d,m;const h=document.createElement("canvas"),g=e.getSettings(),v=(u=(l=g.width)!==null&&l!==void 0?l:s.videoWidth)!==null&&u!==void 0?u:1280,b=(m=(d=g.height)!==null&&d!==void 0?d:s.videoHeight)!==null&&m!==void 0?m:720;h.width=v,h.height=b;const k=h.getContext("2d");k.drawImage(s,0,0);const E=k.getImageData(0,0,h.width,h.height).data;let _=!0;for(let x=0;x<E.length;x+=4)if(E[x]!==0||E[x+1]!==0||E[x+2]!==0){_=!1;break}_?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},s.play()}),s.remove()})}}class Xw extends Fi{get description(){return"Resuming connection after interruption"}perform(){return O(this,void 0,void 0,function*(){var e;const i=yield this.connect();let s=!1,o=!1,l;const u=new Promise(h=>{setTimeout(h,5e3),l=h}),d=()=>{s=!0};i.on(W.SignalReconnecting,d).on(W.Reconnecting,d).on(W.Reconnected,()=>{o=!0,l(!0)}),(e=i.engine.client.ws)===null||e===void 0||e.close();const m=i.engine.client.onClose;if(m&&m(""),yield u,s){if(!o||i.state!==Ne.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Jw extends Fi{get description(){return"Can connect via TURN"}perform(){return O(this,void 0,void 0,function*(){var e,i;const s=new nh,o=yield s.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let l=!1,u=!1,d=!1;for(let m of o.iceServers)for(let h of m.urls)h.startsWith("turn:")?(u=!0,d=!0):h.startsWith("turns:")&&(u=!0,d=!0,l=!0),h.startsWith("stun:")&&(d=!0);d?u&&!l&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield s.close(),!((i=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||i===void 0)&&i.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(m=>setTimeout(m,0)))})}}class Zw extends Fi{get description(){return"Establishing WebRTC connection"}perform(){return O(this,void 0,void 0,function*(){let e=!1,i=!1;this.room.on(W.SignalConnected,()=>{const s=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(o,l)=>{if(o.candidate){const u=new RTCIceCandidate(o);let d="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(Ww(u.address)?d+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,d+=" (passive)"):u.protocol==="udp"&&(i=!0)),this.appendMessage(d)}s&&s(o,l)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=o=>{o instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(o.errorCode," ").concat(o.errorText," ").concat(o.url))})});try{yield this.connect(),Ee.info("now the room is connected")}catch(s){throw this.appendWarning("ports need to be open on firewall in order to connect."),s}e||this.appendWarning("Server is not configured for ICE/TCP"),i||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Ww(a){const e=a.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const i=parseInt(e[1],10);if(i>=16&&i<=31)return!0}}return!1}class $w extends Fi{get description(){return"Connecting to signal connection via WebSocket"}perform(){return O(this,void 0,void 0,function*(){var e,i,s;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new nh;const l=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(l.serverVersion,".")),((e=l.serverInfo)===null||e===void 0?void 0:e.edition)===M0.Cloud&&(!((i=l.serverInfo)===null||i===void 0)&&i.region)&&this.appendMessage("LiveKit Cloud: ".concat((s=l.serverInfo)===null||s===void 0?void 0:s.region)),yield o.close()})}}class Rx extends jn.EventEmitter{constructor(e,i){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=i,this.options=s}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:pn.IDLE,name:"",description:""}),e}updateCheck(e,i){this.checkResults.set(e,i),this.emit("checkUpdate",e,i)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==pn.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return O(this,void 0,void 0,function*(){const i=this.getNextCheckId(),s=new e(this.url,this.token,this.options),o=u=>{this.updateCheck(i,u)};s.on("update",o);const l=yield s.run();return s.off("update",o),l})}checkWebsocket(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck($w)})}checkWebRTC(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck(Zw)})}checkTURN(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck(Jw)})}checkReconnect(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck(Xw)})}checkPublishAudio(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck(Yw)})}checkPublishVideo(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck(Qw)})}checkConnectionProtocol(){return O(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(Fw);if(e.data&&"protocol"in e.data){const i=e.data;this.options.protocol=i.protocol}return e})}checkCloudRegion(){return O(this,void 0,void 0,function*(){return this.createAndRunCheck(Hw)})}}class ex{constructor(){ss(this,"room");ss(this,"handleParticipantConnected",e=>{console.log("Participant connected:",e.identity)});ss(this,"handleParticipantDisconnected",e=>{console.log("Participant disconnected:",e.identity)});ss(this,"handleDisconnect",()=>{console.log("Disconnected from room")});ss(this,"handleConnectionStateChanged",e=>{console.log("Connection state changed:",e)});this.room=new bs({adaptiveStream:!0,dynacast:!0,disconnectOnPageLeave:!1}),this.room.on(W.ParticipantConnected,this.handleParticipantConnected).on(W.ParticipantDisconnected,this.handleParticipantDisconnected).on(W.Disconnected,this.handleDisconnect).on(W.ConnectionStateChanged,this.handleConnectionStateChanged)}async getActiveRooms(){try{return(await tt.get("/api/rooms")).data.rooms}catch(e){throw console.error("Failed to get active rooms:",e),new Error("방 목록을 가져오는데 실패했습니다.")}}async createToken(e,i,s){try{return(await tt.post("/api/create-token",{identity:e,roomName:i,metadata:{name:s}})).data.token}catch(o){throw console.error("Failed to create token:",o),new Error("토큰 생성에 실패했습니다.")}}async startBroadcast(e){try{const i="wss://livekitserver1.picklive.show";console.log(`LiveKit 서버 연결 시도: ${i}`),console.log(`토큰 일부: ${e.substring(0,20)}...`);const s={autoSubscribe:!0};return console.log("LiveKit 서버 연결 시작..."),await this.room.connect(i,e,s),console.log("방에 성공적으로 연결됨:",this.room.name),await this.publishLocalTracks(),console.log("로컬 미디어 트랙 게시 완료"),this.room}catch(i){throw console.error("Failed to connect to room:",i),new Error("방송 시작에 실패했습니다.")}}async joinAsViewer(e){try{const i="wss://livekitserver1.picklive.show";console.log(`시청자 모드로 LiveKit 서버 연결 시도: ${i}`);const s={autoSubscribe:!0};return await this.room.connect(i,e,s),console.log("시청자로 방에 성공적으로 연결됨:",this.room.name),this.room}catch(i){throw console.error("Failed to join room as viewer:",i),new Error("방 참여에 실패했습니다.")}}async publishLocalTracks(){try{const e=await ch({audio:!0,video:!0}),i=[];for(const s of e){const o=await this.room.localParticipant.publishTrack(s);i.push(o)}return console.log("Local tracks published"),i}catch(e){throw console.error("Failed to publish local tracks:",e),new Error("카메라 및 마이크 설정에 실패했습니다.")}}async stopBroadcast(){this.room.disconnect(),console.log("Disconnected from room")}getRoom(){return this.room}getLocalParticipant(){return this.room.localParticipant}getRemoteParticipants(){return Array.from(this.room.remoteParticipants.values())}getLocalVideoTrack(){const e=this.getLocalParticipant();if(e)return Array.from(e.trackPublications.values()).find(i=>i.kind==="video")}attachVideoTrack(e){console.log("attachVideoTrack 호출됨:",e);const i=this.getLocalParticipant();if(!i)return console.error("로컬 참가자를 찾을 수 없습니다"),!1;console.log("로컬 참가자 ID:",i.identity);try{const s=Array.from(i.trackPublications.values());console.log("사용 가능한 트랙:",s.map(d=>({kind:d.kind,trackName:d.trackName,source:d.source,hasTrack:!!d.track})));const o=s.filter(d=>d.kind==="video");if(console.log("비디오 트랙 수:",o.length),o.length===0)return console.log("비디오 트랙을 찾을 수 없어 직접 미디어 스트림을 연결합니다"),this.attachDirectMediaStream(e),!0;const l=o[0];console.log("사용할 비디오 트랙:",l.trackName);const u=l.track;return u?(console.log("비디오 트랙 정보:",{id:u.sid,kind:u.kind,mediaStreamTrack:u.mediaStreamTrack?"있음":"없음"}),u.attach(e),console.log("비디오 트랙 연결 성공:",l.trackName),!0):(console.error("비디오 트랙이 없습니다"),!1)}catch(s){return console.error("비디오 트랙 연결 실패:",s),!1}}async attachDirectMediaStream(e){try{if(console.log("직접 미디어 스트림 연결 시도..."),e.srcObject)return console.log("이미 비디오 요소에 스트림이 연결되어 있습니다"),!0;const i={video:{width:{ideal:1280},height:{ideal:720},frameRate:{ideal:30}},audio:!0};console.log("사용자 미디어 요청 중...",i);const s=await navigator.mediaDevices.getUserMedia(i);console.log("미디어 스트림 트랙:",s.getTracks().map(o=>({kind:o.kind,label:o.label,enabled:o.enabled,id:o.id}))),e.srcObject=s;try{await e.play(),console.log("비디오 요소 재생 시작")}catch(o){console.error("비디오 요소 재생 실패:",o),console.log("브라우저 정책으로 인해 사용자 상호작용 후 재생이 필요할 수 있습니다")}return console.log("직접 미디어 스트림 연결 성공"),!0}catch(i){return console.error("직접 미디어 스트림 연결 실패:",i),!1}}}const An=new ex,Kb=({roomName:a,userName:e})=>{const[i,s]=B.useState([]),[o,l]=B.useState(""),u=B.useRef(null);B.useEffect(()=>{m({id:Date.now().toString(),sender:"system",content:`${a} 채팅방에 오신 것을 환영합니다!`,timestamp:new Date}),setTimeout(()=>{m({id:(Date.now()+1).toString(),sender:"시청자1",content:"안녕하세요! 오늘 방송 주제가 뭔가요?",timestamp:new Date})},2e3),setTimeout(()=>{m({id:(Date.now()+2).toString(),sender:"시청자2",content:"화면이 너무 깨끗하네요! 카메라가 뭔가요?",timestamp:new Date})},5e3)},[a]),B.useEffect(()=>{d()},[i]);const d=()=>{var v;(v=u.current)==null||v.scrollIntoView({behavior:"smooth"})},m=v=>{s(b=>[...b,v])},h=v=>{v.preventDefault(),o.trim()!==""&&(m({id:Date.now().toString(),sender:e,content:o,timestamp:new Date}),l(""))},g=v=>v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return C.jsxs("div",{className:"chat-container",children:[C.jsxs("div",{className:"chat-header",children:[C.jsx("h3",{children:"라이브 채팅"}),C.jsx("span",{className:"chat-room",children:a})]}),C.jsxs("div",{className:"chat-messages",children:[i.map(v=>C.jsxs("div",{className:`chat-message ${v.sender==="system"?"system-message":""} ${v.sender===e?"my-message":""}`,children:[C.jsxs("div",{className:"message-header",children:[C.jsx("span",{className:"message-sender",children:v.sender}),C.jsx("span",{className:"message-time",children:g(v.timestamp)})]}),C.jsx("div",{className:"message-content",children:v.content})]},v.id)),C.jsx("div",{ref:u})]}),C.jsxs("form",{className:"chat-input-form",onSubmit:h,children:[C.jsx("input",{type:"text",value:o,onChange:v=>l(v.target.value),placeholder:"메시지 입력...",className:"chat-input"}),C.jsx("button",{type:"submit",className:"chat-send-btn",children:"전송"})]})]})},tx=({userName:a,roomName:e,onClose:i})=>{const[s,o]=B.useState(!0),[l,u]=B.useState(null),[d,m]=B.useState(null),[h,g]=B.useState(!1),[v,b]=B.useState(0),[k,T]=B.useState(0),E=B.useRef(null);B.useEffect(()=>{let I=null;return h&&(I=window.setInterval(()=>{T(U=>U+1)},1e3)),()=>{I&&clearInterval(I)}},[h]),B.useEffect(()=>((async()=>{try{o(!0),u(null);const U=await An.createToken(a,e,a);console.log("토큰 생성 성공");const N=await An.startBroadcast(U);console.log("방 연결 성공:",N.name),m(N),g(!0),setTimeout(()=>{try{let w=null;if(E.current?(w=E.current,console.log("localVideoRef로 비디오 요소를 찾았습니다")):(w=document.getElementById("video-preview"),w&&console.log("getElementById로 비디오 요소를 찾았습니다")),!w){const F=document.querySelectorAll("video");F.length>0&&(w=F[0],console.log("querySelector로 비디오 요소를 찾았습니다"))}if(!w){console.error("어떤 방법으로도 비디오 요소를 찾을 수 없습니다");return}console.log("비디오 요소를 성공적으로 찾았습니다:",w),console.log("비디오 요소에 트랙 연결 시도..."),An.attachVideoTrack(w)||console.error("비디오 트랙을 연결할 수 없습니다")}catch(w){console.error("비디오 연결 오류:",w)}},2e3),N.on("participantConnected",()=>{const w=An.getRemoteParticipants().length;b(w)}),N.on("participantDisconnected",()=>{const w=An.getRemoteParticipants().length;b(w)})}catch(U){console.error("방 초기화 중 오류 발생:",U),u(U instanceof Error?U.message:"방송을 시작할 수 없습니다.")}finally{o(!1)}})(),()=>{d&&An.stopBroadcast()}),[e,a]);const _=()=>{d&&(An.stopBroadcast(),g(!1),i())},x=I=>{const U=Math.floor(I/3600),N=Math.floor(I%3600/60),w=I%60;return[U>0?U.toString().padStart(2,"0"):null,N.toString().padStart(2,"0"),w.toString().padStart(2,"0")].filter(Boolean).join(":")};return s?C.jsxs("div",{className:"broadcaster-container loading",children:[C.jsx("div",{className:"loading-spinner"}),C.jsx("p",{children:"방송을 준비 중입니다..."})]}):l?C.jsxs("div",{className:"broadcaster-container error",children:[C.jsx("div",{className:"error-icon",children:"❌"}),C.jsx("h3",{children:"오류가 발생했습니다"}),C.jsx("p",{children:l}),C.jsx("button",{className:"btn btn-primary",onClick:i,children:"닫기"})]}):C.jsxs("div",{className:"broadcaster-container",children:[C.jsxs("div",{className:"broadcast-header",children:[C.jsxs("div",{className:"broadcast-info",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsx("span",{className:"room-name",children:e}),C.jsx("span",{className:"time-elapsed",children:x(k)})]}),C.jsxs("div",{className:"broadcast-controls",children:[C.jsxs("span",{className:"viewer-count",children:["👁️ ",v]}),C.jsx("button",{className:"btn btn-danger",onClick:_,children:"방송 종료"})]})]}),C.jsxs("div",{className:"broadcast-content",children:[C.jsx("div",{className:"video-container",children:C.jsx("video",{id:"video-preview",ref:E,autoPlay:!0,playsInline:!0,muted:!0,className:"local-video"})}),C.jsx("div",{className:"chat-container-wrapper",children:C.jsx(Kb,{roomName:e,userName:a})})]}),C.jsx("div",{className:"broadcast-footer",children:C.jsx("p",{className:"broadcast-tip",children:"💡 방송 팁: 밝은 곳에서 방송하고, 명확하게 말하면 시청자들이 더 잘 이해할 수 있습니다."})})]})},nx=({userName:a,roomName:e,onClose:i})=>{const[s,o]=B.useState(!0),[l,u]=B.useState(null),[d,m]=B.useState(null),[h,g]=B.useState(0),[v,b]=B.useState(null),[k,T]=B.useState(null),E=I=>{I&&I!==k&&T(I)},_=I=>{if(!k)return;let U;I.trackPublications.forEach(N=>{N.kind===Y.Kind.Video&&(U=N.track)}),U?(U.attach(k),console.log("방송자 비디오 연결 성공")):console.log("방송자 비디오 트랙을 찾을 수 없습니다")};B.useEffect(()=>((async()=>{try{o(!0),u(null);const U=await An.createToken(a,e,a);console.log("토큰 생성 성공");const N=await An.joinAsViewer(U);console.log("방 참여 성공:",N.name),m(N),N.remoteParticipants.forEach(w=>{w.metadata&&w.metadata.includes("host")&&(b(w),k&&_(w))}),g(N.remoteParticipants.size+1),N.on("participantConnected",w=>{w.metadata&&w.metadata.includes("host")&&(b(w),k&&_(w)),g(N.remoteParticipants.size+1)}),N.on("participantDisconnected",w=>{w.metadata&&w.metadata.includes("host")&&(b(null),u("방송이 종료되었습니다.")),g(N.remoteParticipants.size+1)}),N.on("trackSubscribed",(w,F,J)=>{J.metadata&&J.metadata.includes("host")&&w.kind===Y.Kind.Video&&k&&(w.attach(k),console.log("방송자 비디오 트랙 구독 및 연결 성공"))})}catch(U){console.error("방 참여 중 오류 발생:",U),u(U instanceof Error?U.message:"방 참여에 실패했습니다.")}finally{o(!1)}})(),()=>{d&&d.disconnect()}),[e,a]),B.useEffect(()=>{k&&v&&_(v)},[k,v]);const x=()=>{d&&d.disconnect(),i()};return s?C.jsxs("div",{className:"viewer-container loading",children:[C.jsx("div",{className:"loading-spinner"}),C.jsx("p",{children:"방송 연결 중입니다..."})]}):l?C.jsxs("div",{className:"viewer-container error",children:[C.jsx("div",{className:"error-icon",children:"❌"}),C.jsx("h3",{children:"오류가 발생했습니다"}),C.jsx("p",{children:l}),C.jsx("button",{className:"btn btn-primary",onClick:i,children:"닫기"})]}):C.jsxs("div",{className:"viewer-container",children:[C.jsxs("div",{className:"broadcast-header",children:[C.jsxs("div",{className:"broadcast-info",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsx("span",{className:"room-name",children:e})]}),C.jsxs("div",{className:"broadcast-controls",children:[C.jsxs("span",{className:"viewer-count",children:["👁️ ",h]}),C.jsx("button",{className:"btn btn-secondary",onClick:x,children:"나가기"})]})]}),C.jsxs("div",{className:"broadcast-content",children:[C.jsxs("div",{className:"video-container",children:[C.jsx("video",{ref:E,id:"remote-video",autoPlay:!0,playsInline:!0,className:"remote-video"}),!v&&C.jsx("div",{className:"no-broadcast",children:C.jsx("p",{children:"방송이 시작되지 않았거나 종료되었습니다."})})]}),C.jsx("div",{className:"chat-container-wrapper",children:C.jsx(Kb,{roomName:e,userName:a})})]})]})};function ix(){const[a,e]=B.useState(null),[i,s]=B.useState(!1),[o,l]=B.useState(!1),[u,d]=B.useState(""),[m,h]=B.useState(""),[g,v]=B.useState(""),[b,k]=B.useState(""),[T,E]=B.useState([]),[_,x]=B.useState(!1),[I,U]=B.useState(null),[N,w]=B.useState("");B.useEffect(()=>{a==="watch"&&F()},[a]);const F=async()=>{try{x(!0);const ue=await An.getActiveRooms();E(ue),console.log("활성 방 목록 로드 성공:",ue)}catch(ue){console.error("활성 방 목록 로드 실패:",ue)}finally{x(!1)}},J=ue=>{e(ue)},ne=ue=>{ue.preventDefault(),console.log("방송 시작 폼 제출됨:",{roomName:u,userName:m,category:g,description:b}),u&&g?(console.log("방송 시작 조건 충족"),s(!0)):console.log("방송 시작 조건 불충족:",{roomName:u,category:g})},Q=()=>{s(!1)},ee=ue=>{U(ue)},le=ue=>{ue.preventDefault(),I&&N&&(console.log("방 참여 시작:",{roomName:I.name,viewerName:N}),d(I.name),h(N),l(!0))},Re=()=>{l(!1),U(null)};return i?C.jsxs("div",{className:"live-page",children:[C.jsx(pc,{isHomePage:!1}),C.jsx("main",{className:"live-container",children:C.jsx(tx,{userName:m||"익명 사용자",roomName:u,onClose:Q})}),C.jsx(gc,{simplified:!0})]}):o?C.jsxs("div",{className:"live-page",children:[C.jsx(pc,{isHomePage:!1}),C.jsx("main",{className:"live-container",children:C.jsx(nx,{userName:m||"익명 시청자",roomName:u,onClose:Re})}),C.jsx(gc,{simplified:!0})]}):C.jsxs("div",{className:"live-page",children:[C.jsx(pc,{isHomePage:!1}),C.jsxs("main",{className:"live-container",children:[C.jsx("h1",{className:"live-title",children:"라이브 방송"}),C.jsx("p",{className:"live-description",children:"라이브 방송을 통해 제품을 홍보하고 실시간으로 고객과 소통하세요."}),C.jsxs("div",{className:"options-container",children:[C.jsxs("div",{className:`option-card ${a==="broadcast"?"selected":""}`,onClick:()=>J("broadcast"),children:[C.jsx("div",{className:"option-icon",children:"📹"}),C.jsx("h2",{children:"방송하기"}),C.jsx("p",{children:"제품 라이브 방송을 시작하고 고객과 실시간으로 소통하세요."}),C.jsx("button",{className:"btn btn-primary",onClick:ue=>{ue.stopPropagation(),J("broadcast")},children:"방송 시작하기"})]}),C.jsxs("div",{className:`option-card ${a==="watch"?"selected":""}`,onClick:()=>J("watch"),children:[C.jsx("div",{className:"option-icon",children:"👁️"}),C.jsx("h2",{children:"시청하기"}),C.jsx("p",{children:"진행 중인 라이브 방송을 확인하고 참여하세요."}),C.jsx("button",{className:"btn btn-primary",onClick:ue=>{ue.stopPropagation(),J("watch"),F()},children:"라이브 찾기"})]})]}),a==="broadcast"&&C.jsxs("div",{className:"option-details",children:[C.jsx("h3",{children:"방송 시작하기"}),C.jsx("p",{children:"방송을 시작하기 전에 다음 정보를 확인해 주세요:"}),C.jsxs("ul",{children:[C.jsx("li",{children:"제품 정보가 정확히 입력되어 있는지 확인하세요."}),C.jsx("li",{children:"카메라와 마이크 연결 상태를 확인하세요."}),C.jsx("li",{children:"인터넷 연결이 안정적인지 확인하세요."})]}),C.jsxs("form",{className:"broadcast-form",onSubmit:ne,children:[C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"방송 제목",value:u,onChange:ue=>d(ue.target.value),required:!0})}),C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"방송자 이름",value:m,onChange:ue=>h(ue.target.value)})}),C.jsx("div",{className:"form-group",children:C.jsxs("select",{value:g,onChange:ue=>v(ue.target.value),required:!0,children:[C.jsx("option",{value:"",children:"카테고리 선택"}),C.jsx("option",{value:"fashion",children:"패션/의류"}),C.jsx("option",{value:"beauty",children:"뷰티/화장품"}),C.jsx("option",{value:"food",children:"식품"}),C.jsx("option",{value:"home",children:"홈/리빙"}),C.jsx("option",{value:"digital",children:"디지털/가전"})]})}),C.jsx("div",{className:"form-group",children:C.jsx("textarea",{placeholder:"방송 설명",rows:3,value:b,onChange:ue=>k(ue.target.value)})}),C.jsx("button",{type:"submit",className:"btn btn-primary btn-full",children:"방송 시작하기"})]})]}),a==="watch"&&C.jsxs("div",{className:"option-details",children:[C.jsx("h3",{children:"라이브 방송 둘러보기"}),C.jsx("p",{children:"현재 진행 중인 라이브 방송:"}),_?C.jsxs("div",{className:"loading-indicator",children:[C.jsx("div",{className:"loading-spinner"}),C.jsx("p",{children:"방 목록을 불러오는 중..."})]}):T.length>0?C.jsx("div",{className:"live-list",children:T.map(ue=>{var vt;return C.jsxs("div",{className:`live-item ${(I==null?void 0:I.name)===ue.name?"selected":""}`,onClick:()=>ee(ue),children:[C.jsxs("div",{className:"live-thumbnail",children:[C.jsx("span",{className:"live-badge",children:"LIVE"}),C.jsxs("div",{className:"viewer-count",children:["👁️ ",ue.numParticipants]})]}),C.jsx("h4",{children:ue.name}),C.jsxs("p",{children:[((vt=ue.metadata)==null?void 0:vt.category)||"일반"," |",ue.creationTime?new Date(parseInt(ue.creationTime)).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}):"방금"," 시작"]})]},ue.name)})}):C.jsxs("div",{className:"no-rooms",children:[C.jsx("p",{children:"현재 진행 중인 라이브 방송이 없습니다."}),C.jsx("button",{className:"btn btn-secondary",onClick:F,children:"새로고침"})]}),I&&C.jsxs("div",{className:"room-join-form",children:[C.jsxs("h4",{children:['"',I.name,'" 방송 참여하기']}),C.jsxs("form",{onSubmit:le,children:[C.jsx("div",{className:"form-group",children:C.jsx("input",{type:"text",placeholder:"시청자 이름",value:N,onChange:ue=>w(ue.target.value),required:!0})}),C.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:!N,children:"방송 참여하기"})]})]})]})]}),C.jsx(gc,{simplified:!0})]})}function ax(){return C.jsx(zC,{children:C.jsxs(vC,{children:[C.jsx(Kd,{path:"/",element:C.jsx(JC,{})}),C.jsx(Kd,{path:"/live",element:C.jsx(ix,{})})]})})}_k.createRoot(document.getElementById("root")).render(C.jsx(B.StrictMode,{children:C.jsx(ax,{})}));
